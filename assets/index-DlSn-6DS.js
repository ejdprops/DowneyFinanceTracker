var yp=g=>{throw TypeError(g)};var Du=(g,t,i)=>t.has(g)||yp("Cannot "+i);var ne=(g,t,i)=>(Du(g,t,"read from private field"),i?i.call(g):t.get(g)),Fi=(g,t,i)=>t.has(g)?yp("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(g):t.set(g,i),We=(g,t,i,s)=>(Du(g,t,"write to private field"),s?s.call(g,i):t.set(g,i),i),zi=(g,t,i)=>(Du(g,t,"access private method"),i);var vp=(g,t,i,s)=>({set _(a){We(g,t,a,i)},get _(){return ne(g,t,s)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function i(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(a){if(a.ep)return;a.ep=!0;const o=i(a);fetch(a.href,o)}})();function hy(g){return g&&g.__esModule&&Object.prototype.hasOwnProperty.call(g,"default")?g.default:g}var Nu={exports:{}},rr={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xp;function dy(){if(xp)return rr;xp=1;var g=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function i(s,a,o){var l=null;if(o!==void 0&&(l=""+o),a.key!==void 0&&(l=""+a.key),"key"in a){o={};for(var u in a)u!=="key"&&(o[u]=a[u])}else o=a;return a=o.ref,{$$typeof:g,type:s,key:l,ref:a!==void 0?a:null,props:o}}return rr.Fragment=t,rr.jsx=i,rr.jsxs=i,rr}var Ap;function fy(){return Ap||(Ap=1,Nu.exports=dy()),Nu.exports}var y=fy(),Mu={exports:{}},Et={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sp;function gy(){if(Sp)return Et;Sp=1;var g=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),b=Symbol.for("react.activity"),v=Symbol.iterator;function A(M){return M===null||typeof M!="object"?null:(M=v&&M[v]||M["@@iterator"],typeof M=="function"?M:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,C={};function E(M,H,T){this.props=M,this.context=H,this.refs=C,this.updater=T||w}E.prototype.isReactComponent={},E.prototype.setState=function(M,H){if(typeof M!="object"&&typeof M!="function"&&M!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,M,H,"setState")},E.prototype.forceUpdate=function(M){this.updater.enqueueForceUpdate(this,M,"forceUpdate")};function k(){}k.prototype=E.prototype;function O(M,H,T){this.props=M,this.context=H,this.refs=C,this.updater=T||w}var P=O.prototype=new k;P.constructor=O,S(P,E.prototype),P.isPureReactComponent=!0;var z=Array.isArray;function L(){}var j={H:null,A:null,T:null,S:null},D=Object.prototype.hasOwnProperty;function N(M,H,T){var Q=T.ref;return{$$typeof:g,type:M,key:H,ref:Q!==void 0?Q:null,props:T}}function U(M,H){return N(M.type,H,M.props)}function $(M){return typeof M=="object"&&M!==null&&M.$$typeof===g}function tt(M){var H={"=":"=0",":":"=2"};return"$"+M.replace(/[=:]/g,function(T){return H[T]})}var at=/\/+/g;function gt(M,H){return typeof M=="object"&&M!==null&&M.key!=null?tt(""+M.key):H.toString(36)}function bt(M){switch(M.status){case"fulfilled":return M.value;case"rejected":throw M.reason;default:switch(typeof M.status=="string"?M.then(L,L):(M.status="pending",M.then(function(H){M.status==="pending"&&(M.status="fulfilled",M.value=H)},function(H){M.status==="pending"&&(M.status="rejected",M.reason=H)})),M.status){case"fulfilled":return M.value;case"rejected":throw M.reason}}throw M}function F(M,H,T,Q,nt){var rt=typeof M;(rt==="undefined"||rt==="boolean")&&(M=null);var ot=!1;if(M===null)ot=!0;else switch(rt){case"bigint":case"string":case"number":ot=!0;break;case"object":switch(M.$$typeof){case g:case t:ot=!0;break;case p:return ot=M._init,F(ot(M._payload),H,T,Q,nt)}}if(ot)return nt=nt(M),ot=Q===""?"."+gt(M,0):Q,z(nt)?(T="",ot!=null&&(T=ot.replace(at,"$&/")+"/"),F(nt,H,T,"",function(st){return st})):nt!=null&&($(nt)&&(nt=U(nt,T+(nt.key==null||M&&M.key===nt.key?"":(""+nt.key).replace(at,"$&/")+"/")+ot)),H.push(nt)),1;ot=0;var ft=Q===""?".":Q+":";if(z(M))for(var X=0;X<M.length;X++)Q=M[X],rt=ft+gt(Q,X),ot+=F(Q,H,T,rt,nt);else if(X=A(M),typeof X=="function")for(M=X.call(M),X=0;!(Q=M.next()).done;)Q=Q.value,rt=ft+gt(Q,X++),ot+=F(Q,H,T,rt,nt);else if(rt==="object"){if(typeof M.then=="function")return F(bt(M),H,T,Q,nt);throw H=String(M),Error("Objects are not valid as a React child (found: "+(H==="[object Object]"?"object with keys {"+Object.keys(M).join(", ")+"}":H)+"). If you meant to render a collection of children, use an array instead.")}return ot}function q(M,H,T){if(M==null)return M;var Q=[],nt=0;return F(M,Q,"","",function(rt){return H.call(T,rt,nt++)}),Q}function et(M){if(M._status===-1){var H=M._result;H=H(),H.then(function(T){(M._status===0||M._status===-1)&&(M._status=1,M._result=T)},function(T){(M._status===0||M._status===-1)&&(M._status=2,M._result=T)}),M._status===-1&&(M._status=0,M._result=H)}if(M._status===1)return M._result.default;throw M._result}var it=typeof reportError=="function"?reportError:function(M){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var H=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof M=="object"&&M!==null&&typeof M.message=="string"?String(M.message):String(M),error:M});if(!window.dispatchEvent(H))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",M);return}console.error(M)},ut={map:q,forEach:function(M,H,T){q(M,function(){H.apply(this,arguments)},T)},count:function(M){var H=0;return q(M,function(){H++}),H},toArray:function(M){return q(M,function(H){return H})||[]},only:function(M){if(!$(M))throw Error("React.Children.only expected to receive a single React element child.");return M}};return Et.Activity=b,Et.Children=ut,Et.Component=E,Et.Fragment=i,Et.Profiler=a,Et.PureComponent=O,Et.StrictMode=s,Et.Suspense=h,Et.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=j,Et.__COMPILER_RUNTIME={__proto__:null,c:function(M){return j.H.useMemoCache(M)}},Et.cache=function(M){return function(){return M.apply(null,arguments)}},Et.cacheSignal=function(){return null},Et.cloneElement=function(M,H,T){if(M==null)throw Error("The argument must be a React element, but you passed "+M+".");var Q=S({},M.props),nt=M.key;if(H!=null)for(rt in H.key!==void 0&&(nt=""+H.key),H)!D.call(H,rt)||rt==="key"||rt==="__self"||rt==="__source"||rt==="ref"&&H.ref===void 0||(Q[rt]=H[rt]);var rt=arguments.length-2;if(rt===1)Q.children=T;else if(1<rt){for(var ot=Array(rt),ft=0;ft<rt;ft++)ot[ft]=arguments[ft+2];Q.children=ot}return N(M.type,nt,Q)},Et.createContext=function(M){return M={$$typeof:l,_currentValue:M,_currentValue2:M,_threadCount:0,Provider:null,Consumer:null},M.Provider=M,M.Consumer={$$typeof:o,_context:M},M},Et.createElement=function(M,H,T){var Q,nt={},rt=null;if(H!=null)for(Q in H.key!==void 0&&(rt=""+H.key),H)D.call(H,Q)&&Q!=="key"&&Q!=="__self"&&Q!=="__source"&&(nt[Q]=H[Q]);var ot=arguments.length-2;if(ot===1)nt.children=T;else if(1<ot){for(var ft=Array(ot),X=0;X<ot;X++)ft[X]=arguments[X+2];nt.children=ft}if(M&&M.defaultProps)for(Q in ot=M.defaultProps,ot)nt[Q]===void 0&&(nt[Q]=ot[Q]);return N(M,rt,nt)},Et.createRef=function(){return{current:null}},Et.forwardRef=function(M){return{$$typeof:u,render:M}},Et.isValidElement=$,Et.lazy=function(M){return{$$typeof:p,_payload:{_status:-1,_result:M},_init:et}},Et.memo=function(M,H){return{$$typeof:d,type:M,compare:H===void 0?null:H}},Et.startTransition=function(M){var H=j.T,T={};j.T=T;try{var Q=M(),nt=j.S;nt!==null&&nt(T,Q),typeof Q=="object"&&Q!==null&&typeof Q.then=="function"&&Q.then(L,it)}catch(rt){it(rt)}finally{H!==null&&T.types!==null&&(H.types=T.types),j.T=H}},Et.unstable_useCacheRefresh=function(){return j.H.useCacheRefresh()},Et.use=function(M){return j.H.use(M)},Et.useActionState=function(M,H,T){return j.H.useActionState(M,H,T)},Et.useCallback=function(M,H){return j.H.useCallback(M,H)},Et.useContext=function(M){return j.H.useContext(M)},Et.useDebugValue=function(){},Et.useDeferredValue=function(M,H){return j.H.useDeferredValue(M,H)},Et.useEffect=function(M,H){return j.H.useEffect(M,H)},Et.useEffectEvent=function(M){return j.H.useEffectEvent(M)},Et.useId=function(){return j.H.useId()},Et.useImperativeHandle=function(M,H,T){return j.H.useImperativeHandle(M,H,T)},Et.useInsertionEffect=function(M,H){return j.H.useInsertionEffect(M,H)},Et.useLayoutEffect=function(M,H){return j.H.useLayoutEffect(M,H)},Et.useMemo=function(M,H){return j.H.useMemo(M,H)},Et.useOptimistic=function(M,H){return j.H.useOptimistic(M,H)},Et.useReducer=function(M,H,T){return j.H.useReducer(M,H,T)},Et.useRef=function(M){return j.H.useRef(M)},Et.useState=function(M){return j.H.useState(M)},Et.useSyncExternalStore=function(M,H,T){return j.H.useSyncExternalStore(M,H,T)},Et.useTransition=function(){return j.H.useTransition()},Et.version="19.2.0",Et}var wp;function sh(){return wp||(wp=1,Mu.exports=gy()),Mu.exports}var mt=sh(),Ru={exports:{}},or={},ku={exports:{}},Ou={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _p;function py(){return _p||(_p=1,(function(g){function t(F,q){var et=F.length;F.push(q);t:for(;0<et;){var it=et-1>>>1,ut=F[it];if(0<a(ut,q))F[it]=q,F[et]=ut,et=it;else break t}}function i(F){return F.length===0?null:F[0]}function s(F){if(F.length===0)return null;var q=F[0],et=F.pop();if(et!==q){F[0]=et;t:for(var it=0,ut=F.length,M=ut>>>1;it<M;){var H=2*(it+1)-1,T=F[H],Q=H+1,nt=F[Q];if(0>a(T,et))Q<ut&&0>a(nt,T)?(F[it]=nt,F[Q]=et,it=Q):(F[it]=T,F[H]=et,it=H);else if(Q<ut&&0>a(nt,et))F[it]=nt,F[Q]=et,it=Q;else break t}}return q}function a(F,q){var et=F.sortIndex-q.sortIndex;return et!==0?et:F.id-q.id}if(g.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;g.unstable_now=function(){return o.now()}}else{var l=Date,u=l.now();g.unstable_now=function(){return l.now()-u}}var h=[],d=[],p=1,b=null,v=3,A=!1,w=!1,S=!1,C=!1,E=typeof setTimeout=="function"?setTimeout:null,k=typeof clearTimeout=="function"?clearTimeout:null,O=typeof setImmediate<"u"?setImmediate:null;function P(F){for(var q=i(d);q!==null;){if(q.callback===null)s(d);else if(q.startTime<=F)s(d),q.sortIndex=q.expirationTime,t(h,q);else break;q=i(d)}}function z(F){if(S=!1,P(F),!w)if(i(h)!==null)w=!0,L||(L=!0,tt());else{var q=i(d);q!==null&&bt(z,q.startTime-F)}}var L=!1,j=-1,D=5,N=-1;function U(){return C?!0:!(g.unstable_now()-N<D)}function $(){if(C=!1,L){var F=g.unstable_now();N=F;var q=!0;try{t:{w=!1,S&&(S=!1,k(j),j=-1),A=!0;var et=v;try{e:{for(P(F),b=i(h);b!==null&&!(b.expirationTime>F&&U());){var it=b.callback;if(typeof it=="function"){b.callback=null,v=b.priorityLevel;var ut=it(b.expirationTime<=F);if(F=g.unstable_now(),typeof ut=="function"){b.callback=ut,P(F),q=!0;break e}b===i(h)&&s(h),P(F)}else s(h);b=i(h)}if(b!==null)q=!0;else{var M=i(d);M!==null&&bt(z,M.startTime-F),q=!1}}break t}finally{b=null,v=et,A=!1}q=void 0}}finally{q?tt():L=!1}}}var tt;if(typeof O=="function")tt=function(){O($)};else if(typeof MessageChannel<"u"){var at=new MessageChannel,gt=at.port2;at.port1.onmessage=$,tt=function(){gt.postMessage(null)}}else tt=function(){E($,0)};function bt(F,q){j=E(function(){F(g.unstable_now())},q)}g.unstable_IdlePriority=5,g.unstable_ImmediatePriority=1,g.unstable_LowPriority=4,g.unstable_NormalPriority=3,g.unstable_Profiling=null,g.unstable_UserBlockingPriority=2,g.unstable_cancelCallback=function(F){F.callback=null},g.unstable_forceFrameRate=function(F){0>F||125<F?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<F?Math.floor(1e3/F):5},g.unstable_getCurrentPriorityLevel=function(){return v},g.unstable_next=function(F){switch(v){case 1:case 2:case 3:var q=3;break;default:q=v}var et=v;v=q;try{return F()}finally{v=et}},g.unstable_requestPaint=function(){C=!0},g.unstable_runWithPriority=function(F,q){switch(F){case 1:case 2:case 3:case 4:case 5:break;default:F=3}var et=v;v=F;try{return q()}finally{v=et}},g.unstable_scheduleCallback=function(F,q,et){var it=g.unstable_now();switch(typeof et=="object"&&et!==null?(et=et.delay,et=typeof et=="number"&&0<et?it+et:it):et=it,F){case 1:var ut=-1;break;case 2:ut=250;break;case 5:ut=1073741823;break;case 4:ut=1e4;break;default:ut=5e3}return ut=et+ut,F={id:p++,callback:q,priorityLevel:F,startTime:et,expirationTime:ut,sortIndex:-1},et>it?(F.sortIndex=et,t(d,F),i(h)===null&&F===i(d)&&(S?(k(j),j=-1):S=!0,bt(z,et-it))):(F.sortIndex=ut,t(h,F),w||A||(w=!0,L||(L=!0,tt()))),F},g.unstable_shouldYield=U,g.unstable_wrapCallback=function(F){var q=v;return function(){var et=v;v=q;try{return F.apply(this,arguments)}finally{v=et}}}})(Ou)),Ou}var Ep;function my(){return Ep||(Ep=1,ku.exports=py()),ku.exports}var Lu={exports:{}},Pe={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Cp;function by(){if(Cp)return Pe;Cp=1;var g=sh();function t(h){var d="https://react.dev/errors/"+h;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)d+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+h+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(){}var s={d:{f:i,r:function(){throw Error(t(522))},D:i,C:i,L:i,m:i,X:i,S:i,M:i},p:0,findDOMNode:null},a=Symbol.for("react.portal");function o(h,d,p){var b=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:b==null?null:""+b,children:h,containerInfo:d,implementation:p}}var l=g.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(h,d){if(h==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return Pe.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,Pe.createPortal=function(h,d){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(t(299));return o(h,d,null,p)},Pe.flushSync=function(h){var d=l.T,p=s.p;try{if(l.T=null,s.p=2,h)return h()}finally{l.T=d,s.p=p,s.d.f()}},Pe.preconnect=function(h,d){typeof h=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,s.d.C(h,d))},Pe.prefetchDNS=function(h){typeof h=="string"&&s.d.D(h)},Pe.preinit=function(h,d){if(typeof h=="string"&&d&&typeof d.as=="string"){var p=d.as,b=u(p,d.crossOrigin),v=typeof d.integrity=="string"?d.integrity:void 0,A=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;p==="style"?s.d.S(h,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:b,integrity:v,fetchPriority:A}):p==="script"&&s.d.X(h,{crossOrigin:b,integrity:v,fetchPriority:A,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},Pe.preinitModule=function(h,d){if(typeof h=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var p=u(d.as,d.crossOrigin);s.d.M(h,{crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&s.d.M(h)},Pe.preload=function(h,d){if(typeof h=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var p=d.as,b=u(p,d.crossOrigin);s.d.L(h,p,{crossOrigin:b,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},Pe.preloadModule=function(h,d){if(typeof h=="string")if(d){var p=u(d.as,d.crossOrigin);s.d.m(h,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else s.d.m(h)},Pe.requestFormReset=function(h){s.d.r(h)},Pe.unstable_batchedUpdates=function(h,d){return h(d)},Pe.useFormState=function(h,d,p){return l.H.useFormState(h,d,p)},Pe.useFormStatus=function(){return l.H.useHostTransitionStatus()},Pe.version="19.2.0",Pe}var Tp;function yy(){if(Tp)return Lu.exports;Tp=1;function g(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(g)}catch(t){console.error(t)}}return g(),Lu.exports=by(),Lu.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Dp;function vy(){if(Dp)return or;Dp=1;var g=my(),t=sh(),i=yy();function s(e){var n="https://react.dev/errors/"+e;if(1<arguments.length){n+="?args[]="+encodeURIComponent(arguments[1]);for(var r=2;r<arguments.length;r++)n+="&args[]="+encodeURIComponent(arguments[r])}return"Minified React error #"+e+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function o(e){var n=e,r=e;if(e.alternate)for(;n.return;)n=n.return;else{e=n;do n=e,(n.flags&4098)!==0&&(r=n.return),e=n.return;while(e)}return n.tag===3?r:null}function l(e){if(e.tag===13){var n=e.memoizedState;if(n===null&&(e=e.alternate,e!==null&&(n=e.memoizedState)),n!==null)return n.dehydrated}return null}function u(e){if(e.tag===31){var n=e.memoizedState;if(n===null&&(e=e.alternate,e!==null&&(n=e.memoizedState)),n!==null)return n.dehydrated}return null}function h(e){if(o(e)!==e)throw Error(s(188))}function d(e){var n=e.alternate;if(!n){if(n=o(e),n===null)throw Error(s(188));return n!==e?null:e}for(var r=e,c=n;;){var f=r.return;if(f===null)break;var m=f.alternate;if(m===null){if(c=f.return,c!==null){r=c;continue}break}if(f.child===m.child){for(m=f.child;m;){if(m===r)return h(f),e;if(m===c)return h(f),n;m=m.sibling}throw Error(s(188))}if(r.return!==c.return)r=f,c=m;else{for(var x=!1,_=f.child;_;){if(_===r){x=!0,r=f,c=m;break}if(_===c){x=!0,c=f,r=m;break}_=_.sibling}if(!x){for(_=m.child;_;){if(_===r){x=!0,r=m,c=f;break}if(_===c){x=!0,c=m,r=f;break}_=_.sibling}if(!x)throw Error(s(189))}}if(r.alternate!==c)throw Error(s(190))}if(r.tag!==3)throw Error(s(188));return r.stateNode.current===r?e:n}function p(e){var n=e.tag;if(n===5||n===26||n===27||n===6)return e;for(e=e.child;e!==null;){if(n=p(e),n!==null)return n;e=e.sibling}return null}var b=Object.assign,v=Symbol.for("react.element"),A=Symbol.for("react.transitional.element"),w=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),C=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),k=Symbol.for("react.consumer"),O=Symbol.for("react.context"),P=Symbol.for("react.forward_ref"),z=Symbol.for("react.suspense"),L=Symbol.for("react.suspense_list"),j=Symbol.for("react.memo"),D=Symbol.for("react.lazy"),N=Symbol.for("react.activity"),U=Symbol.for("react.memo_cache_sentinel"),$=Symbol.iterator;function tt(e){return e===null||typeof e!="object"?null:(e=$&&e[$]||e["@@iterator"],typeof e=="function"?e:null)}var at=Symbol.for("react.client.reference");function gt(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===at?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case S:return"Fragment";case E:return"Profiler";case C:return"StrictMode";case z:return"Suspense";case L:return"SuspenseList";case N:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case w:return"Portal";case O:return e.displayName||"Context";case k:return(e._context.displayName||"Context")+".Consumer";case P:var n=e.render;return e=e.displayName,e||(e=n.displayName||n.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case j:return n=e.displayName||null,n!==null?n:gt(e.type)||"Memo";case D:n=e._payload,e=e._init;try{return gt(e(n))}catch{}}return null}var bt=Array.isArray,F=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,q=i.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,et={pending:!1,data:null,method:null,action:null},it=[],ut=-1;function M(e){return{current:e}}function H(e){0>ut||(e.current=it[ut],it[ut]=null,ut--)}function T(e,n){ut++,it[ut]=e.current,e.current=n}var Q=M(null),nt=M(null),rt=M(null),ot=M(null);function ft(e,n){switch(T(rt,n),T(nt,e),T(Q,null),n.nodeType){case 9:case 11:e=(e=n.documentElement)&&(e=e.namespaceURI)?Ug(e):0;break;default:if(e=n.tagName,n=n.namespaceURI)n=Ug(n),e=Hg(n,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}H(Q),T(Q,e)}function X(){H(Q),H(nt),H(rt)}function st(e){e.memoizedState!==null&&T(ot,e);var n=Q.current,r=Hg(n,e.type);n!==r&&(T(nt,e),T(Q,r))}function lt(e){nt.current===e&&(H(Q),H(nt)),ot.current===e&&(H(ot),ir._currentValue=et)}var Rt,Gt;function St(e){if(Rt===void 0)try{throw Error()}catch(r){var n=r.stack.trim().match(/\n( *(at )?)/);Rt=n&&n[1]||"",Gt=-1<r.stack.indexOf(`
    at`)?" (<anonymous>)":-1<r.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Rt+e+Gt}var Lt=!1;function wt(e,n){if(!e||Lt)return"";Lt=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(n){var J=function(){throw Error()};if(Object.defineProperty(J.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(J,[])}catch(K){var Y=K}Reflect.construct(e,[],J)}else{try{J.call()}catch(K){Y=K}e.call(J.prototype)}}else{try{throw Error()}catch(K){Y=K}(J=e())&&typeof J.catch=="function"&&J.catch(function(){})}}catch(K){if(K&&Y&&typeof K.stack=="string")return[K.stack,Y.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var f=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");f&&f.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var m=c.DetermineComponentFrameRoot(),x=m[0],_=m[1];if(x&&_){var R=x.split(`
`),V=_.split(`
`);for(f=c=0;c<R.length&&!R[c].includes("DetermineComponentFrameRoot");)c++;for(;f<V.length&&!V[f].includes("DetermineComponentFrameRoot");)f++;if(c===R.length||f===V.length)for(c=R.length-1,f=V.length-1;1<=c&&0<=f&&R[c]!==V[f];)f--;for(;1<=c&&0<=f;c--,f--)if(R[c]!==V[f]){if(c!==1||f!==1)do if(c--,f--,0>f||R[c]!==V[f]){var W=`
`+R[c].replace(" at new "," at ");return e.displayName&&W.includes("<anonymous>")&&(W=W.replace("<anonymous>",e.displayName)),W}while(1<=c&&0<=f);break}}}finally{Lt=!1,Error.prepareStackTrace=r}return(r=e?e.displayName||e.name:"")?St(r):""}function je(e,n){switch(e.tag){case 26:case 27:case 5:return St(e.type);case 16:return St("Lazy");case 13:return e.child!==n&&n!==null?St("Suspense Fallback"):St("Suspense");case 19:return St("SuspenseList");case 0:case 15:return wt(e.type,!1);case 11:return wt(e.type.render,!1);case 1:return wt(e.type,!0);case 31:return St("Activity");default:return""}}function _t(e){try{var n="",r=null;do n+=je(e,r),r=e,e=e.return;while(e);return n}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var Ht=Object.prototype.hasOwnProperty,oe=g.unstable_scheduleCallback,Oi=g.unstable_cancelCallback,hi=g.unstable_shouldYield,qn=g.unstable_requestPaint,Vt=g.unstable_now,di=g.unstable_getCurrentPriorityLevel,he=g.unstable_ImmediatePriority,Ee=g.unstable_UserBlockingPriority,qe=g.unstable_NormalPriority,fa=g.unstable_LowPriority,ga=g.unstable_IdlePriority,fn=g.log,fi=g.unstable_setDisableYieldValue,Di=null,Be=null;function gn(e){if(typeof fn=="function"&&fi(e),Be&&typeof Be.setStrictMode=="function")try{Be.setStrictMode(Di,e)}catch{}}var ei=Math.clz32?Math.clz32:Wm,Km=Math.log,Qm=Math.LN2;function Wm(e){return e>>>=0,e===0?32:31-(Km(e)/Qm|0)|0}var Dr=256,Nr=262144,Mr=4194304;function Gn(e){var n=e&42;if(n!==0)return n;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Rr(e,n,r){var c=e.pendingLanes;if(c===0)return 0;var f=0,m=e.suspendedLanes,x=e.pingedLanes;e=e.warmLanes;var _=c&134217727;return _!==0?(c=_&~m,c!==0?f=Gn(c):(x&=_,x!==0?f=Gn(x):r||(r=_&~e,r!==0&&(f=Gn(r))))):(_=c&~m,_!==0?f=Gn(_):x!==0?f=Gn(x):r||(r=c&~e,r!==0&&(f=Gn(r)))),f===0?0:n!==0&&n!==f&&(n&m)===0&&(m=f&-f,r=n&-n,m>=r||m===32&&(r&4194048)!==0)?n:f}function pa(e,n){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&n)===0}function Zm(e,n){switch(e){case 1:case 2:case 4:case 8:case 64:return n+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ah(){var e=Mr;return Mr<<=1,(Mr&62914560)===0&&(Mr=4194304),e}function ml(e){for(var n=[],r=0;31>r;r++)n.push(e);return n}function ma(e,n){e.pendingLanes|=n,n!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Jm(e,n,r,c,f,m){var x=e.pendingLanes;e.pendingLanes=r,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=r,e.entangledLanes&=r,e.errorRecoveryDisabledLanes&=r,e.shellSuspendCounter=0;var _=e.entanglements,R=e.expirationTimes,V=e.hiddenUpdates;for(r=x&~r;0<r;){var W=31-ei(r),J=1<<W;_[W]=0,R[W]=-1;var Y=V[W];if(Y!==null)for(V[W]=null,W=0;W<Y.length;W++){var K=Y[W];K!==null&&(K.lane&=-536870913)}r&=~J}c!==0&&Sh(e,c,0),m!==0&&f===0&&e.tag!==0&&(e.suspendedLanes|=m&~(x&~n))}function Sh(e,n,r){e.pendingLanes|=n,e.suspendedLanes&=~n;var c=31-ei(n);e.entangledLanes|=n,e.entanglements[c]=e.entanglements[c]|1073741824|r&261930}function wh(e,n){var r=e.entangledLanes|=n;for(e=e.entanglements;r;){var c=31-ei(r),f=1<<c;f&n|e[c]&n&&(e[c]|=n),r&=~f}}function _h(e,n){var r=n&-n;return r=(r&42)!==0?1:bl(r),(r&(e.suspendedLanes|n))!==0?0:r}function bl(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function yl(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function Eh(){var e=q.p;return e!==0?e:(e=window.event,e===void 0?32:hp(e.type))}function Ch(e,n){var r=q.p;try{return q.p=e,n()}finally{q.p=r}}var pn=Math.random().toString(36).slice(2),Ce="__reactFiber$"+pn,Ge="__reactProps$"+pn,bs="__reactContainer$"+pn,vl="__reactEvents$"+pn,t0="__reactListeners$"+pn,e0="__reactHandles$"+pn,Th="__reactResources$"+pn,ba="__reactMarker$"+pn;function xl(e){delete e[Ce],delete e[Ge],delete e[vl],delete e[t0],delete e[e0]}function ys(e){var n=e[Ce];if(n)return n;for(var r=e.parentNode;r;){if(n=r[bs]||r[Ce]){if(r=n.alternate,n.child!==null||r!==null&&r.child!==null)for(e=Kg(e);e!==null;){if(r=e[Ce])return r;e=Kg(e)}return n}e=r,r=e.parentNode}return null}function vs(e){if(e=e[Ce]||e[bs]){var n=e.tag;if(n===5||n===6||n===13||n===31||n===26||n===27||n===3)return e}return null}function ya(e){var n=e.tag;if(n===5||n===26||n===27||n===6)return e.stateNode;throw Error(s(33))}function xs(e){var n=e[Th];return n||(n=e[Th]={hoistableStyles:new Map,hoistableScripts:new Map}),n}function Se(e){e[ba]=!0}var Dh=new Set,Nh={};function Vn(e,n){As(e,n),As(e+"Capture",n)}function As(e,n){for(Nh[e]=n,e=0;e<n.length;e++)Dh.add(n[e])}var i0=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Mh={},Rh={};function n0(e){return Ht.call(Rh,e)?!0:Ht.call(Mh,e)?!1:i0.test(e)?Rh[e]=!0:(Mh[e]=!0,!1)}function kr(e,n,r){if(n0(n))if(r===null)e.removeAttribute(n);else{switch(typeof r){case"undefined":case"function":case"symbol":e.removeAttribute(n);return;case"boolean":var c=n.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){e.removeAttribute(n);return}}e.setAttribute(n,""+r)}}function Or(e,n,r){if(r===null)e.removeAttribute(n);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(n);return}e.setAttribute(n,""+r)}}function Vi(e,n,r,c){if(c===null)e.removeAttribute(r);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(r);return}e.setAttributeNS(n,r,""+c)}}function gi(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function kh(e){var n=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function s0(e,n,r){var c=Object.getOwnPropertyDescriptor(e.constructor.prototype,n);if(!e.hasOwnProperty(n)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var f=c.get,m=c.set;return Object.defineProperty(e,n,{configurable:!0,get:function(){return f.call(this)},set:function(x){r=""+x,m.call(this,x)}}),Object.defineProperty(e,n,{enumerable:c.enumerable}),{getValue:function(){return r},setValue:function(x){r=""+x},stopTracking:function(){e._valueTracker=null,delete e[n]}}}}function Al(e){if(!e._valueTracker){var n=kh(e)?"checked":"value";e._valueTracker=s0(e,n,""+e[n])}}function Oh(e){if(!e)return!1;var n=e._valueTracker;if(!n)return!0;var r=n.getValue(),c="";return e&&(c=kh(e)?e.checked?"true":"false":e.value),e=c,e!==r?(n.setValue(e),!0):!1}function Lr(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var a0=/[\n"\\]/g;function pi(e){return e.replace(a0,function(n){return"\\"+n.charCodeAt(0).toString(16)+" "})}function Sl(e,n,r,c,f,m,x,_){e.name="",x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"?e.type=x:e.removeAttribute("type"),n!=null?x==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+gi(n)):e.value!==""+gi(n)&&(e.value=""+gi(n)):x!=="submit"&&x!=="reset"||e.removeAttribute("value"),n!=null?wl(e,x,gi(n)):r!=null?wl(e,x,gi(r)):c!=null&&e.removeAttribute("value"),f==null&&m!=null&&(e.defaultChecked=!!m),f!=null&&(e.checked=f&&typeof f!="function"&&typeof f!="symbol"),_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"?e.name=""+gi(_):e.removeAttribute("name")}function Lh(e,n,r,c,f,m,x,_){if(m!=null&&typeof m!="function"&&typeof m!="symbol"&&typeof m!="boolean"&&(e.type=m),n!=null||r!=null){if(!(m!=="submit"&&m!=="reset"||n!=null)){Al(e);return}r=r!=null?""+gi(r):"",n=n!=null?""+gi(n):r,_||n===e.value||(e.value=n),e.defaultValue=n}c=c??f,c=typeof c!="function"&&typeof c!="symbol"&&!!c,e.checked=_?e.checked:!!c,e.defaultChecked=!!c,x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"&&(e.name=x),Al(e)}function wl(e,n,r){n==="number"&&Lr(e.ownerDocument)===e||e.defaultValue===""+r||(e.defaultValue=""+r)}function Ss(e,n,r,c){if(e=e.options,n){n={};for(var f=0;f<r.length;f++)n["$"+r[f]]=!0;for(r=0;r<e.length;r++)f=n.hasOwnProperty("$"+e[r].value),e[r].selected!==f&&(e[r].selected=f),f&&c&&(e[r].defaultSelected=!0)}else{for(r=""+gi(r),n=null,f=0;f<e.length;f++){if(e[f].value===r){e[f].selected=!0,c&&(e[f].defaultSelected=!0);return}n!==null||e[f].disabled||(n=e[f])}n!==null&&(n.selected=!0)}}function jh(e,n,r){if(n!=null&&(n=""+gi(n),n!==e.value&&(e.value=n),r==null)){e.defaultValue!==n&&(e.defaultValue=n);return}e.defaultValue=r!=null?""+gi(r):""}function Bh(e,n,r,c){if(n==null){if(c!=null){if(r!=null)throw Error(s(92));if(bt(c)){if(1<c.length)throw Error(s(93));c=c[0]}r=c}r==null&&(r=""),n=r}r=gi(n),e.defaultValue=r,c=e.textContent,c===r&&c!==""&&c!==null&&(e.value=c),Al(e)}function ws(e,n){if(n){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=n;return}}e.textContent=n}var r0=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Ph(e,n,r){var c=n.indexOf("--")===0;r==null||typeof r=="boolean"||r===""?c?e.setProperty(n,""):n==="float"?e.cssFloat="":e[n]="":c?e.setProperty(n,r):typeof r!="number"||r===0||r0.has(n)?n==="float"?e.cssFloat=r:e[n]=(""+r).trim():e[n]=r+"px"}function Fh(e,n,r){if(n!=null&&typeof n!="object")throw Error(s(62));if(e=e.style,r!=null){for(var c in r)!r.hasOwnProperty(c)||n!=null&&n.hasOwnProperty(c)||(c.indexOf("--")===0?e.setProperty(c,""):c==="float"?e.cssFloat="":e[c]="");for(var f in n)c=n[f],n.hasOwnProperty(f)&&r[f]!==c&&Ph(e,f,c)}else for(var m in n)n.hasOwnProperty(m)&&Ph(e,m,n[m])}function _l(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var o0=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),l0=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function jr(e){return l0.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function Yi(){}var El=null;function Cl(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var _s=null,Es=null;function zh(e){var n=vs(e);if(n&&(e=n.stateNode)){var r=e[Ge]||null;t:switch(e=n.stateNode,n.type){case"input":if(Sl(e,r.value,r.defaultValue,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name),n=r.name,r.type==="radio"&&n!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll('input[name="'+pi(""+n)+'"][type="radio"]'),n=0;n<r.length;n++){var c=r[n];if(c!==e&&c.form===e.form){var f=c[Ge]||null;if(!f)throw Error(s(90));Sl(c,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name)}}for(n=0;n<r.length;n++)c=r[n],c.form===e.form&&Oh(c)}break t;case"textarea":jh(e,r.value,r.defaultValue);break t;case"select":n=r.value,n!=null&&Ss(e,!!r.multiple,n,!1)}}}var Tl=!1;function Ih(e,n,r){if(Tl)return e(n,r);Tl=!0;try{var c=e(n);return c}finally{if(Tl=!1,(_s!==null||Es!==null)&&(wo(),_s&&(n=_s,e=Es,Es=_s=null,zh(n),e)))for(n=0;n<e.length;n++)zh(e[n])}}function va(e,n){var r=e.stateNode;if(r===null)return null;var c=r[Ge]||null;if(c===null)return null;r=c[n];t:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(e=e.type,c=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!c;break t;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(s(231,n,typeof r));return r}var Xi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Dl=!1;if(Xi)try{var xa={};Object.defineProperty(xa,"passive",{get:function(){Dl=!0}}),window.addEventListener("test",xa,xa),window.removeEventListener("test",xa,xa)}catch{Dl=!1}var mn=null,Nl=null,Br=null;function Uh(){if(Br)return Br;var e,n=Nl,r=n.length,c,f="value"in mn?mn.value:mn.textContent,m=f.length;for(e=0;e<r&&n[e]===f[e];e++);var x=r-e;for(c=1;c<=x&&n[r-c]===f[m-c];c++);return Br=f.slice(e,1<c?1-c:void 0)}function Pr(e){var n=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&n===13&&(e=13)):e=n,e===10&&(e=13),32<=e||e===13?e:0}function Fr(){return!0}function Hh(){return!1}function Ve(e){function n(r,c,f,m,x){this._reactName=r,this._targetInst=f,this.type=c,this.nativeEvent=m,this.target=x,this.currentTarget=null;for(var _ in e)e.hasOwnProperty(_)&&(r=e[_],this[_]=r?r(m):m[_]);return this.isDefaultPrevented=(m.defaultPrevented!=null?m.defaultPrevented:m.returnValue===!1)?Fr:Hh,this.isPropagationStopped=Hh,this}return b(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Fr)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Fr)},persist:function(){},isPersistent:Fr}),n}var Yn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},zr=Ve(Yn),Aa=b({},Yn,{view:0,detail:0}),c0=Ve(Aa),Ml,Rl,Sa,Ir=b({},Aa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ol,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Sa&&(Sa&&e.type==="mousemove"?(Ml=e.screenX-Sa.screenX,Rl=e.screenY-Sa.screenY):Rl=Ml=0,Sa=e),Ml)},movementY:function(e){return"movementY"in e?e.movementY:Rl}}),qh=Ve(Ir),u0=b({},Ir,{dataTransfer:0}),h0=Ve(u0),d0=b({},Aa,{relatedTarget:0}),kl=Ve(d0),f0=b({},Yn,{animationName:0,elapsedTime:0,pseudoElement:0}),g0=Ve(f0),p0=b({},Yn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),m0=Ve(p0),b0=b({},Yn,{data:0}),Gh=Ve(b0),y0={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},v0={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},x0={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function A0(e){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(e):(e=x0[e])?!!n[e]:!1}function Ol(){return A0}var S0=b({},Aa,{key:function(e){if(e.key){var n=y0[e.key]||e.key;if(n!=="Unidentified")return n}return e.type==="keypress"?(e=Pr(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?v0[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ol,charCode:function(e){return e.type==="keypress"?Pr(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Pr(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),w0=Ve(S0),_0=b({},Ir,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Vh=Ve(_0),E0=b({},Aa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ol}),C0=Ve(E0),T0=b({},Yn,{propertyName:0,elapsedTime:0,pseudoElement:0}),D0=Ve(T0),N0=b({},Ir,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),M0=Ve(N0),R0=b({},Yn,{newState:0,oldState:0}),k0=Ve(R0),O0=[9,13,27,32],Ll=Xi&&"CompositionEvent"in window,wa=null;Xi&&"documentMode"in document&&(wa=document.documentMode);var L0=Xi&&"TextEvent"in window&&!wa,Yh=Xi&&(!Ll||wa&&8<wa&&11>=wa),Xh=" ",$h=!1;function Kh(e,n){switch(e){case"keyup":return O0.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Qh(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Cs=!1;function j0(e,n){switch(e){case"compositionend":return Qh(n);case"keypress":return n.which!==32?null:($h=!0,Xh);case"textInput":return e=n.data,e===Xh&&$h?null:e;default:return null}}function B0(e,n){if(Cs)return e==="compositionend"||!Ll&&Kh(e,n)?(e=Uh(),Br=Nl=mn=null,Cs=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return Yh&&n.locale!=="ko"?null:n.data;default:return null}}var P0={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Wh(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n==="input"?!!P0[e.type]:n==="textarea"}function Zh(e,n,r,c){_s?Es?Es.push(c):Es=[c]:_s=c,n=Mo(n,"onChange"),0<n.length&&(r=new zr("onChange","change",null,r,c),e.push({event:r,listeners:n}))}var _a=null,Ea=null;function F0(e){jg(e,0)}function Ur(e){var n=ya(e);if(Oh(n))return e}function Jh(e,n){if(e==="change")return n}var td=!1;if(Xi){var jl;if(Xi){var Bl="oninput"in document;if(!Bl){var ed=document.createElement("div");ed.setAttribute("oninput","return;"),Bl=typeof ed.oninput=="function"}jl=Bl}else jl=!1;td=jl&&(!document.documentMode||9<document.documentMode)}function id(){_a&&(_a.detachEvent("onpropertychange",nd),Ea=_a=null)}function nd(e){if(e.propertyName==="value"&&Ur(Ea)){var n=[];Zh(n,Ea,e,Cl(e)),Ih(F0,n)}}function z0(e,n,r){e==="focusin"?(id(),_a=n,Ea=r,_a.attachEvent("onpropertychange",nd)):e==="focusout"&&id()}function I0(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Ur(Ea)}function U0(e,n){if(e==="click")return Ur(n)}function H0(e,n){if(e==="input"||e==="change")return Ur(n)}function q0(e,n){return e===n&&(e!==0||1/e===1/n)||e!==e&&n!==n}var ii=typeof Object.is=="function"?Object.is:q0;function Ca(e,n){if(ii(e,n))return!0;if(typeof e!="object"||e===null||typeof n!="object"||n===null)return!1;var r=Object.keys(e),c=Object.keys(n);if(r.length!==c.length)return!1;for(c=0;c<r.length;c++){var f=r[c];if(!Ht.call(n,f)||!ii(e[f],n[f]))return!1}return!0}function sd(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ad(e,n){var r=sd(e);e=0;for(var c;r;){if(r.nodeType===3){if(c=e+r.textContent.length,e<=n&&c>=n)return{node:r,offset:n-e};e=c}t:{for(;r;){if(r.nextSibling){r=r.nextSibling;break t}r=r.parentNode}r=void 0}r=sd(r)}}function rd(e,n){return e&&n?e===n?!0:e&&e.nodeType===3?!1:n&&n.nodeType===3?rd(e,n.parentNode):"contains"in e?e.contains(n):e.compareDocumentPosition?!!(e.compareDocumentPosition(n)&16):!1:!1}function od(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var n=Lr(e.document);n instanceof e.HTMLIFrameElement;){try{var r=typeof n.contentWindow.location.href=="string"}catch{r=!1}if(r)e=n.contentWindow;else break;n=Lr(e.document)}return n}function Pl(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n&&(n==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||n==="textarea"||e.contentEditable==="true")}var G0=Xi&&"documentMode"in document&&11>=document.documentMode,Ts=null,Fl=null,Ta=null,zl=!1;function ld(e,n,r){var c=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;zl||Ts==null||Ts!==Lr(c)||(c=Ts,"selectionStart"in c&&Pl(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),Ta&&Ca(Ta,c)||(Ta=c,c=Mo(Fl,"onSelect"),0<c.length&&(n=new zr("onSelect","select",null,n,r),e.push({event:n,listeners:c}),n.target=Ts)))}function Xn(e,n){var r={};return r[e.toLowerCase()]=n.toLowerCase(),r["Webkit"+e]="webkit"+n,r["Moz"+e]="moz"+n,r}var Ds={animationend:Xn("Animation","AnimationEnd"),animationiteration:Xn("Animation","AnimationIteration"),animationstart:Xn("Animation","AnimationStart"),transitionrun:Xn("Transition","TransitionRun"),transitionstart:Xn("Transition","TransitionStart"),transitioncancel:Xn("Transition","TransitionCancel"),transitionend:Xn("Transition","TransitionEnd")},Il={},cd={};Xi&&(cd=document.createElement("div").style,"AnimationEvent"in window||(delete Ds.animationend.animation,delete Ds.animationiteration.animation,delete Ds.animationstart.animation),"TransitionEvent"in window||delete Ds.transitionend.transition);function $n(e){if(Il[e])return Il[e];if(!Ds[e])return e;var n=Ds[e],r;for(r in n)if(n.hasOwnProperty(r)&&r in cd)return Il[e]=n[r];return e}var ud=$n("animationend"),hd=$n("animationiteration"),dd=$n("animationstart"),V0=$n("transitionrun"),Y0=$n("transitionstart"),X0=$n("transitioncancel"),fd=$n("transitionend"),gd=new Map,Ul="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Ul.push("scrollEnd");function Ni(e,n){gd.set(e,n),Vn(n,[e])}var Hr=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var n=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(n))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},mi=[],Ns=0,Hl=0;function qr(){for(var e=Ns,n=Hl=Ns=0;n<e;){var r=mi[n];mi[n++]=null;var c=mi[n];mi[n++]=null;var f=mi[n];mi[n++]=null;var m=mi[n];if(mi[n++]=null,c!==null&&f!==null){var x=c.pending;x===null?f.next=f:(f.next=x.next,x.next=f),c.pending=f}m!==0&&pd(r,f,m)}}function Gr(e,n,r,c){mi[Ns++]=e,mi[Ns++]=n,mi[Ns++]=r,mi[Ns++]=c,Hl|=c,e.lanes|=c,e=e.alternate,e!==null&&(e.lanes|=c)}function ql(e,n,r,c){return Gr(e,n,r,c),Vr(e)}function Kn(e,n){return Gr(e,null,null,n),Vr(e)}function pd(e,n,r){e.lanes|=r;var c=e.alternate;c!==null&&(c.lanes|=r);for(var f=!1,m=e.return;m!==null;)m.childLanes|=r,c=m.alternate,c!==null&&(c.childLanes|=r),m.tag===22&&(e=m.stateNode,e===null||e._visibility&1||(f=!0)),e=m,m=m.return;return e.tag===3?(m=e.stateNode,f&&n!==null&&(f=31-ei(r),e=m.hiddenUpdates,c=e[f],c===null?e[f]=[n]:c.push(n),n.lane=r|536870912),m):null}function Vr(e){if(50<Ka)throw Ka=0,Zc=null,Error(s(185));for(var n=e.return;n!==null;)e=n,n=e.return;return e.tag===3?e.stateNode:null}var Ms={};function $0(e,n,r,c){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ni(e,n,r,c){return new $0(e,n,r,c)}function Gl(e){return e=e.prototype,!(!e||!e.isReactComponent)}function $i(e,n){var r=e.alternate;return r===null?(r=ni(e.tag,n,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=n,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&65011712,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,n=e.dependencies,r.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r.refCleanup=e.refCleanup,r}function md(e,n){e.flags&=65011714;var r=e.alternate;return r===null?(e.childLanes=0,e.lanes=n,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=r.childLanes,e.lanes=r.lanes,e.child=r.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=r.memoizedProps,e.memoizedState=r.memoizedState,e.updateQueue=r.updateQueue,e.type=r.type,n=r.dependencies,e.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),e}function Yr(e,n,r,c,f,m){var x=0;if(c=e,typeof e=="function")Gl(e)&&(x=1);else if(typeof e=="string")x=Jb(e,r,Q.current)?26:e==="html"||e==="head"||e==="body"?27:5;else t:switch(e){case N:return e=ni(31,r,n,f),e.elementType=N,e.lanes=m,e;case S:return Qn(r.children,f,m,n);case C:x=8,f|=24;break;case E:return e=ni(12,r,n,f|2),e.elementType=E,e.lanes=m,e;case z:return e=ni(13,r,n,f),e.elementType=z,e.lanes=m,e;case L:return e=ni(19,r,n,f),e.elementType=L,e.lanes=m,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case O:x=10;break t;case k:x=9;break t;case P:x=11;break t;case j:x=14;break t;case D:x=16,c=null;break t}x=29,r=Error(s(130,e===null?"null":typeof e,"")),c=null}return n=ni(x,r,n,f),n.elementType=e,n.type=c,n.lanes=m,n}function Qn(e,n,r,c){return e=ni(7,e,c,n),e.lanes=r,e}function Vl(e,n,r){return e=ni(6,e,null,n),e.lanes=r,e}function bd(e){var n=ni(18,null,null,0);return n.stateNode=e,n}function Yl(e,n,r){return n=ni(4,e.children!==null?e.children:[],e.key,n),n.lanes=r,n.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},n}var yd=new WeakMap;function bi(e,n){if(typeof e=="object"&&e!==null){var r=yd.get(e);return r!==void 0?r:(n={value:e,source:n,stack:_t(n)},yd.set(e,n),n)}return{value:e,source:n,stack:_t(n)}}var Rs=[],ks=0,Xr=null,Da=0,yi=[],vi=0,bn=null,Li=1,ji="";function Ki(e,n){Rs[ks++]=Da,Rs[ks++]=Xr,Xr=e,Da=n}function vd(e,n,r){yi[vi++]=Li,yi[vi++]=ji,yi[vi++]=bn,bn=e;var c=Li;e=ji;var f=32-ei(c)-1;c&=~(1<<f),r+=1;var m=32-ei(n)+f;if(30<m){var x=f-f%5;m=(c&(1<<x)-1).toString(32),c>>=x,f-=x,Li=1<<32-ei(n)+f|r<<f|c,ji=m+e}else Li=1<<m|r<<f|c,ji=e}function Xl(e){e.return!==null&&(Ki(e,1),vd(e,1,0))}function $l(e){for(;e===Xr;)Xr=Rs[--ks],Rs[ks]=null,Da=Rs[--ks],Rs[ks]=null;for(;e===bn;)bn=yi[--vi],yi[vi]=null,ji=yi[--vi],yi[vi]=null,Li=yi[--vi],yi[vi]=null}function xd(e,n){yi[vi++]=Li,yi[vi++]=ji,yi[vi++]=bn,Li=n.id,ji=n.overflow,bn=e}var Te=null,te=null,Pt=!1,yn=null,xi=!1,Kl=Error(s(519));function vn(e){var n=Error(s(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Na(bi(n,e)),Kl}function Ad(e){var n=e.stateNode,r=e.type,c=e.memoizedProps;switch(n[Ce]=e,n[Ge]=c,r){case"dialog":Ot("cancel",n),Ot("close",n);break;case"iframe":case"object":case"embed":Ot("load",n);break;case"video":case"audio":for(r=0;r<Wa.length;r++)Ot(Wa[r],n);break;case"source":Ot("error",n);break;case"img":case"image":case"link":Ot("error",n),Ot("load",n);break;case"details":Ot("toggle",n);break;case"input":Ot("invalid",n),Lh(n,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":Ot("invalid",n);break;case"textarea":Ot("invalid",n),Bh(n,c.value,c.defaultValue,c.children)}r=c.children,typeof r!="string"&&typeof r!="number"&&typeof r!="bigint"||n.textContent===""+r||c.suppressHydrationWarning===!0||zg(n.textContent,r)?(c.popover!=null&&(Ot("beforetoggle",n),Ot("toggle",n)),c.onScroll!=null&&Ot("scroll",n),c.onScrollEnd!=null&&Ot("scrollend",n),c.onClick!=null&&(n.onclick=Yi),n=!0):n=!1,n||vn(e,!0)}function Sd(e){for(Te=e.return;Te;)switch(Te.tag){case 5:case 31:case 13:xi=!1;return;case 27:case 3:xi=!0;return;default:Te=Te.return}}function Os(e){if(e!==Te)return!1;if(!Pt)return Sd(e),Pt=!0,!1;var n=e.tag,r;if((r=n!==3&&n!==27)&&((r=n===5)&&(r=e.type,r=!(r!=="form"&&r!=="button")||fu(e.type,e.memoizedProps)),r=!r),r&&te&&vn(e),Sd(e),n===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(s(317));te=$g(e)}else if(n===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(s(317));te=$g(e)}else n===27?(n=te,On(e.type)?(e=yu,yu=null,te=e):te=n):te=Te?Si(e.stateNode.nextSibling):null;return!0}function Wn(){te=Te=null,Pt=!1}function Ql(){var e=yn;return e!==null&&(Ke===null?Ke=e:Ke.push.apply(Ke,e),yn=null),e}function Na(e){yn===null?yn=[e]:yn.push(e)}var Wl=M(null),Zn=null,Qi=null;function xn(e,n,r){T(Wl,n._currentValue),n._currentValue=r}function Wi(e){e._currentValue=Wl.current,H(Wl)}function Zl(e,n,r){for(;e!==null;){var c=e.alternate;if((e.childLanes&n)!==n?(e.childLanes|=n,c!==null&&(c.childLanes|=n)):c!==null&&(c.childLanes&n)!==n&&(c.childLanes|=n),e===r)break;e=e.return}}function Jl(e,n,r,c){var f=e.child;for(f!==null&&(f.return=e);f!==null;){var m=f.dependencies;if(m!==null){var x=f.child;m=m.firstContext;t:for(;m!==null;){var _=m;m=f;for(var R=0;R<n.length;R++)if(_.context===n[R]){m.lanes|=r,_=m.alternate,_!==null&&(_.lanes|=r),Zl(m.return,r,e),c||(x=null);break t}m=_.next}}else if(f.tag===18){if(x=f.return,x===null)throw Error(s(341));x.lanes|=r,m=x.alternate,m!==null&&(m.lanes|=r),Zl(x,r,e),x=null}else x=f.child;if(x!==null)x.return=f;else for(x=f;x!==null;){if(x===e){x=null;break}if(f=x.sibling,f!==null){f.return=x.return,x=f;break}x=x.return}f=x}}function Ls(e,n,r,c){e=null;for(var f=n,m=!1;f!==null;){if(!m){if((f.flags&524288)!==0)m=!0;else if((f.flags&262144)!==0)break}if(f.tag===10){var x=f.alternate;if(x===null)throw Error(s(387));if(x=x.memoizedProps,x!==null){var _=f.type;ii(f.pendingProps.value,x.value)||(e!==null?e.push(_):e=[_])}}else if(f===ot.current){if(x=f.alternate,x===null)throw Error(s(387));x.memoizedState.memoizedState!==f.memoizedState.memoizedState&&(e!==null?e.push(ir):e=[ir])}f=f.return}e!==null&&Jl(n,e,r,c),n.flags|=262144}function $r(e){for(e=e.firstContext;e!==null;){if(!ii(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Jn(e){Zn=e,Qi=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function De(e){return wd(Zn,e)}function Kr(e,n){return Zn===null&&Jn(e),wd(e,n)}function wd(e,n){var r=n._currentValue;if(n={context:n,memoizedValue:r,next:null},Qi===null){if(e===null)throw Error(s(308));Qi=n,e.dependencies={lanes:0,firstContext:n},e.flags|=524288}else Qi=Qi.next=n;return r}var K0=typeof AbortController<"u"?AbortController:function(){var e=[],n=this.signal={aborted:!1,addEventListener:function(r,c){e.push(c)}};this.abort=function(){n.aborted=!0,e.forEach(function(r){return r()})}},Q0=g.unstable_scheduleCallback,W0=g.unstable_NormalPriority,pe={$$typeof:O,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function tc(){return{controller:new K0,data:new Map,refCount:0}}function Ma(e){e.refCount--,e.refCount===0&&Q0(W0,function(){e.controller.abort()})}var Ra=null,ec=0,js=0,Bs=null;function Z0(e,n){if(Ra===null){var r=Ra=[];ec=0,js=su(),Bs={status:"pending",value:void 0,then:function(c){r.push(c)}}}return ec++,n.then(_d,_d),n}function _d(){if(--ec===0&&Ra!==null){Bs!==null&&(Bs.status="fulfilled");var e=Ra;Ra=null,js=0,Bs=null;for(var n=0;n<e.length;n++)(0,e[n])()}}function J0(e,n){var r=[],c={status:"pending",value:null,reason:null,then:function(f){r.push(f)}};return e.then(function(){c.status="fulfilled",c.value=n;for(var f=0;f<r.length;f++)(0,r[f])(n)},function(f){for(c.status="rejected",c.reason=f,f=0;f<r.length;f++)(0,r[f])(void 0)}),c}var Ed=F.S;F.S=function(e,n){cg=Vt(),typeof n=="object"&&n!==null&&typeof n.then=="function"&&Z0(e,n),Ed!==null&&Ed(e,n)};var ts=M(null);function ic(){var e=ts.current;return e!==null?e:Zt.pooledCache}function Qr(e,n){n===null?T(ts,ts.current):T(ts,n.pool)}function Cd(){var e=ic();return e===null?null:{parent:pe._currentValue,pool:e}}var Ps=Error(s(460)),nc=Error(s(474)),Wr=Error(s(542)),Zr={then:function(){}};function Td(e){return e=e.status,e==="fulfilled"||e==="rejected"}function Dd(e,n,r){switch(r=e[r],r===void 0?e.push(n):r!==n&&(n.then(Yi,Yi),n=r),n.status){case"fulfilled":return n.value;case"rejected":throw e=n.reason,Md(e),e;default:if(typeof n.status=="string")n.then(Yi,Yi);else{if(e=Zt,e!==null&&100<e.shellSuspendCounter)throw Error(s(482));e=n,e.status="pending",e.then(function(c){if(n.status==="pending"){var f=n;f.status="fulfilled",f.value=c}},function(c){if(n.status==="pending"){var f=n;f.status="rejected",f.reason=c}})}switch(n.status){case"fulfilled":return n.value;case"rejected":throw e=n.reason,Md(e),e}throw is=n,Ps}}function es(e){try{var n=e._init;return n(e._payload)}catch(r){throw r!==null&&typeof r=="object"&&typeof r.then=="function"?(is=r,Ps):r}}var is=null;function Nd(){if(is===null)throw Error(s(459));var e=is;return is=null,e}function Md(e){if(e===Ps||e===Wr)throw Error(s(483))}var Fs=null,ka=0;function Jr(e){var n=ka;return ka+=1,Fs===null&&(Fs=[]),Dd(Fs,e,n)}function Oa(e,n){n=n.props.ref,e.ref=n!==void 0?n:null}function to(e,n){throw n.$$typeof===v?Error(s(525)):(e=Object.prototype.toString.call(n),Error(s(31,e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)))}function Rd(e){function n(I,B){if(e){var G=I.deletions;G===null?(I.deletions=[B],I.flags|=16):G.push(B)}}function r(I,B){if(!e)return null;for(;B!==null;)n(I,B),B=B.sibling;return null}function c(I){for(var B=new Map;I!==null;)I.key!==null?B.set(I.key,I):B.set(I.index,I),I=I.sibling;return B}function f(I,B){return I=$i(I,B),I.index=0,I.sibling=null,I}function m(I,B,G){return I.index=G,e?(G=I.alternate,G!==null?(G=G.index,G<B?(I.flags|=67108866,B):G):(I.flags|=67108866,B)):(I.flags|=1048576,B)}function x(I){return e&&I.alternate===null&&(I.flags|=67108866),I}function _(I,B,G,Z){return B===null||B.tag!==6?(B=Vl(G,I.mode,Z),B.return=I,B):(B=f(B,G),B.return=I,B)}function R(I,B,G,Z){var yt=G.type;return yt===S?W(I,B,G.props.children,Z,G.key):B!==null&&(B.elementType===yt||typeof yt=="object"&&yt!==null&&yt.$$typeof===D&&es(yt)===B.type)?(B=f(B,G.props),Oa(B,G),B.return=I,B):(B=Yr(G.type,G.key,G.props,null,I.mode,Z),Oa(B,G),B.return=I,B)}function V(I,B,G,Z){return B===null||B.tag!==4||B.stateNode.containerInfo!==G.containerInfo||B.stateNode.implementation!==G.implementation?(B=Yl(G,I.mode,Z),B.return=I,B):(B=f(B,G.children||[]),B.return=I,B)}function W(I,B,G,Z,yt){return B===null||B.tag!==7?(B=Qn(G,I.mode,Z,yt),B.return=I,B):(B=f(B,G),B.return=I,B)}function J(I,B,G){if(typeof B=="string"&&B!==""||typeof B=="number"||typeof B=="bigint")return B=Vl(""+B,I.mode,G),B.return=I,B;if(typeof B=="object"&&B!==null){switch(B.$$typeof){case A:return G=Yr(B.type,B.key,B.props,null,I.mode,G),Oa(G,B),G.return=I,G;case w:return B=Yl(B,I.mode,G),B.return=I,B;case D:return B=es(B),J(I,B,G)}if(bt(B)||tt(B))return B=Qn(B,I.mode,G,null),B.return=I,B;if(typeof B.then=="function")return J(I,Jr(B),G);if(B.$$typeof===O)return J(I,Kr(I,B),G);to(I,B)}return null}function Y(I,B,G,Z){var yt=B!==null?B.key:null;if(typeof G=="string"&&G!==""||typeof G=="number"||typeof G=="bigint")return yt!==null?null:_(I,B,""+G,Z);if(typeof G=="object"&&G!==null){switch(G.$$typeof){case A:return G.key===yt?R(I,B,G,Z):null;case w:return G.key===yt?V(I,B,G,Z):null;case D:return G=es(G),Y(I,B,G,Z)}if(bt(G)||tt(G))return yt!==null?null:W(I,B,G,Z,null);if(typeof G.then=="function")return Y(I,B,Jr(G),Z);if(G.$$typeof===O)return Y(I,B,Kr(I,G),Z);to(I,G)}return null}function K(I,B,G,Z,yt){if(typeof Z=="string"&&Z!==""||typeof Z=="number"||typeof Z=="bigint")return I=I.get(G)||null,_(B,I,""+Z,yt);if(typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case A:return I=I.get(Z.key===null?G:Z.key)||null,R(B,I,Z,yt);case w:return I=I.get(Z.key===null?G:Z.key)||null,V(B,I,Z,yt);case D:return Z=es(Z),K(I,B,G,Z,yt)}if(bt(Z)||tt(Z))return I=I.get(G)||null,W(B,I,Z,yt,null);if(typeof Z.then=="function")return K(I,B,G,Jr(Z),yt);if(Z.$$typeof===O)return K(I,B,G,Kr(B,Z),yt);to(B,Z)}return null}function ht(I,B,G,Z){for(var yt=null,It=null,pt=B,Nt=B=0,Bt=null;pt!==null&&Nt<G.length;Nt++){pt.index>Nt?(Bt=pt,pt=null):Bt=pt.sibling;var Ut=Y(I,pt,G[Nt],Z);if(Ut===null){pt===null&&(pt=Bt);break}e&&pt&&Ut.alternate===null&&n(I,pt),B=m(Ut,B,Nt),It===null?yt=Ut:It.sibling=Ut,It=Ut,pt=Bt}if(Nt===G.length)return r(I,pt),Pt&&Ki(I,Nt),yt;if(pt===null){for(;Nt<G.length;Nt++)pt=J(I,G[Nt],Z),pt!==null&&(B=m(pt,B,Nt),It===null?yt=pt:It.sibling=pt,It=pt);return Pt&&Ki(I,Nt),yt}for(pt=c(pt);Nt<G.length;Nt++)Bt=K(pt,I,Nt,G[Nt],Z),Bt!==null&&(e&&Bt.alternate!==null&&pt.delete(Bt.key===null?Nt:Bt.key),B=m(Bt,B,Nt),It===null?yt=Bt:It.sibling=Bt,It=Bt);return e&&pt.forEach(function(Fn){return n(I,Fn)}),Pt&&Ki(I,Nt),yt}function xt(I,B,G,Z){if(G==null)throw Error(s(151));for(var yt=null,It=null,pt=B,Nt=B=0,Bt=null,Ut=G.next();pt!==null&&!Ut.done;Nt++,Ut=G.next()){pt.index>Nt?(Bt=pt,pt=null):Bt=pt.sibling;var Fn=Y(I,pt,Ut.value,Z);if(Fn===null){pt===null&&(pt=Bt);break}e&&pt&&Fn.alternate===null&&n(I,pt),B=m(Fn,B,Nt),It===null?yt=Fn:It.sibling=Fn,It=Fn,pt=Bt}if(Ut.done)return r(I,pt),Pt&&Ki(I,Nt),yt;if(pt===null){for(;!Ut.done;Nt++,Ut=G.next())Ut=J(I,Ut.value,Z),Ut!==null&&(B=m(Ut,B,Nt),It===null?yt=Ut:It.sibling=Ut,It=Ut);return Pt&&Ki(I,Nt),yt}for(pt=c(pt);!Ut.done;Nt++,Ut=G.next())Ut=K(pt,I,Nt,Ut.value,Z),Ut!==null&&(e&&Ut.alternate!==null&&pt.delete(Ut.key===null?Nt:Ut.key),B=m(Ut,B,Nt),It===null?yt=Ut:It.sibling=Ut,It=Ut);return e&&pt.forEach(function(uy){return n(I,uy)}),Pt&&Ki(I,Nt),yt}function Qt(I,B,G,Z){if(typeof G=="object"&&G!==null&&G.type===S&&G.key===null&&(G=G.props.children),typeof G=="object"&&G!==null){switch(G.$$typeof){case A:t:{for(var yt=G.key;B!==null;){if(B.key===yt){if(yt=G.type,yt===S){if(B.tag===7){r(I,B.sibling),Z=f(B,G.props.children),Z.return=I,I=Z;break t}}else if(B.elementType===yt||typeof yt=="object"&&yt!==null&&yt.$$typeof===D&&es(yt)===B.type){r(I,B.sibling),Z=f(B,G.props),Oa(Z,G),Z.return=I,I=Z;break t}r(I,B);break}else n(I,B);B=B.sibling}G.type===S?(Z=Qn(G.props.children,I.mode,Z,G.key),Z.return=I,I=Z):(Z=Yr(G.type,G.key,G.props,null,I.mode,Z),Oa(Z,G),Z.return=I,I=Z)}return x(I);case w:t:{for(yt=G.key;B!==null;){if(B.key===yt)if(B.tag===4&&B.stateNode.containerInfo===G.containerInfo&&B.stateNode.implementation===G.implementation){r(I,B.sibling),Z=f(B,G.children||[]),Z.return=I,I=Z;break t}else{r(I,B);break}else n(I,B);B=B.sibling}Z=Yl(G,I.mode,Z),Z.return=I,I=Z}return x(I);case D:return G=es(G),Qt(I,B,G,Z)}if(bt(G))return ht(I,B,G,Z);if(tt(G)){if(yt=tt(G),typeof yt!="function")throw Error(s(150));return G=yt.call(G),xt(I,B,G,Z)}if(typeof G.then=="function")return Qt(I,B,Jr(G),Z);if(G.$$typeof===O)return Qt(I,B,Kr(I,G),Z);to(I,G)}return typeof G=="string"&&G!==""||typeof G=="number"||typeof G=="bigint"?(G=""+G,B!==null&&B.tag===6?(r(I,B.sibling),Z=f(B,G),Z.return=I,I=Z):(r(I,B),Z=Vl(G,I.mode,Z),Z.return=I,I=Z),x(I)):r(I,B)}return function(I,B,G,Z){try{ka=0;var yt=Qt(I,B,G,Z);return Fs=null,yt}catch(pt){if(pt===Ps||pt===Wr)throw pt;var It=ni(29,pt,null,I.mode);return It.lanes=Z,It.return=I,It}finally{}}}var ns=Rd(!0),kd=Rd(!1),An=!1;function sc(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function ac(e,n){e=e.updateQueue,n.updateQueue===e&&(n.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function Sn(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function wn(e,n,r){var c=e.updateQueue;if(c===null)return null;if(c=c.shared,(qt&2)!==0){var f=c.pending;return f===null?n.next=n:(n.next=f.next,f.next=n),c.pending=n,n=Vr(e),pd(e,null,r),n}return Gr(e,c,n,r),Vr(e)}function La(e,n,r){if(n=n.updateQueue,n!==null&&(n=n.shared,(r&4194048)!==0)){var c=n.lanes;c&=e.pendingLanes,r|=c,n.lanes=r,wh(e,r)}}function rc(e,n){var r=e.updateQueue,c=e.alternate;if(c!==null&&(c=c.updateQueue,r===c)){var f=null,m=null;if(r=r.firstBaseUpdate,r!==null){do{var x={lane:r.lane,tag:r.tag,payload:r.payload,callback:null,next:null};m===null?f=m=x:m=m.next=x,r=r.next}while(r!==null);m===null?f=m=n:m=m.next=n}else f=m=n;r={baseState:c.baseState,firstBaseUpdate:f,lastBaseUpdate:m,shared:c.shared,callbacks:c.callbacks},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=n:e.next=n,r.lastBaseUpdate=n}var oc=!1;function ja(){if(oc){var e=Bs;if(e!==null)throw e}}function Ba(e,n,r,c){oc=!1;var f=e.updateQueue;An=!1;var m=f.firstBaseUpdate,x=f.lastBaseUpdate,_=f.shared.pending;if(_!==null){f.shared.pending=null;var R=_,V=R.next;R.next=null,x===null?m=V:x.next=V,x=R;var W=e.alternate;W!==null&&(W=W.updateQueue,_=W.lastBaseUpdate,_!==x&&(_===null?W.firstBaseUpdate=V:_.next=V,W.lastBaseUpdate=R))}if(m!==null){var J=f.baseState;x=0,W=V=R=null,_=m;do{var Y=_.lane&-536870913,K=Y!==_.lane;if(K?(jt&Y)===Y:(c&Y)===Y){Y!==0&&Y===js&&(oc=!0),W!==null&&(W=W.next={lane:0,tag:_.tag,payload:_.payload,callback:null,next:null});t:{var ht=e,xt=_;Y=n;var Qt=r;switch(xt.tag){case 1:if(ht=xt.payload,typeof ht=="function"){J=ht.call(Qt,J,Y);break t}J=ht;break t;case 3:ht.flags=ht.flags&-65537|128;case 0:if(ht=xt.payload,Y=typeof ht=="function"?ht.call(Qt,J,Y):ht,Y==null)break t;J=b({},J,Y);break t;case 2:An=!0}}Y=_.callback,Y!==null&&(e.flags|=64,K&&(e.flags|=8192),K=f.callbacks,K===null?f.callbacks=[Y]:K.push(Y))}else K={lane:Y,tag:_.tag,payload:_.payload,callback:_.callback,next:null},W===null?(V=W=K,R=J):W=W.next=K,x|=Y;if(_=_.next,_===null){if(_=f.shared.pending,_===null)break;K=_,_=K.next,K.next=null,f.lastBaseUpdate=K,f.shared.pending=null}}while(!0);W===null&&(R=J),f.baseState=R,f.firstBaseUpdate=V,f.lastBaseUpdate=W,m===null&&(f.shared.lanes=0),Dn|=x,e.lanes=x,e.memoizedState=J}}function Od(e,n){if(typeof e!="function")throw Error(s(191,e));e.call(n)}function Ld(e,n){var r=e.callbacks;if(r!==null)for(e.callbacks=null,e=0;e<r.length;e++)Od(r[e],n)}var zs=M(null),eo=M(0);function jd(e,n){e=on,T(eo,e),T(zs,n),on=e|n.baseLanes}function lc(){T(eo,on),T(zs,zs.current)}function cc(){on=eo.current,H(zs),H(eo)}var si=M(null),Ai=null;function _n(e){var n=e.alternate;T(de,de.current&1),T(si,e),Ai===null&&(n===null||zs.current!==null||n.memoizedState!==null)&&(Ai=e)}function uc(e){T(de,de.current),T(si,e),Ai===null&&(Ai=e)}function Bd(e){e.tag===22?(T(de,de.current),T(si,e),Ai===null&&(Ai=e)):En()}function En(){T(de,de.current),T(si,si.current)}function ai(e){H(si),Ai===e&&(Ai=null),H(de)}var de=M(0);function io(e){for(var n=e;n!==null;){if(n.tag===13){var r=n.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||mu(r)||bu(r)))return n}else if(n.tag===19&&(n.memoizedProps.revealOrder==="forwards"||n.memoizedProps.revealOrder==="backwards"||n.memoizedProps.revealOrder==="unstable_legacy-backwards"||n.memoizedProps.revealOrder==="together")){if((n.flags&128)!==0)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var Zi=0,Dt=null,$t=null,me=null,no=!1,Is=!1,ss=!1,so=0,Pa=0,Us=null,tb=0;function le(){throw Error(s(321))}function hc(e,n){if(n===null)return!1;for(var r=0;r<n.length&&r<e.length;r++)if(!ii(e[r],n[r]))return!1;return!0}function dc(e,n,r,c,f,m){return Zi=m,Dt=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,F.H=e===null||e.memoizedState===null?xf:Tc,ss=!1,m=r(c,f),ss=!1,Is&&(m=Fd(n,r,c,f)),Pd(e),m}function Pd(e){F.H=Ia;var n=$t!==null&&$t.next!==null;if(Zi=0,me=$t=Dt=null,no=!1,Pa=0,Us=null,n)throw Error(s(300));e===null||be||(e=e.dependencies,e!==null&&$r(e)&&(be=!0))}function Fd(e,n,r,c){Dt=e;var f=0;do{if(Is&&(Us=null),Pa=0,Is=!1,25<=f)throw Error(s(301));if(f+=1,me=$t=null,e.updateQueue!=null){var m=e.updateQueue;m.lastEffect=null,m.events=null,m.stores=null,m.memoCache!=null&&(m.memoCache.index=0)}F.H=Af,m=n(r,c)}while(Is);return m}function eb(){var e=F.H,n=e.useState()[0];return n=typeof n.then=="function"?Fa(n):n,e=e.useState()[0],($t!==null?$t.memoizedState:null)!==e&&(Dt.flags|=1024),n}function fc(){var e=so!==0;return so=0,e}function gc(e,n,r){n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~r}function pc(e){if(no){for(e=e.memoizedState;e!==null;){var n=e.queue;n!==null&&(n.pending=null),e=e.next}no=!1}Zi=0,me=$t=Dt=null,Is=!1,Pa=so=0,Us=null}function Fe(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return me===null?Dt.memoizedState=me=e:me=me.next=e,me}function fe(){if($t===null){var e=Dt.alternate;e=e!==null?e.memoizedState:null}else e=$t.next;var n=me===null?Dt.memoizedState:me.next;if(n!==null)me=n,$t=e;else{if(e===null)throw Dt.alternate===null?Error(s(467)):Error(s(310));$t=e,e={memoizedState:$t.memoizedState,baseState:$t.baseState,baseQueue:$t.baseQueue,queue:$t.queue,next:null},me===null?Dt.memoizedState=me=e:me=me.next=e}return me}function ao(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Fa(e){var n=Pa;return Pa+=1,Us===null&&(Us=[]),e=Dd(Us,e,n),n=Dt,(me===null?n.memoizedState:me.next)===null&&(n=n.alternate,F.H=n===null||n.memoizedState===null?xf:Tc),e}function ro(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return Fa(e);if(e.$$typeof===O)return De(e)}throw Error(s(438,String(e)))}function mc(e){var n=null,r=Dt.updateQueue;if(r!==null&&(n=r.memoCache),n==null){var c=Dt.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(n={data:c.data.map(function(f){return f.slice()}),index:0})))}if(n==null&&(n={data:[],index:0}),r===null&&(r=ao(),Dt.updateQueue=r),r.memoCache=n,r=n.data[n.index],r===void 0)for(r=n.data[n.index]=Array(e),c=0;c<e;c++)r[c]=U;return n.index++,r}function Ji(e,n){return typeof n=="function"?n(e):n}function oo(e){var n=fe();return bc(n,$t,e)}function bc(e,n,r){var c=e.queue;if(c===null)throw Error(s(311));c.lastRenderedReducer=r;var f=e.baseQueue,m=c.pending;if(m!==null){if(f!==null){var x=f.next;f.next=m.next,m.next=x}n.baseQueue=f=m,c.pending=null}if(m=e.baseState,f===null)e.memoizedState=m;else{n=f.next;var _=x=null,R=null,V=n,W=!1;do{var J=V.lane&-536870913;if(J!==V.lane?(jt&J)===J:(Zi&J)===J){var Y=V.revertLane;if(Y===0)R!==null&&(R=R.next={lane:0,revertLane:0,gesture:null,action:V.action,hasEagerState:V.hasEagerState,eagerState:V.eagerState,next:null}),J===js&&(W=!0);else if((Zi&Y)===Y){V=V.next,Y===js&&(W=!0);continue}else J={lane:0,revertLane:V.revertLane,gesture:null,action:V.action,hasEagerState:V.hasEagerState,eagerState:V.eagerState,next:null},R===null?(_=R=J,x=m):R=R.next=J,Dt.lanes|=Y,Dn|=Y;J=V.action,ss&&r(m,J),m=V.hasEagerState?V.eagerState:r(m,J)}else Y={lane:J,revertLane:V.revertLane,gesture:V.gesture,action:V.action,hasEagerState:V.hasEagerState,eagerState:V.eagerState,next:null},R===null?(_=R=Y,x=m):R=R.next=Y,Dt.lanes|=J,Dn|=J;V=V.next}while(V!==null&&V!==n);if(R===null?x=m:R.next=_,!ii(m,e.memoizedState)&&(be=!0,W&&(r=Bs,r!==null)))throw r;e.memoizedState=m,e.baseState=x,e.baseQueue=R,c.lastRenderedState=m}return f===null&&(c.lanes=0),[e.memoizedState,c.dispatch]}function yc(e){var n=fe(),r=n.queue;if(r===null)throw Error(s(311));r.lastRenderedReducer=e;var c=r.dispatch,f=r.pending,m=n.memoizedState;if(f!==null){r.pending=null;var x=f=f.next;do m=e(m,x.action),x=x.next;while(x!==f);ii(m,n.memoizedState)||(be=!0),n.memoizedState=m,n.baseQueue===null&&(n.baseState=m),r.lastRenderedState=m}return[m,c]}function zd(e,n,r){var c=Dt,f=fe(),m=Pt;if(m){if(r===void 0)throw Error(s(407));r=r()}else r=n();var x=!ii(($t||f).memoizedState,r);if(x&&(f.memoizedState=r,be=!0),f=f.queue,Ac(Hd.bind(null,c,f,e),[e]),f.getSnapshot!==n||x||me!==null&&me.memoizedState.tag&1){if(c.flags|=2048,Hs(9,{destroy:void 0},Ud.bind(null,c,f,r,n),null),Zt===null)throw Error(s(349));m||(Zi&127)!==0||Id(c,n,r)}return r}function Id(e,n,r){e.flags|=16384,e={getSnapshot:n,value:r},n=Dt.updateQueue,n===null?(n=ao(),Dt.updateQueue=n,n.stores=[e]):(r=n.stores,r===null?n.stores=[e]:r.push(e))}function Ud(e,n,r,c){n.value=r,n.getSnapshot=c,qd(n)&&Gd(e)}function Hd(e,n,r){return r(function(){qd(n)&&Gd(e)})}function qd(e){var n=e.getSnapshot;e=e.value;try{var r=n();return!ii(e,r)}catch{return!0}}function Gd(e){var n=Kn(e,2);n!==null&&Qe(n,e,2)}function vc(e){var n=Fe();if(typeof e=="function"){var r=e;if(e=r(),ss){gn(!0);try{r()}finally{gn(!1)}}}return n.memoizedState=n.baseState=e,n.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ji,lastRenderedState:e},n}function Vd(e,n,r,c){return e.baseState=r,bc(e,$t,typeof c=="function"?c:Ji)}function ib(e,n,r,c,f){if(uo(e))throw Error(s(485));if(e=n.action,e!==null){var m={payload:f,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(x){m.listeners.push(x)}};F.T!==null?r(!0):m.isTransition=!1,c(m),r=n.pending,r===null?(m.next=n.pending=m,Yd(n,m)):(m.next=r.next,n.pending=r.next=m)}}function Yd(e,n){var r=n.action,c=n.payload,f=e.state;if(n.isTransition){var m=F.T,x={};F.T=x;try{var _=r(f,c),R=F.S;R!==null&&R(x,_),Xd(e,n,_)}catch(V){xc(e,n,V)}finally{m!==null&&x.types!==null&&(m.types=x.types),F.T=m}}else try{m=r(f,c),Xd(e,n,m)}catch(V){xc(e,n,V)}}function Xd(e,n,r){r!==null&&typeof r=="object"&&typeof r.then=="function"?r.then(function(c){$d(e,n,c)},function(c){return xc(e,n,c)}):$d(e,n,r)}function $d(e,n,r){n.status="fulfilled",n.value=r,Kd(n),e.state=r,n=e.pending,n!==null&&(r=n.next,r===n?e.pending=null:(r=r.next,n.next=r,Yd(e,r)))}function xc(e,n,r){var c=e.pending;if(e.pending=null,c!==null){c=c.next;do n.status="rejected",n.reason=r,Kd(n),n=n.next;while(n!==c)}e.action=null}function Kd(e){e=e.listeners;for(var n=0;n<e.length;n++)(0,e[n])()}function Qd(e,n){return n}function Wd(e,n){if(Pt){var r=Zt.formState;if(r!==null){t:{var c=Dt;if(Pt){if(te){e:{for(var f=te,m=xi;f.nodeType!==8;){if(!m){f=null;break e}if(f=Si(f.nextSibling),f===null){f=null;break e}}m=f.data,f=m==="F!"||m==="F"?f:null}if(f){te=Si(f.nextSibling),c=f.data==="F!";break t}}vn(c)}c=!1}c&&(n=r[0])}}return r=Fe(),r.memoizedState=r.baseState=n,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Qd,lastRenderedState:n},r.queue=c,r=bf.bind(null,Dt,c),c.dispatch=r,c=vc(!1),m=Cc.bind(null,Dt,!1,c.queue),c=Fe(),f={state:n,dispatch:null,action:e,pending:null},c.queue=f,r=ib.bind(null,Dt,f,m,r),f.dispatch=r,c.memoizedState=e,[n,r,!1]}function Zd(e){var n=fe();return Jd(n,$t,e)}function Jd(e,n,r){if(n=bc(e,n,Qd)[0],e=oo(Ji)[0],typeof n=="object"&&n!==null&&typeof n.then=="function")try{var c=Fa(n)}catch(x){throw x===Ps?Wr:x}else c=n;n=fe();var f=n.queue,m=f.dispatch;return r!==n.memoizedState&&(Dt.flags|=2048,Hs(9,{destroy:void 0},nb.bind(null,f,r),null)),[c,m,e]}function nb(e,n){e.action=n}function tf(e){var n=fe(),r=$t;if(r!==null)return Jd(n,r,e);fe(),n=n.memoizedState,r=fe();var c=r.queue.dispatch;return r.memoizedState=e,[n,c,!1]}function Hs(e,n,r,c){return e={tag:e,create:r,deps:c,inst:n,next:null},n=Dt.updateQueue,n===null&&(n=ao(),Dt.updateQueue=n),r=n.lastEffect,r===null?n.lastEffect=e.next=e:(c=r.next,r.next=e,e.next=c,n.lastEffect=e),e}function ef(){return fe().memoizedState}function lo(e,n,r,c){var f=Fe();Dt.flags|=e,f.memoizedState=Hs(1|n,{destroy:void 0},r,c===void 0?null:c)}function co(e,n,r,c){var f=fe();c=c===void 0?null:c;var m=f.memoizedState.inst;$t!==null&&c!==null&&hc(c,$t.memoizedState.deps)?f.memoizedState=Hs(n,m,r,c):(Dt.flags|=e,f.memoizedState=Hs(1|n,m,r,c))}function nf(e,n){lo(8390656,8,e,n)}function Ac(e,n){co(2048,8,e,n)}function sb(e){Dt.flags|=4;var n=Dt.updateQueue;if(n===null)n=ao(),Dt.updateQueue=n,n.events=[e];else{var r=n.events;r===null?n.events=[e]:r.push(e)}}function sf(e){var n=fe().memoizedState;return sb({ref:n,nextImpl:e}),function(){if((qt&2)!==0)throw Error(s(440));return n.impl.apply(void 0,arguments)}}function af(e,n){return co(4,2,e,n)}function rf(e,n){return co(4,4,e,n)}function of(e,n){if(typeof n=="function"){e=e();var r=n(e);return function(){typeof r=="function"?r():n(null)}}if(n!=null)return e=e(),n.current=e,function(){n.current=null}}function lf(e,n,r){r=r!=null?r.concat([e]):null,co(4,4,of.bind(null,n,e),r)}function Sc(){}function cf(e,n){var r=fe();n=n===void 0?null:n;var c=r.memoizedState;return n!==null&&hc(n,c[1])?c[0]:(r.memoizedState=[e,n],e)}function uf(e,n){var r=fe();n=n===void 0?null:n;var c=r.memoizedState;if(n!==null&&hc(n,c[1]))return c[0];if(c=e(),ss){gn(!0);try{e()}finally{gn(!1)}}return r.memoizedState=[c,n],c}function wc(e,n,r){return r===void 0||(Zi&1073741824)!==0&&(jt&261930)===0?e.memoizedState=n:(e.memoizedState=r,e=hg(),Dt.lanes|=e,Dn|=e,r)}function hf(e,n,r,c){return ii(r,n)?r:zs.current!==null?(e=wc(e,r,c),ii(e,n)||(be=!0),e):(Zi&42)===0||(Zi&1073741824)!==0&&(jt&261930)===0?(be=!0,e.memoizedState=r):(e=hg(),Dt.lanes|=e,Dn|=e,n)}function df(e,n,r,c,f){var m=q.p;q.p=m!==0&&8>m?m:8;var x=F.T,_={};F.T=_,Cc(e,!1,n,r);try{var R=f(),V=F.S;if(V!==null&&V(_,R),R!==null&&typeof R=="object"&&typeof R.then=="function"){var W=J0(R,c);za(e,n,W,li(e))}else za(e,n,c,li(e))}catch(J){za(e,n,{then:function(){},status:"rejected",reason:J},li())}finally{q.p=m,x!==null&&_.types!==null&&(x.types=_.types),F.T=x}}function ab(){}function _c(e,n,r,c){if(e.tag!==5)throw Error(s(476));var f=ff(e).queue;df(e,f,n,et,r===null?ab:function(){return gf(e),r(c)})}function ff(e){var n=e.memoizedState;if(n!==null)return n;n={memoizedState:et,baseState:et,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ji,lastRenderedState:et},next:null};var r={};return n.next={memoizedState:r,baseState:r,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ji,lastRenderedState:r},next:null},e.memoizedState=n,e=e.alternate,e!==null&&(e.memoizedState=n),n}function gf(e){var n=ff(e);n.next===null&&(n=e.alternate.memoizedState),za(e,n.next.queue,{},li())}function Ec(){return De(ir)}function pf(){return fe().memoizedState}function mf(){return fe().memoizedState}function rb(e){for(var n=e.return;n!==null;){switch(n.tag){case 24:case 3:var r=li();e=Sn(r);var c=wn(n,e,r);c!==null&&(Qe(c,n,r),La(c,n,r)),n={cache:tc()},e.payload=n;return}n=n.return}}function ob(e,n,r){var c=li();r={lane:c,revertLane:0,gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null},uo(e)?yf(n,r):(r=ql(e,n,r,c),r!==null&&(Qe(r,e,c),vf(r,n,c)))}function bf(e,n,r){var c=li();za(e,n,r,c)}function za(e,n,r,c){var f={lane:c,revertLane:0,gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null};if(uo(e))yf(n,f);else{var m=e.alternate;if(e.lanes===0&&(m===null||m.lanes===0)&&(m=n.lastRenderedReducer,m!==null))try{var x=n.lastRenderedState,_=m(x,r);if(f.hasEagerState=!0,f.eagerState=_,ii(_,x))return Gr(e,n,f,0),Zt===null&&qr(),!1}catch{}finally{}if(r=ql(e,n,f,c),r!==null)return Qe(r,e,c),vf(r,n,c),!0}return!1}function Cc(e,n,r,c){if(c={lane:2,revertLane:su(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},uo(e)){if(n)throw Error(s(479))}else n=ql(e,r,c,2),n!==null&&Qe(n,e,2)}function uo(e){var n=e.alternate;return e===Dt||n!==null&&n===Dt}function yf(e,n){Is=no=!0;var r=e.pending;r===null?n.next=n:(n.next=r.next,r.next=n),e.pending=n}function vf(e,n,r){if((r&4194048)!==0){var c=n.lanes;c&=e.pendingLanes,r|=c,n.lanes=r,wh(e,r)}}var Ia={readContext:De,use:ro,useCallback:le,useContext:le,useEffect:le,useImperativeHandle:le,useLayoutEffect:le,useInsertionEffect:le,useMemo:le,useReducer:le,useRef:le,useState:le,useDebugValue:le,useDeferredValue:le,useTransition:le,useSyncExternalStore:le,useId:le,useHostTransitionStatus:le,useFormState:le,useActionState:le,useOptimistic:le,useMemoCache:le,useCacheRefresh:le};Ia.useEffectEvent=le;var xf={readContext:De,use:ro,useCallback:function(e,n){return Fe().memoizedState=[e,n===void 0?null:n],e},useContext:De,useEffect:nf,useImperativeHandle:function(e,n,r){r=r!=null?r.concat([e]):null,lo(4194308,4,of.bind(null,n,e),r)},useLayoutEffect:function(e,n){return lo(4194308,4,e,n)},useInsertionEffect:function(e,n){lo(4,2,e,n)},useMemo:function(e,n){var r=Fe();n=n===void 0?null:n;var c=e();if(ss){gn(!0);try{e()}finally{gn(!1)}}return r.memoizedState=[c,n],c},useReducer:function(e,n,r){var c=Fe();if(r!==void 0){var f=r(n);if(ss){gn(!0);try{r(n)}finally{gn(!1)}}}else f=n;return c.memoizedState=c.baseState=f,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:f},c.queue=e,e=e.dispatch=ob.bind(null,Dt,e),[c.memoizedState,e]},useRef:function(e){var n=Fe();return e={current:e},n.memoizedState=e},useState:function(e){e=vc(e);var n=e.queue,r=bf.bind(null,Dt,n);return n.dispatch=r,[e.memoizedState,r]},useDebugValue:Sc,useDeferredValue:function(e,n){var r=Fe();return wc(r,e,n)},useTransition:function(){var e=vc(!1);return e=df.bind(null,Dt,e.queue,!0,!1),Fe().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,n,r){var c=Dt,f=Fe();if(Pt){if(r===void 0)throw Error(s(407));r=r()}else{if(r=n(),Zt===null)throw Error(s(349));(jt&127)!==0||Id(c,n,r)}f.memoizedState=r;var m={value:r,getSnapshot:n};return f.queue=m,nf(Hd.bind(null,c,m,e),[e]),c.flags|=2048,Hs(9,{destroy:void 0},Ud.bind(null,c,m,r,n),null),r},useId:function(){var e=Fe(),n=Zt.identifierPrefix;if(Pt){var r=ji,c=Li;r=(c&~(1<<32-ei(c)-1)).toString(32)+r,n="_"+n+"R_"+r,r=so++,0<r&&(n+="H"+r.toString(32)),n+="_"}else r=tb++,n="_"+n+"r_"+r.toString(32)+"_";return e.memoizedState=n},useHostTransitionStatus:Ec,useFormState:Wd,useActionState:Wd,useOptimistic:function(e){var n=Fe();n.memoizedState=n.baseState=e;var r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return n.queue=r,n=Cc.bind(null,Dt,!0,r),r.dispatch=n,[e,n]},useMemoCache:mc,useCacheRefresh:function(){return Fe().memoizedState=rb.bind(null,Dt)},useEffectEvent:function(e){var n=Fe(),r={impl:e};return n.memoizedState=r,function(){if((qt&2)!==0)throw Error(s(440));return r.impl.apply(void 0,arguments)}}},Tc={readContext:De,use:ro,useCallback:cf,useContext:De,useEffect:Ac,useImperativeHandle:lf,useInsertionEffect:af,useLayoutEffect:rf,useMemo:uf,useReducer:oo,useRef:ef,useState:function(){return oo(Ji)},useDebugValue:Sc,useDeferredValue:function(e,n){var r=fe();return hf(r,$t.memoizedState,e,n)},useTransition:function(){var e=oo(Ji)[0],n=fe().memoizedState;return[typeof e=="boolean"?e:Fa(e),n]},useSyncExternalStore:zd,useId:pf,useHostTransitionStatus:Ec,useFormState:Zd,useActionState:Zd,useOptimistic:function(e,n){var r=fe();return Vd(r,$t,e,n)},useMemoCache:mc,useCacheRefresh:mf};Tc.useEffectEvent=sf;var Af={readContext:De,use:ro,useCallback:cf,useContext:De,useEffect:Ac,useImperativeHandle:lf,useInsertionEffect:af,useLayoutEffect:rf,useMemo:uf,useReducer:yc,useRef:ef,useState:function(){return yc(Ji)},useDebugValue:Sc,useDeferredValue:function(e,n){var r=fe();return $t===null?wc(r,e,n):hf(r,$t.memoizedState,e,n)},useTransition:function(){var e=yc(Ji)[0],n=fe().memoizedState;return[typeof e=="boolean"?e:Fa(e),n]},useSyncExternalStore:zd,useId:pf,useHostTransitionStatus:Ec,useFormState:tf,useActionState:tf,useOptimistic:function(e,n){var r=fe();return $t!==null?Vd(r,$t,e,n):(r.baseState=e,[e,r.queue.dispatch])},useMemoCache:mc,useCacheRefresh:mf};Af.useEffectEvent=sf;function Dc(e,n,r,c){n=e.memoizedState,r=r(c,n),r=r==null?n:b({},n,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Nc={enqueueSetState:function(e,n,r){e=e._reactInternals;var c=li(),f=Sn(c);f.payload=n,r!=null&&(f.callback=r),n=wn(e,f,c),n!==null&&(Qe(n,e,c),La(n,e,c))},enqueueReplaceState:function(e,n,r){e=e._reactInternals;var c=li(),f=Sn(c);f.tag=1,f.payload=n,r!=null&&(f.callback=r),n=wn(e,f,c),n!==null&&(Qe(n,e,c),La(n,e,c))},enqueueForceUpdate:function(e,n){e=e._reactInternals;var r=li(),c=Sn(r);c.tag=2,n!=null&&(c.callback=n),n=wn(e,c,r),n!==null&&(Qe(n,e,r),La(n,e,r))}};function Sf(e,n,r,c,f,m,x){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(c,m,x):n.prototype&&n.prototype.isPureReactComponent?!Ca(r,c)||!Ca(f,m):!0}function wf(e,n,r,c){e=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(r,c),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(r,c),n.state!==e&&Nc.enqueueReplaceState(n,n.state,null)}function as(e,n){var r=n;if("ref"in n){r={};for(var c in n)c!=="ref"&&(r[c]=n[c])}if(e=e.defaultProps){r===n&&(r=b({},r));for(var f in e)r[f]===void 0&&(r[f]=e[f])}return r}function _f(e){Hr(e)}function Ef(e){console.error(e)}function Cf(e){Hr(e)}function ho(e,n){try{var r=e.onUncaughtError;r(n.value,{componentStack:n.stack})}catch(c){setTimeout(function(){throw c})}}function Tf(e,n,r){try{var c=e.onCaughtError;c(r.value,{componentStack:r.stack,errorBoundary:n.tag===1?n.stateNode:null})}catch(f){setTimeout(function(){throw f})}}function Mc(e,n,r){return r=Sn(r),r.tag=3,r.payload={element:null},r.callback=function(){ho(e,n)},r}function Df(e){return e=Sn(e),e.tag=3,e}function Nf(e,n,r,c){var f=r.type.getDerivedStateFromError;if(typeof f=="function"){var m=c.value;e.payload=function(){return f(m)},e.callback=function(){Tf(n,r,c)}}var x=r.stateNode;x!==null&&typeof x.componentDidCatch=="function"&&(e.callback=function(){Tf(n,r,c),typeof f!="function"&&(Nn===null?Nn=new Set([this]):Nn.add(this));var _=c.stack;this.componentDidCatch(c.value,{componentStack:_!==null?_:""})})}function lb(e,n,r,c,f){if(r.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(n=r.alternate,n!==null&&Ls(n,r,f,!0),r=si.current,r!==null){switch(r.tag){case 31:case 13:return Ai===null?_o():r.alternate===null&&ce===0&&(ce=3),r.flags&=-257,r.flags|=65536,r.lanes=f,c===Zr?r.flags|=16384:(n=r.updateQueue,n===null?r.updateQueue=new Set([c]):n.add(c),eu(e,c,f)),!1;case 22:return r.flags|=65536,c===Zr?r.flags|=16384:(n=r.updateQueue,n===null?(n={transitions:null,markerInstances:null,retryQueue:new Set([c])},r.updateQueue=n):(r=n.retryQueue,r===null?n.retryQueue=new Set([c]):r.add(c)),eu(e,c,f)),!1}throw Error(s(435,r.tag))}return eu(e,c,f),_o(),!1}if(Pt)return n=si.current,n!==null?((n.flags&65536)===0&&(n.flags|=256),n.flags|=65536,n.lanes=f,c!==Kl&&(e=Error(s(422),{cause:c}),Na(bi(e,r)))):(c!==Kl&&(n=Error(s(423),{cause:c}),Na(bi(n,r))),e=e.current.alternate,e.flags|=65536,f&=-f,e.lanes|=f,c=bi(c,r),f=Mc(e.stateNode,c,f),rc(e,f),ce!==4&&(ce=2)),!1;var m=Error(s(520),{cause:c});if(m=bi(m,r),$a===null?$a=[m]:$a.push(m),ce!==4&&(ce=2),n===null)return!0;c=bi(c,r),r=n;do{switch(r.tag){case 3:return r.flags|=65536,e=f&-f,r.lanes|=e,e=Mc(r.stateNode,c,e),rc(r,e),!1;case 1:if(n=r.type,m=r.stateNode,(r.flags&128)===0&&(typeof n.getDerivedStateFromError=="function"||m!==null&&typeof m.componentDidCatch=="function"&&(Nn===null||!Nn.has(m))))return r.flags|=65536,f&=-f,r.lanes|=f,f=Df(f),Nf(f,e,r,c),rc(r,f),!1}r=r.return}while(r!==null);return!1}var Rc=Error(s(461)),be=!1;function Ne(e,n,r,c){n.child=e===null?kd(n,null,r,c):ns(n,e.child,r,c)}function Mf(e,n,r,c,f){r=r.render;var m=n.ref;if("ref"in c){var x={};for(var _ in c)_!=="ref"&&(x[_]=c[_])}else x=c;return Jn(n),c=dc(e,n,r,x,m,f),_=fc(),e!==null&&!be?(gc(e,n,f),tn(e,n,f)):(Pt&&_&&Xl(n),n.flags|=1,Ne(e,n,c,f),n.child)}function Rf(e,n,r,c,f){if(e===null){var m=r.type;return typeof m=="function"&&!Gl(m)&&m.defaultProps===void 0&&r.compare===null?(n.tag=15,n.type=m,kf(e,n,m,c,f)):(e=Yr(r.type,null,c,n,n.mode,f),e.ref=n.ref,e.return=n,n.child=e)}if(m=e.child,!zc(e,f)){var x=m.memoizedProps;if(r=r.compare,r=r!==null?r:Ca,r(x,c)&&e.ref===n.ref)return tn(e,n,f)}return n.flags|=1,e=$i(m,c),e.ref=n.ref,e.return=n,n.child=e}function kf(e,n,r,c,f){if(e!==null){var m=e.memoizedProps;if(Ca(m,c)&&e.ref===n.ref)if(be=!1,n.pendingProps=c=m,zc(e,f))(e.flags&131072)!==0&&(be=!0);else return n.lanes=e.lanes,tn(e,n,f)}return kc(e,n,r,c,f)}function Of(e,n,r,c){var f=c.children,m=e!==null?e.memoizedState:null;if(e===null&&n.stateNode===null&&(n.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((n.flags&128)!==0){if(m=m!==null?m.baseLanes|r:r,e!==null){for(c=n.child=e.child,f=0;c!==null;)f=f|c.lanes|c.childLanes,c=c.sibling;c=f&~m}else c=0,n.child=null;return Lf(e,n,m,r,c)}if((r&536870912)!==0)n.memoizedState={baseLanes:0,cachePool:null},e!==null&&Qr(n,m!==null?m.cachePool:null),m!==null?jd(n,m):lc(),Bd(n);else return c=n.lanes=536870912,Lf(e,n,m!==null?m.baseLanes|r:r,r,c)}else m!==null?(Qr(n,m.cachePool),jd(n,m),En(),n.memoizedState=null):(e!==null&&Qr(n,null),lc(),En());return Ne(e,n,f,r),n.child}function Ua(e,n){return e!==null&&e.tag===22||n.stateNode!==null||(n.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),n.sibling}function Lf(e,n,r,c,f){var m=ic();return m=m===null?null:{parent:pe._currentValue,pool:m},n.memoizedState={baseLanes:r,cachePool:m},e!==null&&Qr(n,null),lc(),Bd(n),e!==null&&Ls(e,n,c,!0),n.childLanes=f,null}function fo(e,n){return n=po({mode:n.mode,children:n.children},e.mode),n.ref=e.ref,e.child=n,n.return=e,n}function jf(e,n,r){return ns(n,e.child,null,r),e=fo(n,n.pendingProps),e.flags|=2,ai(n),n.memoizedState=null,e}function cb(e,n,r){var c=n.pendingProps,f=(n.flags&128)!==0;if(n.flags&=-129,e===null){if(Pt){if(c.mode==="hidden")return e=fo(n,c),n.lanes=536870912,Ua(null,e);if(uc(n),(e=te)?(e=Xg(e,xi),e=e!==null&&e.data==="&"?e:null,e!==null&&(n.memoizedState={dehydrated:e,treeContext:bn!==null?{id:Li,overflow:ji}:null,retryLane:536870912,hydrationErrors:null},r=bd(e),r.return=n,n.child=r,Te=n,te=null)):e=null,e===null)throw vn(n);return n.lanes=536870912,null}return fo(n,c)}var m=e.memoizedState;if(m!==null){var x=m.dehydrated;if(uc(n),f)if(n.flags&256)n.flags&=-257,n=jf(e,n,r);else if(n.memoizedState!==null)n.child=e.child,n.flags|=128,n=null;else throw Error(s(558));else if(be||Ls(e,n,r,!1),f=(r&e.childLanes)!==0,be||f){if(c=Zt,c!==null&&(x=_h(c,r),x!==0&&x!==m.retryLane))throw m.retryLane=x,Kn(e,x),Qe(c,e,x),Rc;_o(),n=jf(e,n,r)}else e=m.treeContext,te=Si(x.nextSibling),Te=n,Pt=!0,yn=null,xi=!1,e!==null&&xd(n,e),n=fo(n,c),n.flags|=4096;return n}return e=$i(e.child,{mode:c.mode,children:c.children}),e.ref=n.ref,n.child=e,e.return=n,e}function go(e,n){var r=n.ref;if(r===null)e!==null&&e.ref!==null&&(n.flags|=4194816);else{if(typeof r!="function"&&typeof r!="object")throw Error(s(284));(e===null||e.ref!==r)&&(n.flags|=4194816)}}function kc(e,n,r,c,f){return Jn(n),r=dc(e,n,r,c,void 0,f),c=fc(),e!==null&&!be?(gc(e,n,f),tn(e,n,f)):(Pt&&c&&Xl(n),n.flags|=1,Ne(e,n,r,f),n.child)}function Bf(e,n,r,c,f,m){return Jn(n),n.updateQueue=null,r=Fd(n,c,r,f),Pd(e),c=fc(),e!==null&&!be?(gc(e,n,m),tn(e,n,m)):(Pt&&c&&Xl(n),n.flags|=1,Ne(e,n,r,m),n.child)}function Pf(e,n,r,c,f){if(Jn(n),n.stateNode===null){var m=Ms,x=r.contextType;typeof x=="object"&&x!==null&&(m=De(x)),m=new r(c,m),n.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,m.updater=Nc,n.stateNode=m,m._reactInternals=n,m=n.stateNode,m.props=c,m.state=n.memoizedState,m.refs={},sc(n),x=r.contextType,m.context=typeof x=="object"&&x!==null?De(x):Ms,m.state=n.memoizedState,x=r.getDerivedStateFromProps,typeof x=="function"&&(Dc(n,r,x,c),m.state=n.memoizedState),typeof r.getDerivedStateFromProps=="function"||typeof m.getSnapshotBeforeUpdate=="function"||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(x=m.state,typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount(),x!==m.state&&Nc.enqueueReplaceState(m,m.state,null),Ba(n,c,m,f),ja(),m.state=n.memoizedState),typeof m.componentDidMount=="function"&&(n.flags|=4194308),c=!0}else if(e===null){m=n.stateNode;var _=n.memoizedProps,R=as(r,_);m.props=R;var V=m.context,W=r.contextType;x=Ms,typeof W=="object"&&W!==null&&(x=De(W));var J=r.getDerivedStateFromProps;W=typeof J=="function"||typeof m.getSnapshotBeforeUpdate=="function",_=n.pendingProps!==_,W||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(_||V!==x)&&wf(n,m,c,x),An=!1;var Y=n.memoizedState;m.state=Y,Ba(n,c,m,f),ja(),V=n.memoizedState,_||Y!==V||An?(typeof J=="function"&&(Dc(n,r,J,c),V=n.memoizedState),(R=An||Sf(n,r,R,c,Y,V,x))?(W||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount()),typeof m.componentDidMount=="function"&&(n.flags|=4194308)):(typeof m.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=c,n.memoizedState=V),m.props=c,m.state=V,m.context=x,c=R):(typeof m.componentDidMount=="function"&&(n.flags|=4194308),c=!1)}else{m=n.stateNode,ac(e,n),x=n.memoizedProps,W=as(r,x),m.props=W,J=n.pendingProps,Y=m.context,V=r.contextType,R=Ms,typeof V=="object"&&V!==null&&(R=De(V)),_=r.getDerivedStateFromProps,(V=typeof _=="function"||typeof m.getSnapshotBeforeUpdate=="function")||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(x!==J||Y!==R)&&wf(n,m,c,R),An=!1,Y=n.memoizedState,m.state=Y,Ba(n,c,m,f),ja();var K=n.memoizedState;x!==J||Y!==K||An||e!==null&&e.dependencies!==null&&$r(e.dependencies)?(typeof _=="function"&&(Dc(n,r,_,c),K=n.memoizedState),(W=An||Sf(n,r,W,c,Y,K,R)||e!==null&&e.dependencies!==null&&$r(e.dependencies))?(V||typeof m.UNSAFE_componentWillUpdate!="function"&&typeof m.componentWillUpdate!="function"||(typeof m.componentWillUpdate=="function"&&m.componentWillUpdate(c,K,R),typeof m.UNSAFE_componentWillUpdate=="function"&&m.UNSAFE_componentWillUpdate(c,K,R)),typeof m.componentDidUpdate=="function"&&(n.flags|=4),typeof m.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof m.componentDidUpdate!="function"||x===e.memoizedProps&&Y===e.memoizedState||(n.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||x===e.memoizedProps&&Y===e.memoizedState||(n.flags|=1024),n.memoizedProps=c,n.memoizedState=K),m.props=c,m.state=K,m.context=R,c=W):(typeof m.componentDidUpdate!="function"||x===e.memoizedProps&&Y===e.memoizedState||(n.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||x===e.memoizedProps&&Y===e.memoizedState||(n.flags|=1024),c=!1)}return m=c,go(e,n),c=(n.flags&128)!==0,m||c?(m=n.stateNode,r=c&&typeof r.getDerivedStateFromError!="function"?null:m.render(),n.flags|=1,e!==null&&c?(n.child=ns(n,e.child,null,f),n.child=ns(n,null,r,f)):Ne(e,n,r,f),n.memoizedState=m.state,e=n.child):e=tn(e,n,f),e}function Ff(e,n,r,c){return Wn(),n.flags|=256,Ne(e,n,r,c),n.child}var Oc={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Lc(e){return{baseLanes:e,cachePool:Cd()}}function jc(e,n,r){return e=e!==null?e.childLanes&~r:0,n&&(e|=oi),e}function zf(e,n,r){var c=n.pendingProps,f=!1,m=(n.flags&128)!==0,x;if((x=m)||(x=e!==null&&e.memoizedState===null?!1:(de.current&2)!==0),x&&(f=!0,n.flags&=-129),x=(n.flags&32)!==0,n.flags&=-33,e===null){if(Pt){if(f?_n(n):En(),(e=te)?(e=Xg(e,xi),e=e!==null&&e.data!=="&"?e:null,e!==null&&(n.memoizedState={dehydrated:e,treeContext:bn!==null?{id:Li,overflow:ji}:null,retryLane:536870912,hydrationErrors:null},r=bd(e),r.return=n,n.child=r,Te=n,te=null)):e=null,e===null)throw vn(n);return bu(e)?n.lanes=32:n.lanes=536870912,null}var _=c.children;return c=c.fallback,f?(En(),f=n.mode,_=po({mode:"hidden",children:_},f),c=Qn(c,f,r,null),_.return=n,c.return=n,_.sibling=c,n.child=_,c=n.child,c.memoizedState=Lc(r),c.childLanes=jc(e,x,r),n.memoizedState=Oc,Ua(null,c)):(_n(n),Bc(n,_))}var R=e.memoizedState;if(R!==null&&(_=R.dehydrated,_!==null)){if(m)n.flags&256?(_n(n),n.flags&=-257,n=Pc(e,n,r)):n.memoizedState!==null?(En(),n.child=e.child,n.flags|=128,n=null):(En(),_=c.fallback,f=n.mode,c=po({mode:"visible",children:c.children},f),_=Qn(_,f,r,null),_.flags|=2,c.return=n,_.return=n,c.sibling=_,n.child=c,ns(n,e.child,null,r),c=n.child,c.memoizedState=Lc(r),c.childLanes=jc(e,x,r),n.memoizedState=Oc,n=Ua(null,c));else if(_n(n),bu(_)){if(x=_.nextSibling&&_.nextSibling.dataset,x)var V=x.dgst;x=V,c=Error(s(419)),c.stack="",c.digest=x,Na({value:c,source:null,stack:null}),n=Pc(e,n,r)}else if(be||Ls(e,n,r,!1),x=(r&e.childLanes)!==0,be||x){if(x=Zt,x!==null&&(c=_h(x,r),c!==0&&c!==R.retryLane))throw R.retryLane=c,Kn(e,c),Qe(x,e,c),Rc;mu(_)||_o(),n=Pc(e,n,r)}else mu(_)?(n.flags|=192,n.child=e.child,n=null):(e=R.treeContext,te=Si(_.nextSibling),Te=n,Pt=!0,yn=null,xi=!1,e!==null&&xd(n,e),n=Bc(n,c.children),n.flags|=4096);return n}return f?(En(),_=c.fallback,f=n.mode,R=e.child,V=R.sibling,c=$i(R,{mode:"hidden",children:c.children}),c.subtreeFlags=R.subtreeFlags&65011712,V!==null?_=$i(V,_):(_=Qn(_,f,r,null),_.flags|=2),_.return=n,c.return=n,c.sibling=_,n.child=c,Ua(null,c),c=n.child,_=e.child.memoizedState,_===null?_=Lc(r):(f=_.cachePool,f!==null?(R=pe._currentValue,f=f.parent!==R?{parent:R,pool:R}:f):f=Cd(),_={baseLanes:_.baseLanes|r,cachePool:f}),c.memoizedState=_,c.childLanes=jc(e,x,r),n.memoizedState=Oc,Ua(e.child,c)):(_n(n),r=e.child,e=r.sibling,r=$i(r,{mode:"visible",children:c.children}),r.return=n,r.sibling=null,e!==null&&(x=n.deletions,x===null?(n.deletions=[e],n.flags|=16):x.push(e)),n.child=r,n.memoizedState=null,r)}function Bc(e,n){return n=po({mode:"visible",children:n},e.mode),n.return=e,e.child=n}function po(e,n){return e=ni(22,e,null,n),e.lanes=0,e}function Pc(e,n,r){return ns(n,e.child,null,r),e=Bc(n,n.pendingProps.children),e.flags|=2,n.memoizedState=null,e}function If(e,n,r){e.lanes|=n;var c=e.alternate;c!==null&&(c.lanes|=n),Zl(e.return,n,r)}function Fc(e,n,r,c,f,m){var x=e.memoizedState;x===null?e.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:c,tail:r,tailMode:f,treeForkCount:m}:(x.isBackwards=n,x.rendering=null,x.renderingStartTime=0,x.last=c,x.tail=r,x.tailMode=f,x.treeForkCount=m)}function Uf(e,n,r){var c=n.pendingProps,f=c.revealOrder,m=c.tail;c=c.children;var x=de.current,_=(x&2)!==0;if(_?(x=x&1|2,n.flags|=128):x&=1,T(de,x),Ne(e,n,c,r),c=Pt?Da:0,!_&&e!==null&&(e.flags&128)!==0)t:for(e=n.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&If(e,r,n);else if(e.tag===19)If(e,r,n);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break t;for(;e.sibling===null;){if(e.return===null||e.return===n)break t;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(f){case"forwards":for(r=n.child,f=null;r!==null;)e=r.alternate,e!==null&&io(e)===null&&(f=r),r=r.sibling;r=f,r===null?(f=n.child,n.child=null):(f=r.sibling,r.sibling=null),Fc(n,!1,f,r,m,c);break;case"backwards":case"unstable_legacy-backwards":for(r=null,f=n.child,n.child=null;f!==null;){if(e=f.alternate,e!==null&&io(e)===null){n.child=f;break}e=f.sibling,f.sibling=r,r=f,f=e}Fc(n,!0,r,null,m,c);break;case"together":Fc(n,!1,null,null,void 0,c);break;default:n.memoizedState=null}return n.child}function tn(e,n,r){if(e!==null&&(n.dependencies=e.dependencies),Dn|=n.lanes,(r&n.childLanes)===0)if(e!==null){if(Ls(e,n,r,!1),(r&n.childLanes)===0)return null}else return null;if(e!==null&&n.child!==e.child)throw Error(s(153));if(n.child!==null){for(e=n.child,r=$i(e,e.pendingProps),n.child=r,r.return=n;e.sibling!==null;)e=e.sibling,r=r.sibling=$i(e,e.pendingProps),r.return=n;r.sibling=null}return n.child}function zc(e,n){return(e.lanes&n)!==0?!0:(e=e.dependencies,!!(e!==null&&$r(e)))}function ub(e,n,r){switch(n.tag){case 3:ft(n,n.stateNode.containerInfo),xn(n,pe,e.memoizedState.cache),Wn();break;case 27:case 5:st(n);break;case 4:ft(n,n.stateNode.containerInfo);break;case 10:xn(n,n.type,n.memoizedProps.value);break;case 31:if(n.memoizedState!==null)return n.flags|=128,uc(n),null;break;case 13:var c=n.memoizedState;if(c!==null)return c.dehydrated!==null?(_n(n),n.flags|=128,null):(r&n.child.childLanes)!==0?zf(e,n,r):(_n(n),e=tn(e,n,r),e!==null?e.sibling:null);_n(n);break;case 19:var f=(e.flags&128)!==0;if(c=(r&n.childLanes)!==0,c||(Ls(e,n,r,!1),c=(r&n.childLanes)!==0),f){if(c)return Uf(e,n,r);n.flags|=128}if(f=n.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),T(de,de.current),c)break;return null;case 22:return n.lanes=0,Of(e,n,r,n.pendingProps);case 24:xn(n,pe,e.memoizedState.cache)}return tn(e,n,r)}function Hf(e,n,r){if(e!==null)if(e.memoizedProps!==n.pendingProps)be=!0;else{if(!zc(e,r)&&(n.flags&128)===0)return be=!1,ub(e,n,r);be=(e.flags&131072)!==0}else be=!1,Pt&&(n.flags&1048576)!==0&&vd(n,Da,n.index);switch(n.lanes=0,n.tag){case 16:t:{var c=n.pendingProps;if(e=es(n.elementType),n.type=e,typeof e=="function")Gl(e)?(c=as(e,c),n.tag=1,n=Pf(null,n,e,c,r)):(n.tag=0,n=kc(null,n,e,c,r));else{if(e!=null){var f=e.$$typeof;if(f===P){n.tag=11,n=Mf(null,n,e,c,r);break t}else if(f===j){n.tag=14,n=Rf(null,n,e,c,r);break t}}throw n=gt(e)||e,Error(s(306,n,""))}}return n;case 0:return kc(e,n,n.type,n.pendingProps,r);case 1:return c=n.type,f=as(c,n.pendingProps),Pf(e,n,c,f,r);case 3:t:{if(ft(n,n.stateNode.containerInfo),e===null)throw Error(s(387));c=n.pendingProps;var m=n.memoizedState;f=m.element,ac(e,n),Ba(n,c,null,r);var x=n.memoizedState;if(c=x.cache,xn(n,pe,c),c!==m.cache&&Jl(n,[pe],r,!0),ja(),c=x.element,m.isDehydrated)if(m={element:c,isDehydrated:!1,cache:x.cache},n.updateQueue.baseState=m,n.memoizedState=m,n.flags&256){n=Ff(e,n,c,r);break t}else if(c!==f){f=bi(Error(s(424)),n),Na(f),n=Ff(e,n,c,r);break t}else{switch(e=n.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(te=Si(e.firstChild),Te=n,Pt=!0,yn=null,xi=!0,r=kd(n,null,c,r),n.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling}else{if(Wn(),c===f){n=tn(e,n,r);break t}Ne(e,n,c,r)}n=n.child}return n;case 26:return go(e,n),e===null?(r=Jg(n.type,null,n.pendingProps,null))?n.memoizedState=r:Pt||(r=n.type,e=n.pendingProps,c=Ro(rt.current).createElement(r),c[Ce]=n,c[Ge]=e,Me(c,r,e),Se(c),n.stateNode=c):n.memoizedState=Jg(n.type,e.memoizedProps,n.pendingProps,e.memoizedState),null;case 27:return st(n),e===null&&Pt&&(c=n.stateNode=Qg(n.type,n.pendingProps,rt.current),Te=n,xi=!0,f=te,On(n.type)?(yu=f,te=Si(c.firstChild)):te=f),Ne(e,n,n.pendingProps.children,r),go(e,n),e===null&&(n.flags|=4194304),n.child;case 5:return e===null&&Pt&&((f=c=te)&&(c=Ib(c,n.type,n.pendingProps,xi),c!==null?(n.stateNode=c,Te=n,te=Si(c.firstChild),xi=!1,f=!0):f=!1),f||vn(n)),st(n),f=n.type,m=n.pendingProps,x=e!==null?e.memoizedProps:null,c=m.children,fu(f,m)?c=null:x!==null&&fu(f,x)&&(n.flags|=32),n.memoizedState!==null&&(f=dc(e,n,eb,null,null,r),ir._currentValue=f),go(e,n),Ne(e,n,c,r),n.child;case 6:return e===null&&Pt&&((e=r=te)&&(r=Ub(r,n.pendingProps,xi),r!==null?(n.stateNode=r,Te=n,te=null,e=!0):e=!1),e||vn(n)),null;case 13:return zf(e,n,r);case 4:return ft(n,n.stateNode.containerInfo),c=n.pendingProps,e===null?n.child=ns(n,null,c,r):Ne(e,n,c,r),n.child;case 11:return Mf(e,n,n.type,n.pendingProps,r);case 7:return Ne(e,n,n.pendingProps,r),n.child;case 8:return Ne(e,n,n.pendingProps.children,r),n.child;case 12:return Ne(e,n,n.pendingProps.children,r),n.child;case 10:return c=n.pendingProps,xn(n,n.type,c.value),Ne(e,n,c.children,r),n.child;case 9:return f=n.type._context,c=n.pendingProps.children,Jn(n),f=De(f),c=c(f),n.flags|=1,Ne(e,n,c,r),n.child;case 14:return Rf(e,n,n.type,n.pendingProps,r);case 15:return kf(e,n,n.type,n.pendingProps,r);case 19:return Uf(e,n,r);case 31:return cb(e,n,r);case 22:return Of(e,n,r,n.pendingProps);case 24:return Jn(n),c=De(pe),e===null?(f=ic(),f===null&&(f=Zt,m=tc(),f.pooledCache=m,m.refCount++,m!==null&&(f.pooledCacheLanes|=r),f=m),n.memoizedState={parent:c,cache:f},sc(n),xn(n,pe,f)):((e.lanes&r)!==0&&(ac(e,n),Ba(n,null,null,r),ja()),f=e.memoizedState,m=n.memoizedState,f.parent!==c?(f={parent:c,cache:c},n.memoizedState=f,n.lanes===0&&(n.memoizedState=n.updateQueue.baseState=f),xn(n,pe,c)):(c=m.cache,xn(n,pe,c),c!==f.cache&&Jl(n,[pe],r,!0))),Ne(e,n,n.pendingProps.children,r),n.child;case 29:throw n.pendingProps}throw Error(s(156,n.tag))}function en(e){e.flags|=4}function Ic(e,n,r,c,f){if((n=(e.mode&32)!==0)&&(n=!1),n){if(e.flags|=16777216,(f&335544128)===f)if(e.stateNode.complete)e.flags|=8192;else if(pg())e.flags|=8192;else throw is=Zr,nc}else e.flags&=-16777217}function qf(e,n){if(n.type!=="stylesheet"||(n.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!sp(n))if(pg())e.flags|=8192;else throw is=Zr,nc}function mo(e,n){n!==null&&(e.flags|=4),e.flags&16384&&(n=e.tag!==22?Ah():536870912,e.lanes|=n,Ys|=n)}function Ha(e,n){if(!Pt)switch(e.tailMode){case"hidden":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var c=null;r!==null;)r.alternate!==null&&(c=r),r=r.sibling;c===null?n||e.tail===null?e.tail=null:e.tail.sibling=null:c.sibling=null}}function ee(e){var n=e.alternate!==null&&e.alternate.child===e.child,r=0,c=0;if(n)for(var f=e.child;f!==null;)r|=f.lanes|f.childLanes,c|=f.subtreeFlags&65011712,c|=f.flags&65011712,f.return=e,f=f.sibling;else for(f=e.child;f!==null;)r|=f.lanes|f.childLanes,c|=f.subtreeFlags,c|=f.flags,f.return=e,f=f.sibling;return e.subtreeFlags|=c,e.childLanes=r,n}function hb(e,n,r){var c=n.pendingProps;switch($l(n),n.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ee(n),null;case 1:return ee(n),null;case 3:return r=n.stateNode,c=null,e!==null&&(c=e.memoizedState.cache),n.memoizedState.cache!==c&&(n.flags|=2048),Wi(pe),X(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(Os(n)?en(n):e===null||e.memoizedState.isDehydrated&&(n.flags&256)===0||(n.flags|=1024,Ql())),ee(n),null;case 26:var f=n.type,m=n.memoizedState;return e===null?(en(n),m!==null?(ee(n),qf(n,m)):(ee(n),Ic(n,f,null,c,r))):m?m!==e.memoizedState?(en(n),ee(n),qf(n,m)):(ee(n),n.flags&=-16777217):(e=e.memoizedProps,e!==c&&en(n),ee(n),Ic(n,f,e,c,r)),null;case 27:if(lt(n),r=rt.current,f=n.type,e!==null&&n.stateNode!=null)e.memoizedProps!==c&&en(n);else{if(!c){if(n.stateNode===null)throw Error(s(166));return ee(n),null}e=Q.current,Os(n)?Ad(n):(e=Qg(f,c,r),n.stateNode=e,en(n))}return ee(n),null;case 5:if(lt(n),f=n.type,e!==null&&n.stateNode!=null)e.memoizedProps!==c&&en(n);else{if(!c){if(n.stateNode===null)throw Error(s(166));return ee(n),null}if(m=Q.current,Os(n))Ad(n);else{var x=Ro(rt.current);switch(m){case 1:m=x.createElementNS("http://www.w3.org/2000/svg",f);break;case 2:m=x.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;default:switch(f){case"svg":m=x.createElementNS("http://www.w3.org/2000/svg",f);break;case"math":m=x.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;case"script":m=x.createElement("div"),m.innerHTML="<script><\/script>",m=m.removeChild(m.firstChild);break;case"select":m=typeof c.is=="string"?x.createElement("select",{is:c.is}):x.createElement("select"),c.multiple?m.multiple=!0:c.size&&(m.size=c.size);break;default:m=typeof c.is=="string"?x.createElement(f,{is:c.is}):x.createElement(f)}}m[Ce]=n,m[Ge]=c;t:for(x=n.child;x!==null;){if(x.tag===5||x.tag===6)m.appendChild(x.stateNode);else if(x.tag!==4&&x.tag!==27&&x.child!==null){x.child.return=x,x=x.child;continue}if(x===n)break t;for(;x.sibling===null;){if(x.return===null||x.return===n)break t;x=x.return}x.sibling.return=x.return,x=x.sibling}n.stateNode=m;t:switch(Me(m,f,c),f){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break t;case"img":c=!0;break t;default:c=!1}c&&en(n)}}return ee(n),Ic(n,n.type,e===null?null:e.memoizedProps,n.pendingProps,r),null;case 6:if(e&&n.stateNode!=null)e.memoizedProps!==c&&en(n);else{if(typeof c!="string"&&n.stateNode===null)throw Error(s(166));if(e=rt.current,Os(n)){if(e=n.stateNode,r=n.memoizedProps,c=null,f=Te,f!==null)switch(f.tag){case 27:case 5:c=f.memoizedProps}e[Ce]=n,e=!!(e.nodeValue===r||c!==null&&c.suppressHydrationWarning===!0||zg(e.nodeValue,r)),e||vn(n,!0)}else e=Ro(e).createTextNode(c),e[Ce]=n,n.stateNode=e}return ee(n),null;case 31:if(r=n.memoizedState,e===null||e.memoizedState!==null){if(c=Os(n),r!==null){if(e===null){if(!c)throw Error(s(318));if(e=n.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(s(557));e[Ce]=n}else Wn(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;ee(n),e=!1}else r=Ql(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=r),e=!0;if(!e)return n.flags&256?(ai(n),n):(ai(n),null);if((n.flags&128)!==0)throw Error(s(558))}return ee(n),null;case 13:if(c=n.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(f=Os(n),c!==null&&c.dehydrated!==null){if(e===null){if(!f)throw Error(s(318));if(f=n.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(s(317));f[Ce]=n}else Wn(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;ee(n),f=!1}else f=Ql(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=f),f=!0;if(!f)return n.flags&256?(ai(n),n):(ai(n),null)}return ai(n),(n.flags&128)!==0?(n.lanes=r,n):(r=c!==null,e=e!==null&&e.memoizedState!==null,r&&(c=n.child,f=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(f=c.alternate.memoizedState.cachePool.pool),m=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(m=c.memoizedState.cachePool.pool),m!==f&&(c.flags|=2048)),r!==e&&r&&(n.child.flags|=8192),mo(n,n.updateQueue),ee(n),null);case 4:return X(),e===null&&lu(n.stateNode.containerInfo),ee(n),null;case 10:return Wi(n.type),ee(n),null;case 19:if(H(de),c=n.memoizedState,c===null)return ee(n),null;if(f=(n.flags&128)!==0,m=c.rendering,m===null)if(f)Ha(c,!1);else{if(ce!==0||e!==null&&(e.flags&128)!==0)for(e=n.child;e!==null;){if(m=io(e),m!==null){for(n.flags|=128,Ha(c,!1),e=m.updateQueue,n.updateQueue=e,mo(n,e),n.subtreeFlags=0,e=r,r=n.child;r!==null;)md(r,e),r=r.sibling;return T(de,de.current&1|2),Pt&&Ki(n,c.treeForkCount),n.child}e=e.sibling}c.tail!==null&&Vt()>Ao&&(n.flags|=128,f=!0,Ha(c,!1),n.lanes=4194304)}else{if(!f)if(e=io(m),e!==null){if(n.flags|=128,f=!0,e=e.updateQueue,n.updateQueue=e,mo(n,e),Ha(c,!0),c.tail===null&&c.tailMode==="hidden"&&!m.alternate&&!Pt)return ee(n),null}else 2*Vt()-c.renderingStartTime>Ao&&r!==536870912&&(n.flags|=128,f=!0,Ha(c,!1),n.lanes=4194304);c.isBackwards?(m.sibling=n.child,n.child=m):(e=c.last,e!==null?e.sibling=m:n.child=m,c.last=m)}return c.tail!==null?(e=c.tail,c.rendering=e,c.tail=e.sibling,c.renderingStartTime=Vt(),e.sibling=null,r=de.current,T(de,f?r&1|2:r&1),Pt&&Ki(n,c.treeForkCount),e):(ee(n),null);case 22:case 23:return ai(n),cc(),c=n.memoizedState!==null,e!==null?e.memoizedState!==null!==c&&(n.flags|=8192):c&&(n.flags|=8192),c?(r&536870912)!==0&&(n.flags&128)===0&&(ee(n),n.subtreeFlags&6&&(n.flags|=8192)):ee(n),r=n.updateQueue,r!==null&&mo(n,r.retryQueue),r=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(r=e.memoizedState.cachePool.pool),c=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(c=n.memoizedState.cachePool.pool),c!==r&&(n.flags|=2048),e!==null&&H(ts),null;case 24:return r=null,e!==null&&(r=e.memoizedState.cache),n.memoizedState.cache!==r&&(n.flags|=2048),Wi(pe),ee(n),null;case 25:return null;case 30:return null}throw Error(s(156,n.tag))}function db(e,n){switch($l(n),n.tag){case 1:return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 3:return Wi(pe),X(),e=n.flags,(e&65536)!==0&&(e&128)===0?(n.flags=e&-65537|128,n):null;case 26:case 27:case 5:return lt(n),null;case 31:if(n.memoizedState!==null){if(ai(n),n.alternate===null)throw Error(s(340));Wn()}return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 13:if(ai(n),e=n.memoizedState,e!==null&&e.dehydrated!==null){if(n.alternate===null)throw Error(s(340));Wn()}return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 19:return H(de),null;case 4:return X(),null;case 10:return Wi(n.type),null;case 22:case 23:return ai(n),cc(),e!==null&&H(ts),e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 24:return Wi(pe),null;case 25:return null;default:return null}}function Gf(e,n){switch($l(n),n.tag){case 3:Wi(pe),X();break;case 26:case 27:case 5:lt(n);break;case 4:X();break;case 31:n.memoizedState!==null&&ai(n);break;case 13:ai(n);break;case 19:H(de);break;case 10:Wi(n.type);break;case 22:case 23:ai(n),cc(),e!==null&&H(ts);break;case 24:Wi(pe)}}function qa(e,n){try{var r=n.updateQueue,c=r!==null?r.lastEffect:null;if(c!==null){var f=c.next;r=f;do{if((r.tag&e)===e){c=void 0;var m=r.create,x=r.inst;c=m(),x.destroy=c}r=r.next}while(r!==f)}}catch(_){Xt(n,n.return,_)}}function Cn(e,n,r){try{var c=n.updateQueue,f=c!==null?c.lastEffect:null;if(f!==null){var m=f.next;c=m;do{if((c.tag&e)===e){var x=c.inst,_=x.destroy;if(_!==void 0){x.destroy=void 0,f=n;var R=r,V=_;try{V()}catch(W){Xt(f,R,W)}}}c=c.next}while(c!==m)}}catch(W){Xt(n,n.return,W)}}function Vf(e){var n=e.updateQueue;if(n!==null){var r=e.stateNode;try{Ld(n,r)}catch(c){Xt(e,e.return,c)}}}function Yf(e,n,r){r.props=as(e.type,e.memoizedProps),r.state=e.memoizedState;try{r.componentWillUnmount()}catch(c){Xt(e,n,c)}}function Ga(e,n){try{var r=e.ref;if(r!==null){switch(e.tag){case 26:case 27:case 5:var c=e.stateNode;break;case 30:c=e.stateNode;break;default:c=e.stateNode}typeof r=="function"?e.refCleanup=r(c):r.current=c}}catch(f){Xt(e,n,f)}}function Bi(e,n){var r=e.ref,c=e.refCleanup;if(r!==null)if(typeof c=="function")try{c()}catch(f){Xt(e,n,f)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof r=="function")try{r(null)}catch(f){Xt(e,n,f)}else r.current=null}function Xf(e){var n=e.type,r=e.memoizedProps,c=e.stateNode;try{t:switch(n){case"button":case"input":case"select":case"textarea":r.autoFocus&&c.focus();break t;case"img":r.src?c.src=r.src:r.srcSet&&(c.srcset=r.srcSet)}}catch(f){Xt(e,e.return,f)}}function Uc(e,n,r){try{var c=e.stateNode;Lb(c,e.type,r,n),c[Ge]=n}catch(f){Xt(e,e.return,f)}}function $f(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&On(e.type)||e.tag===4}function Hc(e){t:for(;;){for(;e.sibling===null;){if(e.return===null||$f(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&On(e.type)||e.flags&2||e.child===null||e.tag===4)continue t;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function qc(e,n,r){var c=e.tag;if(c===5||c===6)e=e.stateNode,n?(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r).insertBefore(e,n):(n=r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,n.appendChild(e),r=r._reactRootContainer,r!=null||n.onclick!==null||(n.onclick=Yi));else if(c!==4&&(c===27&&On(e.type)&&(r=e.stateNode,n=null),e=e.child,e!==null))for(qc(e,n,r),e=e.sibling;e!==null;)qc(e,n,r),e=e.sibling}function bo(e,n,r){var c=e.tag;if(c===5||c===6)e=e.stateNode,n?r.insertBefore(e,n):r.appendChild(e);else if(c!==4&&(c===27&&On(e.type)&&(r=e.stateNode),e=e.child,e!==null))for(bo(e,n,r),e=e.sibling;e!==null;)bo(e,n,r),e=e.sibling}function Kf(e){var n=e.stateNode,r=e.memoizedProps;try{for(var c=e.type,f=n.attributes;f.length;)n.removeAttributeNode(f[0]);Me(n,c,r),n[Ce]=e,n[Ge]=r}catch(m){Xt(e,e.return,m)}}var nn=!1,ye=!1,Gc=!1,Qf=typeof WeakSet=="function"?WeakSet:Set,we=null;function fb(e,n){if(e=e.containerInfo,hu=Fo,e=od(e),Pl(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else t:{r=(r=e.ownerDocument)&&r.defaultView||window;var c=r.getSelection&&r.getSelection();if(c&&c.rangeCount!==0){r=c.anchorNode;var f=c.anchorOffset,m=c.focusNode;c=c.focusOffset;try{r.nodeType,m.nodeType}catch{r=null;break t}var x=0,_=-1,R=-1,V=0,W=0,J=e,Y=null;e:for(;;){for(var K;J!==r||f!==0&&J.nodeType!==3||(_=x+f),J!==m||c!==0&&J.nodeType!==3||(R=x+c),J.nodeType===3&&(x+=J.nodeValue.length),(K=J.firstChild)!==null;)Y=J,J=K;for(;;){if(J===e)break e;if(Y===r&&++V===f&&(_=x),Y===m&&++W===c&&(R=x),(K=J.nextSibling)!==null)break;J=Y,Y=J.parentNode}J=K}r=_===-1||R===-1?null:{start:_,end:R}}else r=null}r=r||{start:0,end:0}}else r=null;for(du={focusedElem:e,selectionRange:r},Fo=!1,we=n;we!==null;)if(n=we,e=n.child,(n.subtreeFlags&1028)!==0&&e!==null)e.return=n,we=e;else for(;we!==null;){switch(n=we,m=n.alternate,e=n.flags,n.tag){case 0:if((e&4)!==0&&(e=n.updateQueue,e=e!==null?e.events:null,e!==null))for(r=0;r<e.length;r++)f=e[r],f.ref.impl=f.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&m!==null){e=void 0,r=n,f=m.memoizedProps,m=m.memoizedState,c=r.stateNode;try{var ht=as(r.type,f);e=c.getSnapshotBeforeUpdate(ht,m),c.__reactInternalSnapshotBeforeUpdate=e}catch(xt){Xt(r,r.return,xt)}}break;case 3:if((e&1024)!==0){if(e=n.stateNode.containerInfo,r=e.nodeType,r===9)pu(e);else if(r===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":pu(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(s(163))}if(e=n.sibling,e!==null){e.return=n.return,we=e;break}we=n.return}}function Wf(e,n,r){var c=r.flags;switch(r.tag){case 0:case 11:case 15:an(e,r),c&4&&qa(5,r);break;case 1:if(an(e,r),c&4)if(e=r.stateNode,n===null)try{e.componentDidMount()}catch(x){Xt(r,r.return,x)}else{var f=as(r.type,n.memoizedProps);n=n.memoizedState;try{e.componentDidUpdate(f,n,e.__reactInternalSnapshotBeforeUpdate)}catch(x){Xt(r,r.return,x)}}c&64&&Vf(r),c&512&&Ga(r,r.return);break;case 3:if(an(e,r),c&64&&(e=r.updateQueue,e!==null)){if(n=null,r.child!==null)switch(r.child.tag){case 27:case 5:n=r.child.stateNode;break;case 1:n=r.child.stateNode}try{Ld(e,n)}catch(x){Xt(r,r.return,x)}}break;case 27:n===null&&c&4&&Kf(r);case 26:case 5:an(e,r),n===null&&c&4&&Xf(r),c&512&&Ga(r,r.return);break;case 12:an(e,r);break;case 31:an(e,r),c&4&&tg(e,r);break;case 13:an(e,r),c&4&&eg(e,r),c&64&&(e=r.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(r=Sb.bind(null,r),Hb(e,r))));break;case 22:if(c=r.memoizedState!==null||nn,!c){n=n!==null&&n.memoizedState!==null||ye,f=nn;var m=ye;nn=c,(ye=n)&&!m?rn(e,r,(r.subtreeFlags&8772)!==0):an(e,r),nn=f,ye=m}break;case 30:break;default:an(e,r)}}function Zf(e){var n=e.alternate;n!==null&&(e.alternate=null,Zf(n)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(n=e.stateNode,n!==null&&xl(n)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var ie=null,Ye=!1;function sn(e,n,r){for(r=r.child;r!==null;)Jf(e,n,r),r=r.sibling}function Jf(e,n,r){if(Be&&typeof Be.onCommitFiberUnmount=="function")try{Be.onCommitFiberUnmount(Di,r)}catch{}switch(r.tag){case 26:ye||Bi(r,n),sn(e,n,r),r.memoizedState?r.memoizedState.count--:r.stateNode&&(r=r.stateNode,r.parentNode.removeChild(r));break;case 27:ye||Bi(r,n);var c=ie,f=Ye;On(r.type)&&(ie=r.stateNode,Ye=!1),sn(e,n,r),Ja(r.stateNode),ie=c,Ye=f;break;case 5:ye||Bi(r,n);case 6:if(c=ie,f=Ye,ie=null,sn(e,n,r),ie=c,Ye=f,ie!==null)if(Ye)try{(ie.nodeType===9?ie.body:ie.nodeName==="HTML"?ie.ownerDocument.body:ie).removeChild(r.stateNode)}catch(m){Xt(r,n,m)}else try{ie.removeChild(r.stateNode)}catch(m){Xt(r,n,m)}break;case 18:ie!==null&&(Ye?(e=ie,Vg(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,r.stateNode),ta(e)):Vg(ie,r.stateNode));break;case 4:c=ie,f=Ye,ie=r.stateNode.containerInfo,Ye=!0,sn(e,n,r),ie=c,Ye=f;break;case 0:case 11:case 14:case 15:Cn(2,r,n),ye||Cn(4,r,n),sn(e,n,r);break;case 1:ye||(Bi(r,n),c=r.stateNode,typeof c.componentWillUnmount=="function"&&Yf(r,n,c)),sn(e,n,r);break;case 21:sn(e,n,r);break;case 22:ye=(c=ye)||r.memoizedState!==null,sn(e,n,r),ye=c;break;default:sn(e,n,r)}}function tg(e,n){if(n.memoizedState===null&&(e=n.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{ta(e)}catch(r){Xt(n,n.return,r)}}}function eg(e,n){if(n.memoizedState===null&&(e=n.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{ta(e)}catch(r){Xt(n,n.return,r)}}function gb(e){switch(e.tag){case 31:case 13:case 19:var n=e.stateNode;return n===null&&(n=e.stateNode=new Qf),n;case 22:return e=e.stateNode,n=e._retryCache,n===null&&(n=e._retryCache=new Qf),n;default:throw Error(s(435,e.tag))}}function yo(e,n){var r=gb(e);n.forEach(function(c){if(!r.has(c)){r.add(c);var f=wb.bind(null,e,c);c.then(f,f)}})}function Xe(e,n){var r=n.deletions;if(r!==null)for(var c=0;c<r.length;c++){var f=r[c],m=e,x=n,_=x;t:for(;_!==null;){switch(_.tag){case 27:if(On(_.type)){ie=_.stateNode,Ye=!1;break t}break;case 5:ie=_.stateNode,Ye=!1;break t;case 3:case 4:ie=_.stateNode.containerInfo,Ye=!0;break t}_=_.return}if(ie===null)throw Error(s(160));Jf(m,x,f),ie=null,Ye=!1,m=f.alternate,m!==null&&(m.return=null),f.return=null}if(n.subtreeFlags&13886)for(n=n.child;n!==null;)ig(n,e),n=n.sibling}var Mi=null;function ig(e,n){var r=e.alternate,c=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Xe(n,e),$e(e),c&4&&(Cn(3,e,e.return),qa(3,e),Cn(5,e,e.return));break;case 1:Xe(n,e),$e(e),c&512&&(ye||r===null||Bi(r,r.return)),c&64&&nn&&(e=e.updateQueue,e!==null&&(c=e.callbacks,c!==null&&(r=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=r===null?c:r.concat(c))));break;case 26:var f=Mi;if(Xe(n,e),$e(e),c&512&&(ye||r===null||Bi(r,r.return)),c&4){var m=r!==null?r.memoizedState:null;if(c=e.memoizedState,r===null)if(c===null)if(e.stateNode===null){t:{c=e.type,r=e.memoizedProps,f=f.ownerDocument||f;e:switch(c){case"title":m=f.getElementsByTagName("title")[0],(!m||m[ba]||m[Ce]||m.namespaceURI==="http://www.w3.org/2000/svg"||m.hasAttribute("itemprop"))&&(m=f.createElement(c),f.head.insertBefore(m,f.querySelector("head > title"))),Me(m,c,r),m[Ce]=e,Se(m),c=m;break t;case"link":var x=ip("link","href",f).get(c+(r.href||""));if(x){for(var _=0;_<x.length;_++)if(m=x[_],m.getAttribute("href")===(r.href==null||r.href===""?null:r.href)&&m.getAttribute("rel")===(r.rel==null?null:r.rel)&&m.getAttribute("title")===(r.title==null?null:r.title)&&m.getAttribute("crossorigin")===(r.crossOrigin==null?null:r.crossOrigin)){x.splice(_,1);break e}}m=f.createElement(c),Me(m,c,r),f.head.appendChild(m);break;case"meta":if(x=ip("meta","content",f).get(c+(r.content||""))){for(_=0;_<x.length;_++)if(m=x[_],m.getAttribute("content")===(r.content==null?null:""+r.content)&&m.getAttribute("name")===(r.name==null?null:r.name)&&m.getAttribute("property")===(r.property==null?null:r.property)&&m.getAttribute("http-equiv")===(r.httpEquiv==null?null:r.httpEquiv)&&m.getAttribute("charset")===(r.charSet==null?null:r.charSet)){x.splice(_,1);break e}}m=f.createElement(c),Me(m,c,r),f.head.appendChild(m);break;default:throw Error(s(468,c))}m[Ce]=e,Se(m),c=m}e.stateNode=c}else np(f,e.type,e.stateNode);else e.stateNode=ep(f,c,e.memoizedProps);else m!==c?(m===null?r.stateNode!==null&&(r=r.stateNode,r.parentNode.removeChild(r)):m.count--,c===null?np(f,e.type,e.stateNode):ep(f,c,e.memoizedProps)):c===null&&e.stateNode!==null&&Uc(e,e.memoizedProps,r.memoizedProps)}break;case 27:Xe(n,e),$e(e),c&512&&(ye||r===null||Bi(r,r.return)),r!==null&&c&4&&Uc(e,e.memoizedProps,r.memoizedProps);break;case 5:if(Xe(n,e),$e(e),c&512&&(ye||r===null||Bi(r,r.return)),e.flags&32){f=e.stateNode;try{ws(f,"")}catch(ht){Xt(e,e.return,ht)}}c&4&&e.stateNode!=null&&(f=e.memoizedProps,Uc(e,f,r!==null?r.memoizedProps:f)),c&1024&&(Gc=!0);break;case 6:if(Xe(n,e),$e(e),c&4){if(e.stateNode===null)throw Error(s(162));c=e.memoizedProps,r=e.stateNode;try{r.nodeValue=c}catch(ht){Xt(e,e.return,ht)}}break;case 3:if(Lo=null,f=Mi,Mi=ko(n.containerInfo),Xe(n,e),Mi=f,$e(e),c&4&&r!==null&&r.memoizedState.isDehydrated)try{ta(n.containerInfo)}catch(ht){Xt(e,e.return,ht)}Gc&&(Gc=!1,ng(e));break;case 4:c=Mi,Mi=ko(e.stateNode.containerInfo),Xe(n,e),$e(e),Mi=c;break;case 12:Xe(n,e),$e(e);break;case 31:Xe(n,e),$e(e),c&4&&(c=e.updateQueue,c!==null&&(e.updateQueue=null,yo(e,c)));break;case 13:Xe(n,e),$e(e),e.child.flags&8192&&e.memoizedState!==null!=(r!==null&&r.memoizedState!==null)&&(xo=Vt()),c&4&&(c=e.updateQueue,c!==null&&(e.updateQueue=null,yo(e,c)));break;case 22:f=e.memoizedState!==null;var R=r!==null&&r.memoizedState!==null,V=nn,W=ye;if(nn=V||f,ye=W||R,Xe(n,e),ye=W,nn=V,$e(e),c&8192)t:for(n=e.stateNode,n._visibility=f?n._visibility&-2:n._visibility|1,f&&(r===null||R||nn||ye||rs(e)),r=null,n=e;;){if(n.tag===5||n.tag===26){if(r===null){R=r=n;try{if(m=R.stateNode,f)x=m.style,typeof x.setProperty=="function"?x.setProperty("display","none","important"):x.display="none";else{_=R.stateNode;var J=R.memoizedProps.style,Y=J!=null&&J.hasOwnProperty("display")?J.display:null;_.style.display=Y==null||typeof Y=="boolean"?"":(""+Y).trim()}}catch(ht){Xt(R,R.return,ht)}}}else if(n.tag===6){if(r===null){R=n;try{R.stateNode.nodeValue=f?"":R.memoizedProps}catch(ht){Xt(R,R.return,ht)}}}else if(n.tag===18){if(r===null){R=n;try{var K=R.stateNode;f?Yg(K,!0):Yg(R.stateNode,!1)}catch(ht){Xt(R,R.return,ht)}}}else if((n.tag!==22&&n.tag!==23||n.memoizedState===null||n===e)&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break t;for(;n.sibling===null;){if(n.return===null||n.return===e)break t;r===n&&(r=null),n=n.return}r===n&&(r=null),n.sibling.return=n.return,n=n.sibling}c&4&&(c=e.updateQueue,c!==null&&(r=c.retryQueue,r!==null&&(c.retryQueue=null,yo(e,r))));break;case 19:Xe(n,e),$e(e),c&4&&(c=e.updateQueue,c!==null&&(e.updateQueue=null,yo(e,c)));break;case 30:break;case 21:break;default:Xe(n,e),$e(e)}}function $e(e){var n=e.flags;if(n&2){try{for(var r,c=e.return;c!==null;){if($f(c)){r=c;break}c=c.return}if(r==null)throw Error(s(160));switch(r.tag){case 27:var f=r.stateNode,m=Hc(e);bo(e,m,f);break;case 5:var x=r.stateNode;r.flags&32&&(ws(x,""),r.flags&=-33);var _=Hc(e);bo(e,_,x);break;case 3:case 4:var R=r.stateNode.containerInfo,V=Hc(e);qc(e,V,R);break;default:throw Error(s(161))}}catch(W){Xt(e,e.return,W)}e.flags&=-3}n&4096&&(e.flags&=-4097)}function ng(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var n=e;ng(n),n.tag===5&&n.flags&1024&&n.stateNode.reset(),e=e.sibling}}function an(e,n){if(n.subtreeFlags&8772)for(n=n.child;n!==null;)Wf(e,n.alternate,n),n=n.sibling}function rs(e){for(e=e.child;e!==null;){var n=e;switch(n.tag){case 0:case 11:case 14:case 15:Cn(4,n,n.return),rs(n);break;case 1:Bi(n,n.return);var r=n.stateNode;typeof r.componentWillUnmount=="function"&&Yf(n,n.return,r),rs(n);break;case 27:Ja(n.stateNode);case 26:case 5:Bi(n,n.return),rs(n);break;case 22:n.memoizedState===null&&rs(n);break;case 30:rs(n);break;default:rs(n)}e=e.sibling}}function rn(e,n,r){for(r=r&&(n.subtreeFlags&8772)!==0,n=n.child;n!==null;){var c=n.alternate,f=e,m=n,x=m.flags;switch(m.tag){case 0:case 11:case 15:rn(f,m,r),qa(4,m);break;case 1:if(rn(f,m,r),c=m,f=c.stateNode,typeof f.componentDidMount=="function")try{f.componentDidMount()}catch(V){Xt(c,c.return,V)}if(c=m,f=c.updateQueue,f!==null){var _=c.stateNode;try{var R=f.shared.hiddenCallbacks;if(R!==null)for(f.shared.hiddenCallbacks=null,f=0;f<R.length;f++)Od(R[f],_)}catch(V){Xt(c,c.return,V)}}r&&x&64&&Vf(m),Ga(m,m.return);break;case 27:Kf(m);case 26:case 5:rn(f,m,r),r&&c===null&&x&4&&Xf(m),Ga(m,m.return);break;case 12:rn(f,m,r);break;case 31:rn(f,m,r),r&&x&4&&tg(f,m);break;case 13:rn(f,m,r),r&&x&4&&eg(f,m);break;case 22:m.memoizedState===null&&rn(f,m,r),Ga(m,m.return);break;case 30:break;default:rn(f,m,r)}n=n.sibling}}function Vc(e,n){var r=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(r=e.memoizedState.cachePool.pool),e=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(e=n.memoizedState.cachePool.pool),e!==r&&(e!=null&&e.refCount++,r!=null&&Ma(r))}function Yc(e,n){e=null,n.alternate!==null&&(e=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==e&&(n.refCount++,e!=null&&Ma(e))}function Ri(e,n,r,c){if(n.subtreeFlags&10256)for(n=n.child;n!==null;)sg(e,n,r,c),n=n.sibling}function sg(e,n,r,c){var f=n.flags;switch(n.tag){case 0:case 11:case 15:Ri(e,n,r,c),f&2048&&qa(9,n);break;case 1:Ri(e,n,r,c);break;case 3:Ri(e,n,r,c),f&2048&&(e=null,n.alternate!==null&&(e=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==e&&(n.refCount++,e!=null&&Ma(e)));break;case 12:if(f&2048){Ri(e,n,r,c),e=n.stateNode;try{var m=n.memoizedProps,x=m.id,_=m.onPostCommit;typeof _=="function"&&_(x,n.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(R){Xt(n,n.return,R)}}else Ri(e,n,r,c);break;case 31:Ri(e,n,r,c);break;case 13:Ri(e,n,r,c);break;case 23:break;case 22:m=n.stateNode,x=n.alternate,n.memoizedState!==null?m._visibility&2?Ri(e,n,r,c):Va(e,n):m._visibility&2?Ri(e,n,r,c):(m._visibility|=2,qs(e,n,r,c,(n.subtreeFlags&10256)!==0||!1)),f&2048&&Vc(x,n);break;case 24:Ri(e,n,r,c),f&2048&&Yc(n.alternate,n);break;default:Ri(e,n,r,c)}}function qs(e,n,r,c,f){for(f=f&&((n.subtreeFlags&10256)!==0||!1),n=n.child;n!==null;){var m=e,x=n,_=r,R=c,V=x.flags;switch(x.tag){case 0:case 11:case 15:qs(m,x,_,R,f),qa(8,x);break;case 23:break;case 22:var W=x.stateNode;x.memoizedState!==null?W._visibility&2?qs(m,x,_,R,f):Va(m,x):(W._visibility|=2,qs(m,x,_,R,f)),f&&V&2048&&Vc(x.alternate,x);break;case 24:qs(m,x,_,R,f),f&&V&2048&&Yc(x.alternate,x);break;default:qs(m,x,_,R,f)}n=n.sibling}}function Va(e,n){if(n.subtreeFlags&10256)for(n=n.child;n!==null;){var r=e,c=n,f=c.flags;switch(c.tag){case 22:Va(r,c),f&2048&&Vc(c.alternate,c);break;case 24:Va(r,c),f&2048&&Yc(c.alternate,c);break;default:Va(r,c)}n=n.sibling}}var Ya=8192;function Gs(e,n,r){if(e.subtreeFlags&Ya)for(e=e.child;e!==null;)ag(e,n,r),e=e.sibling}function ag(e,n,r){switch(e.tag){case 26:Gs(e,n,r),e.flags&Ya&&e.memoizedState!==null&&ty(r,Mi,e.memoizedState,e.memoizedProps);break;case 5:Gs(e,n,r);break;case 3:case 4:var c=Mi;Mi=ko(e.stateNode.containerInfo),Gs(e,n,r),Mi=c;break;case 22:e.memoizedState===null&&(c=e.alternate,c!==null&&c.memoizedState!==null?(c=Ya,Ya=16777216,Gs(e,n,r),Ya=c):Gs(e,n,r));break;default:Gs(e,n,r)}}function rg(e){var n=e.alternate;if(n!==null&&(e=n.child,e!==null)){n.child=null;do n=e.sibling,e.sibling=null,e=n;while(e!==null)}}function Xa(e){var n=e.deletions;if((e.flags&16)!==0){if(n!==null)for(var r=0;r<n.length;r++){var c=n[r];we=c,lg(c,e)}rg(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)og(e),e=e.sibling}function og(e){switch(e.tag){case 0:case 11:case 15:Xa(e),e.flags&2048&&Cn(9,e,e.return);break;case 3:Xa(e);break;case 12:Xa(e);break;case 22:var n=e.stateNode;e.memoizedState!==null&&n._visibility&2&&(e.return===null||e.return.tag!==13)?(n._visibility&=-3,vo(e)):Xa(e);break;default:Xa(e)}}function vo(e){var n=e.deletions;if((e.flags&16)!==0){if(n!==null)for(var r=0;r<n.length;r++){var c=n[r];we=c,lg(c,e)}rg(e)}for(e=e.child;e!==null;){switch(n=e,n.tag){case 0:case 11:case 15:Cn(8,n,n.return),vo(n);break;case 22:r=n.stateNode,r._visibility&2&&(r._visibility&=-3,vo(n));break;default:vo(n)}e=e.sibling}}function lg(e,n){for(;we!==null;){var r=we;switch(r.tag){case 0:case 11:case 15:Cn(8,r,n);break;case 23:case 22:if(r.memoizedState!==null&&r.memoizedState.cachePool!==null){var c=r.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:Ma(r.memoizedState.cache)}if(c=r.child,c!==null)c.return=r,we=c;else t:for(r=e;we!==null;){c=we;var f=c.sibling,m=c.return;if(Zf(c),c===r){we=null;break t}if(f!==null){f.return=m,we=f;break t}we=m}}}var pb={getCacheForType:function(e){var n=De(pe),r=n.data.get(e);return r===void 0&&(r=e(),n.data.set(e,r)),r},cacheSignal:function(){return De(pe).controller.signal}},mb=typeof WeakMap=="function"?WeakMap:Map,qt=0,Zt=null,kt=null,jt=0,Yt=0,ri=null,Tn=!1,Vs=!1,Xc=!1,on=0,ce=0,Dn=0,os=0,$c=0,oi=0,Ys=0,$a=null,Ke=null,Kc=!1,xo=0,cg=0,Ao=1/0,So=null,Nn=null,Ae=0,Mn=null,Xs=null,ln=0,Qc=0,Wc=null,ug=null,Ka=0,Zc=null;function li(){return(qt&2)!==0&&jt!==0?jt&-jt:F.T!==null?su():Eh()}function hg(){if(oi===0)if((jt&536870912)===0||Pt){var e=Nr;Nr<<=1,(Nr&3932160)===0&&(Nr=262144),oi=e}else oi=536870912;return e=si.current,e!==null&&(e.flags|=32),oi}function Qe(e,n,r){(e===Zt&&(Yt===2||Yt===9)||e.cancelPendingCommit!==null)&&($s(e,0),Rn(e,jt,oi,!1)),ma(e,r),((qt&2)===0||e!==Zt)&&(e===Zt&&((qt&2)===0&&(os|=r),ce===4&&Rn(e,jt,oi,!1)),Pi(e))}function dg(e,n,r){if((qt&6)!==0)throw Error(s(327));var c=!r&&(n&127)===0&&(n&e.expiredLanes)===0||pa(e,n),f=c?vb(e,n):tu(e,n,!0),m=c;do{if(f===0){Vs&&!c&&Rn(e,n,0,!1);break}else{if(r=e.current.alternate,m&&!bb(r)){f=tu(e,n,!1),m=!1;continue}if(f===2){if(m=n,e.errorRecoveryDisabledLanes&m)var x=0;else x=e.pendingLanes&-536870913,x=x!==0?x:x&536870912?536870912:0;if(x!==0){n=x;t:{var _=e;f=$a;var R=_.current.memoizedState.isDehydrated;if(R&&($s(_,x).flags|=256),x=tu(_,x,!1),x!==2){if(Xc&&!R){_.errorRecoveryDisabledLanes|=m,os|=m,f=4;break t}m=Ke,Ke=f,m!==null&&(Ke===null?Ke=m:Ke.push.apply(Ke,m))}f=x}if(m=!1,f!==2)continue}}if(f===1){$s(e,0),Rn(e,n,0,!0);break}t:{switch(c=e,m=f,m){case 0:case 1:throw Error(s(345));case 4:if((n&4194048)!==n)break;case 6:Rn(c,n,oi,!Tn);break t;case 2:Ke=null;break;case 3:case 5:break;default:throw Error(s(329))}if((n&62914560)===n&&(f=xo+300-Vt(),10<f)){if(Rn(c,n,oi,!Tn),Rr(c,0,!0)!==0)break t;ln=n,c.timeoutHandle=qg(fg.bind(null,c,r,Ke,So,Kc,n,oi,os,Ys,Tn,m,"Throttled",-0,0),f);break t}fg(c,r,Ke,So,Kc,n,oi,os,Ys,Tn,m,null,-0,0)}}break}while(!0);Pi(e)}function fg(e,n,r,c,f,m,x,_,R,V,W,J,Y,K){if(e.timeoutHandle=-1,J=n.subtreeFlags,J&8192||(J&16785408)===16785408){J={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Yi},ag(n,m,J);var ht=(m&62914560)===m?xo-Vt():(m&4194048)===m?cg-Vt():0;if(ht=ey(J,ht),ht!==null){ln=m,e.cancelPendingCommit=ht(Ag.bind(null,e,n,m,r,c,f,x,_,R,W,J,null,Y,K)),Rn(e,m,x,!V);return}}Ag(e,n,m,r,c,f,x,_,R)}function bb(e){for(var n=e;;){var r=n.tag;if((r===0||r===11||r===15)&&n.flags&16384&&(r=n.updateQueue,r!==null&&(r=r.stores,r!==null)))for(var c=0;c<r.length;c++){var f=r[c],m=f.getSnapshot;f=f.value;try{if(!ii(m(),f))return!1}catch{return!1}}if(r=n.child,n.subtreeFlags&16384&&r!==null)r.return=n,n=r;else{if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function Rn(e,n,r,c){n&=~$c,n&=~os,e.suspendedLanes|=n,e.pingedLanes&=~n,c&&(e.warmLanes|=n),c=e.expirationTimes;for(var f=n;0<f;){var m=31-ei(f),x=1<<m;c[m]=-1,f&=~x}r!==0&&Sh(e,r,n)}function wo(){return(qt&6)===0?(Qa(0),!1):!0}function Jc(){if(kt!==null){if(Yt===0)var e=kt.return;else e=kt,Qi=Zn=null,pc(e),Fs=null,ka=0,e=kt;for(;e!==null;)Gf(e.alternate,e),e=e.return;kt=null}}function $s(e,n){var r=e.timeoutHandle;r!==-1&&(e.timeoutHandle=-1,Pb(r)),r=e.cancelPendingCommit,r!==null&&(e.cancelPendingCommit=null,r()),ln=0,Jc(),Zt=e,kt=r=$i(e.current,null),jt=n,Yt=0,ri=null,Tn=!1,Vs=pa(e,n),Xc=!1,Ys=oi=$c=os=Dn=ce=0,Ke=$a=null,Kc=!1,(n&8)!==0&&(n|=n&32);var c=e.entangledLanes;if(c!==0)for(e=e.entanglements,c&=n;0<c;){var f=31-ei(c),m=1<<f;n|=e[f],c&=~m}return on=n,qr(),r}function gg(e,n){Dt=null,F.H=Ia,n===Ps||n===Wr?(n=Nd(),Yt=3):n===nc?(n=Nd(),Yt=4):Yt=n===Rc?8:n!==null&&typeof n=="object"&&typeof n.then=="function"?6:1,ri=n,kt===null&&(ce=1,ho(e,bi(n,e.current)))}function pg(){var e=si.current;return e===null?!0:(jt&4194048)===jt?Ai===null:(jt&62914560)===jt||(jt&536870912)!==0?e===Ai:!1}function mg(){var e=F.H;return F.H=Ia,e===null?Ia:e}function bg(){var e=F.A;return F.A=pb,e}function _o(){ce=4,Tn||(jt&4194048)!==jt&&si.current!==null||(Vs=!0),(Dn&134217727)===0&&(os&134217727)===0||Zt===null||Rn(Zt,jt,oi,!1)}function tu(e,n,r){var c=qt;qt|=2;var f=mg(),m=bg();(Zt!==e||jt!==n)&&(So=null,$s(e,n)),n=!1;var x=ce;t:do try{if(Yt!==0&&kt!==null){var _=kt,R=ri;switch(Yt){case 8:Jc(),x=6;break t;case 3:case 2:case 9:case 6:si.current===null&&(n=!0);var V=Yt;if(Yt=0,ri=null,Ks(e,_,R,V),r&&Vs){x=0;break t}break;default:V=Yt,Yt=0,ri=null,Ks(e,_,R,V)}}yb(),x=ce;break}catch(W){gg(e,W)}while(!0);return n&&e.shellSuspendCounter++,Qi=Zn=null,qt=c,F.H=f,F.A=m,kt===null&&(Zt=null,jt=0,qr()),x}function yb(){for(;kt!==null;)yg(kt)}function vb(e,n){var r=qt;qt|=2;var c=mg(),f=bg();Zt!==e||jt!==n?(So=null,Ao=Vt()+500,$s(e,n)):Vs=pa(e,n);t:do try{if(Yt!==0&&kt!==null){n=kt;var m=ri;e:switch(Yt){case 1:Yt=0,ri=null,Ks(e,n,m,1);break;case 2:case 9:if(Td(m)){Yt=0,ri=null,vg(n);break}n=function(){Yt!==2&&Yt!==9||Zt!==e||(Yt=7),Pi(e)},m.then(n,n);break t;case 3:Yt=7;break t;case 4:Yt=5;break t;case 7:Td(m)?(Yt=0,ri=null,vg(n)):(Yt=0,ri=null,Ks(e,n,m,7));break;case 5:var x=null;switch(kt.tag){case 26:x=kt.memoizedState;case 5:case 27:var _=kt;if(x?sp(x):_.stateNode.complete){Yt=0,ri=null;var R=_.sibling;if(R!==null)kt=R;else{var V=_.return;V!==null?(kt=V,Eo(V)):kt=null}break e}}Yt=0,ri=null,Ks(e,n,m,5);break;case 6:Yt=0,ri=null,Ks(e,n,m,6);break;case 8:Jc(),ce=6;break t;default:throw Error(s(462))}}xb();break}catch(W){gg(e,W)}while(!0);return Qi=Zn=null,F.H=c,F.A=f,qt=r,kt!==null?0:(Zt=null,jt=0,qr(),ce)}function xb(){for(;kt!==null&&!hi();)yg(kt)}function yg(e){var n=Hf(e.alternate,e,on);e.memoizedProps=e.pendingProps,n===null?Eo(e):kt=n}function vg(e){var n=e,r=n.alternate;switch(n.tag){case 15:case 0:n=Bf(r,n,n.pendingProps,n.type,void 0,jt);break;case 11:n=Bf(r,n,n.pendingProps,n.type.render,n.ref,jt);break;case 5:pc(n);default:Gf(r,n),n=kt=md(n,on),n=Hf(r,n,on)}e.memoizedProps=e.pendingProps,n===null?Eo(e):kt=n}function Ks(e,n,r,c){Qi=Zn=null,pc(n),Fs=null,ka=0;var f=n.return;try{if(lb(e,f,n,r,jt)){ce=1,ho(e,bi(r,e.current)),kt=null;return}}catch(m){if(f!==null)throw kt=f,m;ce=1,ho(e,bi(r,e.current)),kt=null;return}n.flags&32768?(Pt||c===1?e=!0:Vs||(jt&536870912)!==0?e=!1:(Tn=e=!0,(c===2||c===9||c===3||c===6)&&(c=si.current,c!==null&&c.tag===13&&(c.flags|=16384))),xg(n,e)):Eo(n)}function Eo(e){var n=e;do{if((n.flags&32768)!==0){xg(n,Tn);return}e=n.return;var r=hb(n.alternate,n,on);if(r!==null){kt=r;return}if(n=n.sibling,n!==null){kt=n;return}kt=n=e}while(n!==null);ce===0&&(ce=5)}function xg(e,n){do{var r=db(e.alternate,e);if(r!==null){r.flags&=32767,kt=r;return}if(r=e.return,r!==null&&(r.flags|=32768,r.subtreeFlags=0,r.deletions=null),!n&&(e=e.sibling,e!==null)){kt=e;return}kt=e=r}while(e!==null);ce=6,kt=null}function Ag(e,n,r,c,f,m,x,_,R){e.cancelPendingCommit=null;do Co();while(Ae!==0);if((qt&6)!==0)throw Error(s(327));if(n!==null){if(n===e.current)throw Error(s(177));if(m=n.lanes|n.childLanes,m|=Hl,Jm(e,r,m,x,_,R),e===Zt&&(kt=Zt=null,jt=0),Xs=n,Mn=e,ln=r,Qc=m,Wc=f,ug=c,(n.subtreeFlags&10256)!==0||(n.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,_b(qe,function(){return Cg(),null})):(e.callbackNode=null,e.callbackPriority=0),c=(n.flags&13878)!==0,(n.subtreeFlags&13878)!==0||c){c=F.T,F.T=null,f=q.p,q.p=2,x=qt,qt|=4;try{fb(e,n,r)}finally{qt=x,q.p=f,F.T=c}}Ae=1,Sg(),wg(),_g()}}function Sg(){if(Ae===1){Ae=0;var e=Mn,n=Xs,r=(n.flags&13878)!==0;if((n.subtreeFlags&13878)!==0||r){r=F.T,F.T=null;var c=q.p;q.p=2;var f=qt;qt|=4;try{ig(n,e);var m=du,x=od(e.containerInfo),_=m.focusedElem,R=m.selectionRange;if(x!==_&&_&&_.ownerDocument&&rd(_.ownerDocument.documentElement,_)){if(R!==null&&Pl(_)){var V=R.start,W=R.end;if(W===void 0&&(W=V),"selectionStart"in _)_.selectionStart=V,_.selectionEnd=Math.min(W,_.value.length);else{var J=_.ownerDocument||document,Y=J&&J.defaultView||window;if(Y.getSelection){var K=Y.getSelection(),ht=_.textContent.length,xt=Math.min(R.start,ht),Qt=R.end===void 0?xt:Math.min(R.end,ht);!K.extend&&xt>Qt&&(x=Qt,Qt=xt,xt=x);var I=ad(_,xt),B=ad(_,Qt);if(I&&B&&(K.rangeCount!==1||K.anchorNode!==I.node||K.anchorOffset!==I.offset||K.focusNode!==B.node||K.focusOffset!==B.offset)){var G=J.createRange();G.setStart(I.node,I.offset),K.removeAllRanges(),xt>Qt?(K.addRange(G),K.extend(B.node,B.offset)):(G.setEnd(B.node,B.offset),K.addRange(G))}}}}for(J=[],K=_;K=K.parentNode;)K.nodeType===1&&J.push({element:K,left:K.scrollLeft,top:K.scrollTop});for(typeof _.focus=="function"&&_.focus(),_=0;_<J.length;_++){var Z=J[_];Z.element.scrollLeft=Z.left,Z.element.scrollTop=Z.top}}Fo=!!hu,du=hu=null}finally{qt=f,q.p=c,F.T=r}}e.current=n,Ae=2}}function wg(){if(Ae===2){Ae=0;var e=Mn,n=Xs,r=(n.flags&8772)!==0;if((n.subtreeFlags&8772)!==0||r){r=F.T,F.T=null;var c=q.p;q.p=2;var f=qt;qt|=4;try{Wf(e,n.alternate,n)}finally{qt=f,q.p=c,F.T=r}}Ae=3}}function _g(){if(Ae===4||Ae===3){Ae=0,qn();var e=Mn,n=Xs,r=ln,c=ug;(n.subtreeFlags&10256)!==0||(n.flags&10256)!==0?Ae=5:(Ae=0,Xs=Mn=null,Eg(e,e.pendingLanes));var f=e.pendingLanes;if(f===0&&(Nn=null),yl(r),n=n.stateNode,Be&&typeof Be.onCommitFiberRoot=="function")try{Be.onCommitFiberRoot(Di,n,void 0,(n.current.flags&128)===128)}catch{}if(c!==null){n=F.T,f=q.p,q.p=2,F.T=null;try{for(var m=e.onRecoverableError,x=0;x<c.length;x++){var _=c[x];m(_.value,{componentStack:_.stack})}}finally{F.T=n,q.p=f}}(ln&3)!==0&&Co(),Pi(e),f=e.pendingLanes,(r&261930)!==0&&(f&42)!==0?e===Zc?Ka++:(Ka=0,Zc=e):Ka=0,Qa(0)}}function Eg(e,n){(e.pooledCacheLanes&=n)===0&&(n=e.pooledCache,n!=null&&(e.pooledCache=null,Ma(n)))}function Co(){return Sg(),wg(),_g(),Cg()}function Cg(){if(Ae!==5)return!1;var e=Mn,n=Qc;Qc=0;var r=yl(ln),c=F.T,f=q.p;try{q.p=32>r?32:r,F.T=null,r=Wc,Wc=null;var m=Mn,x=ln;if(Ae=0,Xs=Mn=null,ln=0,(qt&6)!==0)throw Error(s(331));var _=qt;if(qt|=4,og(m.current),sg(m,m.current,x,r),qt=_,Qa(0,!1),Be&&typeof Be.onPostCommitFiberRoot=="function")try{Be.onPostCommitFiberRoot(Di,m)}catch{}return!0}finally{q.p=f,F.T=c,Eg(e,n)}}function Tg(e,n,r){n=bi(r,n),n=Mc(e.stateNode,n,2),e=wn(e,n,2),e!==null&&(ma(e,2),Pi(e))}function Xt(e,n,r){if(e.tag===3)Tg(e,e,r);else for(;n!==null;){if(n.tag===3){Tg(n,e,r);break}else if(n.tag===1){var c=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Nn===null||!Nn.has(c))){e=bi(r,e),r=Df(2),c=wn(n,r,2),c!==null&&(Nf(r,c,n,e),ma(c,2),Pi(c));break}}n=n.return}}function eu(e,n,r){var c=e.pingCache;if(c===null){c=e.pingCache=new mb;var f=new Set;c.set(n,f)}else f=c.get(n),f===void 0&&(f=new Set,c.set(n,f));f.has(r)||(Xc=!0,f.add(r),e=Ab.bind(null,e,n,r),n.then(e,e))}function Ab(e,n,r){var c=e.pingCache;c!==null&&c.delete(n),e.pingedLanes|=e.suspendedLanes&r,e.warmLanes&=~r,Zt===e&&(jt&r)===r&&(ce===4||ce===3&&(jt&62914560)===jt&&300>Vt()-xo?(qt&2)===0&&$s(e,0):$c|=r,Ys===jt&&(Ys=0)),Pi(e)}function Dg(e,n){n===0&&(n=Ah()),e=Kn(e,n),e!==null&&(ma(e,n),Pi(e))}function Sb(e){var n=e.memoizedState,r=0;n!==null&&(r=n.retryLane),Dg(e,r)}function wb(e,n){var r=0;switch(e.tag){case 31:case 13:var c=e.stateNode,f=e.memoizedState;f!==null&&(r=f.retryLane);break;case 19:c=e.stateNode;break;case 22:c=e.stateNode._retryCache;break;default:throw Error(s(314))}c!==null&&c.delete(n),Dg(e,r)}function _b(e,n){return oe(e,n)}var To=null,Qs=null,iu=!1,Do=!1,nu=!1,kn=0;function Pi(e){e!==Qs&&e.next===null&&(Qs===null?To=Qs=e:Qs=Qs.next=e),Do=!0,iu||(iu=!0,Cb())}function Qa(e,n){if(!nu&&Do){nu=!0;do for(var r=!1,c=To;c!==null;){if(e!==0){var f=c.pendingLanes;if(f===0)var m=0;else{var x=c.suspendedLanes,_=c.pingedLanes;m=(1<<31-ei(42|e)+1)-1,m&=f&~(x&~_),m=m&201326741?m&201326741|1:m?m|2:0}m!==0&&(r=!0,kg(c,m))}else m=jt,m=Rr(c,c===Zt?m:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(m&3)===0||pa(c,m)||(r=!0,kg(c,m));c=c.next}while(r);nu=!1}}function Eb(){Ng()}function Ng(){Do=iu=!1;var e=0;kn!==0&&Bb()&&(e=kn);for(var n=Vt(),r=null,c=To;c!==null;){var f=c.next,m=Mg(c,n);m===0?(c.next=null,r===null?To=f:r.next=f,f===null&&(Qs=r)):(r=c,(e!==0||(m&3)!==0)&&(Do=!0)),c=f}Ae!==0&&Ae!==5||Qa(e),kn!==0&&(kn=0)}function Mg(e,n){for(var r=e.suspendedLanes,c=e.pingedLanes,f=e.expirationTimes,m=e.pendingLanes&-62914561;0<m;){var x=31-ei(m),_=1<<x,R=f[x];R===-1?((_&r)===0||(_&c)!==0)&&(f[x]=Zm(_,n)):R<=n&&(e.expiredLanes|=_),m&=~_}if(n=Zt,r=jt,r=Rr(e,e===n?r:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),c=e.callbackNode,r===0||e===n&&(Yt===2||Yt===9)||e.cancelPendingCommit!==null)return c!==null&&c!==null&&Oi(c),e.callbackNode=null,e.callbackPriority=0;if((r&3)===0||pa(e,r)){if(n=r&-r,n===e.callbackPriority)return n;switch(c!==null&&Oi(c),yl(r)){case 2:case 8:r=Ee;break;case 32:r=qe;break;case 268435456:r=ga;break;default:r=qe}return c=Rg.bind(null,e),r=oe(r,c),e.callbackPriority=n,e.callbackNode=r,n}return c!==null&&c!==null&&Oi(c),e.callbackPriority=2,e.callbackNode=null,2}function Rg(e,n){if(Ae!==0&&Ae!==5)return e.callbackNode=null,e.callbackPriority=0,null;var r=e.callbackNode;if(Co()&&e.callbackNode!==r)return null;var c=jt;return c=Rr(e,e===Zt?c:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),c===0?null:(dg(e,c,n),Mg(e,Vt()),e.callbackNode!=null&&e.callbackNode===r?Rg.bind(null,e):null)}function kg(e,n){if(Co())return null;dg(e,n,!0)}function Cb(){Fb(function(){(qt&6)!==0?oe(he,Eb):Ng()})}function su(){if(kn===0){var e=js;e===0&&(e=Dr,Dr<<=1,(Dr&261888)===0&&(Dr=256)),kn=e}return kn}function Og(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:jr(""+e)}function Lg(e,n){var r=n.ownerDocument.createElement("input");return r.name=n.name,r.value=n.value,e.id&&r.setAttribute("form",e.id),n.parentNode.insertBefore(r,n),e=new FormData(e),r.parentNode.removeChild(r),e}function Tb(e,n,r,c,f){if(n==="submit"&&r&&r.stateNode===f){var m=Og((f[Ge]||null).action),x=c.submitter;x&&(n=(n=x[Ge]||null)?Og(n.formAction):x.getAttribute("formAction"),n!==null&&(m=n,x=null));var _=new zr("action","action",null,c,f);e.push({event:_,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(kn!==0){var R=x?Lg(f,x):new FormData(f);_c(r,{pending:!0,data:R,method:f.method,action:m},null,R)}}else typeof m=="function"&&(_.preventDefault(),R=x?Lg(f,x):new FormData(f),_c(r,{pending:!0,data:R,method:f.method,action:m},m,R))},currentTarget:f}]})}}for(var au=0;au<Ul.length;au++){var ru=Ul[au],Db=ru.toLowerCase(),Nb=ru[0].toUpperCase()+ru.slice(1);Ni(Db,"on"+Nb)}Ni(ud,"onAnimationEnd"),Ni(hd,"onAnimationIteration"),Ni(dd,"onAnimationStart"),Ni("dblclick","onDoubleClick"),Ni("focusin","onFocus"),Ni("focusout","onBlur"),Ni(V0,"onTransitionRun"),Ni(Y0,"onTransitionStart"),Ni(X0,"onTransitionCancel"),Ni(fd,"onTransitionEnd"),As("onMouseEnter",["mouseout","mouseover"]),As("onMouseLeave",["mouseout","mouseover"]),As("onPointerEnter",["pointerout","pointerover"]),As("onPointerLeave",["pointerout","pointerover"]),Vn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Vn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Vn("onBeforeInput",["compositionend","keypress","textInput","paste"]),Vn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Vn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Vn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Wa="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Mb=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Wa));function jg(e,n){n=(n&4)!==0;for(var r=0;r<e.length;r++){var c=e[r],f=c.event;c=c.listeners;t:{var m=void 0;if(n)for(var x=c.length-1;0<=x;x--){var _=c[x],R=_.instance,V=_.currentTarget;if(_=_.listener,R!==m&&f.isPropagationStopped())break t;m=_,f.currentTarget=V;try{m(f)}catch(W){Hr(W)}f.currentTarget=null,m=R}else for(x=0;x<c.length;x++){if(_=c[x],R=_.instance,V=_.currentTarget,_=_.listener,R!==m&&f.isPropagationStopped())break t;m=_,f.currentTarget=V;try{m(f)}catch(W){Hr(W)}f.currentTarget=null,m=R}}}}function Ot(e,n){var r=n[vl];r===void 0&&(r=n[vl]=new Set);var c=e+"__bubble";r.has(c)||(Bg(n,e,2,!1),r.add(c))}function ou(e,n,r){var c=0;n&&(c|=4),Bg(r,e,c,n)}var No="_reactListening"+Math.random().toString(36).slice(2);function lu(e){if(!e[No]){e[No]=!0,Dh.forEach(function(r){r!=="selectionchange"&&(Mb.has(r)||ou(r,!1,e),ou(r,!0,e))});var n=e.nodeType===9?e:e.ownerDocument;n===null||n[No]||(n[No]=!0,ou("selectionchange",!1,n))}}function Bg(e,n,r,c){switch(hp(n)){case 2:var f=sy;break;case 8:f=ay;break;default:f=wu}r=f.bind(null,n,r,e),f=void 0,!Dl||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(f=!0),c?f!==void 0?e.addEventListener(n,r,{capture:!0,passive:f}):e.addEventListener(n,r,!0):f!==void 0?e.addEventListener(n,r,{passive:f}):e.addEventListener(n,r,!1)}function cu(e,n,r,c,f){var m=c;if((n&1)===0&&(n&2)===0&&c!==null)t:for(;;){if(c===null)return;var x=c.tag;if(x===3||x===4){var _=c.stateNode.containerInfo;if(_===f)break;if(x===4)for(x=c.return;x!==null;){var R=x.tag;if((R===3||R===4)&&x.stateNode.containerInfo===f)return;x=x.return}for(;_!==null;){if(x=ys(_),x===null)return;if(R=x.tag,R===5||R===6||R===26||R===27){c=m=x;continue t}_=_.parentNode}}c=c.return}Ih(function(){var V=m,W=Cl(r),J=[];t:{var Y=gd.get(e);if(Y!==void 0){var K=zr,ht=e;switch(e){case"keypress":if(Pr(r)===0)break t;case"keydown":case"keyup":K=w0;break;case"focusin":ht="focus",K=kl;break;case"focusout":ht="blur",K=kl;break;case"beforeblur":case"afterblur":K=kl;break;case"click":if(r.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":K=qh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":K=h0;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":K=C0;break;case ud:case hd:case dd:K=g0;break;case fd:K=D0;break;case"scroll":case"scrollend":K=c0;break;case"wheel":K=M0;break;case"copy":case"cut":case"paste":K=m0;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":K=Vh;break;case"toggle":case"beforetoggle":K=k0}var xt=(n&4)!==0,Qt=!xt&&(e==="scroll"||e==="scrollend"),I=xt?Y!==null?Y+"Capture":null:Y;xt=[];for(var B=V,G;B!==null;){var Z=B;if(G=Z.stateNode,Z=Z.tag,Z!==5&&Z!==26&&Z!==27||G===null||I===null||(Z=va(B,I),Z!=null&&xt.push(Za(B,Z,G))),Qt)break;B=B.return}0<xt.length&&(Y=new K(Y,ht,null,r,W),J.push({event:Y,listeners:xt}))}}if((n&7)===0){t:{if(Y=e==="mouseover"||e==="pointerover",K=e==="mouseout"||e==="pointerout",Y&&r!==El&&(ht=r.relatedTarget||r.fromElement)&&(ys(ht)||ht[bs]))break t;if((K||Y)&&(Y=W.window===W?W:(Y=W.ownerDocument)?Y.defaultView||Y.parentWindow:window,K?(ht=r.relatedTarget||r.toElement,K=V,ht=ht?ys(ht):null,ht!==null&&(Qt=o(ht),xt=ht.tag,ht!==Qt||xt!==5&&xt!==27&&xt!==6)&&(ht=null)):(K=null,ht=V),K!==ht)){if(xt=qh,Z="onMouseLeave",I="onMouseEnter",B="mouse",(e==="pointerout"||e==="pointerover")&&(xt=Vh,Z="onPointerLeave",I="onPointerEnter",B="pointer"),Qt=K==null?Y:ya(K),G=ht==null?Y:ya(ht),Y=new xt(Z,B+"leave",K,r,W),Y.target=Qt,Y.relatedTarget=G,Z=null,ys(W)===V&&(xt=new xt(I,B+"enter",ht,r,W),xt.target=G,xt.relatedTarget=Qt,Z=xt),Qt=Z,K&&ht)e:{for(xt=Rb,I=K,B=ht,G=0,Z=I;Z;Z=xt(Z))G++;Z=0;for(var yt=B;yt;yt=xt(yt))Z++;for(;0<G-Z;)I=xt(I),G--;for(;0<Z-G;)B=xt(B),Z--;for(;G--;){if(I===B||B!==null&&I===B.alternate){xt=I;break e}I=xt(I),B=xt(B)}xt=null}else xt=null;K!==null&&Pg(J,Y,K,xt,!1),ht!==null&&Qt!==null&&Pg(J,Qt,ht,xt,!0)}}t:{if(Y=V?ya(V):window,K=Y.nodeName&&Y.nodeName.toLowerCase(),K==="select"||K==="input"&&Y.type==="file")var It=Jh;else if(Wh(Y))if(td)It=H0;else{It=I0;var pt=z0}else K=Y.nodeName,!K||K.toLowerCase()!=="input"||Y.type!=="checkbox"&&Y.type!=="radio"?V&&_l(V.elementType)&&(It=Jh):It=U0;if(It&&(It=It(e,V))){Zh(J,It,r,W);break t}pt&&pt(e,Y,V),e==="focusout"&&V&&Y.type==="number"&&V.memoizedProps.value!=null&&wl(Y,"number",Y.value)}switch(pt=V?ya(V):window,e){case"focusin":(Wh(pt)||pt.contentEditable==="true")&&(Ts=pt,Fl=V,Ta=null);break;case"focusout":Ta=Fl=Ts=null;break;case"mousedown":zl=!0;break;case"contextmenu":case"mouseup":case"dragend":zl=!1,ld(J,r,W);break;case"selectionchange":if(G0)break;case"keydown":case"keyup":ld(J,r,W)}var Nt;if(Ll)t:{switch(e){case"compositionstart":var Bt="onCompositionStart";break t;case"compositionend":Bt="onCompositionEnd";break t;case"compositionupdate":Bt="onCompositionUpdate";break t}Bt=void 0}else Cs?Kh(e,r)&&(Bt="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(Bt="onCompositionStart");Bt&&(Yh&&r.locale!=="ko"&&(Cs||Bt!=="onCompositionStart"?Bt==="onCompositionEnd"&&Cs&&(Nt=Uh()):(mn=W,Nl="value"in mn?mn.value:mn.textContent,Cs=!0)),pt=Mo(V,Bt),0<pt.length&&(Bt=new Gh(Bt,e,null,r,W),J.push({event:Bt,listeners:pt}),Nt?Bt.data=Nt:(Nt=Qh(r),Nt!==null&&(Bt.data=Nt)))),(Nt=L0?j0(e,r):B0(e,r))&&(Bt=Mo(V,"onBeforeInput"),0<Bt.length&&(pt=new Gh("onBeforeInput","beforeinput",null,r,W),J.push({event:pt,listeners:Bt}),pt.data=Nt)),Tb(J,e,V,r,W)}jg(J,n)})}function Za(e,n,r){return{instance:e,listener:n,currentTarget:r}}function Mo(e,n){for(var r=n+"Capture",c=[];e!==null;){var f=e,m=f.stateNode;if(f=f.tag,f!==5&&f!==26&&f!==27||m===null||(f=va(e,r),f!=null&&c.unshift(Za(e,f,m)),f=va(e,n),f!=null&&c.push(Za(e,f,m))),e.tag===3)return c;e=e.return}return[]}function Rb(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function Pg(e,n,r,c,f){for(var m=n._reactName,x=[];r!==null&&r!==c;){var _=r,R=_.alternate,V=_.stateNode;if(_=_.tag,R!==null&&R===c)break;_!==5&&_!==26&&_!==27||V===null||(R=V,f?(V=va(r,m),V!=null&&x.unshift(Za(r,V,R))):f||(V=va(r,m),V!=null&&x.push(Za(r,V,R)))),r=r.return}x.length!==0&&e.push({event:n,listeners:x})}var kb=/\r\n?/g,Ob=/\u0000|\uFFFD/g;function Fg(e){return(typeof e=="string"?e:""+e).replace(kb,`
`).replace(Ob,"")}function zg(e,n){return n=Fg(n),Fg(e)===n}function Kt(e,n,r,c,f,m){switch(r){case"children":typeof c=="string"?n==="body"||n==="textarea"&&c===""||ws(e,c):(typeof c=="number"||typeof c=="bigint")&&n!=="body"&&ws(e,""+c);break;case"className":Or(e,"class",c);break;case"tabIndex":Or(e,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":Or(e,r,c);break;case"style":Fh(e,c,m);break;case"data":if(n!=="object"){Or(e,"data",c);break}case"src":case"href":if(c===""&&(n!=="a"||r!=="href")){e.removeAttribute(r);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){e.removeAttribute(r);break}c=jr(""+c),e.setAttribute(r,c);break;case"action":case"formAction":if(typeof c=="function"){e.setAttribute(r,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof m=="function"&&(r==="formAction"?(n!=="input"&&Kt(e,n,"name",f.name,f,null),Kt(e,n,"formEncType",f.formEncType,f,null),Kt(e,n,"formMethod",f.formMethod,f,null),Kt(e,n,"formTarget",f.formTarget,f,null)):(Kt(e,n,"encType",f.encType,f,null),Kt(e,n,"method",f.method,f,null),Kt(e,n,"target",f.target,f,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){e.removeAttribute(r);break}c=jr(""+c),e.setAttribute(r,c);break;case"onClick":c!=null&&(e.onclick=Yi);break;case"onScroll":c!=null&&Ot("scroll",e);break;case"onScrollEnd":c!=null&&Ot("scrollend",e);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(s(61));if(r=c.__html,r!=null){if(f.children!=null)throw Error(s(60));e.innerHTML=r}}break;case"multiple":e.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":e.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){e.removeAttribute("xlink:href");break}r=jr(""+c),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",r);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?e.setAttribute(r,""+c):e.removeAttribute(r);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?e.setAttribute(r,""):e.removeAttribute(r);break;case"capture":case"download":c===!0?e.setAttribute(r,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?e.setAttribute(r,c):e.removeAttribute(r);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?e.setAttribute(r,c):e.removeAttribute(r);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?e.removeAttribute(r):e.setAttribute(r,c);break;case"popover":Ot("beforetoggle",e),Ot("toggle",e),kr(e,"popover",c);break;case"xlinkActuate":Vi(e,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":Vi(e,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":Vi(e,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":Vi(e,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":Vi(e,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":Vi(e,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":Vi(e,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":Vi(e,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":Vi(e,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":kr(e,"is",c);break;case"innerText":case"textContent":break;default:(!(2<r.length)||r[0]!=="o"&&r[0]!=="O"||r[1]!=="n"&&r[1]!=="N")&&(r=o0.get(r)||r,kr(e,r,c))}}function uu(e,n,r,c,f,m){switch(r){case"style":Fh(e,c,m);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(s(61));if(r=c.__html,r!=null){if(f.children!=null)throw Error(s(60));e.innerHTML=r}}break;case"children":typeof c=="string"?ws(e,c):(typeof c=="number"||typeof c=="bigint")&&ws(e,""+c);break;case"onScroll":c!=null&&Ot("scroll",e);break;case"onScrollEnd":c!=null&&Ot("scrollend",e);break;case"onClick":c!=null&&(e.onclick=Yi);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Nh.hasOwnProperty(r))t:{if(r[0]==="o"&&r[1]==="n"&&(f=r.endsWith("Capture"),n=r.slice(2,f?r.length-7:void 0),m=e[Ge]||null,m=m!=null?m[r]:null,typeof m=="function"&&e.removeEventListener(n,m,f),typeof c=="function")){typeof m!="function"&&m!==null&&(r in e?e[r]=null:e.hasAttribute(r)&&e.removeAttribute(r)),e.addEventListener(n,c,f);break t}r in e?e[r]=c:c===!0?e.setAttribute(r,""):kr(e,r,c)}}}function Me(e,n,r){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ot("error",e),Ot("load",e);var c=!1,f=!1,m;for(m in r)if(r.hasOwnProperty(m)){var x=r[m];if(x!=null)switch(m){case"src":c=!0;break;case"srcSet":f=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,n));default:Kt(e,n,m,x,r,null)}}f&&Kt(e,n,"srcSet",r.srcSet,r,null),c&&Kt(e,n,"src",r.src,r,null);return;case"input":Ot("invalid",e);var _=m=x=f=null,R=null,V=null;for(c in r)if(r.hasOwnProperty(c)){var W=r[c];if(W!=null)switch(c){case"name":f=W;break;case"type":x=W;break;case"checked":R=W;break;case"defaultChecked":V=W;break;case"value":m=W;break;case"defaultValue":_=W;break;case"children":case"dangerouslySetInnerHTML":if(W!=null)throw Error(s(137,n));break;default:Kt(e,n,c,W,r,null)}}Lh(e,m,_,R,V,x,f,!1);return;case"select":Ot("invalid",e),c=x=m=null;for(f in r)if(r.hasOwnProperty(f)&&(_=r[f],_!=null))switch(f){case"value":m=_;break;case"defaultValue":x=_;break;case"multiple":c=_;default:Kt(e,n,f,_,r,null)}n=m,r=x,e.multiple=!!c,n!=null?Ss(e,!!c,n,!1):r!=null&&Ss(e,!!c,r,!0);return;case"textarea":Ot("invalid",e),m=f=c=null;for(x in r)if(r.hasOwnProperty(x)&&(_=r[x],_!=null))switch(x){case"value":c=_;break;case"defaultValue":f=_;break;case"children":m=_;break;case"dangerouslySetInnerHTML":if(_!=null)throw Error(s(91));break;default:Kt(e,n,x,_,r,null)}Bh(e,c,f,m);return;case"option":for(R in r)if(r.hasOwnProperty(R)&&(c=r[R],c!=null))switch(R){case"selected":e.selected=c&&typeof c!="function"&&typeof c!="symbol";break;default:Kt(e,n,R,c,r,null)}return;case"dialog":Ot("beforetoggle",e),Ot("toggle",e),Ot("cancel",e),Ot("close",e);break;case"iframe":case"object":Ot("load",e);break;case"video":case"audio":for(c=0;c<Wa.length;c++)Ot(Wa[c],e);break;case"image":Ot("error",e),Ot("load",e);break;case"details":Ot("toggle",e);break;case"embed":case"source":case"link":Ot("error",e),Ot("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(V in r)if(r.hasOwnProperty(V)&&(c=r[V],c!=null))switch(V){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,n));default:Kt(e,n,V,c,r,null)}return;default:if(_l(n)){for(W in r)r.hasOwnProperty(W)&&(c=r[W],c!==void 0&&uu(e,n,W,c,r,void 0));return}}for(_ in r)r.hasOwnProperty(_)&&(c=r[_],c!=null&&Kt(e,n,_,c,r,null))}function Lb(e,n,r,c){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var f=null,m=null,x=null,_=null,R=null,V=null,W=null;for(K in r){var J=r[K];if(r.hasOwnProperty(K)&&J!=null)switch(K){case"checked":break;case"value":break;case"defaultValue":R=J;default:c.hasOwnProperty(K)||Kt(e,n,K,null,c,J)}}for(var Y in c){var K=c[Y];if(J=r[Y],c.hasOwnProperty(Y)&&(K!=null||J!=null))switch(Y){case"type":m=K;break;case"name":f=K;break;case"checked":V=K;break;case"defaultChecked":W=K;break;case"value":x=K;break;case"defaultValue":_=K;break;case"children":case"dangerouslySetInnerHTML":if(K!=null)throw Error(s(137,n));break;default:K!==J&&Kt(e,n,Y,K,c,J)}}Sl(e,x,_,R,V,W,m,f);return;case"select":K=x=_=Y=null;for(m in r)if(R=r[m],r.hasOwnProperty(m)&&R!=null)switch(m){case"value":break;case"multiple":K=R;default:c.hasOwnProperty(m)||Kt(e,n,m,null,c,R)}for(f in c)if(m=c[f],R=r[f],c.hasOwnProperty(f)&&(m!=null||R!=null))switch(f){case"value":Y=m;break;case"defaultValue":_=m;break;case"multiple":x=m;default:m!==R&&Kt(e,n,f,m,c,R)}n=_,r=x,c=K,Y!=null?Ss(e,!!r,Y,!1):!!c!=!!r&&(n!=null?Ss(e,!!r,n,!0):Ss(e,!!r,r?[]:"",!1));return;case"textarea":K=Y=null;for(_ in r)if(f=r[_],r.hasOwnProperty(_)&&f!=null&&!c.hasOwnProperty(_))switch(_){case"value":break;case"children":break;default:Kt(e,n,_,null,c,f)}for(x in c)if(f=c[x],m=r[x],c.hasOwnProperty(x)&&(f!=null||m!=null))switch(x){case"value":Y=f;break;case"defaultValue":K=f;break;case"children":break;case"dangerouslySetInnerHTML":if(f!=null)throw Error(s(91));break;default:f!==m&&Kt(e,n,x,f,c,m)}jh(e,Y,K);return;case"option":for(var ht in r)if(Y=r[ht],r.hasOwnProperty(ht)&&Y!=null&&!c.hasOwnProperty(ht))switch(ht){case"selected":e.selected=!1;break;default:Kt(e,n,ht,null,c,Y)}for(R in c)if(Y=c[R],K=r[R],c.hasOwnProperty(R)&&Y!==K&&(Y!=null||K!=null))switch(R){case"selected":e.selected=Y&&typeof Y!="function"&&typeof Y!="symbol";break;default:Kt(e,n,R,Y,c,K)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var xt in r)Y=r[xt],r.hasOwnProperty(xt)&&Y!=null&&!c.hasOwnProperty(xt)&&Kt(e,n,xt,null,c,Y);for(V in c)if(Y=c[V],K=r[V],c.hasOwnProperty(V)&&Y!==K&&(Y!=null||K!=null))switch(V){case"children":case"dangerouslySetInnerHTML":if(Y!=null)throw Error(s(137,n));break;default:Kt(e,n,V,Y,c,K)}return;default:if(_l(n)){for(var Qt in r)Y=r[Qt],r.hasOwnProperty(Qt)&&Y!==void 0&&!c.hasOwnProperty(Qt)&&uu(e,n,Qt,void 0,c,Y);for(W in c)Y=c[W],K=r[W],!c.hasOwnProperty(W)||Y===K||Y===void 0&&K===void 0||uu(e,n,W,Y,c,K);return}}for(var I in r)Y=r[I],r.hasOwnProperty(I)&&Y!=null&&!c.hasOwnProperty(I)&&Kt(e,n,I,null,c,Y);for(J in c)Y=c[J],K=r[J],!c.hasOwnProperty(J)||Y===K||Y==null&&K==null||Kt(e,n,J,Y,c,K)}function Ig(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function jb(){if(typeof performance.getEntriesByType=="function"){for(var e=0,n=0,r=performance.getEntriesByType("resource"),c=0;c<r.length;c++){var f=r[c],m=f.transferSize,x=f.initiatorType,_=f.duration;if(m&&_&&Ig(x)){for(x=0,_=f.responseEnd,c+=1;c<r.length;c++){var R=r[c],V=R.startTime;if(V>_)break;var W=R.transferSize,J=R.initiatorType;W&&Ig(J)&&(R=R.responseEnd,x+=W*(R<_?1:(_-V)/(R-V)))}if(--c,n+=8*(m+x)/(f.duration/1e3),e++,10<e)break}}if(0<e)return n/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var hu=null,du=null;function Ro(e){return e.nodeType===9?e:e.ownerDocument}function Ug(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Hg(e,n){if(e===0)switch(n){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&n==="foreignObject"?0:e}function fu(e,n){return e==="textarea"||e==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.children=="bigint"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var gu=null;function Bb(){var e=window.event;return e&&e.type==="popstate"?e===gu?!1:(gu=e,!0):(gu=null,!1)}var qg=typeof setTimeout=="function"?setTimeout:void 0,Pb=typeof clearTimeout=="function"?clearTimeout:void 0,Gg=typeof Promise=="function"?Promise:void 0,Fb=typeof queueMicrotask=="function"?queueMicrotask:typeof Gg<"u"?function(e){return Gg.resolve(null).then(e).catch(zb)}:qg;function zb(e){setTimeout(function(){throw e})}function On(e){return e==="head"}function Vg(e,n){var r=n,c=0;do{var f=r.nextSibling;if(e.removeChild(r),f&&f.nodeType===8)if(r=f.data,r==="/$"||r==="/&"){if(c===0){e.removeChild(f),ta(n);return}c--}else if(r==="$"||r==="$?"||r==="$~"||r==="$!"||r==="&")c++;else if(r==="html")Ja(e.ownerDocument.documentElement);else if(r==="head"){r=e.ownerDocument.head,Ja(r);for(var m=r.firstChild;m;){var x=m.nextSibling,_=m.nodeName;m[ba]||_==="SCRIPT"||_==="STYLE"||_==="LINK"&&m.rel.toLowerCase()==="stylesheet"||r.removeChild(m),m=x}}else r==="body"&&Ja(e.ownerDocument.body);r=f}while(r);ta(n)}function Yg(e,n){var r=e;e=0;do{var c=r.nextSibling;if(r.nodeType===1?n?(r._stashedDisplay=r.style.display,r.style.display="none"):(r.style.display=r._stashedDisplay||"",r.getAttribute("style")===""&&r.removeAttribute("style")):r.nodeType===3&&(n?(r._stashedText=r.nodeValue,r.nodeValue=""):r.nodeValue=r._stashedText||""),c&&c.nodeType===8)if(r=c.data,r==="/$"){if(e===0)break;e--}else r!=="$"&&r!=="$?"&&r!=="$~"&&r!=="$!"||e++;r=c}while(r)}function pu(e){var n=e.firstChild;for(n&&n.nodeType===10&&(n=n.nextSibling);n;){var r=n;switch(n=n.nextSibling,r.nodeName){case"HTML":case"HEAD":case"BODY":pu(r),xl(r);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(r.rel.toLowerCase()==="stylesheet")continue}e.removeChild(r)}}function Ib(e,n,r,c){for(;e.nodeType===1;){var f=r;if(e.nodeName.toLowerCase()!==n.toLowerCase()){if(!c&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(c){if(!e[ba])switch(n){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(m=e.getAttribute("rel"),m==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(m!==f.rel||e.getAttribute("href")!==(f.href==null||f.href===""?null:f.href)||e.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin)||e.getAttribute("title")!==(f.title==null?null:f.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(m=e.getAttribute("src"),(m!==(f.src==null?null:f.src)||e.getAttribute("type")!==(f.type==null?null:f.type)||e.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin))&&m&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(n==="input"&&e.type==="hidden"){var m=f.name==null?null:""+f.name;if(f.type==="hidden"&&e.getAttribute("name")===m)return e}else return e;if(e=Si(e.nextSibling),e===null)break}return null}function Ub(e,n,r){if(n==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!r||(e=Si(e.nextSibling),e===null))return null;return e}function Xg(e,n){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!n||(e=Si(e.nextSibling),e===null))return null;return e}function mu(e){return e.data==="$?"||e.data==="$~"}function bu(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function Hb(e,n){var r=e.ownerDocument;if(e.data==="$~")e._reactRetry=n;else if(e.data!=="$?"||r.readyState!=="loading")n();else{var c=function(){n(),r.removeEventListener("DOMContentLoaded",c)};r.addEventListener("DOMContentLoaded",c),e._reactRetry=c}}function Si(e){for(;e!=null;e=e.nextSibling){var n=e.nodeType;if(n===1||n===3)break;if(n===8){if(n=e.data,n==="$"||n==="$!"||n==="$?"||n==="$~"||n==="&"||n==="F!"||n==="F")break;if(n==="/$"||n==="/&")return null}}return e}var yu=null;function $g(e){e=e.nextSibling;for(var n=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"||r==="/&"){if(n===0)return Si(e.nextSibling);n--}else r!=="$"&&r!=="$!"&&r!=="$?"&&r!=="$~"&&r!=="&"||n++}e=e.nextSibling}return null}function Kg(e){e=e.previousSibling;for(var n=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"){if(n===0)return e;n--}else r!=="/$"&&r!=="/&"||n++}e=e.previousSibling}return null}function Qg(e,n,r){switch(n=Ro(r),e){case"html":if(e=n.documentElement,!e)throw Error(s(452));return e;case"head":if(e=n.head,!e)throw Error(s(453));return e;case"body":if(e=n.body,!e)throw Error(s(454));return e;default:throw Error(s(451))}}function Ja(e){for(var n=e.attributes;n.length;)e.removeAttributeNode(n[0]);xl(e)}var wi=new Map,Wg=new Set;function ko(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var cn=q.d;q.d={f:qb,r:Gb,D:Vb,C:Yb,L:Xb,m:$b,X:Qb,S:Kb,M:Wb};function qb(){var e=cn.f(),n=wo();return e||n}function Gb(e){var n=vs(e);n!==null&&n.tag===5&&n.type==="form"?gf(n):cn.r(e)}var Ws=typeof document>"u"?null:document;function Zg(e,n,r){var c=Ws;if(c&&typeof n=="string"&&n){var f=pi(n);f='link[rel="'+e+'"][href="'+f+'"]',typeof r=="string"&&(f+='[crossorigin="'+r+'"]'),Wg.has(f)||(Wg.add(f),e={rel:e,crossOrigin:r,href:n},c.querySelector(f)===null&&(n=c.createElement("link"),Me(n,"link",e),Se(n),c.head.appendChild(n)))}}function Vb(e){cn.D(e),Zg("dns-prefetch",e,null)}function Yb(e,n){cn.C(e,n),Zg("preconnect",e,n)}function Xb(e,n,r){cn.L(e,n,r);var c=Ws;if(c&&e&&n){var f='link[rel="preload"][as="'+pi(n)+'"]';n==="image"&&r&&r.imageSrcSet?(f+='[imagesrcset="'+pi(r.imageSrcSet)+'"]',typeof r.imageSizes=="string"&&(f+='[imagesizes="'+pi(r.imageSizes)+'"]')):f+='[href="'+pi(e)+'"]';var m=f;switch(n){case"style":m=Zs(e);break;case"script":m=Js(e)}wi.has(m)||(e=b({rel:"preload",href:n==="image"&&r&&r.imageSrcSet?void 0:e,as:n},r),wi.set(m,e),c.querySelector(f)!==null||n==="style"&&c.querySelector(tr(m))||n==="script"&&c.querySelector(er(m))||(n=c.createElement("link"),Me(n,"link",e),Se(n),c.head.appendChild(n)))}}function $b(e,n){cn.m(e,n);var r=Ws;if(r&&e){var c=n&&typeof n.as=="string"?n.as:"script",f='link[rel="modulepreload"][as="'+pi(c)+'"][href="'+pi(e)+'"]',m=f;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":m=Js(e)}if(!wi.has(m)&&(e=b({rel:"modulepreload",href:e},n),wi.set(m,e),r.querySelector(f)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(r.querySelector(er(m)))return}c=r.createElement("link"),Me(c,"link",e),Se(c),r.head.appendChild(c)}}}function Kb(e,n,r){cn.S(e,n,r);var c=Ws;if(c&&e){var f=xs(c).hoistableStyles,m=Zs(e);n=n||"default";var x=f.get(m);if(!x){var _={loading:0,preload:null};if(x=c.querySelector(tr(m)))_.loading=5;else{e=b({rel:"stylesheet",href:e,"data-precedence":n},r),(r=wi.get(m))&&vu(e,r);var R=x=c.createElement("link");Se(R),Me(R,"link",e),R._p=new Promise(function(V,W){R.onload=V,R.onerror=W}),R.addEventListener("load",function(){_.loading|=1}),R.addEventListener("error",function(){_.loading|=2}),_.loading|=4,Oo(x,n,c)}x={type:"stylesheet",instance:x,count:1,state:_},f.set(m,x)}}}function Qb(e,n){cn.X(e,n);var r=Ws;if(r&&e){var c=xs(r).hoistableScripts,f=Js(e),m=c.get(f);m||(m=r.querySelector(er(f)),m||(e=b({src:e,async:!0},n),(n=wi.get(f))&&xu(e,n),m=r.createElement("script"),Se(m),Me(m,"link",e),r.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},c.set(f,m))}}function Wb(e,n){cn.M(e,n);var r=Ws;if(r&&e){var c=xs(r).hoistableScripts,f=Js(e),m=c.get(f);m||(m=r.querySelector(er(f)),m||(e=b({src:e,async:!0,type:"module"},n),(n=wi.get(f))&&xu(e,n),m=r.createElement("script"),Se(m),Me(m,"link",e),r.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},c.set(f,m))}}function Jg(e,n,r,c){var f=(f=rt.current)?ko(f):null;if(!f)throw Error(s(446));switch(e){case"meta":case"title":return null;case"style":return typeof r.precedence=="string"&&typeof r.href=="string"?(n=Zs(r.href),r=xs(f).hoistableStyles,c=r.get(n),c||(c={type:"style",instance:null,count:0,state:null},r.set(n,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(r.rel==="stylesheet"&&typeof r.href=="string"&&typeof r.precedence=="string"){e=Zs(r.href);var m=xs(f).hoistableStyles,x=m.get(e);if(x||(f=f.ownerDocument||f,x={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},m.set(e,x),(m=f.querySelector(tr(e)))&&!m._p&&(x.instance=m,x.state.loading=5),wi.has(e)||(r={rel:"preload",as:"style",href:r.href,crossOrigin:r.crossOrigin,integrity:r.integrity,media:r.media,hrefLang:r.hrefLang,referrerPolicy:r.referrerPolicy},wi.set(e,r),m||Zb(f,e,r,x.state))),n&&c===null)throw Error(s(528,""));return x}if(n&&c!==null)throw Error(s(529,""));return null;case"script":return n=r.async,r=r.src,typeof r=="string"&&n&&typeof n!="function"&&typeof n!="symbol"?(n=Js(r),r=xs(f).hoistableScripts,c=r.get(n),c||(c={type:"script",instance:null,count:0,state:null},r.set(n,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,e))}}function Zs(e){return'href="'+pi(e)+'"'}function tr(e){return'link[rel="stylesheet"]['+e+"]"}function tp(e){return b({},e,{"data-precedence":e.precedence,precedence:null})}function Zb(e,n,r,c){e.querySelector('link[rel="preload"][as="style"]['+n+"]")?c.loading=1:(n=e.createElement("link"),c.preload=n,n.addEventListener("load",function(){return c.loading|=1}),n.addEventListener("error",function(){return c.loading|=2}),Me(n,"link",r),Se(n),e.head.appendChild(n))}function Js(e){return'[src="'+pi(e)+'"]'}function er(e){return"script[async]"+e}function ep(e,n,r){if(n.count++,n.instance===null)switch(n.type){case"style":var c=e.querySelector('style[data-href~="'+pi(r.href)+'"]');if(c)return n.instance=c,Se(c),c;var f=b({},r,{"data-href":r.href,"data-precedence":r.precedence,href:null,precedence:null});return c=(e.ownerDocument||e).createElement("style"),Se(c),Me(c,"style",f),Oo(c,r.precedence,e),n.instance=c;case"stylesheet":f=Zs(r.href);var m=e.querySelector(tr(f));if(m)return n.state.loading|=4,n.instance=m,Se(m),m;c=tp(r),(f=wi.get(f))&&vu(c,f),m=(e.ownerDocument||e).createElement("link"),Se(m);var x=m;return x._p=new Promise(function(_,R){x.onload=_,x.onerror=R}),Me(m,"link",c),n.state.loading|=4,Oo(m,r.precedence,e),n.instance=m;case"script":return m=Js(r.src),(f=e.querySelector(er(m)))?(n.instance=f,Se(f),f):(c=r,(f=wi.get(m))&&(c=b({},r),xu(c,f)),e=e.ownerDocument||e,f=e.createElement("script"),Se(f),Me(f,"link",c),e.head.appendChild(f),n.instance=f);case"void":return null;default:throw Error(s(443,n.type))}else n.type==="stylesheet"&&(n.state.loading&4)===0&&(c=n.instance,n.state.loading|=4,Oo(c,r.precedence,e));return n.instance}function Oo(e,n,r){for(var c=r.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),f=c.length?c[c.length-1]:null,m=f,x=0;x<c.length;x++){var _=c[x];if(_.dataset.precedence===n)m=_;else if(m!==f)break}m?m.parentNode.insertBefore(e,m.nextSibling):(n=r.nodeType===9?r.head:r,n.insertBefore(e,n.firstChild))}function vu(e,n){e.crossOrigin==null&&(e.crossOrigin=n.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=n.referrerPolicy),e.title==null&&(e.title=n.title)}function xu(e,n){e.crossOrigin==null&&(e.crossOrigin=n.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=n.referrerPolicy),e.integrity==null&&(e.integrity=n.integrity)}var Lo=null;function ip(e,n,r){if(Lo===null){var c=new Map,f=Lo=new Map;f.set(r,c)}else f=Lo,c=f.get(r),c||(c=new Map,f.set(r,c));if(c.has(e))return c;for(c.set(e,null),r=r.getElementsByTagName(e),f=0;f<r.length;f++){var m=r[f];if(!(m[ba]||m[Ce]||e==="link"&&m.getAttribute("rel")==="stylesheet")&&m.namespaceURI!=="http://www.w3.org/2000/svg"){var x=m.getAttribute(n)||"";x=e+x;var _=c.get(x);_?_.push(m):c.set(x,[m])}}return c}function np(e,n,r){e=e.ownerDocument||e,e.head.insertBefore(r,n==="title"?e.querySelector("head > title"):null)}function Jb(e,n,r){if(r===1||n.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof n.precedence!="string"||typeof n.href!="string"||n.href==="")break;return!0;case"link":if(typeof n.rel!="string"||typeof n.href!="string"||n.href===""||n.onLoad||n.onError)break;switch(n.rel){case"stylesheet":return e=n.disabled,typeof n.precedence=="string"&&e==null;default:return!0}case"script":if(n.async&&typeof n.async!="function"&&typeof n.async!="symbol"&&!n.onLoad&&!n.onError&&n.src&&typeof n.src=="string")return!0}return!1}function sp(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function ty(e,n,r,c){if(r.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(r.state.loading&4)===0){if(r.instance===null){var f=Zs(c.href),m=n.querySelector(tr(f));if(m){n=m._p,n!==null&&typeof n=="object"&&typeof n.then=="function"&&(e.count++,e=jo.bind(e),n.then(e,e)),r.state.loading|=4,r.instance=m,Se(m);return}m=n.ownerDocument||n,c=tp(c),(f=wi.get(f))&&vu(c,f),m=m.createElement("link"),Se(m);var x=m;x._p=new Promise(function(_,R){x.onload=_,x.onerror=R}),Me(m,"link",c),r.instance=m}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(r,n),(n=r.state.preload)&&(r.state.loading&3)===0&&(e.count++,r=jo.bind(e),n.addEventListener("load",r),n.addEventListener("error",r))}}var Au=0;function ey(e,n){return e.stylesheets&&e.count===0&&Po(e,e.stylesheets),0<e.count||0<e.imgCount?function(r){var c=setTimeout(function(){if(e.stylesheets&&Po(e,e.stylesheets),e.unsuspend){var m=e.unsuspend;e.unsuspend=null,m()}},6e4+n);0<e.imgBytes&&Au===0&&(Au=62500*jb());var f=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&Po(e,e.stylesheets),e.unsuspend)){var m=e.unsuspend;e.unsuspend=null,m()}},(e.imgBytes>Au?50:800)+n);return e.unsuspend=r,function(){e.unsuspend=null,clearTimeout(c),clearTimeout(f)}}:null}function jo(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Po(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var Bo=null;function Po(e,n){e.stylesheets=null,e.unsuspend!==null&&(e.count++,Bo=new Map,n.forEach(iy,e),Bo=null,jo.call(e))}function iy(e,n){if(!(n.state.loading&4)){var r=Bo.get(e);if(r)var c=r.get(null);else{r=new Map,Bo.set(e,r);for(var f=e.querySelectorAll("link[data-precedence],style[data-precedence]"),m=0;m<f.length;m++){var x=f[m];(x.nodeName==="LINK"||x.getAttribute("media")!=="not all")&&(r.set(x.dataset.precedence,x),c=x)}c&&r.set(null,c)}f=n.instance,x=f.getAttribute("data-precedence"),m=r.get(x)||c,m===c&&r.set(null,f),r.set(x,f),this.count++,c=jo.bind(this),f.addEventListener("load",c),f.addEventListener("error",c),m?m.parentNode.insertBefore(f,m.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(f,e.firstChild)),n.state.loading|=4}}var ir={$$typeof:O,Provider:null,Consumer:null,_currentValue:et,_currentValue2:et,_threadCount:0};function ny(e,n,r,c,f,m,x,_,R){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ml(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ml(0),this.hiddenUpdates=ml(null),this.identifierPrefix=c,this.onUncaughtError=f,this.onCaughtError=m,this.onRecoverableError=x,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=R,this.incompleteTransitions=new Map}function ap(e,n,r,c,f,m,x,_,R,V,W,J){return e=new ny(e,n,r,x,R,V,W,J,_),n=1,m===!0&&(n|=24),m=ni(3,null,null,n),e.current=m,m.stateNode=e,n=tc(),n.refCount++,e.pooledCache=n,n.refCount++,m.memoizedState={element:c,isDehydrated:r,cache:n},sc(m),e}function rp(e){return e?(e=Ms,e):Ms}function op(e,n,r,c,f,m){f=rp(f),c.context===null?c.context=f:c.pendingContext=f,c=Sn(n),c.payload={element:r},m=m===void 0?null:m,m!==null&&(c.callback=m),r=wn(e,c,n),r!==null&&(Qe(r,e,n),La(r,e,n))}function lp(e,n){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<n?r:n}}function Su(e,n){lp(e,n),(e=e.alternate)&&lp(e,n)}function cp(e){if(e.tag===13||e.tag===31){var n=Kn(e,67108864);n!==null&&Qe(n,e,67108864),Su(e,67108864)}}function up(e){if(e.tag===13||e.tag===31){var n=li();n=bl(n);var r=Kn(e,n);r!==null&&Qe(r,e,n),Su(e,n)}}var Fo=!0;function sy(e,n,r,c){var f=F.T;F.T=null;var m=q.p;try{q.p=2,wu(e,n,r,c)}finally{q.p=m,F.T=f}}function ay(e,n,r,c){var f=F.T;F.T=null;var m=q.p;try{q.p=8,wu(e,n,r,c)}finally{q.p=m,F.T=f}}function wu(e,n,r,c){if(Fo){var f=_u(c);if(f===null)cu(e,n,c,zo,r),dp(e,c);else if(oy(f,e,n,r,c))c.stopPropagation();else if(dp(e,c),n&4&&-1<ry.indexOf(e)){for(;f!==null;){var m=vs(f);if(m!==null)switch(m.tag){case 3:if(m=m.stateNode,m.current.memoizedState.isDehydrated){var x=Gn(m.pendingLanes);if(x!==0){var _=m;for(_.pendingLanes|=2,_.entangledLanes|=2;x;){var R=1<<31-ei(x);_.entanglements[1]|=R,x&=~R}Pi(m),(qt&6)===0&&(Ao=Vt()+500,Qa(0))}}break;case 31:case 13:_=Kn(m,2),_!==null&&Qe(_,m,2),wo(),Su(m,2)}if(m=_u(c),m===null&&cu(e,n,c,zo,r),m===f)break;f=m}f!==null&&c.stopPropagation()}else cu(e,n,c,null,r)}}function _u(e){return e=Cl(e),Eu(e)}var zo=null;function Eu(e){if(zo=null,e=ys(e),e!==null){var n=o(e);if(n===null)e=null;else{var r=n.tag;if(r===13){if(e=l(n),e!==null)return e;e=null}else if(r===31){if(e=u(n),e!==null)return e;e=null}else if(r===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;e=null}else n!==e&&(e=null)}}return zo=e,null}function hp(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(di()){case he:return 2;case Ee:return 8;case qe:case fa:return 32;case ga:return 268435456;default:return 32}default:return 32}}var Cu=!1,Ln=null,jn=null,Bn=null,nr=new Map,sr=new Map,Pn=[],ry="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function dp(e,n){switch(e){case"focusin":case"focusout":Ln=null;break;case"dragenter":case"dragleave":jn=null;break;case"mouseover":case"mouseout":Bn=null;break;case"pointerover":case"pointerout":nr.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":sr.delete(n.pointerId)}}function ar(e,n,r,c,f,m){return e===null||e.nativeEvent!==m?(e={blockedOn:n,domEventName:r,eventSystemFlags:c,nativeEvent:m,targetContainers:[f]},n!==null&&(n=vs(n),n!==null&&cp(n)),e):(e.eventSystemFlags|=c,n=e.targetContainers,f!==null&&n.indexOf(f)===-1&&n.push(f),e)}function oy(e,n,r,c,f){switch(n){case"focusin":return Ln=ar(Ln,e,n,r,c,f),!0;case"dragenter":return jn=ar(jn,e,n,r,c,f),!0;case"mouseover":return Bn=ar(Bn,e,n,r,c,f),!0;case"pointerover":var m=f.pointerId;return nr.set(m,ar(nr.get(m)||null,e,n,r,c,f)),!0;case"gotpointercapture":return m=f.pointerId,sr.set(m,ar(sr.get(m)||null,e,n,r,c,f)),!0}return!1}function fp(e){var n=ys(e.target);if(n!==null){var r=o(n);if(r!==null){if(n=r.tag,n===13){if(n=l(r),n!==null){e.blockedOn=n,Ch(e.priority,function(){up(r)});return}}else if(n===31){if(n=u(r),n!==null){e.blockedOn=n,Ch(e.priority,function(){up(r)});return}}else if(n===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Io(e){if(e.blockedOn!==null)return!1;for(var n=e.targetContainers;0<n.length;){var r=_u(e.nativeEvent);if(r===null){r=e.nativeEvent;var c=new r.constructor(r.type,r);El=c,r.target.dispatchEvent(c),El=null}else return n=vs(r),n!==null&&cp(n),e.blockedOn=r,!1;n.shift()}return!0}function gp(e,n,r){Io(e)&&r.delete(n)}function ly(){Cu=!1,Ln!==null&&Io(Ln)&&(Ln=null),jn!==null&&Io(jn)&&(jn=null),Bn!==null&&Io(Bn)&&(Bn=null),nr.forEach(gp),sr.forEach(gp)}function Uo(e,n){e.blockedOn===n&&(e.blockedOn=null,Cu||(Cu=!0,g.unstable_scheduleCallback(g.unstable_NormalPriority,ly)))}var Ho=null;function pp(e){Ho!==e&&(Ho=e,g.unstable_scheduleCallback(g.unstable_NormalPriority,function(){Ho===e&&(Ho=null);for(var n=0;n<e.length;n+=3){var r=e[n],c=e[n+1],f=e[n+2];if(typeof c!="function"){if(Eu(c||r)===null)continue;break}var m=vs(r);m!==null&&(e.splice(n,3),n-=3,_c(m,{pending:!0,data:f,method:r.method,action:c},c,f))}}))}function ta(e){function n(R){return Uo(R,e)}Ln!==null&&Uo(Ln,e),jn!==null&&Uo(jn,e),Bn!==null&&Uo(Bn,e),nr.forEach(n),sr.forEach(n);for(var r=0;r<Pn.length;r++){var c=Pn[r];c.blockedOn===e&&(c.blockedOn=null)}for(;0<Pn.length&&(r=Pn[0],r.blockedOn===null);)fp(r),r.blockedOn===null&&Pn.shift();if(r=(e.ownerDocument||e).$$reactFormReplay,r!=null)for(c=0;c<r.length;c+=3){var f=r[c],m=r[c+1],x=f[Ge]||null;if(typeof m=="function")x||pp(r);else if(x){var _=null;if(m&&m.hasAttribute("formAction")){if(f=m,x=m[Ge]||null)_=x.formAction;else if(Eu(f)!==null)continue}else _=x.action;typeof _=="function"?r[c+1]=_:(r.splice(c,3),c-=3),pp(r)}}}function mp(){function e(m){m.canIntercept&&m.info==="react-transition"&&m.intercept({handler:function(){return new Promise(function(x){return f=x})},focusReset:"manual",scroll:"manual"})}function n(){f!==null&&(f(),f=null),c||setTimeout(r,20)}function r(){if(!c&&!navigation.transition){var m=navigation.currentEntry;m&&m.url!=null&&navigation.navigate(m.url,{state:m.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,f=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",n),navigation.addEventListener("navigateerror",n),setTimeout(r,100),function(){c=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",n),navigation.removeEventListener("navigateerror",n),f!==null&&(f(),f=null)}}}function Tu(e){this._internalRoot=e}qo.prototype.render=Tu.prototype.render=function(e){var n=this._internalRoot;if(n===null)throw Error(s(409));var r=n.current,c=li();op(r,c,e,n,null,null)},qo.prototype.unmount=Tu.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var n=e.containerInfo;op(e.current,2,null,e,null,null),wo(),n[bs]=null}};function qo(e){this._internalRoot=e}qo.prototype.unstable_scheduleHydration=function(e){if(e){var n=Eh();e={blockedOn:null,target:e,priority:n};for(var r=0;r<Pn.length&&n!==0&&n<Pn[r].priority;r++);Pn.splice(r,0,e),r===0&&fp(e)}};var bp=t.version;if(bp!=="19.2.0")throw Error(s(527,bp,"19.2.0"));q.findDOMNode=function(e){var n=e._reactInternals;if(n===void 0)throw typeof e.render=="function"?Error(s(188)):(e=Object.keys(e).join(","),Error(s(268,e)));return e=d(n),e=e!==null?p(e):null,e=e===null?null:e.stateNode,e};var cy={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:F,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Go=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Go.isDisabled&&Go.supportsFiber)try{Di=Go.inject(cy),Be=Go}catch{}}return or.createRoot=function(e,n){if(!a(e))throw Error(s(299));var r=!1,c="",f=_f,m=Ef,x=Cf;return n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(c=n.identifierPrefix),n.onUncaughtError!==void 0&&(f=n.onUncaughtError),n.onCaughtError!==void 0&&(m=n.onCaughtError),n.onRecoverableError!==void 0&&(x=n.onRecoverableError)),n=ap(e,1,!1,null,null,r,c,null,f,m,x,mp),e[bs]=n.current,lu(e),new Tu(n)},or.hydrateRoot=function(e,n,r){if(!a(e))throw Error(s(299));var c=!1,f="",m=_f,x=Ef,_=Cf,R=null;return r!=null&&(r.unstable_strictMode===!0&&(c=!0),r.identifierPrefix!==void 0&&(f=r.identifierPrefix),r.onUncaughtError!==void 0&&(m=r.onUncaughtError),r.onCaughtError!==void 0&&(x=r.onCaughtError),r.onRecoverableError!==void 0&&(_=r.onRecoverableError),r.formState!==void 0&&(R=r.formState)),n=ap(e,1,!0,n,r??null,c,f,R,m,x,_,mp),n.context=rp(null),r=n.current,c=li(),c=bl(c),f=Sn(c),f.callback=null,wn(r,f,c),r=c,n.current.lanes=r,ma(n,r),Pi(n),e[bs]=n.current,lu(e),new qo(n)},or.version="19.2.0",or}var Np;function xy(){if(Np)return Ru.exports;Np=1;function g(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(g)}catch(t){console.error(t)}}return g(),Ru.exports=vy(),Ru.exports}var Ay=xy(),el={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/var Sy=el.exports,Mp;function wy(){return Mp||(Mp=1,(function(g,t){((i,s)=>{g.exports=s()})(Sy,function i(){var s=typeof self<"u"?self:typeof window<"u"?window:s!==void 0?s:{},a,o=!s.document&&!!s.postMessage,l=s.IS_PAPA_WORKER||!1,u={},h=0,d={};function p(D){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(N){var U=z(N);U.chunkSize=parseInt(U.chunkSize),N.step||N.chunk||(U.chunkSize=null),this._handle=new S(U),(this._handle.streamer=this)._config=U}).call(this,D),this.parseChunk=function(N,U){var $=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<$){let at=this._config.newline;at||(tt=this._config.quoteChar||'"',at=this._handle.guessLineEndings(N,tt)),N=[...N.split(at).slice($)].join(at)}this.isFirstChunk&&j(this._config.beforeFirstChunk)&&(tt=this._config.beforeFirstChunk(N))!==void 0&&(N=tt),this.isFirstChunk=!1,this._halted=!1;var $=this._partialLine+N,tt=(this._partialLine="",this._handle.parse($,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(N=tt.meta.cursor,$=(this._finished||(this._partialLine=$.substring(N-this._baseIndex),this._baseIndex=N),tt&&tt.data&&(this._rowCount+=tt.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),l)s.postMessage({results:tt,workerId:d.WORKER_ID,finished:$});else if(j(this._config.chunk)&&!U){if(this._config.chunk(tt,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=tt=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(tt.data),this._completeResults.errors=this._completeResults.errors.concat(tt.errors),this._completeResults.meta=tt.meta),this._completed||!$||!j(this._config.complete)||tt&&tt.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),$||tt&&tt.meta.paused||this._nextChunk(),tt}this._halted=!0},this._sendError=function(N){j(this._config.error)?this._config.error(N):l&&this._config.error&&s.postMessage({workerId:d.WORKER_ID,error:N,finished:!1})}}function b(D){var N;(D=D||{}).chunkSize||(D.chunkSize=d.RemoteChunkSize),p.call(this,D),this._nextChunk=o?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(U){this._input=U,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(N=new XMLHttpRequest,this._config.withCredentials&&(N.withCredentials=this._config.withCredentials),o||(N.onload=L(this._chunkLoaded,this),N.onerror=L(this._chunkError,this)),N.open(this._config.downloadRequestBody?"POST":"GET",this._input,!o),this._config.downloadRequestHeaders){var U,$=this._config.downloadRequestHeaders;for(U in $)N.setRequestHeader(U,$[U])}var tt;this._config.chunkSize&&(tt=this._start+this._config.chunkSize-1,N.setRequestHeader("Range","bytes="+this._start+"-"+tt));try{N.send(this._config.downloadRequestBody)}catch(at){this._chunkError(at.message)}o&&N.status===0&&this._chunkError()}},this._chunkLoaded=function(){N.readyState===4&&(N.status<200||400<=N.status?this._chunkError():(this._start+=this._config.chunkSize||N.responseText.length,this._finished=!this._config.chunkSize||this._start>=(U=>(U=U.getResponseHeader("Content-Range"))!==null?parseInt(U.substring(U.lastIndexOf("/")+1)):-1)(N),this.parseChunk(N.responseText)))},this._chunkError=function(U){U=N.statusText||U,this._sendError(new Error(U))}}function v(D){(D=D||{}).chunkSize||(D.chunkSize=d.LocalChunkSize),p.call(this,D);var N,U,$=typeof FileReader<"u";this.stream=function(tt){this._input=tt,U=tt.slice||tt.webkitSlice||tt.mozSlice,$?((N=new FileReader).onload=L(this._chunkLoaded,this),N.onerror=L(this._chunkError,this)):N=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var tt=this._input,at=(this._config.chunkSize&&(at=Math.min(this._start+this._config.chunkSize,this._input.size),tt=U.call(tt,this._start,at)),N.readAsText(tt,this._config.encoding));$||this._chunkLoaded({target:{result:at}})},this._chunkLoaded=function(tt){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(tt.target.result)},this._chunkError=function(){this._sendError(N.error)}}function A(D){var N;p.call(this,D=D||{}),this.stream=function(U){return N=U,this._nextChunk()},this._nextChunk=function(){var U,$;if(!this._finished)return U=this._config.chunkSize,N=U?($=N.substring(0,U),N.substring(U)):($=N,""),this._finished=!N,this.parseChunk($)}}function w(D){p.call(this,D=D||{});var N=[],U=!0,$=!1;this.pause=function(){p.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){p.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(tt){this._input=tt,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){$&&N.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),N.length?this.parseChunk(N.shift()):U=!0},this._streamData=L(function(tt){try{N.push(typeof tt=="string"?tt:tt.toString(this._config.encoding)),U&&(U=!1,this._checkIsFinished(),this.parseChunk(N.shift()))}catch(at){this._streamError(at)}},this),this._streamError=L(function(tt){this._streamCleanUp(),this._sendError(tt)},this),this._streamEnd=L(function(){this._streamCleanUp(),$=!0,this._streamData("")},this),this._streamCleanUp=L(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function S(D){var N,U,$,tt,at=Math.pow(2,53),gt=-at,bt=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,F=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,q=this,et=0,it=0,ut=!1,M=!1,H=[],T={data:[],errors:[],meta:{}};function Q(ft){return D.skipEmptyLines==="greedy"?ft.join("").trim()==="":ft.length===1&&ft[0].length===0}function nt(){if(T&&$&&(ot("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+d.DefaultDelimiter+"'"),$=!1),D.skipEmptyLines&&(T.data=T.data.filter(function(lt){return!Q(lt)})),rt()){let lt=function(Rt,Gt){j(D.transformHeader)&&(Rt=D.transformHeader(Rt,Gt)),H.push(Rt)};if(T)if(Array.isArray(T.data[0])){for(var ft=0;rt()&&ft<T.data.length;ft++)T.data[ft].forEach(lt);T.data.splice(0,1)}else T.data.forEach(lt)}function X(lt,Rt){for(var Gt=D.header?{}:[],St=0;St<lt.length;St++){var Lt=St,wt=lt[St],wt=((je,_t)=>(Ht=>(D.dynamicTypingFunction&&D.dynamicTyping[Ht]===void 0&&(D.dynamicTyping[Ht]=D.dynamicTypingFunction(Ht)),(D.dynamicTyping[Ht]||D.dynamicTyping)===!0))(je)?_t==="true"||_t==="TRUE"||_t!=="false"&&_t!=="FALSE"&&((Ht=>{if(bt.test(Ht)&&(Ht=parseFloat(Ht),gt<Ht&&Ht<at))return 1})(_t)?parseFloat(_t):F.test(_t)?new Date(_t):_t===""?null:_t):_t)(Lt=D.header?St>=H.length?"__parsed_extra":H[St]:Lt,wt=D.transform?D.transform(wt,Lt):wt);Lt==="__parsed_extra"?(Gt[Lt]=Gt[Lt]||[],Gt[Lt].push(wt)):Gt[Lt]=wt}return D.header&&(St>H.length?ot("FieldMismatch","TooManyFields","Too many fields: expected "+H.length+" fields but parsed "+St,it+Rt):St<H.length&&ot("FieldMismatch","TooFewFields","Too few fields: expected "+H.length+" fields but parsed "+St,it+Rt)),Gt}var st;T&&(D.header||D.dynamicTyping||D.transform)&&(st=1,!T.data.length||Array.isArray(T.data[0])?(T.data=T.data.map(X),st=T.data.length):T.data=X(T.data,0),D.header&&T.meta&&(T.meta.fields=H),it+=st)}function rt(){return D.header&&H.length===0}function ot(ft,X,st,lt){ft={type:ft,code:X,message:st},lt!==void 0&&(ft.row=lt),T.errors.push(ft)}j(D.step)&&(tt=D.step,D.step=function(ft){T=ft,rt()?nt():(nt(),T.data.length!==0&&(et+=ft.data.length,D.preview&&et>D.preview?U.abort():(T.data=T.data[0],tt(T,q))))}),this.parse=function(ft,X,st){var lt=D.quoteChar||'"',lt=(D.newline||(D.newline=this.guessLineEndings(ft,lt)),$=!1,D.delimiter?j(D.delimiter)&&(D.delimiter=D.delimiter(ft),T.meta.delimiter=D.delimiter):((lt=((Rt,Gt,St,Lt,wt)=>{var je,_t,Ht,oe;wt=wt||[",","	","|",";",d.RECORD_SEP,d.UNIT_SEP];for(var Oi=0;Oi<wt.length;Oi++){for(var hi,qn=wt[Oi],Vt=0,di=0,he=0,Ee=(Ht=void 0,new E({comments:Lt,delimiter:qn,newline:Gt,preview:10}).parse(Rt)),qe=0;qe<Ee.data.length;qe++)St&&Q(Ee.data[qe])?he++:(hi=Ee.data[qe].length,di+=hi,Ht===void 0?Ht=hi:0<hi&&(Vt+=Math.abs(hi-Ht),Ht=hi));0<Ee.data.length&&(di/=Ee.data.length-he),(_t===void 0||Vt<=_t)&&(oe===void 0||oe<di)&&1.99<di&&(_t=Vt,je=qn,oe=di)}return{successful:!!(D.delimiter=je),bestDelimiter:je}})(ft,D.newline,D.skipEmptyLines,D.comments,D.delimitersToGuess)).successful?D.delimiter=lt.bestDelimiter:($=!0,D.delimiter=d.DefaultDelimiter),T.meta.delimiter=D.delimiter),z(D));return D.preview&&D.header&&lt.preview++,N=ft,U=new E(lt),T=U.parse(N,X,st),nt(),ut?{meta:{paused:!0}}:T||{meta:{paused:!1}}},this.paused=function(){return ut},this.pause=function(){ut=!0,U.abort(),N=j(D.chunk)?"":N.substring(U.getCharIndex())},this.resume=function(){q.streamer._halted?(ut=!1,q.streamer.parseChunk(N,!0)):setTimeout(q.resume,3)},this.aborted=function(){return M},this.abort=function(){M=!0,U.abort(),T.meta.aborted=!0,j(D.complete)&&D.complete(T),N=""},this.guessLineEndings=function(Rt,lt){Rt=Rt.substring(0,1048576);var lt=new RegExp(C(lt)+"([^]*?)"+C(lt),"gm"),st=(Rt=Rt.replace(lt,"")).split("\r"),lt=Rt.split(`
`),Rt=1<lt.length&&lt[0].length<st[0].length;if(st.length===1||Rt)return`
`;for(var Gt=0,St=0;St<st.length;St++)st[St][0]===`
`&&Gt++;return Gt>=st.length/2?`\r
`:"\r"}}function C(D){return D.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function E(D){var N=(D=D||{}).delimiter,U=D.newline,$=D.comments,tt=D.step,at=D.preview,gt=D.fastMode,bt=null,F=!1,q=D.quoteChar==null?'"':D.quoteChar,et=q;if(D.escapeChar!==void 0&&(et=D.escapeChar),(typeof N!="string"||-1<d.BAD_DELIMITERS.indexOf(N))&&(N=","),$===N)throw new Error("Comment character same as delimiter");$===!0?$="#":(typeof $!="string"||-1<d.BAD_DELIMITERS.indexOf($))&&($=!1),U!==`
`&&U!=="\r"&&U!==`\r
`&&(U=`
`);var it=0,ut=!1;this.parse=function(M,H,T){if(typeof M!="string")throw new Error("Input must be a string");var Q=M.length,nt=N.length,rt=U.length,ot=$.length,ft=j(tt),X=[],st=[],lt=[],Rt=it=0;if(!M)return Vt();if(gt||gt!==!1&&M.indexOf(q)===-1){for(var Gt=M.split(U),St=0;St<Gt.length;St++){if(lt=Gt[St],it+=lt.length,St!==Gt.length-1)it+=U.length;else if(T)return Vt();if(!$||lt.substring(0,ot)!==$){if(ft){if(X=[],oe(lt.split(N)),di(),ut)return Vt()}else oe(lt.split(N));if(at&&at<=St)return X=X.slice(0,at),Vt(!0)}}return Vt()}for(var Lt=M.indexOf(N,it),wt=M.indexOf(U,it),je=new RegExp(C(et)+C(q),"g"),_t=M.indexOf(q,it);;)if(M[it]===q)for(_t=it,it++;;){if((_t=M.indexOf(q,_t+1))===-1)return T||st.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:X.length,index:it}),hi();if(_t===Q-1)return hi(M.substring(it,_t).replace(je,q));if(q===et&&M[_t+1]===et)_t++;else if(q===et||_t===0||M[_t-1]!==et){Lt!==-1&&Lt<_t+1&&(Lt=M.indexOf(N,_t+1));var Ht=Oi((wt=wt!==-1&&wt<_t+1?M.indexOf(U,_t+1):wt)===-1?Lt:Math.min(Lt,wt));if(M.substr(_t+1+Ht,nt)===N){lt.push(M.substring(it,_t).replace(je,q)),M[it=_t+1+Ht+nt]!==q&&(_t=M.indexOf(q,it)),Lt=M.indexOf(N,it),wt=M.indexOf(U,it);break}if(Ht=Oi(wt),M.substring(_t+1+Ht,_t+1+Ht+rt)===U){if(lt.push(M.substring(it,_t).replace(je,q)),qn(_t+1+Ht+rt),Lt=M.indexOf(N,it),_t=M.indexOf(q,it),ft&&(di(),ut))return Vt();if(at&&X.length>=at)return Vt(!0);break}st.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:X.length,index:it}),_t++}}else if($&&lt.length===0&&M.substring(it,it+ot)===$){if(wt===-1)return Vt();it=wt+rt,wt=M.indexOf(U,it),Lt=M.indexOf(N,it)}else if(Lt!==-1&&(Lt<wt||wt===-1))lt.push(M.substring(it,Lt)),it=Lt+nt,Lt=M.indexOf(N,it);else{if(wt===-1)break;if(lt.push(M.substring(it,wt)),qn(wt+rt),ft&&(di(),ut))return Vt();if(at&&X.length>=at)return Vt(!0)}return hi();function oe(he){X.push(he),Rt=it}function Oi(he){var Ee=0;return Ee=he!==-1&&(he=M.substring(_t+1,he))&&he.trim()===""?he.length:Ee}function hi(he){return T||(he===void 0&&(he=M.substring(it)),lt.push(he),it=Q,oe(lt),ft&&di()),Vt()}function qn(he){it=he,oe(lt),lt=[],wt=M.indexOf(U,it)}function Vt(he){if(D.header&&!H&&X.length&&!F){var Ee=X[0],qe=Object.create(null),fa=new Set(Ee);let ga=!1;for(let fn=0;fn<Ee.length;fn++){let fi=Ee[fn];if(qe[fi=j(D.transformHeader)?D.transformHeader(fi,fn):fi]){let Di,Be=qe[fi];for(;Di=fi+"_"+Be,Be++,fa.has(Di););fa.add(Di),Ee[fn]=Di,qe[fi]++,ga=!0,(bt=bt===null?{}:bt)[Di]=fi}else qe[fi]=1,Ee[fn]=fi;fa.add(fi)}ga&&console.warn("Duplicate headers found and renamed."),F=!0}return{data:X,errors:st,meta:{delimiter:N,linebreak:U,aborted:ut,truncated:!!he,cursor:Rt+(H||0),renamedHeaders:bt}}}function di(){tt(Vt()),X=[],st=[]}},this.abort=function(){ut=!0},this.getCharIndex=function(){return it}}function k(D){var N=D.data,U=u[N.workerId],$=!1;if(N.error)U.userError(N.error,N.file);else if(N.results&&N.results.data){var tt={abort:function(){$=!0,O(N.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:P,resume:P};if(j(U.userStep)){for(var at=0;at<N.results.data.length&&(U.userStep({data:N.results.data[at],errors:N.results.errors,meta:N.results.meta},tt),!$);at++);delete N.results}else j(U.userChunk)&&(U.userChunk(N.results,tt,N.file),delete N.results)}N.finished&&!$&&O(N.workerId,N.results)}function O(D,N){var U=u[D];j(U.userComplete)&&U.userComplete(N),U.terminate(),delete u[D]}function P(){throw new Error("Not implemented.")}function z(D){if(typeof D!="object"||D===null)return D;var N,U=Array.isArray(D)?[]:{};for(N in D)U[N]=z(D[N]);return U}function L(D,N){return function(){D.apply(N,arguments)}}function j(D){return typeof D=="function"}return d.parse=function(D,N){var U=(N=N||{}).dynamicTyping||!1;if(j(U)&&(N.dynamicTypingFunction=U,U={}),N.dynamicTyping=U,N.transform=!!j(N.transform)&&N.transform,!N.worker||!d.WORKERS_SUPPORTED)return U=null,d.NODE_STREAM_INPUT,typeof D=="string"?(D=($=>$.charCodeAt(0)!==65279?$:$.slice(1))(D),U=new(N.download?b:A)(N)):D.readable===!0&&j(D.read)&&j(D.on)?U=new w(N):(s.File&&D instanceof File||D instanceof Object)&&(U=new v(N)),U.stream(D);(U=(()=>{var $;return!!d.WORKERS_SUPPORTED&&($=(()=>{var tt=s.URL||s.webkitURL||null,at=i.toString();return d.BLOB_URL||(d.BLOB_URL=tt.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",at,")();"],{type:"text/javascript"})))})(),($=new s.Worker($)).onmessage=k,$.id=h++,u[$.id]=$)})()).userStep=N.step,U.userChunk=N.chunk,U.userComplete=N.complete,U.userError=N.error,N.step=j(N.step),N.chunk=j(N.chunk),N.complete=j(N.complete),N.error=j(N.error),delete N.worker,U.postMessage({input:D,config:N,workerId:U.id})},d.unparse=function(D,N){var U=!1,$=!0,tt=",",at=`\r
`,gt='"',bt=gt+gt,F=!1,q=null,et=!1,it=((()=>{if(typeof N=="object"){if(typeof N.delimiter!="string"||d.BAD_DELIMITERS.filter(function(H){return N.delimiter.indexOf(H)!==-1}).length||(tt=N.delimiter),typeof N.quotes!="boolean"&&typeof N.quotes!="function"&&!Array.isArray(N.quotes)||(U=N.quotes),typeof N.skipEmptyLines!="boolean"&&typeof N.skipEmptyLines!="string"||(F=N.skipEmptyLines),typeof N.newline=="string"&&(at=N.newline),typeof N.quoteChar=="string"&&(gt=N.quoteChar),typeof N.header=="boolean"&&($=N.header),Array.isArray(N.columns)){if(N.columns.length===0)throw new Error("Option columns is empty");q=N.columns}N.escapeChar!==void 0&&(bt=N.escapeChar+gt),N.escapeFormulae instanceof RegExp?et=N.escapeFormulae:typeof N.escapeFormulae=="boolean"&&N.escapeFormulae&&(et=/^[=+\-@\t\r].*$/)}})(),new RegExp(C(gt),"g"));if(typeof D=="string"&&(D=JSON.parse(D)),Array.isArray(D)){if(!D.length||Array.isArray(D[0]))return ut(null,D,F);if(typeof D[0]=="object")return ut(q||Object.keys(D[0]),D,F)}else if(typeof D=="object")return typeof D.data=="string"&&(D.data=JSON.parse(D.data)),Array.isArray(D.data)&&(D.fields||(D.fields=D.meta&&D.meta.fields||q),D.fields||(D.fields=Array.isArray(D.data[0])?D.fields:typeof D.data[0]=="object"?Object.keys(D.data[0]):[]),Array.isArray(D.data[0])||typeof D.data[0]=="object"||(D.data=[D.data])),ut(D.fields||[],D.data||[],F);throw new Error("Unable to serialize unrecognized input");function ut(H,T,Q){var nt="",rt=(typeof H=="string"&&(H=JSON.parse(H)),typeof T=="string"&&(T=JSON.parse(T)),Array.isArray(H)&&0<H.length),ot=!Array.isArray(T[0]);if(rt&&$){for(var ft=0;ft<H.length;ft++)0<ft&&(nt+=tt),nt+=M(H[ft],ft);0<T.length&&(nt+=at)}for(var X=0;X<T.length;X++){var st=(rt?H:T[X]).length,lt=!1,Rt=rt?Object.keys(T[X]).length===0:T[X].length===0;if(Q&&!rt&&(lt=Q==="greedy"?T[X].join("").trim()==="":T[X].length===1&&T[X][0].length===0),Q==="greedy"&&rt){for(var Gt=[],St=0;St<st;St++){var Lt=ot?H[St]:St;Gt.push(T[X][Lt])}lt=Gt.join("").trim()===""}if(!lt){for(var wt=0;wt<st;wt++){0<wt&&!Rt&&(nt+=tt);var je=rt&&ot?H[wt]:wt;nt+=M(T[X][je],wt)}X<T.length-1&&(!Q||0<st&&!Rt)&&(nt+=at)}}return nt}function M(H,T){var Q,nt;return H==null?"":H.constructor===Date?JSON.stringify(H).slice(1,25):(nt=!1,et&&typeof H=="string"&&et.test(H)&&(H="'"+H,nt=!0),Q=H.toString().replace(it,bt),(nt=nt||U===!0||typeof U=="function"&&U(H,T)||Array.isArray(U)&&U[T]||((rt,ot)=>{for(var ft=0;ft<ot.length;ft++)if(-1<rt.indexOf(ot[ft]))return!0;return!1})(Q,d.BAD_DELIMITERS)||-1<Q.indexOf(tt)||Q.charAt(0)===" "||Q.charAt(Q.length-1)===" ")?gt+Q+gt:Q)}},d.RECORD_SEP="",d.UNIT_SEP="",d.BYTE_ORDER_MARK="\uFEFF",d.BAD_DELIMITERS=["\r",`
`,'"',d.BYTE_ORDER_MARK],d.WORKERS_SUPPORTED=!o&&!!s.Worker,d.NODE_STREAM_INPUT=1,d.LocalChunkSize=10485760,d.RemoteChunkSize=5242880,d.DefaultDelimiter=",",d.Parser=E,d.ParserHandle=S,d.NetworkStreamer=b,d.FileStreamer=v,d.StringStreamer=A,d.ReadableStreamStreamer=w,s.jQuery&&((a=s.jQuery).fn.parse=function(D){var N=D.config||{},U=[];return this.each(function(at){if(!(a(this).prop("tagName").toUpperCase()==="INPUT"&&a(this).attr("type").toLowerCase()==="file"&&s.FileReader)||!this.files||this.files.length===0)return!0;for(var gt=0;gt<this.files.length;gt++)U.push({file:this.files[gt],inputElem:this,instanceConfig:a.extend({},N)})}),$(),this;function $(){if(U.length===0)j(D.complete)&&D.complete();else{var at,gt,bt,F,q=U[0];if(j(D.before)){var et=D.before(q.file,q.inputElem);if(typeof et=="object"){if(et.action==="abort")return at="AbortError",gt=q.file,bt=q.inputElem,F=et.reason,void(j(D.error)&&D.error({name:at},gt,bt,F));if(et.action==="skip")return void tt();typeof et.config=="object"&&(q.instanceConfig=a.extend(q.instanceConfig,et.config))}else if(et==="skip")return void tt()}var it=q.instanceConfig.complete;q.instanceConfig.complete=function(ut){j(it)&&it(ut,q.file,q.inputElem),tt()},d.parse(q.file,q.instanceConfig)}}function tt(){U.splice(0,1),$()}}),l&&(s.onmessage=function(D){D=D.data,d.WORKER_ID===void 0&&D&&(d.WORKER_ID=D.workerId),typeof D.input=="string"?s.postMessage({workerId:d.WORKER_ID,results:d.parse(D.input,D.config),finished:!0}):(s.File&&D.input instanceof File||D.input instanceof Object)&&(D=d.parse(D.input,D.config))&&s.postMessage({workerId:d.WORKER_ID,results:D,finished:!0})}),(b.prototype=Object.create(p.prototype)).constructor=b,(v.prototype=Object.create(p.prototype)).constructor=v,(A.prototype=Object.create(A.prototype)).constructor=A,(w.prototype=Object.create(p.prototype)).constructor=w,d})})(el)),el.exports}var _y=wy();const Ey=hy(_y),om="America/Chicago",gs=g=>{if(/^\d{4}-\d{2}-\d{2}$/.test(g)){const[s,a,o]=g.split("-").map(Number),l=new Date;return l.setFullYear(s,a-1,o),l.setHours(0,0,0,0),l}const i=new Date(g).toLocaleString("en-US",{timeZone:om});return new Date(i)},Cy=()=>{const g=new Date().toLocaleString("en-US",{timeZone:om});return new Date(g)},Ty=g=>{const t=g.getFullYear(),i=String(g.getMonth()+1).padStart(2,"0"),s=String(g.getDate()).padStart(2,"0");return`${t}-${i}-${s}`},Dy=g=>new Promise(t=>{const i=[],s=[];let a=null;Ey.parse(g,{header:!0,skipEmptyLines:!0,complete:o=>{if(o.errors.length>0&&i.push(...o.errors.map(h=>h.message)),o.data.length===0){t({transactions:[],errors:["No data found in CSV file"]});return}const l=o.meta.fields||[],u=o.data[0];a=jy.find(h=>h.detect(l,u))||null,a||(i.push("Could not detect bank format. Attempting generic parser..."),a=By),console.log(`Detected CSV format: ${a.name}`),o.data.forEach((h,d)=>{try{const p=a.parse(h,d);p&&s.push(p)}catch(p){i.push(`Row ${d+1}: ${p instanceof Error?p.message:"Unknown error"}`)}}),s.length===0&&i.length===0&&i.push("No valid transactions found in CSV file"),t({transactions:s,errors:i})},error:o=>{t({transactions:[],errors:[`Failed to parse CSV: ${o.message}`]})}})}),Ny=(g,t)=>{const i=g.Date||g.date,s=g.Description||g.description,a=g["Original Description"]||g["original description"]||"",o=g.Category||g.category||"Uncategorized",l=g.Amount||g.amount,u=g.Status||g.status||g["Transaction Status"];if(!i||!s)return console.warn(`Skipping row ${t+1}: Missing required fields`),null;let h=s.toString().trim();a&&a.toString().trim()&&(h+=` | ${a.toString().trim()}`);const d=gs(i);if(isNaN(d.getTime()))throw new Error(`Invalid date: ${i}`);const p=parseFloat(l?.toString().replace(/[$,]/g,"")||"0");if(isNaN(p))throw new Error("Invalid amount format");const b=u?u.toString().toLowerCase().includes("pending"):!1,v=!b;return{id:`csv-${d.getTime()}-${t}-${Math.random().toString(36).substring(2,11)}`,date:d,description:h,category:o.toString().trim(),amount:p,balance:0,isPending:b,isReconciled:v,isManual:!1,sortOrder:t}},My=(g,t)=>{const i=g["Transaction Date"]||g["Post Date"]||g["Posting Date"],s=g.Description||g.Memo,a=g.Category||g.Type||"Uncategorized",o=g.Amount;if(!i||!s)return null;const l=gs(i);if(isNaN(l.getTime()))throw new Error(`Invalid date: ${i}`);const u=parseFloat(o?.toString().replace(/[$,]/g,"")||"0");if(isNaN(u))throw new Error("Invalid amount format");return{id:`csv-${l.getTime()}-${t}-${Math.random().toString(36).substring(2,11)}`,date:l,description:s.toString().trim(),category:a.toString().trim(),amount:u,balance:0,isPending:!1,isManual:!1,sortOrder:t}},Ry=(g,t)=>{const i=g.Date||g["Posted Date"],s=g.Description||g.Payee,a=g.Amount;if(!i||!s)return null;const o=gs(i);if(isNaN(o.getTime()))throw new Error(`Invalid date: ${i}`);const l=parseFloat(a?.toString().replace(/[$,]/g,"")||"0");if(isNaN(l))throw new Error("Invalid amount format");return{id:`${o.getTime()}-${t}`,date:o,description:s.toString().trim(),category:"Uncategorized",amount:l,balance:0,isPending:!1,isManual:!1,sortOrder:t}},ky=(g,t)=>{const i=g.Date,s=g.Description,a=g.Amount;if(!i||!s)return null;const o=gs(i);if(isNaN(o.getTime()))throw new Error(`Invalid date: ${i}`);const l=parseFloat(a?.toString().replace(/[$,]/g,"")||"0");if(isNaN(l))throw new Error("Invalid amount format");return{id:`${o.getTime()}-${t}`,date:o,description:s.toString().trim(),category:"Uncategorized",amount:l,balance:0,isPending:!1,isManual:!1,sortOrder:t}},Oy=(g,t)=>{const i=g["Transaction Date"]||g["Posted Date"],s=g.Description,a=g.Category||"Uncategorized",o=g.Debit||"0",l=g.Credit||"0";if(!i||!s)return null;const u=gs(i);if(isNaN(u.getTime()))throw new Error(`Invalid date: ${i}`);const h=parseFloat(o.toString().replace(/[$,]/g,""))||0,d=parseFloat(l.toString().replace(/[$,]/g,""))||0,p=d>0?d:-h;return p===0?null:{id:`csv-${u.getTime()}-${t}-${Math.random().toString(36).substring(2,11)}`,date:u,description:s.toString().trim(),category:a.toString().trim(),amount:p,balance:0,isPending:!1,isManual:!1,sortOrder:t}},Ly=(g,t)=>{const i=["Date","date","Transaction Date","Post Date","Posted Date","Posting Date"],s=["Description","description","Memo","memo","Payee","payee","Details"],a=["Amount","amount","Transaction Amount"],o=["Category","category","Type","type"],l=i.map(v=>g[v]).find(v=>v),u=s.map(v=>g[v]).find(v=>v),h=a.map(v=>g[v]).find(v=>v),d=o.map(v=>g[v]).find(v=>v)||"Uncategorized";if(!l||!u||!h)return null;const p=gs(l);if(isNaN(p.getTime()))throw new Error(`Invalid date: ${l}`);const b=parseFloat(h.toString().replace(/[$,]/g,""));if(isNaN(b))throw new Error("Invalid amount format");return{id:`csv-${p.getTime()}-${t}-${Math.random().toString(36).substring(2,11)}`,date:p,description:u.toString().trim(),category:d.toString().trim(),amount:b,balance:0,isPending:!1,isManual:!1,sortOrder:t}},jy=[{name:"USAA",detect:g=>{const t=g.join(",").toLowerCase();return t.includes("date")&&(t.includes("description")||t.includes("memo"))&&t.includes("amount")},parse:Ny},{name:"Chase",detect:g=>{const t=g.join(",").toLowerCase();return t.includes("transaction date")||t.includes("posting date")||t.includes("post date")&&t.includes("description")},parse:My},{name:"Bank of America",detect:g=>{const t=g.join(",").toLowerCase();return(t.includes("posted date")||t.includes("date"))&&(t.includes("payee")||t.includes("description"))&&t.includes("amount")&&t.includes("running bal")},parse:Ry},{name:"Wells Fargo",detect:g=>{const t=g.join(",").toLowerCase();return t.includes("date")&&t.includes("description")&&t.includes("amount")&&t.includes("check number")},parse:ky},{name:"Capital One",detect:g=>{const t=g.join(",").toLowerCase();return(t.includes("transaction date")||t.includes("posted date"))&&t.includes("debit")&&t.includes("credit")},parse:Oy}],By={name:"Generic",detect:()=>!0,parse:Ly},Ie=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),qu=[.001,0,0,.001,0,0],ju=1.35,ci={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},zn={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},mr="pdfjs_internal_editor_",Tt={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},Ft={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},Py={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Re={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},il={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},xe={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},ia={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},cl={ERRORS:0,WARNINGS:1,INFOS:5},br={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},Vo={moveTo:0,lineTo:1,curveTo:2,closePath:3},Fy={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let ul=cl.WARNINGS;function zy(g){Number.isInteger(g)&&(ul=g)}function Iy(){return ul}function hl(g){ul>=cl.INFOS&&console.info(`Info: ${g}`)}function Ct(g){ul>=cl.WARNINGS&&console.warn(`Warning: ${g}`)}function Jt(g){throw new Error(g)}function zt(g,t){g||Jt(t)}function Uy(g){switch(g?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function lm(g,t=null,i=null){if(!g)return null;if(i&&typeof g=="string"&&(i.addDefaultProtocol&&g.startsWith("www.")&&g.match(/\./g)?.length>=2&&(g=`http://${g}`),i.tryConvertEncoding))try{g=Yy(g)}catch{}const s=t?URL.parse(g,t):URL.parse(g);return Uy(s)?s:null}function cm(g,t,i=!1){const s=URL.parse(g);return s?(s.hash=t,s.href):i&&lm(g,"http://example.com")?g.split("#",1)[0]+`${t?`#${t}`:""}`:""}function Mt(g,t,i,s=!1){return Object.defineProperty(g,t,{value:i,enumerable:!s,configurable:!0,writable:!1}),i}const ps=(function(){function t(i,s){this.message=i,this.name=s}return t.prototype=new Error,t.constructor=t,t})();class Rp extends ps{constructor(t,i){super(t,"PasswordException"),this.code=i}}class Bu extends ps{constructor(t,i){super(t,"UnknownErrorException"),this.details=i}}class Gu extends ps{constructor(t){super(t,"InvalidPDFException")}}class al extends ps{constructor(t,i,s){super(t,"ResponseException"),this.status=i,this.missing=s}}class Hy extends ps{constructor(t){super(t,"FormatError")}}class Un extends ps{constructor(t){super(t,"AbortException")}}function um(g){(typeof g!="object"||g?.length===void 0)&&Jt("Invalid argument for bytesToString");const t=g.length,i=8192;if(t<i)return String.fromCharCode.apply(null,g);const s=[];for(let a=0;a<t;a+=i){const o=Math.min(a+i,t),l=g.subarray(a,o);s.push(String.fromCharCode.apply(null,l))}return s.join("")}function Ar(g){typeof g!="string"&&Jt("Invalid argument for stringToBytes");const t=g.length,i=new Uint8Array(t);for(let s=0;s<t;++s)i[s]=g.charCodeAt(s)&255;return i}function qy(g){return String.fromCharCode(g>>24&255,g>>16&255,g>>8&255,g&255)}function Gy(){const g=new Uint8Array(4);return g[0]=1,new Uint32Array(g.buffer,0,1)[0]===1}function Vy(){try{return new Function(""),!0}catch{return!1}}class Le{static get isLittleEndian(){return Mt(this,"isLittleEndian",Gy())}static get isEvalSupported(){return Mt(this,"isEvalSupported",Vy())}static get isOffscreenCanvasSupported(){return Mt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return Mt(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){const{platform:t,userAgent:i}=navigator;return Mt(this,"platform",{isAndroid:i.includes("Android"),isLinux:t.includes("Linux"),isMac:t.includes("Mac"),isWindows:t.includes("Win"),isFirefox:i.includes("Firefox")})}static get isCSSRoundSupported(){return Mt(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const Pu=Array.from(Array(256).keys(),g=>g.toString(16).padStart(2,"0"));class dt{static makeHexColor(t,i,s){return`#${Pu[t]}${Pu[i]}${Pu[s]}`}static domMatrixToTransform(t){return[t.a,t.b,t.c,t.d,t.e,t.f]}static scaleMinMax(t,i){let s;t[0]?(t[0]<0&&(s=i[0],i[0]=i[2],i[2]=s),i[0]*=t[0],i[2]*=t[0],t[3]<0&&(s=i[1],i[1]=i[3],i[3]=s),i[1]*=t[3],i[3]*=t[3]):(s=i[0],i[0]=i[1],i[1]=s,s=i[2],i[2]=i[3],i[3]=s,t[1]<0&&(s=i[1],i[1]=i[3],i[3]=s),i[1]*=t[1],i[3]*=t[1],t[2]<0&&(s=i[0],i[0]=i[2],i[2]=s),i[0]*=t[2],i[2]*=t[2]),i[0]+=t[4],i[1]+=t[5],i[2]+=t[4],i[3]+=t[5]}static transform(t,i){return[t[0]*i[0]+t[2]*i[1],t[1]*i[0]+t[3]*i[1],t[0]*i[2]+t[2]*i[3],t[1]*i[2]+t[3]*i[3],t[0]*i[4]+t[2]*i[5]+t[4],t[1]*i[4]+t[3]*i[5]+t[5]]}static multiplyByDOMMatrix(t,i){return[t[0]*i.a+t[2]*i.b,t[1]*i.a+t[3]*i.b,t[0]*i.c+t[2]*i.d,t[1]*i.c+t[3]*i.d,t[0]*i.e+t[2]*i.f+t[4],t[1]*i.e+t[3]*i.f+t[5]]}static applyTransform(t,i,s=0){const a=t[s],o=t[s+1];t[s]=a*i[0]+o*i[2]+i[4],t[s+1]=a*i[1]+o*i[3]+i[5]}static applyTransformToBezier(t,i,s=0){const a=i[0],o=i[1],l=i[2],u=i[3],h=i[4],d=i[5];for(let p=0;p<6;p+=2){const b=t[s+p],v=t[s+p+1];t[s+p]=b*a+v*l+h,t[s+p+1]=b*o+v*u+d}}static applyInverseTransform(t,i){const s=t[0],a=t[1],o=i[0]*i[3]-i[1]*i[2];t[0]=(s*i[3]-a*i[2]+i[2]*i[5]-i[4]*i[3])/o,t[1]=(-s*i[1]+a*i[0]+i[4]*i[1]-i[5]*i[0])/o}static axialAlignedBoundingBox(t,i,s){const a=i[0],o=i[1],l=i[2],u=i[3],h=i[4],d=i[5],p=t[0],b=t[1],v=t[2],A=t[3];let w=a*p+h,S=w,C=a*v+h,E=C,k=u*b+d,O=k,P=u*A+d,z=P;if(o!==0||l!==0){const L=o*p,j=o*v,D=l*b,N=l*A;w+=D,E+=D,C+=N,S+=N,k+=L,z+=L,P+=j,O+=j}s[0]=Math.min(s[0],w,C,S,E),s[1]=Math.min(s[1],k,P,O,z),s[2]=Math.max(s[2],w,C,S,E),s[3]=Math.max(s[3],k,P,O,z)}static inverseTransform(t){const i=t[0]*t[3]-t[1]*t[2];return[t[3]/i,-t[1]/i,-t[2]/i,t[0]/i,(t[2]*t[5]-t[4]*t[3])/i,(t[4]*t[1]-t[5]*t[0])/i]}static singularValueDecompose2dScale(t,i){const s=t[0],a=t[1],o=t[2],l=t[3],u=s**2+a**2,h=s*o+a*l,d=o**2+l**2,p=(u+d)/2,b=Math.sqrt(p**2-(u*d-h**2));i[0]=Math.sqrt(p+b||1),i[1]=Math.sqrt(p-b||1)}static normalizeRect(t){const i=t.slice(0);return t[0]>t[2]&&(i[0]=t[2],i[2]=t[0]),t[1]>t[3]&&(i[1]=t[3],i[3]=t[1]),i}static intersect(t,i){const s=Math.max(Math.min(t[0],t[2]),Math.min(i[0],i[2])),a=Math.min(Math.max(t[0],t[2]),Math.max(i[0],i[2]));if(s>a)return null;const o=Math.max(Math.min(t[1],t[3]),Math.min(i[1],i[3])),l=Math.min(Math.max(t[1],t[3]),Math.max(i[1],i[3]));return o>l?null:[s,o,a,l]}static pointBoundingBox(t,i,s){s[0]=Math.min(s[0],t),s[1]=Math.min(s[1],i),s[2]=Math.max(s[2],t),s[3]=Math.max(s[3],i)}static rectBoundingBox(t,i,s,a,o){o[0]=Math.min(o[0],t,s),o[1]=Math.min(o[1],i,a),o[2]=Math.max(o[2],t,s),o[3]=Math.max(o[3],i,a)}static#t(t,i,s,a,o,l,u,h,d,p){if(d<=0||d>=1)return;const b=1-d,v=d*d,A=v*d,w=b*(b*(b*t+3*d*i)+3*v*s)+A*a,S=b*(b*(b*o+3*d*l)+3*v*u)+A*h;p[0]=Math.min(p[0],w),p[1]=Math.min(p[1],S),p[2]=Math.max(p[2],w),p[3]=Math.max(p[3],S)}static#e(t,i,s,a,o,l,u,h,d,p,b,v){if(Math.abs(d)<1e-12){Math.abs(p)>=1e-12&&this.#t(t,i,s,a,o,l,u,h,-b/p,v);return}const A=p**2-4*b*d;if(A<0)return;const w=Math.sqrt(A),S=2*d;this.#t(t,i,s,a,o,l,u,h,(-p+w)/S,v),this.#t(t,i,s,a,o,l,u,h,(-p-w)/S,v)}static bezierBoundingBox(t,i,s,a,o,l,u,h,d){d[0]=Math.min(d[0],t,u),d[1]=Math.min(d[1],i,h),d[2]=Math.max(d[2],t,u),d[3]=Math.max(d[3],i,h),this.#e(t,s,o,u,i,a,l,h,3*(-t+3*(s-o)+u),6*(t-2*s+o),3*(s-t),d),this.#e(t,s,o,u,i,a,l,h,3*(-i+3*(a-l)+h),6*(i-2*a+l),3*(a-i),d)}}function Yy(g){return decodeURIComponent(escape(g))}let Fu=null,kp=null;function Xy(g){return Fu||(Fu=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,kp=new Map([["","t"]])),g.replaceAll(Fu,(t,i,s)=>i?i.normalize("NFKC"):kp.get(s))}function hm(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const g=new Uint8Array(32);return crypto.getRandomValues(g),um(g)}const ah="pdfjs_internal_id_";function $y(g,t,i){if(!Array.isArray(i)||i.length<2)return!1;const[s,a,...o]=i;if(!g(s)&&!Number.isInteger(s)||!t(a))return!1;const l=o.length;let u=!0;switch(a.name){case"XYZ":if(l<2||l>3)return!1;break;case"Fit":case"FitB":return l===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(l>1)return!1;break;case"FitR":if(l!==4)return!1;u=!1;break;default:return!1}for(const h of o)if(!(typeof h=="number"||u&&h===null))return!1;return!0}function Ue(g,t,i){return Math.min(Math.max(g,t),i)}function dm(g){return Uint8Array.prototype.toBase64?g.toBase64():btoa(um(g))}function Ky(g){return Uint8Array.fromBase64?Uint8Array.fromBase64(g):Ar(atob(g))}typeof Promise.try!="function"&&(Promise.try=function(g,...t){return new Promise(i=>{i(g(...t))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(g){return g.reduce((t,i)=>t+i,0)});class yr{static textContent(t){const i=[],s={items:i,styles:Object.create(null)};function a(o){if(!o)return;let l=null;const u=o.name;if(u==="#text")l=o.value;else if(yr.shouldBuildText(u))o?.attributes?.textContent?l=o.attributes.textContent:o.value&&(l=o.value);else return;if(l!==null&&i.push({str:l}),!!o.children)for(const h of o.children)a(h)}return a(t),s}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}class fm{static setupStorage(t,i,s,a,o){const l=a.getValue(i,{value:null});switch(s.name){case"textarea":if(l.value!==null&&(t.textContent=l.value),o==="print")break;t.addEventListener("input",u=>{a.setValue(i,{value:u.target.value})});break;case"input":if(s.attributes.type==="radio"||s.attributes.type==="checkbox"){if(l.value===s.attributes.xfaOn?t.setAttribute("checked",!0):l.value===s.attributes.xfaOff&&t.removeAttribute("checked"),o==="print")break;t.addEventListener("change",u=>{a.setValue(i,{value:u.target.checked?u.target.getAttribute("xfaOn"):u.target.getAttribute("xfaOff")})})}else{if(l.value!==null&&t.setAttribute("value",l.value),o==="print")break;t.addEventListener("input",u=>{a.setValue(i,{value:u.target.value})})}break;case"select":if(l.value!==null){t.setAttribute("value",l.value);for(const u of s.children)u.attributes.value===l.value?u.attributes.selected=!0:u.attributes.hasOwnProperty("selected")&&delete u.attributes.selected}t.addEventListener("input",u=>{const h=u.target.options,d=h.selectedIndex===-1?"":h[h.selectedIndex].value;a.setValue(i,{value:d})});break}}static setAttributes({html:t,element:i,storage:s=null,intent:a,linkService:o}){const{attributes:l}=i,u=t instanceof HTMLAnchorElement;l.type==="radio"&&(l.name=`${l.name}-${a}`);for(const[h,d]of Object.entries(l))if(d!=null)switch(h){case"class":d.length&&t.setAttribute(h,d.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",d);break;case"style":Object.assign(t.style,d);break;case"textContent":t.textContent=d;break;default:(!u||h!=="href"&&h!=="newWindow")&&t.setAttribute(h,d)}u&&o.addLinkAttributes(t,l.href,l.newWindow),s&&l.dataId&&this.setupStorage(t,l.dataId,i,s)}static render(t){const i=t.annotationStorage,s=t.linkService,a=t.xfaHtml,o=t.intent||"display",l=document.createElement(a.name);a.attributes&&this.setAttributes({html:l,element:a,intent:o,linkService:s});const u=o!=="richText",h=t.div;if(h.append(l),t.viewport){const b=`matrix(${t.viewport.transform.join(",")})`;h.style.transform=b}u&&h.setAttribute("class","xfaLayer xfaFont");const d=[];if(a.children.length===0){if(a.value){const b=document.createTextNode(a.value);l.append(b),u&&yr.shouldBuildText(a.name)&&d.push(b)}return{textDivs:d}}const p=[[a,-1,l]];for(;p.length>0;){const[b,v,A]=p.at(-1);if(v+1===b.children.length){p.pop();continue}const w=b.children[++p.at(-1)[1]];if(w===null)continue;const{name:S}=w;if(S==="#text"){const E=document.createTextNode(w.value);d.push(E),A.append(E);continue}const C=w?.attributes?.xmlns?document.createElementNS(w.attributes.xmlns,S):document.createElement(S);if(A.append(C),w.attributes&&this.setAttributes({html:C,element:w,storage:i,intent:o,linkService:s}),w.children?.length>0)p.push([w,-1,C]);else if(w.value){const E=document.createTextNode(w.value);u&&yr.shouldBuildText(S)&&d.push(E),C.append(E)}}for(const b of h.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))b.setAttribute("readOnly",!0);return{textDivs:d}}static update(t){const i=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=i,t.div.hidden=!1}}const un="http://www.w3.org/2000/svg";class da{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function Sr(g,t="text"){if(dr(g,document.baseURI)){const i=await fetch(g);if(!i.ok)throw new Error(i.statusText);switch(t){case"arraybuffer":return i.arrayBuffer();case"blob":return i.blob();case"json":return i.json()}return i.text()}return new Promise((i,s)=>{const a=new XMLHttpRequest;a.open("GET",g,!0),a.responseType=t,a.onreadystatechange=()=>{if(a.readyState===XMLHttpRequest.DONE){if(a.status===200||a.status===0){switch(t){case"arraybuffer":case"blob":case"json":i(a.response);return}i(a.responseText);return}s(new Error(a.statusText))}},a.send(null)})}class wr{constructor({viewBox:t,userUnit:i,scale:s,rotation:a,offsetX:o=0,offsetY:l=0,dontFlip:u=!1}){this.viewBox=t,this.userUnit=i,this.scale=s,this.rotation=a,this.offsetX=o,this.offsetY=l,s*=i;const h=(t[2]+t[0])/2,d=(t[3]+t[1])/2;let p,b,v,A;switch(a%=360,a<0&&(a+=360),a){case 180:p=-1,b=0,v=0,A=1;break;case 90:p=0,b=1,v=1,A=0;break;case 270:p=0,b=-1,v=-1,A=0;break;case 0:p=1,b=0,v=0,A=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}u&&(v=-v,A=-A);let w,S,C,E;p===0?(w=Math.abs(d-t[1])*s+o,S=Math.abs(h-t[0])*s+l,C=(t[3]-t[1])*s,E=(t[2]-t[0])*s):(w=Math.abs(h-t[0])*s+o,S=Math.abs(d-t[1])*s+l,C=(t[2]-t[0])*s,E=(t[3]-t[1])*s),this.transform=[p*s,b*s,v*s,A*s,w-p*s*h-v*s*d,S-b*s*h-A*s*d],this.width=C,this.height=E}get rawDims(){const t=this.viewBox;return Mt(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}clone({scale:t=this.scale,rotation:i=this.rotation,offsetX:s=this.offsetX,offsetY:a=this.offsetY,dontFlip:o=!1}={}){return new wr({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:t,rotation:i,offsetX:s,offsetY:a,dontFlip:o})}convertToViewportPoint(t,i){const s=[t,i];return dt.applyTransform(s,this.transform),s}convertToViewportRectangle(t){const i=[t[0],t[1]];dt.applyTransform(i,this.transform);const s=[t[2],t[3]];return dt.applyTransform(s,this.transform),[i[0],i[1],s[0],s[1]]}convertToPdfPoint(t,i){const s=[t,i];return dt.applyInverseTransform(s,this.transform),s}}class rh extends ps{constructor(t,i=0){super(t,"RenderingCancelledException"),this.extraDelay=i}}function dl(g){const t=g.length;let i=0;for(;i<t&&g[i].trim()==="";)i++;return g.substring(i,i+5).toLowerCase()==="data:"}function oh(g){return typeof g=="string"&&/\.pdf$/i.test(g)}function Qy(g){return[g]=g.split(/[#?]/,1),g.substring(g.lastIndexOf("/")+1)}function Wy(g,t="document.pdf"){if(typeof g!="string")return t;if(dl(g))return Ct('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const s=(u=>{try{return new URL(u)}catch{try{return new URL(decodeURIComponent(u))}catch{try{return new URL(u,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(u),"https://foo.bar")}catch{return null}}}}})(g);if(!s)return t;const a=u=>{try{let h=decodeURIComponent(u);return h.includes("/")?(h=h.split("/").at(-1),h.test(/^\.pdf$/i)?h:u):h}catch{return u}},o=/\.pdf$/i,l=s.pathname.split("/").at(-1);if(o.test(l))return a(l);if(s.searchParams.size>0){const u=Array.from(s.searchParams.values()).reverse();for(const d of u)if(o.test(d))return a(d);const h=Array.from(s.searchParams.keys()).reverse();for(const d of h)if(o.test(d))return a(d)}if(s.hash){const h=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(s.hash);if(h)return a(h[0])}return t}class Op{started=Object.create(null);times=[];time(t){t in this.started&&Ct(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||Ct(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let i=0;for(const{name:s}of this.times)i=Math.max(s.length,i);for(const{name:s,start:a,end:o}of this.times)t.push(`${s.padEnd(i)} ${o-a}ms
`);return t.join("")}}function dr(g,t){const i=t?URL.parse(g,t):URL.parse(g);return i?.protocol==="http:"||i?.protocol==="https:"}function Ti(g){g.preventDefault()}function ue(g){g.preventDefault(),g.stopPropagation()}function Zy(g){console.log("Deprecated API usage: "+g)}class Vu{static#t;static toDateObject(t){if(t instanceof Date)return t;if(!t||typeof t!="string")return null;this.#t||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const i=this.#t.exec(t);if(!i)return null;const s=parseInt(i[1],10);let a=parseInt(i[2],10);a=a>=1&&a<=12?a-1:0;let o=parseInt(i[3],10);o=o>=1&&o<=31?o:1;let l=parseInt(i[4],10);l=l>=0&&l<=23?l:0;let u=parseInt(i[5],10);u=u>=0&&u<=59?u:0;let h=parseInt(i[6],10);h=h>=0&&h<=59?h:0;const d=i[7]||"Z";let p=parseInt(i[8],10);p=p>=0&&p<=23?p:0;let b=parseInt(i[9],10)||0;return b=b>=0&&b<=59?b:0,d==="-"?(l+=p,u+=b):d==="+"&&(l-=p,u-=b),new Date(Date.UTC(s,a,o,l,u,h))}}function Jy(g,{scale:t=1,rotation:i=0}){const{width:s,height:a}=g.attributes.style,o=[0,0,parseInt(s),parseInt(a)];return new wr({viewBox:o,userUnit:1,scale:t,rotation:i})}function _r(g){if(g.startsWith("#")){const t=parseInt(g.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return g.startsWith("rgb(")?g.slice(4,-1).split(",").map(t=>parseInt(t)):g.startsWith("rgba(")?g.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(Ct(`Not a valid color format: "${g}"`),[0,0,0])}function tv(g){const t=document.createElement("span");t.style.visibility="hidden",t.style.colorScheme="only light",document.body.append(t);for(const i of g.keys()){t.style.color=i;const s=window.getComputedStyle(t).color;g.set(i,_r(s))}t.remove()}function ae(g){const{a:t,b:i,c:s,d:a,e:o,f:l}=g.getTransform();return[t,i,s,a,o,l]}function Ii(g){const{a:t,b:i,c:s,d:a,e:o,f:l}=g.getTransform().invertSelf();return[t,i,s,a,o,l]}function ds(g,t,i=!1,s=!0){if(t instanceof wr){const{pageWidth:a,pageHeight:o}=t.rawDims,{style:l}=g,u=Le.isCSSRoundSupported,h=`var(--total-scale-factor) * ${a}px`,d=`var(--total-scale-factor) * ${o}px`,p=u?`round(down, ${h}, var(--scale-round-x))`:`calc(${h})`,b=u?`round(down, ${d}, var(--scale-round-y))`:`calc(${d})`;!i||t.rotation%180===0?(l.width=p,l.height=b):(l.width=b,l.height=p)}s&&g.setAttribute("data-main-rotation",t.rotation)}class Gi{constructor(){const{pixelRatio:t}=Gi;this.sx=t,this.sy=t}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(t,i,s,a,o=-1){let l=1/0,u=1/0,h=1/0;s=Gi.capPixels(s,o),s>0&&(l=Math.sqrt(s/(t*i))),a!==-1&&(u=a/t,h=a/i);const d=Math.min(l,u,h);return this.sx>d||this.sy>d?(this.sx=d,this.sy=d,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(t,i){if(i>=0){const s=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+i/100));return t>0?Math.min(t,s):s}return t}}const Yu=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class ev{static get isDarkMode(){return Mt(this,"isDarkMode",!!window?.matchMedia?.("(prefers-color-scheme: dark)").matches)}}class iv{static get commentForegroundColor(){const t=document.createElement("span");t.classList.add("comment","sidebar");const{style:i}=t;i.width=i.height="0",i.display="none",i.color="var(--comment-fg-color)",document.body.append(t);const{color:s}=window.getComputedStyle(t);return t.remove(),Mt(this,"commentForegroundColor",_r(s))}}function nv(g,t,i,s){s=Math.min(Math.max(s??1,0),1);const a=255*(1-s);return g=Math.round(g*s+a),t=Math.round(t*s+a),i=Math.round(i*s+a),[g,t,i]}function Lp(g,t){const i=g[0]/255,s=g[1]/255,a=g[2]/255,o=Math.max(i,s,a),l=Math.min(i,s,a),u=(o+l)/2;if(o===l)t[0]=t[1]=0;else{const h=o-l;switch(t[1]=u<.5?h/(o+l):h/(2-o-l),o){case i:t[0]=((s-a)/h+(s<a?6:0))*60;break;case s:t[0]=((a-i)/h+2)*60;break;case a:t[0]=((i-s)/h+4)*60;break}}t[2]=u}function Xu(g,t){const i=g[0],s=g[1],a=g[2],o=(1-Math.abs(2*a-1))*s,l=o*(1-Math.abs(i/60%2-1)),u=a-o/2;switch(Math.floor(i/60)){case 0:t[0]=o+u,t[1]=l+u,t[2]=u;break;case 1:t[0]=l+u,t[1]=o+u,t[2]=u;break;case 2:t[0]=u,t[1]=o+u,t[2]=l+u;break;case 3:t[0]=u,t[1]=l+u,t[2]=o+u;break;case 4:t[0]=l+u,t[1]=u,t[2]=o+u;break;case 5:case 6:t[0]=o+u,t[1]=u,t[2]=l+u;break}}function jp(g){return g<=.03928?g/12.92:((g+.055)/1.055)**2.4}function Bp(g,t,i){Xu(g,i),i.map(jp);const s=.2126*i[0]+.7152*i[1]+.0722*i[2];Xu(t,i),i.map(jp);const a=.2126*i[0]+.7152*i[1]+.0722*i[2];return s>a?(s+.05)/(a+.05):(a+.05)/(s+.05)}const Pp=new Map;function sv(g,t){const i=g[0]+g[1]*256+g[2]*65536+t[0]*16777216+t[1]*4294967296+t[2]*1099511627776;let s=Pp.get(i);if(s)return s;const a=new Float32Array(9),o=a.subarray(0,3),l=a.subarray(3,6);Lp(g,l);const u=a.subarray(6,9);Lp(t,u);const h=u[2]<.5,d=h?12:4.5;if(l[2]=h?Math.sqrt(l[2]):1-Math.sqrt(1-l[2]),Bp(l,u,o)<d){let p,b;h?(p=l[2],b=1):(p=0,b=l[2]);const v=.005;for(;b-p>v;){const A=l[2]=(p+b)/2;h===Bp(l,u,o)<d?p=A:b=A}l[2]=h?b:p}return Xu(l,o),s=dt.makeHexColor(Math.round(o[0]*255),Math.round(o[1]*255),Math.round(o[2]*255)),Pp.set(i,s),s}function gm({html:g,dir:t,className:i},s){const a=document.createDocumentFragment();if(typeof g=="string"){const o=document.createElement("p");o.dir=t||"auto";const l=g.split(/(?:\r\n?|\n)/);for(let u=0,h=l.length;u<h;++u){const d=l[u];o.append(document.createTextNode(d)),u<h-1&&o.append(document.createElement("br"))}a.append(o)}else fm.render({xfaHtml:g,div:a,intent:"richText"});a.firstChild.classList.add("richText",i),s.append(a)}class pr{#t=null;#e=null;#n;#i=null;#r=null;#s=null;#a=null;#o=null;static#c=null;constructor(t){this.#n=t,pr.#c||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"})}render(){const t=this.#t=document.createElement("div");t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const i=this.#n._uiManager._signal;i instanceof AbortSignal&&!i.aborted&&(t.addEventListener("contextmenu",Ti,{signal:i}),t.addEventListener("pointerdown",pr.#l,{signal:i}));const s=this.#i=document.createElement("div");s.className="buttons",t.append(s);const a=this.#n.toolbarPosition;if(a){const{style:o}=t,l=this.#n._uiManager.direction==="ltr"?1-a[0]:a[0];o.insetInlineEnd=`${100*l}%`,o.top=`calc(${100*a[1]}% + var(--editor-toolbar-vert-offset))`}return t}get div(){return this.#t}static#l(t){t.stopPropagation()}#d(t){this.#n._focusEventsAllowed=!1,ue(t)}#h(t){this.#n._focusEventsAllowed=!0,ue(t)}#f(t){const i=this.#n._uiManager._signal;return!(i instanceof AbortSignal)||i.aborted?!1:(t.addEventListener("focusin",this.#d.bind(this),{capture:!0,signal:i}),t.addEventListener("focusout",this.#h.bind(this),{capture:!0,signal:i}),t.addEventListener("contextmenu",Ti,{signal:i}),!0)}hide(){this.#t.classList.add("hidden"),this.#e?.hideDropdown()}show(){this.#t.classList.remove("hidden"),this.#r?.shown(),this.#s?.shown()}addDeleteButton(){const{editorType:t,_uiManager:i}=this.#n,s=document.createElement("button");s.classList.add("basic","deleteButton"),s.tabIndex=0,s.setAttribute("data-l10n-id",pr.#c[t]),this.#f(s)&&s.addEventListener("click",a=>{i.delete()},{signal:i._signal}),this.#i.append(s)}get#m(){const t=document.createElement("div");return t.className="divider",t}async addAltText(t){const i=await t.render();this.#f(i),this.#i.append(i,this.#m),this.#r=t}addComment(t,i=null){if(this.#s)return;const s=t.renderForToolbar();if(!s)return;this.#f(s);const a=this.#a=this.#m;i?(this.#i.insertBefore(s,i),this.#i.insertBefore(a,i)):this.#i.append(s,a),this.#s=t,t.toolbar=this}addColorPicker(t){if(this.#e)return;this.#e=t;const i=t.renderButton();this.#f(i),this.#i.append(i,this.#m)}async addEditSignatureButton(t){const i=this.#o=await t.renderEditButton(this.#n);this.#f(i),this.#i.append(i,this.#m)}removeButton(t){switch(t){case"comment":this.#s?.removeToolbarCommentButton(),this.#s=null,this.#a?.remove(),this.#a=null;break}}async addButton(t,i){switch(t){case"colorPicker":this.addColorPicker(i);break;case"altText":await this.addAltText(i);break;case"editSignature":await this.addEditSignatureButton(i);break;case"delete":this.addDeleteButton();break;case"comment":this.addComment(i);break}}async addButtonBefore(t,i,s){const a=this.#i.querySelector(s);a&&t==="comment"&&this.addComment(i,a)}updateEditSignatureButton(t){this.#o&&(this.#o.title=t)}remove(){this.#t.remove(),this.#e?.destroy(),this.#e=null}}class av{#t=null;#e=null;#n;constructor(t){this.#n=t}#i(){const t=this.#e=document.createElement("div");t.className="editToolbar",t.setAttribute("role","toolbar");const i=this.#n._signal;i instanceof AbortSignal&&!i.aborted&&t.addEventListener("contextmenu",Ti,{signal:i});const s=this.#t=document.createElement("div");return s.className="buttons",t.append(s),this.#n.hasCommentManager()&&this.#s("commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{this.#n.commentSelection("floating_button")}),this.#s("highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{this.#n.highlightSelection("floating_button")}),t}#r(t,i){let s=0,a=0;for(const o of t){const l=o.y+o.height;if(l<s)continue;const u=o.x+(i?o.width:0);if(l>s){a=u,s=l;continue}i?u>a&&(a=u):u<a&&(a=u)}return[i?1-a:a,s]}show(t,i,s){const[a,o]=this.#r(i,s),{style:l}=this.#e||=this.#i();t.append(this.#e),l.insetInlineEnd=`${100*a}%`,l.top=`calc(${100*o}% + var(--editor-toolbar-vert-offset))`}hide(){this.#e.remove()}#s(t,i,s,a){const o=document.createElement("button");o.classList.add("basic",t),o.tabIndex=0,o.setAttribute("data-l10n-id",i);const l=document.createElement("span");o.append(l),l.className="visuallyHidden",l.setAttribute("data-l10n-id",s);const u=this.#n._signal;u instanceof AbortSignal&&!u.aborted&&(o.addEventListener("contextmenu",Ti,{signal:u}),o.addEventListener("click",a,{signal:u})),this.#t.append(o)}}function pm(g,t,i){for(const s of i)t.addEventListener(s,g[s].bind(g))}class rv{#t=0;get id(){return`${mr}${this.#t++}`}}class lh{#t=hm();#e=0;#n=null;static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',s=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),a=new Image;a.src=t;const o=a.decode().then(()=>(s.drawImage(a,0,0,1,1,0,0,1,3),new Uint32Array(s.getImageData(0,0,1,1).data.buffer)[0]===0));return Mt(this,"_isSVGFittingCanvas",o)}async#i(t,i){this.#n||=new Map;let s=this.#n.get(t);if(s===null)return null;if(s?.bitmap)return s.refCounter+=1,s;try{s||={bitmap:null,id:`image_${this.#t}_${this.#e++}`,refCounter:0,isSvg:!1};let a;if(typeof i=="string"?(s.url=i,a=await Sr(i,"blob")):i instanceof File?a=s.file=i:i instanceof Blob&&(a=i),a.type==="image/svg+xml"){const o=lh._isSVGFittingCanvas,l=new FileReader,u=new Image,h=new Promise((d,p)=>{u.onload=()=>{s.bitmap=u,s.isSvg=!0,d()},l.onload=async()=>{const b=s.svgUrl=l.result;u.src=await o?`${b}#svgView(preserveAspectRatio(none))`:b},u.onerror=l.onerror=p});l.readAsDataURL(a),await h}else s.bitmap=await createImageBitmap(a);s.refCounter=1}catch(a){Ct(a),s=null}return this.#n.set(t,s),s&&this.#n.set(s.id,s),s}async getFromFile(t){const{lastModified:i,name:s,size:a,type:o}=t;return this.#i(`${i}_${s}_${a}_${o}`,t)}async getFromUrl(t){return this.#i(t,t)}async getFromBlob(t,i){const s=await i;return this.#i(t,s)}async getFromId(t){this.#n||=new Map;const i=this.#n.get(t);if(!i)return null;if(i.bitmap)return i.refCounter+=1,i;if(i.file)return this.getFromFile(i.file);if(i.blobPromise){const{blobPromise:s}=i;return delete i.blobPromise,this.getFromBlob(i.id,s)}return this.getFromUrl(i.url)}getFromCanvas(t,i){this.#n||=new Map;let s=this.#n.get(t);if(s?.bitmap)return s.refCounter+=1,s;const a=new OffscreenCanvas(i.width,i.height);return a.getContext("2d").drawImage(i,0,0),s={bitmap:a.transferToImageBitmap(),id:`image_${this.#t}_${this.#e++}`,refCounter:1,isSvg:!1},this.#n.set(t,s),this.#n.set(s.id,s),s}getSvgUrl(t){const i=this.#n.get(t);return i?.isSvg?i.svgUrl:null}deleteId(t){this.#n||=new Map;const i=this.#n.get(t);if(!i||(i.refCounter-=1,i.refCounter!==0))return;const{bitmap:s}=i;if(!i.url&&!i.file){const a=new OffscreenCanvas(s.width,s.height);a.getContext("bitmaprenderer").transferFromImageBitmap(s),i.blobPromise=a.convertToBlob()}s.close?.(),i.bitmap=null}isValidId(t){return t.startsWith(`image_${this.#t}_`)}}class ov{#t=[];#e=!1;#n;#i=-1;constructor(t=128){this.#n=t}add({cmd:t,undo:i,post:s,mustExec:a,type:o=NaN,overwriteIfSameType:l=!1,keepUndo:u=!1}){if(a&&t(),this.#e)return;const h={cmd:t,undo:i,post:s,type:o};if(this.#i===-1){this.#t.length>0&&(this.#t.length=0),this.#i=0,this.#t.push(h);return}if(l&&this.#t[this.#i].type===o){u&&(h.undo=this.#t[this.#i].undo),this.#t[this.#i]=h;return}const d=this.#i+1;d===this.#n?this.#t.splice(0,1):(this.#i=d,d<this.#t.length&&this.#t.splice(d)),this.#t.push(h)}undo(){if(this.#i===-1)return;this.#e=!0;const{undo:t,post:i}=this.#t[this.#i];t(),i?.(),this.#e=!1,this.#i-=1}redo(){if(this.#i<this.#t.length-1){this.#i+=1,this.#e=!0;const{cmd:t,post:i}=this.#t[this.#i];t(),i?.(),this.#e=!1}}hasSomethingToUndo(){return this.#i!==-1}hasSomethingToRedo(){return this.#i<this.#t.length-1}cleanType(t){if(this.#i!==-1){for(let i=this.#i;i>=0;i--)if(this.#t[i].type!==t){this.#t.splice(i+1,this.#i-i),this.#i=i;return}this.#t.length=0,this.#i=-1}}destroy(){this.#t=null}}class Er{constructor(t){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:i}=Le.platform;for(const[s,a,o={}]of t)for(const l of s){const u=l.startsWith("mac+");i&&u?(this.callbacks.set(l.slice(4),{callback:a,options:o}),this.allKeys.add(l.split("+").at(-1))):!i&&!u&&(this.callbacks.set(l,{callback:a,options:o}),this.allKeys.add(l.split("+").at(-1)))}}#t(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const i=this.buffer.join("+");return this.buffer.length=0,i}exec(t,i){if(!this.allKeys.has(i.key))return;const s=this.callbacks.get(this.#t(i));if(!s)return;const{callback:a,options:{bubbles:o=!1,args:l=[],checker:u=null}}=s;u&&!u(t,i)||(a.bind(t,...l,i)(),o||ue(i))}}class ch{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return tv(t),Mt(this,"_colors",t)}convert(t){const i=_r(t);if(!window.matchMedia("(forced-colors: active)").matches)return i;for(const[s,a]of this._colors)if(a.every((o,l)=>o===i[l]))return ch._colorsMapping.get(s);return i}getHexCode(t){const i=this._colors.get(t);return i?dt.makeHexColor(...i):t}}class Hn{#t=new AbortController;#e=null;#n=null;#i=new Map;#r=new Map;#s=null;#a=null;#o=null;#c=new ov;#l=null;#d=null;#h=null;#f=0;#m=new Set;#g=null;#u=null;#p=new Set;_editorUndoBar=null;#b=!1;#v=!1;#y=!1;#E=null;#w=null;#x=null;#T=null;#S=!1;#_=null;#M=new rv;#D=!1;#N=!1;#P=!1;#k=null;#L=null;#F=null;#j=null;#G=null;#C=Tt.NONE;#A=new Set;#O=null;#z=null;#U=null;#X=null;#Y=null;#$={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#H=[0,0];#B=null;#V=null;#Z=null;#J=null;#I=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const t=Hn.prototype,i=l=>l.#V.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&l.hasSomethingToControl(),s=(l,{target:u})=>{if(u instanceof HTMLInputElement){const{type:h}=u;return h!=="text"&&h!=="number"}return!0},a=this.TRANSLATE_SMALL,o=this.TRANSLATE_BIG;return Mt(this,"_keyboardManager",new Er([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:s}],[["ctrl+z","mac+meta+z"],t.undo,{checker:s}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:s}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:s}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(l,{target:u})=>!(u instanceof HTMLButtonElement)&&l.#V.contains(u)&&!l.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(l,{target:u})=>!(u instanceof HTMLButtonElement)&&l.#V.contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-a,0],checker:i}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-o,0],checker:i}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[a,0],checker:i}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[o,0],checker:i}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-a],checker:i}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-o],checker:i}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,a],checker:i}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,o],checker:i}]]))}constructor(t,i,s,a,o,l,u,h,d,p,b,v,A,w,S,C){const E=this._signal=this.#t.signal;this.#V=t,this.#Z=i,this.#J=s,this.#s=a,this.#l=o,this.#z=l,this.#Y=h,this._eventBus=u,u._on("editingaction",this.onEditingAction.bind(this),{signal:E}),u._on("pagechanging",this.onPageChanging.bind(this),{signal:E}),u._on("scalechanging",this.onScaleChanging.bind(this),{signal:E}),u._on("rotationchanging",this.onRotationChanging.bind(this),{signal:E}),u._on("setpreference",this.onSetPreference.bind(this),{signal:E}),u._on("switchannotationeditorparams",k=>this.updateParams(k.type,k.value),{signal:E}),window.addEventListener("pointerdown",()=>{this.#N=!0},{capture:!0,signal:E}),window.addEventListener("pointerup",()=>{this.#N=!1},{capture:!0,signal:E}),this.#lt(),this.#dt(),this.#et(),this.#a=h.annotationStorage,this.#E=h.filterFactory,this.#U=d,this.#T=p||null,this.#b=b,this.#v=v,this.#y=A,this.#G=w||null,this.viewParameters={realScale:da.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=S||null,this._supportsPinchToZoom=C!==!1,o?.setSidebarUiManager(this)}destroy(){this.#I?.resolve(),this.#I=null,this.#t?.abort(),this.#t=null,this._signal=null;for(const t of this.#r.values())t.destroy();this.#r.clear(),this.#i.clear(),this.#p.clear(),this.#j?.clear(),this.#e=null,this.#A.clear(),this.#c.destroy(),this.#s?.destroy(),this.#l?.destroy(),this.#z?.destroy(),this.#_?.hide(),this.#_=null,this.#F?.destroy(),this.#F=null,this.#n=null,this.#w&&(clearTimeout(this.#w),this.#w=null),this.#B&&(clearTimeout(this.#B),this.#B=null),this._editorUndoBar?.destroy(),this.#Y=null}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return this.#G}get useNewAltTextFlow(){return this.#v}get useNewAltTextWhenAddingImage(){return this.#y}get hcmFilter(){return Mt(this,"hcmFilter",this.#U?this.#E.addHCMFilter(this.#U.foreground,this.#U.background):"none")}get direction(){return Mt(this,"direction",getComputedStyle(this.#V).direction)}get _highlightColors(){return Mt(this,"_highlightColors",this.#T?new Map(this.#T.split(",").map(t=>(t=t.split("=").map(i=>i.trim()),t[1]=t[1].toUpperCase(),t))):null)}get highlightColors(){const{_highlightColors:t}=this;if(!t)return Mt(this,"highlightColors",null);const i=new Map,s=!!this.#U;for(const[a,o]of t){const l=a.endsWith("_HCM");if(s&&l){i.set(a.replace("_HCM",""),o);continue}!s&&!l&&i.set(a,o)}return Mt(this,"highlightColors",i)}get highlightColorNames(){return Mt(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}getNonHCMColor(t){if(!this._highlightColors)return t;const i=this.highlightColorNames.get(t);return this._highlightColors.get(i)||t}getNonHCMColorName(t){return this.highlightColorNames.get(t)||t}setCurrentDrawingSession(t){t?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#h=t}setMainHighlightColorPicker(t){this.#F=t}editAltText(t,i=!1){this.#s?.editAltText(this,t,i)}hasCommentManager(){return!!this.#l}editComment(t,i,s,a){this.#l?.showDialog(this,t,i,s,a)}selectComment(t,i){this.#r.get(t)?.getEditorByUID(i)?.toggleComment(!0,!0)}updateComment(t){this.#l?.updateComment(t.getData())}updatePopupColor(t){this.#l?.updatePopupColor(t)}removeComment(t){this.#l?.removeComments([t.uid])}toggleComment(t,i,s=void 0){this.#l?.toggleCommentPopup(t,i,s)}makeCommentColor(t,i){return t&&this.#l?.makeCommentColor(t,i)||null}getCommentDialogElement(){return this.#l?.dialogElement||null}async waitForEditorsRendered(t){if(this.#r.has(t-1))return;const{resolve:i,promise:s}=Promise.withResolvers(),a=o=>{o.pageNumber===t&&(this._eventBus._off("editorsrendered",a),i())};this._eventBus.on("editorsrendered",a),await s}getSignature(t){this.#z?.getSignature({uiManager:this,editor:t})}get signatureManager(){return this.#z}switchToMode(t,i){this._eventBus.on("annotationeditormodechanged",i,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,i){this._eventBus.dispatch("setpreference",{source:this,name:t,value:i})}onSetPreference({name:t,value:i}){switch(t){case"enableNewAltTextWhenAddingImage":this.#y=i;break}}onPageChanging({pageNumber:t}){this.#f=t-1}focusMainContainer(){this.#V.focus()}findParent(t,i){for(const s of this.#r.values()){const{x:a,y:o,width:l,height:u}=s.div.getBoundingClientRect();if(t>=a&&t<=a+l&&i>=o&&i<=o+u)return s}return null}disableUserSelect(t=!1){this.#Z.classList.toggle("noUserSelect",t)}addShouldRescale(t){this.#p.add(t)}removeShouldRescale(t){this.#p.delete(t)}onScaleChanging({scale:t}){this.commitOrRemove(),this.viewParameters.realScale=t*da.PDF_TO_CSS_UNITS;for(const i of this.#p)i.onScaleChanging();this.#h?.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}#W({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t}#tt(t){const{currentLayer:i}=this;if(i.hasTextLayer(t))return i;for(const s of this.#r.values())if(s.hasTextLayer(t))return s;return null}highlightSelection(t="",i=!1){const s=document.getSelection();if(!s||s.isCollapsed)return;const{anchorNode:a,anchorOffset:o,focusNode:l,focusOffset:u}=s,h=s.toString(),p=this.#W(s).closest(".textLayer"),b=this.getSelectionBoxes(p);if(!b)return;s.empty();const v=this.#tt(p),A=this.#C===Tt.NONE,w=()=>{const S=v?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:b,anchorNode:a,anchorOffset:o,focusNode:l,focusOffset:u,text:h});A&&this.showAllEditors("highlight",!0,!0),i&&S?.editComment()};if(A){this.switchToMode(Tt.HIGHLIGHT,w);return}w()}commentSelection(t=""){this.highlightSelection(t,!0)}#rt(){const t=document.getSelection();if(!t||t.isCollapsed)return;const s=this.#W(t).closest(".textLayer"),a=this.getSelectionBoxes(s);a&&(this.#_||=new av(this),this.#_.show(s,a,this.direction==="ltr"))}getAndRemoveDataFromAnnotationStorage(t){if(!this.#a)return null;const i=`${mr}${t}`,s=this.#a.getRawValue(i);return s&&this.#a.remove(i),s}addToAnnotationStorage(t){!t.isEmpty()&&this.#a&&!this.#a.has(t.id)&&this.#a.setValue(t.id,t)}a11yAlert(t,i=null){const s=this.#J;s&&(s.setAttribute("data-l10n-id",t),i?s.setAttribute("data-l10n-args",JSON.stringify(i)):s.removeAttribute("data-l10n-args"))}#ot(){const t=document.getSelection();if(!t||t.isCollapsed){this.#O&&(this.#_?.hide(),this.#O=null,this.#R({hasSelectedText:!1}));return}const{anchorNode:i}=t;if(i===this.#O)return;const a=this.#W(t).closest(".textLayer");if(!a){this.#O&&(this.#_?.hide(),this.#O=null,this.#R({hasSelectedText:!1}));return}if(this.#_?.hide(),this.#O=i,this.#R({hasSelectedText:!0}),!(this.#C!==Tt.HIGHLIGHT&&this.#C!==Tt.NONE)&&(this.#C===Tt.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#S=this.isShiftKeyDown,!this.isShiftKeyDown)){const o=this.#C===Tt.HIGHLIGHT?this.#tt(a):null;if(o?.toggleDrawing(),this.#N){const l=new AbortController,u=this.combinedSignal(l),h=d=>{d.type==="pointerup"&&d.button!==0||(l.abort(),o?.toggleDrawing(!0),d.type==="pointerup"&&this.#K("main_toolbar"))};window.addEventListener("pointerup",h,{signal:u}),window.addEventListener("blur",h,{signal:u})}else o?.toggleDrawing(!0),this.#K("main_toolbar")}}#K(t=""){this.#C===Tt.HIGHLIGHT?this.highlightSelection(t):this.#b&&this.#rt()}#lt(){document.addEventListener("selectionchange",this.#ot.bind(this),{signal:this._signal})}#ct(){if(this.#x)return;this.#x=new AbortController;const t=this.combinedSignal(this.#x);window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})}#ut(){this.#x?.abort(),this.#x=null}blur(){if(this.isShiftKeyDown=!1,this.#S&&(this.#S=!1,this.#K("main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const i of this.#A)if(i.div.contains(t)){this.#L=[i,t],i._focusEventsAllowed=!1;break}}focus(){if(!this.#L)return;const[t,i]=this.#L;this.#L=null,i.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),i.focus()}#et(){if(this.#k)return;this.#k=new AbortController;const t=this.combinedSignal(this.#k);window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})}#ht(){this.#k?.abort(),this.#k=null}#it(){if(this.#d)return;this.#d=new AbortController;const t=this.combinedSignal(this.#d);document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})}#nt(){this.#d?.abort(),this.#d=null}#dt(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})}addEditListeners(){this.#et(),this.#it()}removeEditListeners(){this.#ht(),this.#nt()}dragOver(t){for(const{type:i}of t.dataTransfer.items)for(const s of this.#u)if(s.isHandlingMimeForPasting(i)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(const i of t.dataTransfer.items)for(const s of this.#u)if(s.isHandlingMimeForPasting(i.type)){s.paste(i,this.currentLayer),t.preventDefault();return}}copy(t){if(t.preventDefault(),this.#e?.commitOrRemove(),!this.hasSelection)return;const i=[];for(const s of this.#A){const a=s.serialize(!0);a&&i.push(a)}i.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(i))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:i}=t;for(const o of i.items)for(const l of this.#u)if(l.isHandlingMimeForPasting(o.type)){l.paste(o,this.currentLayer);return}let s=i.getData("application/pdfjs");if(!s)return;try{s=JSON.parse(s)}catch(o){Ct(`paste: "${o.message}".`);return}if(!Array.isArray(s))return;this.unselectAll();const a=this.currentLayer;try{const o=[];for(const h of s){const d=await a.deserialize(h);if(!d)return;o.push(d)}const l=()=>{for(const h of o)this.#st(h);this.#at(o)},u=()=>{for(const h of o)h.remove()};this.addCommands({cmd:l,undo:u,mustExec:!0})}catch(o){Ct(`paste: "${o.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),this.#C!==Tt.NONE&&!this.isEditorHandlingKeyboard&&Hn._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,this.#S&&(this.#S=!1,this.#K("main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}#R(t){Object.entries(t).some(([s,a])=>this.#$[s]!==a)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#$,t)}),this.#C===Tt.HIGHLIGHT&&t.hasSelectedEditor===!1&&this.#q([[Ft.HIGHLIGHT_FREE,!0]]))}#q(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})}setEditingState(t){t?(this.#ct(),this.#it(),this.#R({isEditing:this.#C!==Tt.NONE,isEmpty:this.#Q(),hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:this.#c.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#ut(),this.#nt(),this.#R({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!this.#u){this.#u=t;for(const i of this.#u)this.#q(i.defaultPropertiesToUpdate)}}getId(){return this.#M.id}get currentLayer(){return this.#r.get(this.#f)}getLayer(t){return this.#r.get(t)}get currentPageIndex(){return this.#f}addLayer(t){this.#r.set(t.pageIndex,t),this.#D?t.enable():t.disable()}removeLayer(t){this.#r.delete(t.pageIndex)}async updateMode(t,i=null,s=!1,a=!1,o=!1){if(this.#C!==t&&!(this.#I&&(await this.#I.promise,!this.#I))){if(this.#I=Promise.withResolvers(),this.#h?.commitOrRemove(),this.#C===Tt.POPUP&&this.#l?.hideSidebar(),this.#l?.destroyPopup(),this.#C=t,t===Tt.NONE){this.setEditingState(!1),this.#gt();for(const l of this.#i.values())l.hideStandaloneCommentButton();this._editorUndoBar?.hide(),this.toggleComment(null),this.#I.resolve();return}for(const l of this.#i.values())l.addStandaloneCommentButton();t===Tt.SIGNATURE&&await this.#z?.loadSignatures(),this.setEditingState(!0),await this.#ft(),this.unselectAll();for(const l of this.#r.values())l.updateMode(t);if(t===Tt.POPUP){this.#n||=await this.#Y.getAnnotationsByType(new Set(this.#u.map(h=>h._editorType)));const l=new Set,u=[];for(const h of this.#i.values()){const{annotationElementId:d,hasComment:p,deleted:b}=h;d&&l.add(d),p&&!b&&u.push(h.getData())}for(const h of this.#n){const{id:d,popupRef:p,contentsObj:b}=h;p&&b?.str&&!l.has(d)&&!this.#m.has(d)&&u.push(h)}this.#l?.showSidebar(u)}if(!i){s&&this.addNewEditorFromKeyboard(),this.#I.resolve();return}for(const l of this.#i.values())l.uid===i?(this.setSelected(l),o?l.editComment():a?l.enterInEditMode():l.focus()):l.unselect();this.#I.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t.mode!==this.#C&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...t})}updateParams(t,i){if(this.#u){switch(t){case Ft.CREATE:this.currentLayer.addNewEditor(i);return;case Ft.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#X||=new Map).set(t,i),this.showAllEditors("highlight",i);break}if(this.hasSelection)for(const s of this.#A)s.updateParams(t,i);else for(const s of this.#u)s.updateDefaultParams(t,i)}}showAllEditors(t,i,s=!1){for(const o of this.#i.values())o.editorType===t&&o.show(i);(this.#X?.get(Ft.HIGHLIGHT_SHOW_ALL)??!0)!==i&&this.#q([[Ft.HIGHLIGHT_SHOW_ALL,i]])}enableWaiting(t=!1){if(this.#P!==t){this.#P=t;for(const i of this.#r.values())t?i.disableClick():i.enableClick(),i.div.classList.toggle("waiting",t)}}async#ft(){if(!this.#D){this.#D=!0;const t=[];for(const i of this.#r.values())t.push(i.enable());await Promise.all(t);for(const i of this.#i.values())i.enable()}}#gt(){if(this.unselectAll(),this.#D){this.#D=!1;for(const t of this.#r.values())t.disable();for(const t of this.#i.values())t.disable()}}*getEditors(t){for(const i of this.#i.values())i.pageIndex===t&&(yield i)}getEditor(t){return this.#i.get(t)}addEditor(t){this.#i.set(t.id,t)}removeEditor(t){t.div.contains(document.activeElement)&&(this.#w&&clearTimeout(this.#w),this.#w=setTimeout(()=>{this.focusMainContainer(),this.#w=null},0)),this.#i.delete(t.id),t.annotationElementId&&this.#j?.delete(t.annotationElementId),this.unselect(t),(!t.annotationElementId||!this.#m.has(t.annotationElementId))&&this.#a?.remove(t.id)}addDeletedAnnotationElement(t){this.#m.add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return this.#m.has(t)}removeDeletedAnnotationElement(t){this.#m.delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}#st(t){const i=this.#r.get(t.pageIndex);i?i.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))}setActiveEditor(t){this.#e!==t&&(this.#e=t,t&&this.#q(t.propertiesToUpdate))}get#pt(){let t=null;for(t of this.#A);return t}updateUI(t){this.#pt===t&&this.#q(t.propertiesToUpdate)}updateUIForDefaultProperties(t){this.#q(t.defaultPropertiesToUpdate)}toggleSelected(t){if(this.#A.has(t)){this.#A.delete(t),t.unselect(),this.#R({hasSelectedEditor:this.hasSelection});return}this.#A.add(t),t.select(),this.#q(t.propertiesToUpdate),this.#R({hasSelectedEditor:!0})}setSelected(t){this.updateToolbar({mode:t.mode,editId:t.id}),this.#h?.commitOrRemove();for(const i of this.#A)i!==t&&i.unselect();this.#A.clear(),this.#A.add(t),t.select(),this.#q(t.propertiesToUpdate),this.#R({hasSelectedEditor:!0})}isSelected(t){return this.#A.has(t)}get firstSelectedEditor(){return this.#A.values().next().value}unselect(t){t.unselect(),this.#A.delete(t),this.#R({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#A.size!==0}get isEnterHandled(){return this.#A.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#c.undo(),this.#R({hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#Q()}),this._editorUndoBar?.hide()}redo(){this.#c.redo(),this.#R({hasSomethingToUndo:!0,hasSomethingToRedo:this.#c.hasSomethingToRedo(),isEmpty:this.#Q()})}addCommands(t){this.#c.add(t),this.#R({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#Q()})}cleanUndoStack(t){this.#c.cleanType(t)}#Q(){if(this.#i.size===0)return!0;if(this.#i.size===1)for(const t of this.#i.values())return t.isEmpty();return!1}delete(){this.commitOrRemove();const t=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!t)return;const i=t?[t]:[...this.#A],s=()=>{this._editorUndoBar?.show(a,i.length===1?i[0].editorType:i.length);for(const o of i)o.remove()},a=()=>{for(const o of i)this.#st(o)};this.addCommands({cmd:s,undo:a,mustExec:!0})}commitOrRemove(){this.#e?.commitOrRemove()}hasSomethingToControl(){return this.#e||this.hasSelection}#at(t){for(const i of this.#A)i.unselect();this.#A.clear();for(const i of t)i.isEmpty()||(this.#A.add(i),i.select());this.#R({hasSelectedEditor:this.hasSelection})}selectAll(){for(const t of this.#A)t.commit();this.#at(this.#i.values())}unselectAll(){if(!(this.#e&&(this.#e.commitOrRemove(),this.#C!==Tt.NONE))&&!this.#h?.commitOrRemove()&&this.hasSelection){for(const t of this.#A)t.unselect();this.#A.clear(),this.#R({hasSelectedEditor:!1})}}translateSelectedEditors(t,i,s=!1){if(s||this.commitOrRemove(),!this.hasSelection)return;this.#H[0]+=t,this.#H[1]+=i;const[a,o]=this.#H,l=[...this.#A],u=1e3;this.#B&&clearTimeout(this.#B),this.#B=setTimeout(()=>{this.#B=null,this.#H[0]=this.#H[1]=0,this.addCommands({cmd:()=>{for(const h of l)this.#i.has(h.id)&&(h.translateInPage(a,o),h.translationDone())},undo:()=>{for(const h of l)this.#i.has(h.id)&&(h.translateInPage(-a,-o),h.translationDone())},mustExec:!1})},u);for(const h of l)h.translateInPage(t,i),h.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#g=new Map;for(const t of this.#A)this.#g.set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#g)return!1;this.disableUserSelect(!1);const t=this.#g;this.#g=null;let i=!1;for(const[{x:a,y:o,pageIndex:l},u]of t)u.newX=a,u.newY=o,u.newPageIndex=l,i||=a!==u.savedX||o!==u.savedY||l!==u.savedPageIndex;if(!i)return!1;const s=(a,o,l,u)=>{if(this.#i.has(a.id)){const h=this.#r.get(u);h?a._setParentAndPosition(h,o,l):(a.pageIndex=u,a.x=o,a.y=l)}};return this.addCommands({cmd:()=>{for(const[a,{newX:o,newY:l,newPageIndex:u}]of t)s(a,o,l,u)},undo:()=>{for(const[a,{savedX:o,savedY:l,savedPageIndex:u}]of t)s(a,o,l,u)},mustExec:!0}),!0}dragSelectedEditors(t,i){if(this.#g)for(const s of this.#g.keys())s.drag(t,i)}rebuild(t){if(t.parent===null){const i=this.getLayer(t.pageIndex);i?(i.changeParent(t),i.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#A.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return this.#e===t}getActive(){return this.#e}getMode(){return this.#C}isEditingMode(){return this.#C!==Tt.NONE}get imageManager(){return Mt(this,"imageManager",new lh)}getSelectionBoxes(t){if(!t)return null;const i=document.getSelection();for(let d=0,p=i.rangeCount;d<p;d++)if(!t.contains(i.getRangeAt(d).commonAncestorContainer))return null;const{x:s,y:a,width:o,height:l}=t.getBoundingClientRect();let u;switch(t.getAttribute("data-main-rotation")){case"90":u=(d,p,b,v)=>({x:(p-a)/l,y:1-(d+b-s)/o,width:v/l,height:b/o});break;case"180":u=(d,p,b,v)=>({x:1-(d+b-s)/o,y:1-(p+v-a)/l,width:b/o,height:v/l});break;case"270":u=(d,p,b,v)=>({x:1-(p+v-a)/l,y:(d-s)/o,width:v/l,height:b/o});break;default:u=(d,p,b,v)=>({x:(d-s)/o,y:(p-a)/l,width:b/o,height:v/l});break}const h=[];for(let d=0,p=i.rangeCount;d<p;d++){const b=i.getRangeAt(d);if(!b.collapsed)for(const{x:v,y:A,width:w,height:S}of b.getClientRects())w===0||S===0||h.push(u(v,A,w,S))}return h.length===0?null:h}addChangedExistingAnnotation({annotationElementId:t,id:i}){(this.#o||=new Map).set(t,i)}removeChangedExistingAnnotation({annotationElementId:t}){this.#o?.delete(t)}renderAnnotationElement(t){const i=this.#o?.get(t.data.id);if(!i)return;const s=this.#a.getRawValue(i);s&&(this.#C===Tt.NONE&&!s.hasBeenModified||s.renderAnnotationElement(t))}setMissingCanvas(t,i,s){const a=this.#j?.get(t);a&&(a.setCanvas(i,s),this.#j.delete(t))}addMissingCanvas(t,i){(this.#j||=new Map).set(t,i)}}class qi{#t=null;#e=!1;#n=null;#i=null;#r=null;#s=null;#a=!1;#o=null;#c=null;#l=null;#d=null;#h=!1;static#f=null;static _l10n=null;constructor(t){this.#c=t,this.#h=t._uiManager.useNewAltTextFlow,qi.#f||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(t){qi._l10n??=t}async render(){const t=this.#n=document.createElement("button");t.className="altText",t.tabIndex="0";const i=this.#i=document.createElement("span");t.append(i),this.#h?(t.classList.add("new"),t.setAttribute("data-l10n-id",qi.#f.missing),i.setAttribute("data-l10n-id",qi.#f["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),i.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const s=this.#c._uiManager._signal;t.addEventListener("contextmenu",Ti,{signal:s}),t.addEventListener("pointerdown",o=>o.stopPropagation(),{signal:s});const a=o=>{o.preventDefault(),this.#c._uiManager.editAltText(this.#c),this.#h&&this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#m}})};return t.addEventListener("click",a,{capture:!0,signal:s}),t.addEventListener("keydown",o=>{o.target===t&&o.key==="Enter"&&(this.#a=!0,a(o))},{signal:s}),await this.#g(),t}get#m(){return this.#t&&"added"||this.#t===null&&this.guessedText&&"review"||"missing"}finish(){this.#n&&(this.#n.focus({focusVisible:this.#a}),this.#a=!1)}isEmpty(){return this.#h?this.#t===null:!this.#t&&!this.#e}hasData(){return this.#h?this.#t!==null||!!this.#l:this.isEmpty()}get guessedText(){return this.#l}async setGuessedText(t){this.#t===null&&(this.#l=t,this.#d=await qi._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t}),this.#g())}toggleAltTextBadge(t=!1){if(!this.#h||this.#t){this.#o?.remove(),this.#o=null;return}if(!this.#o){const i=this.#o=document.createElement("div");i.className="noAltTextBadge",this.#c.div.append(i)}this.#o.classList.toggle("hidden",!t)}serialize(t){let i=this.#t;return!t&&this.#l===i&&(i=this.#d),{altText:i,decorative:this.#e,guessedText:this.#l,textWithDisclaimer:this.#d}}get data(){return{altText:this.#t,decorative:this.#e}}set data({altText:t,decorative:i,guessedText:s,textWithDisclaimer:a,cancel:o=!1}){s&&(this.#l=s,this.#d=a),!(this.#t===t&&this.#e===i)&&(o||(this.#t=t,this.#e=i),this.#g())}toggle(t=!1){this.#n&&(!t&&this.#s&&(clearTimeout(this.#s),this.#s=null),this.#n.disabled=!t)}shown(){this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#m}})}destroy(){this.#n?.remove(),this.#n=null,this.#i=null,this.#r=null,this.#o?.remove(),this.#o=null}async#g(){const t=this.#n;if(!t)return;if(this.#h){if(t.classList.toggle("done",!!this.#t),t.setAttribute("data-l10n-id",qi.#f[this.#m]),this.#i?.setAttribute("data-l10n-id",qi.#f[`${this.#m}-label`]),!this.#t){this.#r?.remove();return}}else{if(!this.#t&&!this.#e){t.classList.remove("done"),this.#r?.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let i=this.#r;if(!i){this.#r=i=document.createElement("span"),i.className="tooltip",i.setAttribute("role","tooltip"),i.id=`alt-text-tooltip-${this.#c.id}`;const a=100,o=this.#c._uiManager._signal;o.addEventListener("abort",()=>{clearTimeout(this.#s),this.#s=null},{once:!0}),t.addEventListener("mouseenter",()=>{this.#s=setTimeout(()=>{this.#s=null,this.#r.classList.add("show"),this.#c._reportTelemetry({action:"alt_text_tooltip"})},a)},{signal:o}),t.addEventListener("mouseleave",()=>{this.#s&&(clearTimeout(this.#s),this.#s=null),this.#r?.classList.remove("show")},{signal:o})}this.#e?i.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(i.removeAttribute("data-l10n-id"),i.textContent=this.#t),i.parentNode||t.append(i),this.#c.getElementForAltText()?.setAttribute("aria-describedby",i.id)}}class Yo{#t=null;#e=null;#n=!1;#i=null;#r=null;#s=null;#a=null;#o=null;#c=!1;#l=null;constructor(t){this.#i=t}renderForToolbar(){const t=this.#e=document.createElement("button");return t.className="comment",this.#d(t,!1)}renderForStandalone(){const t=this.#t=document.createElement("button");t.className="annotationCommentButton";const i=this.#i.commentButtonPosition;if(i){const{style:s}=t;s.insetInlineEnd=`calc(${100*(this.#i._uiManager.direction==="ltr"?1-i[0]:i[0])}% - var(--comment-button-dim))`,s.top=`calc(${100*i[1]}% - var(--comment-button-dim))`;const a=this.#i.commentButtonColor;a&&(s.backgroundColor=a)}return this.#d(t,!0)}focusButton(){setTimeout(()=>{(this.#t??this.#e)?.focus()},0)}onUpdatedColor(){if(!this.#t)return;const t=this.#i.commentButtonColor;t&&(this.#t.style.backgroundColor=t),this.#i._uiManager.updatePopupColor(this.#i)}get commentButtonWidth(){return(this.#t?.getBoundingClientRect().width??0)/this.#i.parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(this.#l)return this.#l;if(!this.#t)return null;const{x:t,y:i,height:s}=this.#t.getBoundingClientRect(),{x:a,y:o,width:l,height:u}=this.#i.parent.boundingClientRect;return[(t-a)/l,(i+s-o)/u]}set commentPopupPositionInLayer(t){this.#l=t}hasDefaultPopupPosition(){return this.#l===null}removeStandaloneCommentButton(){this.#t?.remove(),this.#t=null}removeToolbarCommentButton(){this.#e?.remove(),this.#e=null}setCommentButtonStates({selected:t,hasPopup:i}){this.#t&&(this.#t.classList.toggle("selected",t),this.#t.ariaExpanded=i)}#d(t,i){if(!this.#i._uiManager.hasCommentManager())return null;t.tabIndex="0",t.ariaHasPopup="dialog",i?(t.ariaControls="commentPopup",t.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(t.ariaControlsElements=[this.#i._uiManager.getCommentDialogElement()],t.setAttribute("data-l10n-id","pdfjs-editor-edit-comment-button"));const s=this.#i._uiManager._signal;if(!(s instanceof AbortSignal)||s.aborted)return t;t.addEventListener("contextmenu",Ti,{signal:s}),i&&(t.addEventListener("focusin",o=>{this.#i._focusEventsAllowed=!1,ue(o)},{capture:!0,signal:s}),t.addEventListener("focusout",o=>{this.#i._focusEventsAllowed=!0,ue(o)},{capture:!0,signal:s})),t.addEventListener("pointerdown",o=>o.stopPropagation(),{signal:s});const a=o=>{o.preventDefault(),t===this.#e?this.edit():this.#i.toggleComment(!0)};return t.addEventListener("click",a,{capture:!0,signal:s}),t.addEventListener("keydown",o=>{o.target===t&&o.key==="Enter"&&(this.#n=!0,a(o))},{signal:s}),t.addEventListener("pointerenter",()=>{this.#i.toggleComment(!1,!0)},{signal:s}),t.addEventListener("pointerleave",()=>{this.#i.toggleComment(!1,!1)},{signal:s}),t}edit(t){const i=this.commentPopupPositionInLayer;let s,a;if(i)[s,a]=i;else{[s,a]=this.#i.commentButtonPosition;const{width:p,height:b,x:v,y:A}=this.#i;s=v+s*p,a=A+a*b}const o=this.#i.parent.boundingClientRect,{x:l,y:u,width:h,height:d}=o;this.#i._uiManager.editComment(this.#i,l+s*h,u+a*d,{...t,parentDimensions:o})}finish(){this.#e&&(this.#e.focus({focusVisible:this.#n}),this.#n=!1)}isDeleted(){return this.#c||this.#a===""}isEmpty(){return this.#a===null}hasBeenEdited(){return this.isDeleted()||this.#a!==this.#r}serialize(){return this.data}get data(){return{text:this.#a,richText:this.#s,date:this.#o,deleted:this.isDeleted()}}set data(t){if(t!==this.#a&&(this.#s=null),t===null){this.#a="",this.#c=!0;return}this.#a=t,this.#o=new Date,this.#c=!1}setInitialText(t,i=null){this.#r=t,this.data=t,this.#o=null,this.#s=i}shown(){}destroy(){this.#e?.remove(),this.#e=null,this.#t?.remove(),this.#t=null,this.#a="",this.#s=null,this.#o=null,this.#i=null,this.#n=!1,this.#c=!1}}class fl{#t;#e=!1;#n=null;#i;#r;#s;#a;#o=null;#c;#l=null;#d;#h=null;constructor({container:t,isPinchingDisabled:i=null,isPinchingStopped:s=null,onPinchStart:a=null,onPinching:o=null,onPinchEnd:l=null,signal:u}){this.#t=t,this.#n=s,this.#i=i,this.#r=a,this.#s=o,this.#a=l,this.#d=new AbortController,this.#c=AbortSignal.any([u,this.#d.signal]),t.addEventListener("touchstart",this.#f.bind(this),{passive:!1,signal:this.#c})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/Gi.pixelRatio}#f(t){if(this.#i?.())return;if(t.touches.length===1){if(this.#o)return;const a=this.#o=new AbortController,o=AbortSignal.any([this.#c,a.signal]),l=this.#t,u={capture:!0,signal:o,passive:!1},h=d=>{d.pointerType==="touch"&&(this.#o?.abort(),this.#o=null)};l.addEventListener("pointerdown",d=>{d.pointerType==="touch"&&(ue(d),h(d))},u),l.addEventListener("pointerup",h,u),l.addEventListener("pointercancel",h,u);return}if(!this.#h){this.#h=new AbortController;const a=AbortSignal.any([this.#c,this.#h.signal]),o=this.#t,l={signal:a,capture:!1,passive:!1};o.addEventListener("touchmove",this.#m.bind(this),l);const u=this.#g.bind(this);o.addEventListener("touchend",u,l),o.addEventListener("touchcancel",u,l),l.capture=!0,o.addEventListener("pointerdown",ue,l),o.addEventListener("pointermove",ue,l),o.addEventListener("pointercancel",ue,l),o.addEventListener("pointerup",ue,l),this.#r?.()}if(ue(t),t.touches.length!==2||this.#n?.()){this.#l=null;return}let[i,s]=t.touches;i.identifier>s.identifier&&([i,s]=[s,i]),this.#l={touch0X:i.screenX,touch0Y:i.screenY,touch1X:s.screenX,touch1Y:s.screenY}}#m(t){if(!this.#l||t.touches.length!==2)return;ue(t);let[i,s]=t.touches;i.identifier>s.identifier&&([i,s]=[s,i]);const{screenX:a,screenY:o}=i,{screenX:l,screenY:u}=s,h=this.#l,{touch0X:d,touch0Y:p,touch1X:b,touch1Y:v}=h,A=b-d,w=v-p,S=l-a,C=u-o,E=Math.hypot(S,C)||1,k=Math.hypot(A,w)||1;if(!this.#e&&Math.abs(k-E)<=fl.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(h.touch0X=a,h.touch0Y=o,h.touch1X=l,h.touch1Y=u,!this.#e){this.#e=!0;return}const O=[(a+l)/2,(o+u)/2];this.#s?.(O,k,E)}#g(t){t.touches.length>=2||(this.#h&&(this.#h.abort(),this.#h=null,this.#a?.()),this.#l&&(ue(t),this.#l=null,this.#e=!1))}destroy(){this.#d?.abort(),this.#d=null,this.#o?.abort(),this.#o=null}}class vt{#t=null;#e=null;#n=null;#i=null;#r=null;#s=!1;#a=null;#o="";#c=null;#l=null;#d=null;#h=null;#f=null;#m="";#g=!1;#u=null;#p=!1;#b=!1;#v=!1;#y=null;#E=0;#w=0;#x=null;#T=null;isSelected=!1;_isCopy=!1;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#S=!1;#_=vt._zIndex++;static _borderLineWidth=-1;static _colorManager=new ch;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const t=vt.prototype._resizeWithKeyboard,i=Hn.TRANSLATE_SMALL,s=Hn.TRANSLATE_BIG;return Mt(this,"_resizerKeyboardManager",new Er([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-i,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-s,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[i,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[s,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-i]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-s]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,i]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,s]}],[["Escape","mac+Escape"],vt.prototype._stopResizingWithKeyboard]]))}constructor(t){this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null,this.annotationElementId=t.annotationElementId||null,this.creationDate=t.creationDate||new Date,this.modificationDate=t.modificationDate||null;const{rotation:i,rawDims:{pageWidth:s,pageHeight:a,pageX:o,pageY:l}}=this.parent.viewport;this.rotation=i,this.pageRotation=(360+i-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[s,a],this.pageTranslation=[o,l];const[u,h]=this.parentDimensions;this.x=t.x/u,this.y=t.y/h,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return Mt(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const i=new lv({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});i.annotationElementId=t.annotationElementId,i.deleted=!0,i._uiManager.addToAnnotationStorage(i)}static initialize(t,i){if(vt._l10n??=t,vt._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),vt._borderLineWidth!==-1)return;const s=getComputedStyle(document.documentElement);vt._borderLineWidth=parseFloat(s.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,i){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,i){Jt("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#S}set _isDraggable(t){this.#S=t,this.div?.classList.toggle("draggable",t)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[t,i]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*i/(t*2),this.y+=this.width*t/(i*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*i/(t*2),this.y-=this.width*t/(i*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#_}setParent(t){t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):(this.#B(),this.#h?.remove(),this.#h=null),this.parent=t}focusin(t){this._focusEventsAllowed&&(this.#g?this.#g=!1:this.parent.setSelected(this))}focusout(t){!this._focusEventsAllowed||!this.isAttachedToDOM||t.relatedTarget?.closest(`#${this.id}`)||(t.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,i,s,a){const[o,l]=this.parentDimensions;[s,a]=this.screenToPageTranslation(s,a),this.x=(t+s)/o,this.y=(i+a)/l,this.fixAndSetPosition()}_moveAfterPaste(t,i){const[s,a]=this.parentDimensions;this.setAt(t*s,i*a,this.width*s,this.height*a),this._onTranslated()}#M([t,i],s,a){[s,a]=this.screenToPageTranslation(s,a),this.x+=s/t,this.y+=a/i,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(t,i){this.#M(this.parentDimensions,t,i)}translateInPage(t,i){this.#u||=[this.x,this.y,this.width,this.height],this.#M(this.pageDimensions,t,i),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(t,i){this.#u||=[this.x,this.y,this.width,this.height];const{div:s,parentDimensions:[a,o]}=this;if(this.x+=t/a,this.y+=i/o,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:b,y:v}=this.div.getBoundingClientRect();this.parent.findNewParent(this,b,v)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:l,y:u}=this;const[h,d]=this.getBaseTranslation();l+=h,u+=d;const{style:p}=s;p.left=`${(100*l).toFixed(2)}%`,p.top=`${(100*u).toFixed(2)}%`,this._onTranslating(l,u),s.scrollIntoView({block:"nearest"})}_onTranslating(t,i){}_onTranslated(t,i){}get _hasBeenMoved(){return!!this.#u&&(this.#u[0]!==this.x||this.#u[1]!==this.y)}get _hasBeenResized(){return!!this.#u&&(this.#u[2]!==this.width||this.#u[3]!==this.height)}getBaseTranslation(){const[t,i]=this.parentDimensions,{_borderLineWidth:s}=vt,a=s/t,o=s/i;switch(this.rotation){case 90:return[-a,o];case 180:return[a,o];case 270:return[a,-o];default:return[-a,-o]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const{div:{style:i},pageDimensions:[s,a]}=this;let{x:o,y:l,width:u,height:h}=this;if(u*=s,h*=a,o*=s,l*=a,this._mustFixPosition)switch(t){case 0:o=Ue(o,0,s-u),l=Ue(l,0,a-h);break;case 90:o=Ue(o,0,s-h),l=Ue(l,u,a);break;case 180:o=Ue(o,u,s),l=Ue(l,h,a);break;case 270:o=Ue(o,h,s),l=Ue(l,0,a-u);break}this.x=o/=s,this.y=l/=a;const[d,p]=this.getBaseTranslation();o+=d,l+=p,i.left=`${(100*o).toFixed(2)}%`,i.top=`${(100*l).toFixed(2)}%`,this.moveInDOM()}static#D(t,i,s){switch(s){case 90:return[i,-t];case 180:return[-t,-i];case 270:return[-i,t];default:return[t,i]}}screenToPageTranslation(t,i){return vt.#D(t,i,this.parentRotation)}pageTranslationToScreen(t,i){return vt.#D(t,i,360-this.parentRotation)}#N(t){switch(t){case 90:{const[i,s]=this.pageDimensions;return[0,-i/s,s/i,0]}case 180:return[-1,0,0,-1];case 270:{const[i,s]=this.pageDimensions;return[0,i/s,-s/i,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[i,s]}=this;return[i*t,s*t]}setDims(){const{div:{style:t},width:i,height:s}=this;t.width=`${(100*i).toFixed(2)}%`,t.height=`${(100*s).toFixed(2)}%`}getInitialTranslation(){return[0,0]}#P(){if(this.#c)return;this.#c=document.createElement("div"),this.#c.classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],i=this._uiManager._signal;for(const s of t){const a=document.createElement("div");this.#c.append(a),a.classList.add("resizer",s),a.setAttribute("data-resizer-name",s),a.addEventListener("pointerdown",this.#k.bind(this,s),{signal:i}),a.addEventListener("contextmenu",Ti,{signal:i}),a.tabIndex=-1}this.div.prepend(this.#c)}#k(t,i){i.preventDefault();const{isMac:s}=Le.platform;if(i.button!==0||i.ctrlKey&&s)return;this.#n?.toggle(!1);const a=this._isDraggable;this._isDraggable=!1,this.#l=[i.screenX,i.screenY];const o=new AbortController,l=this._uiManager.combinedSignal(o);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#j.bind(this,t),{passive:!0,capture:!0,signal:l}),window.addEventListener("touchmove",ue,{passive:!1,signal:l}),window.addEventListener("contextmenu",Ti,{signal:l}),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const u=this.parent.div.style.cursor,h=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(i.target).cursor;const d=()=>{o.abort(),this.parent.togglePointerEvents(!0),this.#n?.toggle(!0),this._isDraggable=a,this.parent.div.style.cursor=u,this.div.style.cursor=h,this.#F()};window.addEventListener("pointerup",d,{signal:l}),window.addEventListener("blur",d,{signal:l})}#L(t,i,s,a){this.width=s,this.height=a,this.x=t,this.y=i,this.setDims(),this.fixAndSetPosition(),this._onResized()}_onResized(){}#F(){if(!this.#d)return;const{savedX:t,savedY:i,savedWidth:s,savedHeight:a}=this.#d;this.#d=null;const o=this.x,l=this.y,u=this.width,h=this.height;o===t&&l===i&&u===s&&h===a||this.addCommands({cmd:this.#L.bind(this,o,l,u,h),undo:this.#L.bind(this,t,i,s,a),mustExec:!0})}static _round(t){return Math.round(t*1e4)/1e4}#j(t,i){const[s,a]=this.parentDimensions,o=this.x,l=this.y,u=this.width,h=this.height,d=vt.MIN_SIZE/s,p=vt.MIN_SIZE/a,b=this.#N(this.rotation),v=(F,q)=>[b[0]*F+b[2]*q,b[1]*F+b[3]*q],A=this.#N(360-this.rotation),w=(F,q)=>[A[0]*F+A[2]*q,A[1]*F+A[3]*q];let S,C,E=!1,k=!1;switch(t){case"topLeft":E=!0,S=(F,q)=>[0,0],C=(F,q)=>[F,q];break;case"topMiddle":S=(F,q)=>[F/2,0],C=(F,q)=>[F/2,q];break;case"topRight":E=!0,S=(F,q)=>[F,0],C=(F,q)=>[0,q];break;case"middleRight":k=!0,S=(F,q)=>[F,q/2],C=(F,q)=>[0,q/2];break;case"bottomRight":E=!0,S=(F,q)=>[F,q],C=(F,q)=>[0,0];break;case"bottomMiddle":S=(F,q)=>[F/2,q],C=(F,q)=>[F/2,0];break;case"bottomLeft":E=!0,S=(F,q)=>[0,q],C=(F,q)=>[F,0];break;case"middleLeft":k=!0,S=(F,q)=>[0,q/2],C=(F,q)=>[F,q/2];break}const O=S(u,h),P=C(u,h);let z=v(...P);const L=vt._round(o+z[0]),j=vt._round(l+z[1]);let D=1,N=1,U,$;if(i.fromKeyboard)({deltaX:U,deltaY:$}=i);else{const{screenX:F,screenY:q}=i,[et,it]=this.#l;[U,$]=this.screenToPageTranslation(F-et,q-it),this.#l[0]=F,this.#l[1]=q}if([U,$]=w(U/s,$/a),E){const F=Math.hypot(u,h);D=N=Math.max(Math.min(Math.hypot(P[0]-O[0]-U,P[1]-O[1]-$)/F,1/u,1/h),d/u,p/h)}else k?D=Ue(Math.abs(P[0]-O[0]-U),d,1)/u:N=Ue(Math.abs(P[1]-O[1]-$),p,1)/h;const tt=vt._round(u*D),at=vt._round(h*N);z=v(...C(tt,at));const gt=L-z[0],bt=j-z[1];this.#u||=[this.x,this.y,this.width,this.height],this.width=tt,this.height=at,this.x=gt,this.y=bt,this.setDims(),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#n?.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||this.#b)return this._editToolbar;this._editToolbar=new pr(this),this.div.append(this._editToolbar.render());const{toolbarButtons:t}=this;if(t)for(const[i,s]of t)await this._editToolbar.addButton(i,s);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){this._editToolbar?.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){this._editToolbar?.removeButton("comment")}removeEditToolbar(){this._editToolbar?.remove(),this._editToolbar=null,this.#n?.destroy()}addContainer(t){const i=this._editToolbar?.div;i?i.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return this.#n||(qi.initialize(vt._l10n),this.#n=new qi(this),this.#t&&(this.#n.data=this.#t,this.#t=null)),this.#n}get altTextData(){return this.#n?.data}set altTextData(t){this.#n&&(this.#n.data=t)}get guessedAltText(){return this.#n?.guessedText}async setGuessedAltText(t){await this.#n?.setGuessedText(t)}serializeAltText(t){return this.#n?.serialize(t)}hasAltText(){return!!this.#n&&!this.#n.isEmpty()}hasAltTextData(){return this.#n?.hasData()??!1}focusCommentButton(){this.#i?.focusButton()}addCommentButton(){return this.#i||=new Yo(this)}addStandaloneCommentButton(){if(this.#r){this._uiManager.isEditingMode()&&this.#r.classList.remove("hidden");return}this.hasComment&&(this.#r=this.#i.renderForStandalone(),this.div.append(this.#r))}removeStandaloneCommentButton(){this.#i.removeStandaloneCommentButton(),this.#r=null}hideStandaloneCommentButton(){this.#r?.classList.add("hidden")}get comment(){const{data:{richText:t,text:i,date:s,deleted:a}}=this.#i;return{text:i,richText:t,date:s,deleted:a,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(t){this.#i||=new Yo(this),this.#i.data=t,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:t,popupRef:i,richText:s}){if(!i||(this.#i||=new Yo(this),this.#i.setInitialText(t,s),!this.annotationElementId))return;const a=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);a&&this.updateFromAnnotationLayer(a)}get hasEditedComment(){return this.#i?.hasBeenEdited()}get hasDeletedComment(){return this.#i?.isDeleted()}get hasComment(){return!!this.#i&&!this.#i.isEmpty()&&!this.#i.isDeleted()}async editComment(t){this.#i||=new Yo(this),this.#i.edit(t)}toggleComment(t,i=void 0){this.hasComment&&this._uiManager.toggleComment(this,t,i)}setSelectedCommentButton(t){this.#i.setSelectedButton(t)}addComment(t){if(this.hasEditedComment){const[,,,a]=t.rect,[o]=this.pageDimensions,[l]=this.pageTranslation,u=l+o+1,h=a-100,d=u+180;t.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[u,h,d,a]}}}updateFromAnnotationLayer({popup:{contents:t,deleted:i}}){this.#i.data=i?null:t}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){const t=this.div=document.createElement("div");t.setAttribute("data-editor-rotation",(360-this.rotation)%360),t.className=this.name,t.setAttribute("id",this.id),t.tabIndex=this.#s?-1:0,t.setAttribute("role","application"),this.defaultL10nId&&t.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||t.classList.add("hidden"),this.setInForeground(),this.#U();const[i,s]=this.parentDimensions;this.parentRotation%180!==0&&(t.style.maxWidth=`${(100*s/i).toFixed(2)}%`,t.style.maxHeight=`${(100*i/s).toFixed(2)}%`);const[a,o]=this.getInitialTranslation();return this.translate(a,o),pm(this,t,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#T||=new fl({container:t,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#G.bind(this),onPinching:this.#C.bind(this),onPinchEnd:this.#A.bind(this),signal:this._uiManager._signal})),this.addStandaloneCommentButton(),this._uiManager._editorUndoBar?.hide(),t}#G(){this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#n?.toggle(!1),this.parent.togglePointerEvents(!1)}#C(t,i,s){let o=.7*(s/i)+1-.7;if(o===1)return;const l=this.#N(this.rotation),u=(L,j)=>[l[0]*L+l[2]*j,l[1]*L+l[3]*j],[h,d]=this.parentDimensions,p=this.x,b=this.y,v=this.width,A=this.height,w=vt.MIN_SIZE/h,S=vt.MIN_SIZE/d;o=Math.max(Math.min(o,1/v,1/A),w/v,S/A);const C=vt._round(v*o),E=vt._round(A*o);if(C===v&&E===A)return;this.#u||=[p,b,v,A];const k=u(v/2,A/2),O=vt._round(p+k[0]),P=vt._round(b+k[1]),z=u(C/2,E/2);this.x=O-z[0],this.y=P-z[1],this.width=C,this.height=E,this.setDims(),this.fixAndSetPosition(),this._onResizing()}#A(){this.#n?.toggle(!0),this.parent.togglePointerEvents(!0),this.#F()}pointerdown(t){const{isMac:i}=Le.platform;if(t.button!==0||t.ctrlKey&&i){t.preventDefault();return}if(this.#g=!0,this._isDraggable){this.#z(t);return}this.#O(t)}#O(t){const{isMac:i}=Le.platform;t.ctrlKey&&!i||t.shiftKey||t.metaKey&&i?this.parent.toggleSelected(this):this.parent.setSelected(this)}#z(t){const{isSelected:i}=this;this._uiManager.setUpDragSession();let s=!1;const a=new AbortController,o=this._uiManager.combinedSignal(a),l={capture:!0,passive:!1,signal:o},u=d=>{a.abort(),this.#a=null,this.#g=!1,this._uiManager.endDragSession()||this.#O(d),s&&this._onStopDragging()};i&&(this.#E=t.clientX,this.#w=t.clientY,this.#a=t.pointerId,this.#o=t.pointerType,window.addEventListener("pointermove",d=>{s||(s=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:p,clientY:b,pointerId:v}=d;if(v!==this.#a){ue(d);return}const[A,w]=this.screenToPageTranslation(p-this.#E,b-this.#w);this.#E=p,this.#w=b,this._uiManager.dragSelectedEditors(A,w)},l),window.addEventListener("touchmove",ue,l),window.addEventListener("pointerdown",d=>{d.pointerType===this.#o&&(this.#T||d.isPrimary)&&u(d),ue(d)},l));const h=d=>{if(!this.#a||this.#a===d.pointerId){u(d);return}ue(d)};window.addEventListener("pointerup",h,{signal:o}),window.addEventListener("blur",h,{signal:o})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#y&&clearTimeout(this.#y),this.#y=setTimeout(()=>{this.#y=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(t,i,s){t.changeParent(this),this.x=i,this.y=s,this.fixAndSetPosition(),this._onTranslated()}getRect(t,i,s=this.rotation){const a=this.parentScale,[o,l]=this.pageDimensions,[u,h]=this.pageTranslation,d=t/a,p=i/a,b=this.x*o,v=this.y*l,A=this.width*o,w=this.height*l;switch(s){case 0:return[b+d+u,l-v-p-w+h,b+d+A+u,l-v-p+h];case 90:return[b+p+u,l-v+d+h,b+p+w+u,l-v+d+A+h];case 180:return[b-d-A+u,l-v+p+h,b-d+u,l-v+p+w+h];case 270:return[b-p-w+u,l-v-d-A+h,b-p+u,l-v-d+h];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,i){const[s,a,o,l]=t,u=o-s,h=l-a;switch(this.rotation){case 0:return[s,i-l,u,h];case 90:return[s,i-a,h,u];case 180:return[o,i-a,u,h];case 270:return[o,i-l,h,u];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&vt._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){this.#i?.onUpdatedColor()}getData(){const{comment:{text:t,color:i,date:s,opacity:a,deleted:o,richText:l},uid:u,pageIndex:h,creationDate:d,modificationDate:p}=this;return{id:u,pageIndex:h,rect:this.getPDFRect(),richText:l,contentsObj:{str:t},creationDate:d,modificationDate:s||p,popupRef:!o,color:i,opacity:a}}onceAdded(t){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),this.#b=!0,!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),this.#b=!1,!0):!1}isInEditMode(){return this.#b}shouldGetKeyboardEvents(){return this.#v}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:t,left:i,bottom:s,right:a}=this.getClientDimensions(),{innerHeight:o,innerWidth:l}=window;return i<l&&a>0&&t<o&&s>0}#U(){if(this.#f||!this.div)return;this.#f=new AbortController;const t=this._uiManager.combinedSignal(this.#f);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})}rebuild(){this.#U()}rotate(t){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(t=!1,i=null){return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:this._initialData?.popupRef||""}}static async deserialize(t,i,s){const a=new this.prototype.constructor({parent:i,id:i.getNextId(),uiManager:s,annotationElementId:t.annotationElementId,creationDate:t.creationDate,modificationDate:t.modificationDate});a.rotation=t.rotation,a.#t=t.accessibilityData,a._isCopy=t.isCopy||!1;const[o,l]=a.pageDimensions,[u,h,d,p]=a.getRectInCurrentCoords(t.rect,l);return a.x=u/o,a.y=h/l,a.width=d/o,a.height=p/l,a}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#f?.abort(),this.#f=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#y&&(clearTimeout(this.#y),this.#y=null),this.#B(),this.removeEditToolbar(),this.#x){for(const t of this.#x.values())clearTimeout(t);this.#x=null}this.parent=null,this.#T?.destroy(),this.#T=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#P(),this.#c.classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction==="ltr"?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[t,i]}=this,[s,a,o,l]=this.getPDFRect();return[vt._round(s+(o-s)*t),vt._round(a+(l-a)*(1-i))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return this.#i.commentPopupPositionInLayer}set commentPopupPosition(t){this.#i.commentPopupPositionInLayer=t}hasDefaultPopupPosition(){return this.#i.hasDefaultPopupPosition()}get commentButtonWidth(){return this.#i.commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(t){this.#i.setCommentButtonStates(t)}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const i=this.#c.children;if(!this.#e){this.#e=Array.from(i);const l=this.#X.bind(this),u=this.#Y.bind(this),h=this._uiManager._signal;for(const d of this.#e){const p=d.getAttribute("data-resizer-name");d.setAttribute("role","spinbutton"),d.addEventListener("keydown",l,{signal:h}),d.addEventListener("blur",u,{signal:h}),d.addEventListener("focus",this.#$.bind(this,p),{signal:h}),d.setAttribute("data-l10n-id",vt._l10nResizer[p])}}const s=this.#e[0];let a=0;for(const l of i){if(l===s)break;a++}const o=(360-this.rotation+this.parentRotation)%360/90*(this.#e.length/4);if(o!==a){if(o<a)for(let u=0;u<a-o;u++)this.#c.append(this.#c.firstChild);else if(o>a)for(let u=0;u<o-a;u++)this.#c.firstChild.before(this.#c.lastChild);let l=0;for(const u of i){const d=this.#e[l++].getAttribute("data-resizer-name");u.setAttribute("data-l10n-id",vt._l10nResizer[d])}}this.#H(0),this.#v=!0,this.#c.firstChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}#X(t){vt._resizerKeyboardManager.exec(this,t)}#Y(t){this.#v&&t.relatedTarget?.parentNode!==this.#c&&this.#B()}#$(t){this.#m=this.#v?t:""}#H(t){if(this.#e)for(const i of this.#e)i.tabIndex=t}_resizeWithKeyboard(t,i){this.#v&&this.#j(this.#m,{deltaX:t,deltaY:i,fromKeyboard:!0})}#B(){this.#v=!1,this.#H(-1),this.#F()}_stopResizingWithKeyboard(){this.#B(),this.div.focus()}select(){if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#n?.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>this.div?.focus({preventScroll:!0}),0)}unselect(){this.isSelected&&(this.isSelected=!1,this.#c?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#n?.toggleAltTextBadge(!0),this.hasComment&&this._uiManager.toggleComment(this,!1,!1))}updateParams(t,i){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(t){t.target.nodeName!=="BUTTON"&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.id}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return this.#p}set isEditing(t){this.#p=t,this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,i=!1){if(i){this.#x||=new Map;const{action:s}=t;let a=this.#x.get(s);a&&clearTimeout(a),a=setTimeout(()=>{this._reportTelemetry(t),this.#x.delete(s),this.#x.size===0&&(this.#x=null)},vt._telemetryTimeout),this.#x.set(s,a);return}t.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),this.#s=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#s=!0}updateFakeAnnotationElement(t){if(!this.#h&&!this.deleted){this.#h=t.addFakeAnnotation(this);return}if(this.deleted){this.#h.remove(),this.#h=null;return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&this.#h.updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;let i=t.container.querySelector(".annotationContent");if(!i)i=document.createElement("div"),i.classList.add("annotationContent",this.editorType),t.container.prepend(i);else if(i.nodeName==="CANVAS"){const s=i;i=document.createElement("div"),i.classList.add("annotationContent",this.editorType),s.before(i)}return i}resetAnnotationElement(t){const{firstChild:i}=t.container;i?.nodeName==="DIV"&&i.classList.contains("annotationContent")&&i.remove()}}class lv extends vt{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const Fp=3285377520,_i=4294901760,Ui=65535;class mm{constructor(t){this.h1=t?t&4294967295:Fp,this.h2=t?t&4294967295:Fp}update(t){let i,s;if(typeof t=="string"){i=new Uint8Array(t.length*2),s=0;for(let S=0,C=t.length;S<C;S++){const E=t.charCodeAt(S);E<=255?i[s++]=E:(i[s++]=E>>>8,i[s++]=E&255)}}else if(ArrayBuffer.isView(t))i=t.slice(),s=i.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const a=s>>2,o=s-a*4,l=new Uint32Array(i.buffer,0,a);let u=0,h=0,d=this.h1,p=this.h2;const b=3432918353,v=461845907,A=b&Ui,w=v&Ui;for(let S=0;S<a;S++)S&1?(u=l[S],u=u*b&_i|u*A&Ui,u=u<<15|u>>>17,u=u*v&_i|u*w&Ui,d^=u,d=d<<13|d>>>19,d=d*5+3864292196):(h=l[S],h=h*b&_i|h*A&Ui,h=h<<15|h>>>17,h=h*v&_i|h*w&Ui,p^=h,p=p<<13|p>>>19,p=p*5+3864292196);switch(u=0,o){case 3:u^=i[a*4+2]<<16;case 2:u^=i[a*4+1]<<8;case 1:u^=i[a*4],u=u*b&_i|u*A&Ui,u=u<<15|u>>>17,u=u*v&_i|u*w&Ui,a&1?d^=u:p^=u}this.h1=d,this.h2=p}hexdigest(){let t=this.h1,i=this.h2;return t^=i>>>1,t=t*3981806797&_i|t*36045&Ui,i=i*4283543511&_i|((i<<16|t>>>16)*2950163797&_i)>>>16,t^=i>>>1,t=t*444984403&_i|t*60499&Ui,i=i*3301882366&_i|((i<<16|t>>>16)*3120437893&_i)>>>16,t^=i>>>1,(t>>>0).toString(16).padStart(8,"0")+(i>>>0).toString(16).padStart(8,"0")}}const $u=Object.freeze({map:null,hash:"",transfer:void 0});class uh{#t=!1;#e=null;#n=null;#i=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,i){const s=this.#i.get(t);return s===void 0?i:Object.assign(i,s)}getRawValue(t){return this.#i.get(t)}remove(t){const i=this.#i.get(t);if(i!==void 0&&(i instanceof vt&&this.#n.delete(i.annotationElementId),this.#i.delete(t),this.#i.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function")){for(const s of this.#i.values())if(s instanceof vt)return;this.onAnnotationEditor(null)}}setValue(t,i){const s=this.#i.get(t);let a=!1;if(s!==void 0)for(const[o,l]of Object.entries(i))s[o]!==l&&(a=!0,s[o]=l);else a=!0,this.#i.set(t,i);a&&this.#r(),i instanceof vt&&((this.#n||=new Map).set(i.annotationElementId,i),typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(i.constructor._type))}has(t){return this.#i.has(t)}get size(){return this.#i.size}#r(){this.#t||(this.#t=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#t&&(this.#t=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new bm(this)}get serializable(){if(this.#i.size===0)return $u;const t=new Map,i=new mm,s=[],a=Object.create(null);let o=!1;for(const[l,u]of this.#i){const h=u instanceof vt?u.serialize(!1,a):u;h&&(t.set(l,h),i.update(`${l}:${JSON.stringify(h)}`),o||=!!h.bitmap)}if(o)for(const l of t.values())l.bitmap&&s.push(l.bitmap);return t.size>0?{map:t,hash:i.hexdigest(),transfer:s}:$u}get editorStats(){let t=null;const i=new Map;let s=0,a=0;for(const o of this.#i.values()){if(!(o instanceof vt)){o.popup&&(o.popup.deleted?a+=1:s+=1);continue}o.isCommentDeleted?a+=1:o.hasEditedComment&&(s+=1);const l=o.telemetryFinalData;if(!l)continue;const{type:u}=l;i.has(u)||i.set(u,Object.getPrototypeOf(o).constructor),t||=Object.create(null);const h=t[u]||=new Map;for(const[d,p]of Object.entries(l)){if(d==="type")continue;let b=h.get(d);b||(b=new Map,h.set(d,b));const v=b.get(p)??0;b.set(p,v+1)}}if((a>0||s>0)&&(t||=Object.create(null),t.comments={deleted:a,edited:s}),!t)return null;for(const[o,l]of i)t[o]=l.computeTelemetryFinalData(t[o]);return t}resetModifiedIds(){this.#e=null}updateEditor(t,i){const s=this.#n?.get(t);return s?(s.updateFromAnnotationLayer(i),!0):!1}getEditor(t){return this.#n?.get(t)||null}get modifiedIds(){if(this.#e)return this.#e;const t=[];if(this.#n)for(const i of this.#n.values())i.serialize()&&t.push(i.annotationElementId);return this.#e={ids:new Set(t),hash:t.join(",")}}[Symbol.iterator](){return this.#i.entries()}}class bm extends uh{#t;constructor(t){super();const{map:i,hash:s,transfer:a}=t.serializable,o=structuredClone(i,a?{transfer:a}:null);this.#t={map:o,hash:s,transfer:a}}get print(){Jt("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#t}get modifiedIds(){return Mt(this,"modifiedIds",{ids:new Set,hash:""})}}class cv{#t=new Set;constructor({ownerDocument:t=globalThis.document,styleElement:i=null}){this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const i=this.styleElement.sheet;i.insertRule(t,i.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),this.#t.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,disableFontFace:i,_inspectFont:s}){if(!(!t||this.#t.has(t.loadedName))){if(zt(!i,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:a,src:o,style:l}=t,u=new FontFace(a,o,l);this.addNativeFontFace(u);try{await u.load(),this.#t.add(a),s?.(t)}catch{Ct(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(u)}return}Jt("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const s=t.createNativeFontFace();if(s){this.addNativeFontFace(s);try{await s.loaded}catch(a){throw Ct(`Failed to load font '${s.family}': '${a}'.`),t.disableFontFace=!0,a}}return}const i=t.createFontFaceRule();if(i){if(this.insertRule(i),this.isSyncFontLoadingSupported)return;await new Promise(s=>{const a=this._queueLoadingCallback(s);this._prepareFontLoadEvent(t,a)})}}get isFontLoadingAPISupported(){const t=!!this._document?.fonts;return Mt(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){return Mt(this,"isSyncFontLoadingSupported",Ie||Le.platform.isFirefox)}_queueLoadingCallback(t){function i(){for(zt(!a.done,"completeRequest() cannot be called twice."),a.done=!0;s.length>0&&s[0].done;){const o=s.shift();setTimeout(o.callback,0)}}const{loadingRequests:s}=this,a={done:!1,complete:i,callback:t};return s.push(a),a}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return Mt(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,i){function s(P,z){return P.charCodeAt(z)<<24|P.charCodeAt(z+1)<<16|P.charCodeAt(z+2)<<8|P.charCodeAt(z+3)&255}function a(P,z,L,j){const D=P.substring(0,z),N=P.substring(z+L);return D+j+N}let o,l;const u=this._document.createElement("canvas");u.width=1,u.height=1;const h=u.getContext("2d");let d=0;function p(P,z){if(++d>30){Ct("Load test font never loaded."),z();return}if(h.font="30px "+P,h.fillText(".",0,20),h.getImageData(0,0,1,1).data[3]>0){z();return}setTimeout(p.bind(null,P,z))}const b=`lt${Date.now()}${this.loadTestFontId++}`;let v=this._loadTestFont;v=a(v,976,b.length,b);const w=16,S=1482184792;let C=s(v,w);for(o=0,l=b.length-3;o<l;o+=4)C=C-S+s(b,o)|0;o<b.length&&(C=C-S+s(b+"XXX",o)|0),v=a(v,w,4,qy(C));const E=`url(data:font/opentype;base64,${btoa(v)});`,k=`@font-face {font-family:"${b}";src:${E}}`;this.insertRule(k);const O=this._document.createElement("div");O.style.visibility="hidden",O.style.width=O.style.height="10px",O.style.position="absolute",O.style.top=O.style.left="0px";for(const P of[t.loadedName,b]){const z=this._document.createElement("span");z.textContent="Hi",z.style.fontFamily=P,O.append(z)}this._document.body.append(O),p(b,()=>{O.remove(),i.complete()})}}class uv{#t;constructor(t,i=null,s,a){this.compiledGlyphs=Object.create(null),this.#t=t,this._inspectFont=i,s&&Object.assign(this,s),a&&(this.charProcOperatorList=a)}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const i={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(i.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,i)}return this._inspectFont?.(this),t}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${dm(this.data)});`;let i;if(!this.cssFontInfo)i=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let s=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(s+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),i=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${s}src:${t}}`}return this._inspectFont?.(this,t),i}getPathGenerator(t,i){if(this.compiledGlyphs[i]!==void 0)return this.compiledGlyphs[i];const s=this.loadedName+"_path_"+i;let a;try{a=t.get(s)}catch(l){Ct(`getPathGenerator - ignoring character: "${l}".`)}const o=new Path2D(a||"");return this.fontExtraProperties||t.delete(s),this.compiledGlyphs[i]=o}get black(){return this.#t.black}get bold(){return this.#t.bold}get disableFontFace(){return this.#t.disableFontFace??!1}get fontExtraProperties(){return this.#t.fontExtraProperties??!1}get isInvalidPDFjsFont(){return this.#t.isInvalidPDFjsFont}get isType3Font(){return this.#t.isType3Font}get italic(){return this.#t.italic}get missingFile(){return this.#t.missingFile}get remeasure(){return this.#t.remeasure}get vertical(){return this.#t.vertical}get ascent(){return this.#t.ascent}get defaultWidth(){return this.#t.defaultWidth}get descent(){return this.#t.descent}get bbox(){return this.#t.bbox}get fontMatrix(){return this.#t.fontMatrix}get fallbackName(){return this.#t.fallbackName}get loadedName(){return this.#t.loadedName}get mimetype(){return this.#t.mimetype}get name(){return this.#t.name}get data(){return this.#t.data}clearData(){this.#t.clearData()}get cssFontInfo(){return this.#t.cssFontInfo}get systemFontInfo(){return this.#t.systemFontInfo}get defaultVMetrics(){return this.#t.defaultVMetrics}}function hv(g){if(g instanceof URL)return g.href;if(typeof g=="string"){if(Ie)return g;const t=URL.parse(g,window.location);if(t)return t.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function dv(g){if(Ie&&typeof Buffer<"u"&&g instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(g instanceof Uint8Array&&g.byteLength===g.buffer.byteLength)return g;if(typeof g=="string")return Ar(g);if(g instanceof ArrayBuffer||ArrayBuffer.isView(g)||typeof g=="object"&&!isNaN(g?.length))return new Uint8Array(g);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function Xo(g){if(typeof g!="string")return null;if(g.endsWith("/"))return g;throw new Error(`Invalid factory url: "${g}" must include trailing slash.`)}const Ku=g=>typeof g=="object"&&Number.isInteger(g?.num)&&g.num>=0&&Number.isInteger(g?.gen)&&g.gen>=0,fv=g=>typeof g=="object"&&typeof g?.name=="string",gv=$y.bind(null,Ku,fv);class pv{#t=new Map;#e=Promise.resolve();postMessage(t,i){const s={data:structuredClone(t,i?{transfer:i}:null)};this.#e.then(()=>{for(const[a]of this.#t)a.call(this,s)})}addEventListener(t,i,s=null){let a=null;if(s?.signal instanceof AbortSignal){const{signal:o}=s;if(o.aborted){Ct("LoopbackPort - cannot use an `aborted` signal.");return}const l=()=>this.removeEventListener(t,i);a=()=>o.removeEventListener("abort",l),o.addEventListener("abort",l)}this.#t.set(i,a)}removeEventListener(t,i){this.#t.get(i)?.(),this.#t.delete(i)}terminate(){for(const[,t]of this.#t)t?.();this.#t.clear()}}const $o={DATA:1,ERROR:2},ve={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function zp(){}function Ze(g){if(g instanceof Un||g instanceof Gu||g instanceof Rp||g instanceof al||g instanceof Bu)return g;switch(g instanceof Error||typeof g=="object"&&g!==null||Jt('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),g.name){case"AbortException":return new Un(g.message);case"InvalidPDFException":return new Gu(g.message);case"PasswordException":return new Rp(g.message,g.code);case"ResponseException":return new al(g.message,g.status,g.missing);case"UnknownErrorException":return new Bu(g.message,g.details)}return new Bu(g.message,g.toString())}class fr{#t=new AbortController;constructor(t,i,s){this.sourceName=t,this.targetName=i,this.comObj=s,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),s.addEventListener("message",this.#e.bind(this),{signal:this.#t.signal})}#e({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream){this.#i(t);return}if(t.callback){const s=t.callbackId,a=this.callbackCapabilities[s];if(!a)throw new Error(`Cannot resolve callback ${s}`);if(delete this.callbackCapabilities[s],t.callback===$o.DATA)a.resolve(t.data);else if(t.callback===$o.ERROR)a.reject(Ze(t.reason));else throw new Error("Unexpected callback case");return}const i=this.actionHandler[t.action];if(!i)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const s=this.sourceName,a=t.sourceName,o=this.comObj;Promise.try(i,t.data).then(function(l){o.postMessage({sourceName:s,targetName:a,callback:$o.DATA,callbackId:t.callbackId,data:l})},function(l){o.postMessage({sourceName:s,targetName:a,callback:$o.ERROR,callbackId:t.callbackId,reason:Ze(l)})});return}if(t.streamId){this.#n(t);return}i(t.data)}on(t,i){const s=this.actionHandler;if(s[t])throw new Error(`There is already an actionName called "${t}"`);s[t]=i}send(t,i,s){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:i},s)}sendWithPromise(t,i,s){const a=this.callbackId++,o=Promise.withResolvers();this.callbackCapabilities[a]=o;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:a,data:i},s)}catch(l){o.reject(l)}return o.promise}sendWithStream(t,i,s,a){const o=this.streamId++,l=this.sourceName,u=this.targetName,h=this.comObj;return new ReadableStream({start:d=>{const p=Promise.withResolvers();return this.streamControllers[o]={controller:d,startCall:p,pullCall:null,cancelCall:null,isClosed:!1},h.postMessage({sourceName:l,targetName:u,action:t,streamId:o,data:i,desiredSize:d.desiredSize},a),p.promise},pull:d=>{const p=Promise.withResolvers();return this.streamControllers[o].pullCall=p,h.postMessage({sourceName:l,targetName:u,stream:ve.PULL,streamId:o,desiredSize:d.desiredSize}),p.promise},cancel:d=>{zt(d instanceof Error,"cancel must have a valid reason");const p=Promise.withResolvers();return this.streamControllers[o].cancelCall=p,this.streamControllers[o].isClosed=!0,h.postMessage({sourceName:l,targetName:u,stream:ve.CANCEL,streamId:o,reason:Ze(d)}),p.promise}},s)}#n(t){const i=t.streamId,s=this.sourceName,a=t.sourceName,o=this.comObj,l=this,u=this.actionHandler[t.action],h={enqueue(d,p=1,b){if(this.isCancelled)return;const v=this.desiredSize;this.desiredSize-=p,v>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),o.postMessage({sourceName:s,targetName:a,stream:ve.ENQUEUE,streamId:i,chunk:d},b)},close(){this.isCancelled||(this.isCancelled=!0,o.postMessage({sourceName:s,targetName:a,stream:ve.CLOSE,streamId:i}),delete l.streamSinks[i])},error(d){zt(d instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,o.postMessage({sourceName:s,targetName:a,stream:ve.ERROR,streamId:i,reason:Ze(d)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};h.sinkCapability.resolve(),h.ready=h.sinkCapability.promise,this.streamSinks[i]=h,Promise.try(u,t.data,h).then(function(){o.postMessage({sourceName:s,targetName:a,stream:ve.START_COMPLETE,streamId:i,success:!0})},function(d){o.postMessage({sourceName:s,targetName:a,stream:ve.START_COMPLETE,streamId:i,reason:Ze(d)})})}#i(t){const i=t.streamId,s=this.sourceName,a=t.sourceName,o=this.comObj,l=this.streamControllers[i],u=this.streamSinks[i];switch(t.stream){case ve.START_COMPLETE:t.success?l.startCall.resolve():l.startCall.reject(Ze(t.reason));break;case ve.PULL_COMPLETE:t.success?l.pullCall.resolve():l.pullCall.reject(Ze(t.reason));break;case ve.PULL:if(!u){o.postMessage({sourceName:s,targetName:a,stream:ve.PULL_COMPLETE,streamId:i,success:!0});break}u.desiredSize<=0&&t.desiredSize>0&&u.sinkCapability.resolve(),u.desiredSize=t.desiredSize,Promise.try(u.onPull||zp).then(function(){o.postMessage({sourceName:s,targetName:a,stream:ve.PULL_COMPLETE,streamId:i,success:!0})},function(d){o.postMessage({sourceName:s,targetName:a,stream:ve.PULL_COMPLETE,streamId:i,reason:Ze(d)})});break;case ve.ENQUEUE:if(zt(l,"enqueue should have stream controller"),l.isClosed)break;l.controller.enqueue(t.chunk);break;case ve.CLOSE:if(zt(l,"close should have stream controller"),l.isClosed)break;l.isClosed=!0,l.controller.close(),this.#r(l,i);break;case ve.ERROR:zt(l,"error should have stream controller"),l.controller.error(Ze(t.reason)),this.#r(l,i);break;case ve.CANCEL_COMPLETE:t.success?l.cancelCall.resolve():l.cancelCall.reject(Ze(t.reason)),this.#r(l,i);break;case ve.CANCEL:if(!u)break;const h=Ze(t.reason);Promise.try(u.onCancel||zp,h).then(function(){o.postMessage({sourceName:s,targetName:a,stream:ve.CANCEL_COMPLETE,streamId:i,success:!0})},function(d){o.postMessage({sourceName:s,targetName:a,stream:ve.CANCEL_COMPLETE,streamId:i,reason:Ze(d)})}),u.sinkCapability.reject(h),u.isCancelled=!0,delete this.streamSinks[i];break;default:throw new Error("Unexpected stream case")}}async#r(t,i){await Promise.allSettled([t.startCall?.promise,t.pullCall?.promise,t.cancelCall?.promise]),delete this.streamControllers[i]}destroy(){this.#t?.abort(),this.#t=null}}class ym{#t=!1;constructor({enableHWA:t=!1}){this.#t=t}create(t,i){if(t<=0||i<=0)throw new Error("Invalid canvas size");const s=this._createCanvas(t,i);return{canvas:s,context:s.getContext("2d",{willReadFrequently:!this.#t})}}reset(t,i,s){if(!t.canvas)throw new Error("Canvas is not specified");if(i<=0||s<=0)throw new Error("Invalid canvas size");t.canvas.width=i,t.canvas.height=s}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,i){Jt("Abstract method `_createCanvas` called.")}}class mv extends ym{constructor({ownerDocument:t=globalThis.document,enableHWA:i=!1}){super({enableHWA:i}),this._document=t}_createCanvas(t,i){const s=this._document.createElement("canvas");return s.width=t,s.height=i,s}}class vm{constructor({baseUrl:t=null,isCompressed:i=!0}){this.baseUrl=t,this.isCompressed=i}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const i=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(i).then(s=>({cMapData:s,isCompressed:this.isCompressed})).catch(s=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${i}`)})}async _fetch(t){Jt("Abstract method `_fetch` called.")}}class Ip extends vm{async _fetch(t){const i=await Sr(t,this.isCompressed?"arraybuffer":"text");return i instanceof ArrayBuffer?new Uint8Array(i):Ar(i)}}class xm{addFilter(t){return"none"}addHCMFilter(t,i){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,i,s,a,o){return"none"}destroy(t=!1){}}class bv extends xm{#t;#e;#n;#i;#r;#s;#a=0;constructor({docId:t,ownerDocument:i=globalThis.document}){super(),this.#i=t,this.#r=i}get#o(){return this.#e||=new Map}get#c(){return this.#s||=new Map}get#l(){if(!this.#n){const t=this.#r.createElement("div"),{style:i}=t;i.visibility="hidden",i.contain="strict",i.width=i.height=0,i.position="absolute",i.top=i.left=0,i.zIndex=-1;const s=this.#r.createElementNS(un,"svg");s.setAttribute("width",0),s.setAttribute("height",0),this.#n=this.#r.createElementNS(un,"defs"),t.append(s),s.append(this.#n),this.#r.body.append(t)}return this.#n}#d(t){if(t.length===1){const h=t[0],d=new Array(256);for(let b=0;b<256;b++)d[b]=h[b]/255;const p=d.join(",");return[p,p,p]}const[i,s,a]=t,o=new Array(256),l=new Array(256),u=new Array(256);for(let h=0;h<256;h++)o[h]=i[h]/255,l[h]=s[h]/255,u[h]=a[h]/255;return[o.join(","),l.join(","),u.join(",")]}#h(t){if(this.#t===void 0){this.#t="";const i=this.#r.URL;i!==this.#r.baseURI&&(dl(i)?Ct('#createUrl: ignore "data:"-URL for performance reasons.'):this.#t=cm(i,""))}return`url(${this.#t}#${t})`}addFilter(t){if(!t)return"none";let i=this.#o.get(t);if(i)return i;const[s,a,o]=this.#d(t),l=t.length===1?s:`${s}${a}${o}`;if(i=this.#o.get(l),i)return this.#o.set(t,i),i;const u=`g_${this.#i}_transfer_map_${this.#a++}`,h=this.#h(u);this.#o.set(t,h),this.#o.set(l,h);const d=this.#g(u);return this.#p(s,a,o,d),h}addHCMFilter(t,i){const s=`${t}-${i}`,a="base";let o=this.#c.get(a);if(o?.key===s||(o?(o.filter?.remove(),o.key=s,o.url="none",o.filter=null):(o={key:s,url:"none",filter:null},this.#c.set(a,o)),!t||!i))return o.url;const l=this.#v(t);t=dt.makeHexColor(...l);const u=this.#v(i);if(i=dt.makeHexColor(...u),this.#l.style.color="",t==="#000000"&&i==="#ffffff"||t===i)return o.url;const h=new Array(256);for(let A=0;A<=255;A++){const w=A/255;h[A]=w<=.03928?w/12.92:((w+.055)/1.055)**2.4}const d=h.join(","),p=`g_${this.#i}_hcm_filter`,b=o.filter=this.#g(p);this.#p(d,d,d,b),this.#m(b);const v=(A,w)=>{const S=l[A]/255,C=u[A]/255,E=new Array(w+1);for(let k=0;k<=w;k++)E[k]=S+k/w*(C-S);return E.join(",")};return this.#p(v(0,5),v(1,5),v(2,5),b),o.url=this.#h(p),o.url}addAlphaFilter(t){let i=this.#o.get(t);if(i)return i;const[s]=this.#d([t]),a=`alpha_${s}`;if(i=this.#o.get(a),i)return this.#o.set(t,i),i;const o=`g_${this.#i}_alpha_map_${this.#a++}`,l=this.#h(o);this.#o.set(t,l),this.#o.set(a,l);const u=this.#g(o);return this.#b(s,u),l}addLuminosityFilter(t){let i=this.#o.get(t||"luminosity");if(i)return i;let s,a;if(t?([s]=this.#d([t]),a=`luminosity_${s}`):a="luminosity",i=this.#o.get(a),i)return this.#o.set(t,i),i;const o=`g_${this.#i}_luminosity_map_${this.#a++}`,l=this.#h(o);this.#o.set(t,l),this.#o.set(a,l);const u=this.#g(o);return this.#f(u),t&&this.#b(s,u),l}addHighlightHCMFilter(t,i,s,a,o){const l=`${i}-${s}-${a}-${o}`;let u=this.#c.get(t);if(u?.key===l||(u?(u.filter?.remove(),u.key=l,u.url="none",u.filter=null):(u={key:l,url:"none",filter:null},this.#c.set(t,u)),!i||!s))return u.url;const[h,d]=[i,s].map(this.#v.bind(this));let p=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),b=Math.round(.2126*d[0]+.7152*d[1]+.0722*d[2]),[v,A]=[a,o].map(this.#v.bind(this));b<p&&([p,b,v,A]=[b,p,A,v]),this.#l.style.color="";const w=(E,k,O)=>{const P=new Array(256),z=(b-p)/O,L=E/255,j=(k-E)/(255*O);let D=0;for(let N=0;N<=O;N++){const U=Math.round(p+N*z),$=L+N*j;for(let tt=D;tt<=U;tt++)P[tt]=$;D=U+1}for(let N=D;N<256;N++)P[N]=P[D-1];return P.join(",")},S=`g_${this.#i}_hcm_${t}_filter`,C=u.filter=this.#g(S);return this.#m(C),this.#p(w(v[0],A[0],5),w(v[1],A[1],5),w(v[2],A[2],5),C),u.url=this.#h(S),u.url}destroy(t=!1){t&&this.#s?.size||(this.#n?.parentNode.parentNode.remove(),this.#n=null,this.#e?.clear(),this.#e=null,this.#s?.clear(),this.#s=null,this.#a=0)}#f(t){const i=this.#r.createElementNS(un,"feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(i)}#m(t){const i=this.#r.createElementNS(un,"feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(i)}#g(t){const i=this.#r.createElementNS(un,"filter");return i.setAttribute("color-interpolation-filters","sRGB"),i.setAttribute("id",t),this.#l.append(i),i}#u(t,i,s){const a=this.#r.createElementNS(un,i);a.setAttribute("type","discrete"),a.setAttribute("tableValues",s),t.append(a)}#p(t,i,s,a){const o=this.#r.createElementNS(un,"feComponentTransfer");a.append(o),this.#u(o,"feFuncR",t),this.#u(o,"feFuncG",i),this.#u(o,"feFuncB",s)}#b(t,i){const s=this.#r.createElementNS(un,"feComponentTransfer");i.append(s),this.#u(s,"feFuncA",t)}#v(t){return this.#l.style.color=t,_r(getComputedStyle(this.#l).getPropertyValue("color"))}}class Am{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const i=`${this.baseUrl}${t}`;return this._fetch(i).catch(s=>{throw new Error(`Unable to load font data at: ${i}`)})}async _fetch(t){Jt("Abstract method `_fetch` called.")}}class Up extends Am{async _fetch(t){const i=await Sr(t,"arraybuffer");return new Uint8Array(i)}}class Sm{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!t)throw new Error("Wasm filename must be specified.");const i=`${this.baseUrl}${t}`;return this._fetch(i).catch(s=>{throw new Error(`Unable to load wasm data at: ${i}`)})}async _fetch(t){Jt("Abstract method `_fetch` called.")}}class Hp extends Sm{async _fetch(t){const i=await Sr(t,"arraybuffer");return new Uint8Array(i)}}Ie&&Ct("Please use the `legacy` build in Node.js environments.");async function hh(g){const i=await process.getBuiltinModule("fs").promises.readFile(g);return new Uint8Array(i)}class yv extends xm{}class vv extends ym{_createCanvas(t,i){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(t,i)}}class xv extends vm{async _fetch(t){return hh(t)}}class Av extends Am{async _fetch(t){return hh(t)}}class Sv extends Sm{async _fetch(t){return hh(t)}}const ea="__forcedDependency",{floor:qp,ceil:Gp}=Math;function Ko(g,t,i,s,a,o){g[t*4+0]=Math.min(g[t*4+0],i),g[t*4+1]=Math.min(g[t*4+1],s),g[t*4+2]=Math.max(g[t*4+2],a),g[t*4+3]=Math.max(g[t*4+3],o)}const Qu=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];class wv{#t;#e;constructor(t,i){this.#t=t,this.#e=i}get length(){return this.#t.length}isEmpty(t){return this.#t[t]===Qu}minX(t){return this.#e[t*4+0]/256}minY(t){return this.#e[t*4+1]/256}maxX(t){return(this.#e[t*4+2]+1)/256}maxY(t){return(this.#e[t*4+3]+1)/256}}const Qo=(g,t)=>{if(!g)return;let i=g.get(t);return i||(i={dependencies:new Set,isRenderingOperation:!1},g.set(t,i)),i};class _v{#t={__proto__:null};#e={__proto__:null,transform:[],moveText:[],sameLineText:[],[ea]:[]};#n=new Map;#i=[];#r=[];#s=[[1,0,0,1,0,0]];#a=[-1/0,-1/0,1/0,1/0];#o=new Float64Array([1/0,1/0,-1/0,-1/0]);#c=-1;#l=new Set;#d=new Map;#h=new Map;#f;#m;#g;#u;#p;constructor(t,i,s=!1){this.#f=t.width,this.#m=t.height,this.#b(i),s&&(this.#p=new Map)}growOperationsCount(t){t>=this.#u.length&&this.#b(t,this.#u)}#b(t,i){const s=new ArrayBuffer(t*4);this.#g=new Uint8ClampedArray(s),this.#u=new Uint32Array(s),i&&i.length>0?(this.#u.set(i),this.#u.fill(Qu,i.length)):this.#u.fill(Qu)}save(t){return this.#t={__proto__:this.#t},this.#e={__proto__:this.#e,transform:{__proto__:this.#e.transform},moveText:{__proto__:this.#e.moveText},sameLineText:{__proto__:this.#e.sameLineText},[ea]:{__proto__:this.#e[ea]}},this.#a={__proto__:this.#a},this.#i.push(t),this}restore(t){const i=Object.getPrototypeOf(this.#t);if(i===null)return this;this.#t=i,this.#e=Object.getPrototypeOf(this.#e),this.#a=Object.getPrototypeOf(this.#a);const s=this.#i.pop();return s!==void 0&&(Qo(this.#p,t)?.dependencies.add(s),this.#u[t]=this.#u[s]),this}recordOpenMarker(t){return this.#i.push(t),this}getOpenMarker(){return this.#i.length===0?null:this.#i.at(-1)}recordCloseMarker(t){const i=this.#i.pop();return i!==void 0&&(Qo(this.#p,t)?.dependencies.add(i),this.#u[t]=this.#u[i]),this}beginMarkedContent(t){return this.#r.push(t),this}endMarkedContent(t){const i=this.#r.pop();return i!==void 0&&(Qo(this.#p,t)?.dependencies.add(i),this.#u[t]=this.#u[i]),this}pushBaseTransform(t){return this.#s.push(dt.multiplyByDOMMatrix(this.#s.at(-1),t.getTransform())),this}popBaseTransform(){return this.#s.length>1&&this.#s.pop(),this}recordSimpleData(t,i){return this.#t[t]=i,this}recordIncrementalData(t,i){return this.#e[t].push(i),this}resetIncrementalData(t,i){return this.#e[t].length=0,this}recordNamedData(t,i){return this.#n.set(t,i),this}recordSimpleDataFromNamed(t,i,s){this.#t[t]=this.#n.get(i)??s}recordFutureForcedDependency(t,i){return this.recordIncrementalData(ea,i),this}inheritSimpleDataAsFutureForcedDependencies(t){for(const i of t)i in this.#t&&this.recordFutureForcedDependency(i,this.#t[i]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const t of this.#l)this.recordFutureForcedDependency(ea,t);return this}resetBBox(t){return this.#c!==t&&(this.#c=t,this.#o[0]=1/0,this.#o[1]=1/0,this.#o[2]=-1/0,this.#o[3]=-1/0),this}recordClipBox(t,i,s,a,o,l){const u=dt.multiplyByDOMMatrix(this.#s.at(-1),i.getTransform()),h=[1/0,1/0,-1/0,-1/0];dt.axialAlignedBoundingBox([s,o,a,l],u,h);const d=dt.intersect(this.#a,h);return d?(this.#a[0]=d[0],this.#a[1]=d[1],this.#a[2]=d[2],this.#a[3]=d[3]):(this.#a[0]=this.#a[1]=1/0,this.#a[2]=this.#a[3]=-1/0),this}recordBBox(t,i,s,a,o,l){const u=this.#a;if(u[0]===1/0)return this;const h=dt.multiplyByDOMMatrix(this.#s.at(-1),i.getTransform());if(u[0]===-1/0)return dt.axialAlignedBoundingBox([s,o,a,l],h,this.#o),this;const d=[1/0,1/0,-1/0,-1/0];return dt.axialAlignedBoundingBox([s,o,a,l],h,d),this.#o[0]=Math.min(this.#o[0],Math.max(d[0],u[0])),this.#o[1]=Math.min(this.#o[1],Math.max(d[1],u[1])),this.#o[2]=Math.max(this.#o[2],Math.min(d[2],u[2])),this.#o[3]=Math.max(this.#o[3],Math.min(d[3],u[3])),this}recordCharacterBBox(t,i,s,a=1,o=0,l=0,u){const h=s.bbox;let d,p;if(h&&(d=h[2]!==h[0]&&h[3]!==h[1]&&this.#h.get(s),d!==!1&&(p=[0,0,0,0],dt.axialAlignedBoundingBox(h,s.fontMatrix,p),(a!==1||o!==0||l!==0)&&dt.scaleMinMax([a,0,0,-a,o,l],p),d)))return this.recordBBox(t,i,p[0],p[2],p[1],p[3]);if(!u)return this.recordFullPageBBox(t);const b=u();return h&&p&&d===void 0&&(d=p[0]<=o-b.actualBoundingBoxLeft&&p[2]>=o+b.actualBoundingBoxRight&&p[1]<=l-b.actualBoundingBoxAscent&&p[3]>=l+b.actualBoundingBoxDescent,this.#h.set(s,d),d)?this.recordBBox(t,i,p[0],p[2],p[1],p[3]):this.recordBBox(t,i,o-b.actualBoundingBoxLeft,o+b.actualBoundingBoxRight,l-b.actualBoundingBoxAscent,l+b.actualBoundingBoxDescent)}recordFullPageBBox(t){return this.#o[0]=Math.max(0,this.#a[0]),this.#o[1]=Math.max(0,this.#a[1]),this.#o[2]=Math.min(this.#f,this.#a[2]),this.#o[3]=Math.min(this.#m,this.#a[3]),this}getSimpleIndex(t){return this.#t[t]}recordDependencies(t,i){const s=this.#l,a=this.#t,o=this.#e;for(const l of i)l in this.#t?s.add(a[l]):l in o&&o[l].forEach(s.add,s);return this}recordNamedDependency(t,i){return this.#n.has(i)&&this.#l.add(this.#n.get(i)),this}recordOperation(t,i=!1){if(this.recordDependencies(t,[ea]),this.#p){const s=Qo(this.#p,t),{dependencies:a}=s;this.#l.forEach(a.add,a),this.#i.forEach(a.add,a),this.#r.forEach(a.add,a),a.delete(t),s.isRenderingOperation=!0}if(this.#c===t){const s=qp(this.#o[0]*256/this.#f),a=qp(this.#o[1]*256/this.#m),o=Gp(this.#o[2]*256/this.#f),l=Gp(this.#o[3]*256/this.#m);Ko(this.#g,t,s,a,o,l);for(const u of this.#l)u!==t&&Ko(this.#g,u,s,a,o,l);for(const u of this.#i)u!==t&&Ko(this.#g,u,s,a,o,l);for(const u of this.#r)u!==t&&Ko(this.#g,u,s,a,o,l);i||(this.#l.clear(),this.#c=-1)}return this}recordShowTextOperation(t,i=!1){const s=Array.from(this.#l);this.recordOperation(t,i),this.recordIncrementalData("sameLineText",t);for(const a of s)this.recordIncrementalData("sameLineText",a);return this}bboxToClipBoxDropOperation(t,i=!1){return this.#c===t&&(this.#c=-1,this.#a[0]=Math.max(this.#a[0],this.#o[0]),this.#a[1]=Math.max(this.#a[1],this.#o[1]),this.#a[2]=Math.min(this.#a[2],this.#o[2]),this.#a[3]=Math.min(this.#a[3],this.#o[3]),i||this.#l.clear()),this}_takePendingDependencies(){const t=this.#l;return this.#l=new Set,t}_extractOperation(t){const i=this.#d.get(t);return this.#d.delete(t),i}_pushPendingDependencies(t){for(const i of t)this.#l.add(i)}take(){return this.#h.clear(),new wv(this.#u,this.#g)}takeDebugMetadata(){return this.#p}}class rl{#t;#e;#n;#i=0;#r=0;constructor(t,i,s){if(t instanceof rl&&t.#n===!!s)return t;this.#t=t,this.#e=i,this.#n=!!s}growOperationsCount(){throw new Error("Unreachable")}save(t){return this.#r++,this.#t.save(this.#e),this}restore(t){return this.#r>0&&(this.#t.restore(this.#e),this.#r--),this}recordOpenMarker(t){return this.#i++,this}getOpenMarker(){return this.#i>0?this.#e:this.#t.getOpenMarker()}recordCloseMarker(t){return this.#i--,this}beginMarkedContent(t){return this}endMarkedContent(t){return this}pushBaseTransform(t){return this.#t.pushBaseTransform(t),this}popBaseTransform(){return this.#t.popBaseTransform(),this}recordSimpleData(t,i){return this.#t.recordSimpleData(t,this.#e),this}recordIncrementalData(t,i){return this.#t.recordIncrementalData(t,this.#e),this}resetIncrementalData(t,i){return this.#t.resetIncrementalData(t,this.#e),this}recordNamedData(t,i){return this}recordSimpleDataFromNamed(t,i,s){return this.#t.recordSimpleDataFromNamed(t,i,this.#e),this}recordFutureForcedDependency(t,i){return this.#t.recordFutureForcedDependency(t,this.#e),this}inheritSimpleDataAsFutureForcedDependencies(t){return this.#t.inheritSimpleDataAsFutureForcedDependencies(t),this}inheritPendingDependenciesAsFutureForcedDependencies(){return this.#t.inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(t){return this.#n||this.#t.resetBBox(this.#e),this}recordClipBox(t,i,s,a,o,l){return this.#n||this.#t.recordClipBox(this.#e,i,s,a,o,l),this}recordBBox(t,i,s,a,o,l){return this.#n||this.#t.recordBBox(this.#e,i,s,a,o,l),this}recordCharacterBBox(t,i,s,a,o,l,u){return this.#n||this.#t.recordCharacterBBox(this.#e,i,s,a,o,l,u),this}recordFullPageBBox(t){return this.#n||this.#t.recordFullPageBBox(this.#e),this}getSimpleIndex(t){return this.#t.getSimpleIndex(t)}recordDependencies(t,i){return this.#t.recordDependencies(this.#e,i),this}recordNamedDependency(t,i){return this.#t.recordNamedDependency(this.#e,i),this}recordOperation(t){return this.#t.recordOperation(this.#e,!0),this}recordShowTextOperation(t){return this.#t.recordShowTextOperation(this.#e,!0),this}bboxToClipBoxDropOperation(t){return this.#n||this.#t.bboxToClipBoxDropOperation(this.#e,!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}}const Ei={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],transform:["transform"],transformAndFill:["transform","fillColor"]},Oe={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function Wu(g,t){if(!t)return;const i=t[2]-t[0],s=t[3]-t[1],a=new Path2D;a.rect(t[0],t[1],i,s),g.clip(a)}class dh{isModifyingCurrentTransform(){return!1}getPattern(){Jt("Abstract method `getPattern` called.")}}class Ev extends dh{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}_createGradient(t){let i;this._type==="axial"?i=t.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(i=t.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const s of this._colorStops)i.addColorStop(s[0],s[1]);return i}getPattern(t,i,s,a){let o;if(a===Oe.STROKE||a===Oe.FILL){const l=i.current.getClippedPathBoundingBox(a,ae(t))||[0,0,0,0],u=Math.ceil(l[2]-l[0])||1,h=Math.ceil(l[3]-l[1])||1,d=i.cachedCanvases.getCanvas("pattern",u,h),p=d.context;p.clearRect(0,0,p.canvas.width,p.canvas.height),p.beginPath(),p.rect(0,0,p.canvas.width,p.canvas.height),p.translate(-l[0],-l[1]),s=dt.transform(s,[1,0,0,1,l[0],l[1]]),p.transform(...i.baseTransform),this.matrix&&p.transform(...this.matrix),Wu(p,this._bbox),p.fillStyle=this._createGradient(p),p.fill(),o=t.createPattern(d.canvas,"no-repeat");const b=new DOMMatrix(s);o.setTransform(b)}else Wu(t,this._bbox),o=this._createGradient(t);return o}}function zu(g,t,i,s,a,o,l,u){const h=t.coords,d=t.colors,p=g.data,b=g.width*4;let v;h[i+1]>h[s+1]&&(v=i,i=s,s=v,v=o,o=l,l=v),h[s+1]>h[a+1]&&(v=s,s=a,a=v,v=l,l=u,u=v),h[i+1]>h[s+1]&&(v=i,i=s,s=v,v=o,o=l,l=v);const A=(h[i]+t.offsetX)*t.scaleX,w=(h[i+1]+t.offsetY)*t.scaleY,S=(h[s]+t.offsetX)*t.scaleX,C=(h[s+1]+t.offsetY)*t.scaleY,E=(h[a]+t.offsetX)*t.scaleX,k=(h[a+1]+t.offsetY)*t.scaleY;if(w>=k)return;const O=d[o],P=d[o+1],z=d[o+2],L=d[l],j=d[l+1],D=d[l+2],N=d[u],U=d[u+1],$=d[u+2],tt=Math.round(w),at=Math.round(k);let gt,bt,F,q,et,it,ut,M;for(let H=tt;H<=at;H++){if(H<C){const ot=H<w?0:(w-H)/(w-C);gt=A-(A-S)*ot,bt=O-(O-L)*ot,F=P-(P-j)*ot,q=z-(z-D)*ot}else{let ot;H>k?ot=1:C===k?ot=0:ot=(C-H)/(C-k),gt=S-(S-E)*ot,bt=L-(L-N)*ot,F=j-(j-U)*ot,q=D-(D-$)*ot}let T;H<w?T=0:H>k?T=1:T=(w-H)/(w-k),et=A-(A-E)*T,it=O-(O-N)*T,ut=P-(P-U)*T,M=z-(z-$)*T;const Q=Math.round(Math.min(gt,et)),nt=Math.round(Math.max(gt,et));let rt=b*H+Q*4;for(let ot=Q;ot<=nt;ot++)T=(gt-ot)/(gt-et),T<0?T=0:T>1&&(T=1),p[rt++]=bt-(bt-it)*T|0,p[rt++]=F-(F-ut)*T|0,p[rt++]=q-(q-M)*T|0,p[rt++]=255}}function Cv(g,t,i){const s=t.coords,a=t.colors;let o,l;switch(t.type){case"lattice":const u=t.verticesPerRow,h=Math.floor(s.length/u)-1,d=u-1;for(o=0;o<h;o++){let p=o*u;for(let b=0;b<d;b++,p++)zu(g,i,s[p],s[p+1],s[p+u],a[p],a[p+1],a[p+u]),zu(g,i,s[p+u+1],s[p+1],s[p+u],a[p+u+1],a[p+1],a[p+u])}break;case"triangles":for(o=0,l=s.length;o<l;o+=3)zu(g,i,s[o],s[o+1],s[o+2],a[o],a[o+1],a[o+2]);break;default:throw new Error("illegal figure")}}class Tv extends dh{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[6],this._background=t[7],this.matrix=null}_createMeshCanvas(t,i,s){const u=Math.floor(this._bounds[0]),h=Math.floor(this._bounds[1]),d=Math.ceil(this._bounds[2])-u,p=Math.ceil(this._bounds[3])-h,b=Math.min(Math.ceil(Math.abs(d*t[0]*1.1)),3e3),v=Math.min(Math.ceil(Math.abs(p*t[1]*1.1)),3e3),A=d/b,w=p/v,S={coords:this._coords,colors:this._colors,offsetX:-u,offsetY:-h,scaleX:1/A,scaleY:1/w},C=b+4,E=v+4,k=s.getCanvas("mesh",C,E),O=k.context,P=O.createImageData(b,v);if(i){const L=P.data;for(let j=0,D=L.length;j<D;j+=4)L[j]=i[0],L[j+1]=i[1],L[j+2]=i[2],L[j+3]=255}for(const L of this._figures)Cv(P,L,S);return O.putImageData(P,2,2),{canvas:k.canvas,offsetX:u-2*A,offsetY:h-2*w,scaleX:A,scaleY:w}}isModifyingCurrentTransform(){return!0}getPattern(t,i,s,a){Wu(t,this._bbox);const o=new Float32Array(2);if(a===Oe.SHADING)dt.singularValueDecompose2dScale(ae(t),o);else if(this.matrix){dt.singularValueDecompose2dScale(this.matrix,o);const[u,h]=o;dt.singularValueDecompose2dScale(i.baseTransform,o),o[0]*=u,o[1]*=h}else dt.singularValueDecompose2dScale(i.baseTransform,o);const l=this._createMeshCanvas(o,a===Oe.SHADING?null:this._background,i.cachedCanvases);return a!==Oe.SHADING&&(t.setTransform(...i.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(l.offsetX,l.offsetY),t.scale(l.scaleX,l.scaleY),t.createPattern(l.canvas,"no-repeat")}}class Dv extends dh{getPattern(){return"hotpink"}}function Nv(g){switch(g[0]){case"RadialAxial":return new Ev(g);case"Mesh":return new Tv(g);case"Dummy":return new Dv}throw new Error(`Unknown IR type: ${g[0]}`)}const Vp={COLORED:1,UNCOLORED:2};class fh{static MAX_PATTERN_SIZE=3e3;constructor(t,i,s,a){this.color=t[1],this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.ctx=i,this.canvasGraphicsFactory=s,this.baseTransform=a}createPatternCanvas(t,i){const{bbox:s,operatorList:a,paintType:o,tilingType:l,color:u,canvasGraphicsFactory:h}=this;let{xstep:d,ystep:p}=this;d=Math.abs(d),p=Math.abs(p),hl("TilingType: "+l);const b=s[0],v=s[1],A=s[2],w=s[3],S=A-b,C=w-v,E=new Float32Array(2);dt.singularValueDecompose2dScale(this.matrix,E);const[k,O]=E;dt.singularValueDecompose2dScale(this.baseTransform,E);const P=k*E[0],z=O*E[1];let L=S,j=C,D=!1,N=!1;const U=Math.ceil(d*P),$=Math.ceil(p*z),tt=Math.ceil(S*P),at=Math.ceil(C*z);U>=tt?L=d:D=!0,$>=at?j=p:N=!0;const gt=this.getSizeAndScale(L,this.ctx.canvas.width,P),bt=this.getSizeAndScale(j,this.ctx.canvas.height,z),F=t.cachedCanvases.getCanvas("pattern",gt.size,bt.size),q=F.context,et=h.createCanvasGraphics(q,i);if(et.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(et,o,u),q.translate(-gt.scale*b,-bt.scale*v),et.transform(0,gt.scale,0,0,bt.scale,0,0),q.save(),et.dependencyTracker?.save(),this.clipBbox(et,b,v,A,w),et.baseTransform=ae(et.ctx),et.executeOperatorList(a),et.endDrawing(),et.dependencyTracker?.restore(),q.restore(),D||N){const it=F.canvas;D&&(L=d),N&&(j=p);const ut=this.getSizeAndScale(L,this.ctx.canvas.width,P),M=this.getSizeAndScale(j,this.ctx.canvas.height,z),H=ut.size,T=M.size,Q=t.cachedCanvases.getCanvas("pattern-workaround",H,T),nt=Q.context,rt=D?Math.floor(S/d):0,ot=N?Math.floor(C/p):0;for(let ft=0;ft<=rt;ft++)for(let X=0;X<=ot;X++)nt.drawImage(it,H*ft,T*X,H,T,0,0,H,T);return{canvas:Q.canvas,scaleX:ut.scale,scaleY:M.scale,offsetX:b,offsetY:v}}return{canvas:F.canvas,scaleX:gt.scale,scaleY:bt.scale,offsetX:b,offsetY:v}}getSizeAndScale(t,i,s){const a=Math.max(fh.MAX_PATTERN_SIZE,i);let o=Math.ceil(t*s);return o>=a?o=a:s=o/t,{scale:s,size:o}}clipBbox(t,i,s,a,o){const l=a-i,u=o-s;t.ctx.rect(i,s,l,u),dt.axialAlignedBoundingBox([i,s,a,o],ae(t.ctx),t.current.minMax),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,i,s){const a=t.ctx,o=t.current;switch(i){case Vp.COLORED:const{fillStyle:l,strokeStyle:u}=this.ctx;a.fillStyle=o.fillColor=l,a.strokeStyle=o.strokeColor=u;break;case Vp.UNCOLORED:a.fillStyle=a.strokeStyle=s,o.fillColor=o.strokeColor=s;break;default:throw new Hy(`Unsupported paint type: ${i}`)}}isModifyingCurrentTransform(){return!1}getPattern(t,i,s,a,o){let l=s;a!==Oe.SHADING&&(l=dt.transform(l,i.baseTransform),this.matrix&&(l=dt.transform(l,this.matrix)));const u=this.createPatternCanvas(i,o);let h=new DOMMatrix(l);h=h.translate(u.offsetX,u.offsetY),h=h.scale(1/u.scaleX,1/u.scaleY);const d=t.createPattern(u.canvas,"repeat");return d.setTransform(h),d}}function Mv({src:g,srcPos:t=0,dest:i,width:s,height:a,nonBlackColor:o=4294967295,inverseDecode:l=!1}){const u=Le.isLittleEndian?4278190080:255,[h,d]=l?[o,u]:[u,o],p=s>>3,b=s&7,v=g.length;i=new Uint32Array(i.buffer);let A=0;for(let w=0;w<a;w++){for(const C=t+p;t<C;t++){const E=t<v?g[t]:255;i[A++]=E&128?d:h,i[A++]=E&64?d:h,i[A++]=E&32?d:h,i[A++]=E&16?d:h,i[A++]=E&8?d:h,i[A++]=E&4?d:h,i[A++]=E&2?d:h,i[A++]=E&1?d:h}if(b===0)continue;const S=t<v?g[t++]:255;for(let C=0;C<b;C++)i[A++]=S&1<<7-C?d:h}return{srcPos:t,destPos:A}}const Yp=16,Xp=100,Rv=15,$p=10,Je=16,Iu=new DOMMatrix,ui=new Float32Array(2),aa=new Float32Array([1/0,1/0,-1/0,-1/0]);function kv(g,t){if(g._removeMirroring)throw new Error("Context is already forwarding operations.");g.__originalSave=g.save,g.__originalRestore=g.restore,g.__originalRotate=g.rotate,g.__originalScale=g.scale,g.__originalTranslate=g.translate,g.__originalTransform=g.transform,g.__originalSetTransform=g.setTransform,g.__originalResetTransform=g.resetTransform,g.__originalClip=g.clip,g.__originalMoveTo=g.moveTo,g.__originalLineTo=g.lineTo,g.__originalBezierCurveTo=g.bezierCurveTo,g.__originalRect=g.rect,g.__originalClosePath=g.closePath,g.__originalBeginPath=g.beginPath,g._removeMirroring=()=>{g.save=g.__originalSave,g.restore=g.__originalRestore,g.rotate=g.__originalRotate,g.scale=g.__originalScale,g.translate=g.__originalTranslate,g.transform=g.__originalTransform,g.setTransform=g.__originalSetTransform,g.resetTransform=g.__originalResetTransform,g.clip=g.__originalClip,g.moveTo=g.__originalMoveTo,g.lineTo=g.__originalLineTo,g.bezierCurveTo=g.__originalBezierCurveTo,g.rect=g.__originalRect,g.closePath=g.__originalClosePath,g.beginPath=g.__originalBeginPath,delete g._removeMirroring},g.save=function(){t.save(),this.__originalSave()},g.restore=function(){t.restore(),this.__originalRestore()},g.translate=function(i,s){t.translate(i,s),this.__originalTranslate(i,s)},g.scale=function(i,s){t.scale(i,s),this.__originalScale(i,s)},g.transform=function(i,s,a,o,l,u){t.transform(i,s,a,o,l,u),this.__originalTransform(i,s,a,o,l,u)},g.setTransform=function(i,s,a,o,l,u){t.setTransform(i,s,a,o,l,u),this.__originalSetTransform(i,s,a,o,l,u)},g.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},g.rotate=function(i){t.rotate(i),this.__originalRotate(i)},g.clip=function(i){t.clip(i),this.__originalClip(i)},g.moveTo=function(i,s){t.moveTo(i,s),this.__originalMoveTo(i,s)},g.lineTo=function(i,s){t.lineTo(i,s),this.__originalLineTo(i,s)},g.bezierCurveTo=function(i,s,a,o,l,u){t.bezierCurveTo(i,s,a,o,l,u),this.__originalBezierCurveTo(i,s,a,o,l,u)},g.rect=function(i,s,a,o){t.rect(i,s,a,o),this.__originalRect(i,s,a,o)},g.closePath=function(){t.closePath(),this.__originalClosePath()},g.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class Ov{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,i,s){let a;return this.cache[t]!==void 0?(a=this.cache[t],this.canvasFactory.reset(a,i,s)):(a=this.canvasFactory.create(i,s),this.cache[t]=a),a}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const i=this.cache[t];this.canvasFactory.destroy(i),delete this.cache[t]}}}function Wo(g,t,i,s,a,o,l,u,h,d){const[p,b,v,A,w,S]=ae(g);if(b===0&&v===0){const k=l*p+w,O=Math.round(k),P=u*A+S,z=Math.round(P),L=(l+h)*p+w,j=Math.abs(Math.round(L)-O)||1,D=(u+d)*A+S,N=Math.abs(Math.round(D)-z)||1;return g.setTransform(Math.sign(p),0,0,Math.sign(A),O,z),g.drawImage(t,i,s,a,o,0,0,j,N),g.setTransform(p,b,v,A,w,S),[j,N]}if(p===0&&A===0){const k=u*v+w,O=Math.round(k),P=l*b+S,z=Math.round(P),L=(u+d)*v+w,j=Math.abs(Math.round(L)-O)||1,D=(l+h)*b+S,N=Math.abs(Math.round(D)-z)||1;return g.setTransform(0,Math.sign(b),Math.sign(v),0,O,z),g.drawImage(t,i,s,a,o,0,0,N,j),g.setTransform(p,b,v,A,w,S),[N,j]}g.drawImage(t,i,s,a,o,l,u,h,d);const C=Math.hypot(p,b),E=Math.hypot(v,A);return[C*h,E*d]}class Kp{alphaIsShape=!1;fontSize=0;fontSizeScale=1;textMatrix=null;textMatrixScale=1;fontMatrix=qu;leading=0;x=0;y=0;lineX=0;lineY=0;charSpacing=0;wordSpacing=0;textHScale=1;textRenderingMode=Re.FILL;textRise=0;fillColor="#000000";strokeColor="#000000";patternFill=!1;patternStroke=!1;fillAlpha=1;strokeAlpha=1;lineWidth=1;activeSMask=null;transferMaps="none";constructor(t,i,s){s?.(this),this.clipBox=new Float32Array([0,0,t,i]),this.minMax=aa.slice()}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t.minMax=this.minMax.slice(),t}getPathBoundingBox(t=Oe.FILL,i=null){const s=this.minMax.slice();if(t===Oe.STROKE){i||Jt("Stroke bounding box must include transform."),dt.singularValueDecompose2dScale(i,ui);const a=ui[0]*this.lineWidth/2,o=ui[1]*this.lineWidth/2;s[0]-=a,s[1]-=o,s[2]+=a,s[3]+=o}return s}updateClipFromPath(){const t=dt.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(t){this.clipBox.set(t,0),this.minMax.set(aa,0)}getClippedPathBoundingBox(t=Oe.FILL,i=null){return dt.intersect(this.clipBox,this.getPathBoundingBox(t,i))}}function Qp(g,t){if(t instanceof ImageData){g.putImageData(t,0,0);return}const i=t.height,s=t.width,a=i%Je,o=(i-a)/Je,l=a===0?o:o+1,u=g.createImageData(s,Je);let h=0,d;const p=t.data,b=u.data;let v,A,w,S;if(t.kind===il.GRAYSCALE_1BPP){const C=p.byteLength,E=new Uint32Array(b.buffer,0,b.byteLength>>2),k=E.length,O=s+7>>3,P=4294967295,z=Le.isLittleEndian?4278190080:255;for(v=0;v<l;v++){for(w=v<o?Je:a,d=0,A=0;A<w;A++){const L=C-h;let j=0;const D=L>O?s:L*8-7,N=D&-8;let U=0,$=0;for(;j<N;j+=8)$=p[h++],E[d++]=$&128?P:z,E[d++]=$&64?P:z,E[d++]=$&32?P:z,E[d++]=$&16?P:z,E[d++]=$&8?P:z,E[d++]=$&4?P:z,E[d++]=$&2?P:z,E[d++]=$&1?P:z;for(;j<D;j++)U===0&&($=p[h++],U=128),E[d++]=$&U?P:z,U>>=1}for(;d<k;)E[d++]=0;g.putImageData(u,0,v*Je)}}else if(t.kind===il.RGBA_32BPP){for(A=0,S=s*Je*4,v=0;v<o;v++)b.set(p.subarray(h,h+S)),h+=S,g.putImageData(u,0,A),A+=Je;v<l&&(S=s*a*4,b.set(p.subarray(h,h+S)),g.putImageData(u,0,A))}else if(t.kind===il.RGB_24BPP)for(w=Je,S=s*w,v=0;v<l;v++){for(v>=o&&(w=a,S=s*w),d=0,A=S;A--;)b[d++]=p[h++],b[d++]=p[h++],b[d++]=p[h++],b[d++]=255;g.putImageData(u,0,v*Je)}else throw new Error(`bad image kind: ${t.kind}`)}function Wp(g,t){if(t.bitmap){g.drawImage(t.bitmap,0,0);return}const i=t.height,s=t.width,a=i%Je,o=(i-a)/Je,l=a===0?o:o+1,u=g.createImageData(s,Je);let h=0;const d=t.data,p=u.data;for(let b=0;b<l;b++){const v=b<o?Je:a;({srcPos:h}=Mv({src:d,srcPos:h,dest:p,width:s,height:v,nonBlackColor:0})),g.putImageData(u,0,b*Je)}}function lr(g,t){const i=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const s of i)g[s]!==void 0&&(t[s]=g[s]);g.setLineDash!==void 0&&(t.setLineDash(g.getLineDash()),t.lineDashOffset=g.lineDashOffset)}function Zo(g){g.strokeStyle=g.fillStyle="#000000",g.fillRule="nonzero",g.globalAlpha=1,g.lineWidth=1,g.lineCap="butt",g.lineJoin="miter",g.miterLimit=10,g.globalCompositeOperation="source-over",g.font="10px sans-serif",g.setLineDash!==void 0&&(g.setLineDash([]),g.lineDashOffset=0);const{filter:t}=g;t!=="none"&&t!==""&&(g.filter="none")}function Zp(g,t){if(t)return!0;dt.singularValueDecompose2dScale(g,ui);const i=Math.fround(Gi.pixelRatio*da.PDF_TO_CSS_UNITS);return ui[0]<=i&&ui[1]<=i}const Lv=["butt","round","square"],jv=["miter","round","bevel"],Bv={},Jp={};class oa{constructor(t,i,s,a,o,{optionalContentConfig:l,markedContentStack:u=null},h,d,p){this.ctx=t,this.current=new Kp(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=i,this.objs=s,this.canvasFactory=a,this.filterFactory=o,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=u||[],this.optionalContentConfig=l,this.cachedCanvases=new Ov(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=h,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=d,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=p??null}getObject(t,i,s=null){return typeof i=="string"?(this.dependencyTracker?.recordNamedDependency(t,i),i.startsWith("g_")?this.commonObjs.get(i):this.objs.get(i)):s}beginDrawing({transform:t,viewport:i,transparency:s=!1,background:a=null}){const o=this.ctx.canvas.width,l=this.ctx.canvas.height,u=this.ctx.fillStyle;if(this.ctx.fillStyle=a||"#ffffff",this.ctx.fillRect(0,0,o,l),this.ctx.fillStyle=u,s){const h=this.cachedCanvases.getCanvas("transparent",o,l);this.compositeCtx=this.ctx,this.transparentCanvas=h.canvas,this.ctx=h.context,this.ctx.save(),this.ctx.transform(...ae(this.compositeCtx))}this.ctx.save(),Zo(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...i.transform),this.viewportScale=i.scale,this.baseTransform=ae(this.ctx)}executeOperatorList(t,i,s,a,o){const l=t.argsArray,u=t.fnArray;let h=i||0;const d=l.length;if(d===h)return h;const p=d-h>$p&&typeof s=="function",b=p?Date.now()+Rv:0;let v=0;const A=this.commonObjs,w=this.objs;let S,C;for(;;){if(a!==void 0&&h===a.nextBreakPoint)return a.breakIt(h,s),h;if(!o||o(h))if(S=u[h],C=l[h]??null,S!==br.dependency)C===null?this[S](h):this[S](h,...C);else for(const E of C){this.dependencyTracker?.recordNamedData(E,h);const k=E.startsWith("g_")?A:w;if(!k.has(E))return k.get(E,s),h}if(h++,h===d)return h;if(p&&++v>$p){if(Date.now()>b)return s(),h;v=0}}}#t(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#t(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const i of t.values())typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement&&(i.width=i.height=0);t.clear()}this._cachedBitmapsMap.clear(),this.#e()}#e(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const i=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=i}}}_scaleImage(t,i){const s=t.width??t.displayWidth,a=t.height??t.displayHeight;let o=Math.max(Math.hypot(i[0],i[1]),1),l=Math.max(Math.hypot(i[2],i[3]),1),u=s,h=a,d="prescale1",p,b;for(;o>2&&u>1||l>2&&h>1;){let v=u,A=h;o>2&&u>1&&(v=u>=16384?Math.floor(u/2)-1||1:Math.ceil(u/2),o/=u/v),l>2&&h>1&&(A=h>=16384?Math.floor(h/2)-1||1:Math.ceil(h)/2,l/=h/A),p=this.cachedCanvases.getCanvas(d,v,A),b=p.context,b.clearRect(0,0,v,A),b.drawImage(t,0,0,u,h,0,0,v,A),t=p.canvas,u=v,h=A,d=d==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:u,paintHeight:h}}_createMaskCanvas(t,i){const s=this.ctx,{width:a,height:o}=i,l=this.current.fillColor,u=this.current.patternFill,h=ae(s);let d,p,b,v;if((i.bitmap||i.data)&&i.count>1){const U=i.bitmap||i.data.buffer;p=JSON.stringify(u?h:[h.slice(0,4),l]),d=this._cachedBitmapsMap.get(U),d||(d=new Map,this._cachedBitmapsMap.set(U,d));const $=d.get(p);if($&&!u){const tt=Math.round(Math.min(h[0],h[2])+h[4]),at=Math.round(Math.min(h[1],h[3])+h[5]);return this.dependencyTracker?.recordDependencies(t,Ei.transformAndFill),{canvas:$,offsetX:tt,offsetY:at}}b=$}b||(v=this.cachedCanvases.getCanvas("maskCanvas",a,o),Wp(v.context,i));let A=dt.transform(h,[1/a,0,0,-1/o,0,0]);A=dt.transform(A,[1,0,0,1,0,-o]);const w=aa.slice();dt.axialAlignedBoundingBox([0,0,a,o],A,w);const[S,C,E,k]=w,O=Math.round(E-S)||1,P=Math.round(k-C)||1,z=this.cachedCanvases.getCanvas("fillCanvas",O,P),L=z.context,j=S,D=C;L.translate(-j,-D),L.transform(...A),b||(b=this._scaleImage(v.canvas,Ii(L)),b=b.img,d&&u&&d.set(p,b)),L.imageSmoothingEnabled=Zp(ae(L),i.interpolate),Wo(L,b,0,0,b.width,b.height,0,0,a,o),L.globalCompositeOperation="source-in";const N=dt.transform(Ii(L),[1,0,0,1,-j,-D]);return L.fillStyle=u?l.getPattern(s,this,N,Oe.FILL,t):l,L.fillRect(0,0,a,o),d&&!u&&(this.cachedCanvases.delete("fillCanvas"),d.set(p,z.canvas)),this.dependencyTracker?.recordDependencies(t,Ei.transformAndFill),{canvas:z.canvas,offsetX:Math.round(j),offsetY:Math.round(D)}}setLineWidth(t,i){this.dependencyTracker?.recordSimpleData("lineWidth",t),i!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=i,this.ctx.lineWidth=i}setLineCap(t,i){this.dependencyTracker?.recordSimpleData("lineCap",t),this.ctx.lineCap=Lv[i]}setLineJoin(t,i){this.dependencyTracker?.recordSimpleData("lineJoin",t),this.ctx.lineJoin=jv[i]}setMiterLimit(t,i){this.dependencyTracker?.recordSimpleData("miterLimit",t),this.ctx.miterLimit=i}setDash(t,i,s){this.dependencyTracker?.recordSimpleData("dash",t);const a=this.ctx;a.setLineDash!==void 0&&(a.setLineDash(i),a.lineDashOffset=s)}setRenderingIntent(t,i){}setFlatness(t,i){}setGState(t,i){for(const[s,a]of i)switch(s){case"LW":this.setLineWidth(t,a);break;case"LC":this.setLineCap(t,a);break;case"LJ":this.setLineJoin(t,a);break;case"ML":this.setMiterLimit(t,a);break;case"D":this.setDash(t,a[0],a[1]);break;case"RI":this.setRenderingIntent(t,a);break;case"FL":this.setFlatness(t,a);break;case"Font":this.setFont(t,a[0],a[1]);break;case"CA":this.dependencyTracker?.recordSimpleData("strokeAlpha",t),this.current.strokeAlpha=a;break;case"ca":this.dependencyTracker?.recordSimpleData("fillAlpha",t),this.ctx.globalAlpha=this.current.fillAlpha=a;break;case"BM":this.dependencyTracker?.recordSimpleData("globalCompositeOperation",t),this.ctx.globalCompositeOperation=a;break;case"SMask":this.dependencyTracker?.recordSimpleData("SMask",t),this.current.activeSMask=a?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.dependencyTracker?.recordSimpleData("filter",t),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(a);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(t){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const i=this.ctx.canvas.width,s=this.ctx.canvas.height,a="smaskGroupAt"+this.groupLevel,o=this.cachedCanvases.getCanvas(a,i,s);this.suspendedCtx=this.ctx;const l=this.ctx=o.context;l.setTransform(this.suspendedCtx.getTransform()),lr(this.suspendedCtx,l),kv(l,this.suspendedCtx),this.setGState(t,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),lr(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const i=this.current.activeSMask,s=this.suspendedCtx;this.composeSMask(s,i,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,i,s,a){const o=a[0],l=a[1],u=a[2]-o,h=a[3]-l;u===0||h===0||(this.genericComposeSMask(i.context,s,u,h,i.subtype,i.backdrop,i.transferMap,o,l,i.offsetX,i.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(s.canvas,0,0),t.restore())}genericComposeSMask(t,i,s,a,o,l,u,h,d,p,b){let v=t.canvas,A=h-p,w=d-b;if(l)if(A<0||w<0||A+s>v.width||w+a>v.height){const C=this.cachedCanvases.getCanvas("maskExtension",s,a),E=C.context;E.drawImage(v,-A,-w),E.globalCompositeOperation="destination-atop",E.fillStyle=l,E.fillRect(0,0,s,a),E.globalCompositeOperation="source-over",v=C.canvas,A=w=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const C=new Path2D;C.rect(A,w,s,a),t.clip(C),t.globalCompositeOperation="destination-atop",t.fillStyle=l,t.fillRect(A,w,s,a),t.restore()}i.save(),i.globalAlpha=1,i.setTransform(1,0,0,1,0,0),o==="Alpha"&&u?i.filter=this.filterFactory.addAlphaFilter(u):o==="Luminosity"&&(i.filter=this.filterFactory.addLuminosityFilter(u));const S=new Path2D;S.rect(h,d,s,a),i.clip(S),i.globalCompositeOperation="destination-in",i.drawImage(v,A,w,s,a,h,d,s,a),i.restore()}save(t){this.inSMaskMode&&lr(this.ctx,this.suspendedCtx),this.ctx.save();const i=this.current;this.stateStack.push(i),this.current=i.clone(),this.dependencyTracker?.save(t)}restore(t){if(this.dependencyTracker?.restore(t),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&lr(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(t,i,s,a,o,l,u){this.dependencyTracker?.recordIncrementalData("transform",t),this.ctx.transform(i,s,a,o,l,u),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,i,s,a){let[o]=s;if(!a){o||=s[0]=new Path2D,this[i](t,o);return}if(this.dependencyTracker!==null){const l=i===br.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(t).recordBBox(t,this.ctx,a[0]-l,a[2]+l,a[1]-l,a[3]+l).recordDependencies(t,["transform"])}if(!(o instanceof Path2D)){const l=s[0]=new Path2D;for(let u=0,h=o.length;u<h;)switch(o[u++]){case Vo.moveTo:l.moveTo(o[u++],o[u++]);break;case Vo.lineTo:l.lineTo(o[u++],o[u++]);break;case Vo.curveTo:l.bezierCurveTo(o[u++],o[u++],o[u++],o[u++],o[u++],o[u++]);break;case Vo.closePath:l.closePath();break;default:Ct(`Unrecognized drawing path operator: ${o[u-1]}`);break}o=l}dt.axialAlignedBoundingBox(a,ae(this.ctx),this.current.minMax),this[i](t,o),this._pathStartIdx=t}closePath(t){this.ctx.closePath()}stroke(t,i,s=!0){const a=this.ctx,o=this.current.strokeColor;if(a.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof o=="object"&&o?.getPattern){const l=o.isModifyingCurrentTransform()?a.getTransform():null;if(a.save(),a.strokeStyle=o.getPattern(a,this,Ii(a),Oe.STROKE,t),l){const u=new Path2D;u.addPath(i,a.getTransform().invertSelf().multiplySelf(l)),i=u}this.rescaleAndStroke(i,!1),a.restore()}else this.rescaleAndStroke(i,!0);this.dependencyTracker?.recordDependencies(t,Ei.stroke),s&&this.consumePath(t,i,this.current.getClippedPathBoundingBox(Oe.STROKE,ae(this.ctx))),a.globalAlpha=this.current.fillAlpha}closeStroke(t,i){this.stroke(t,i)}fill(t,i,s=!0){const a=this.ctx,o=this.current.fillColor,l=this.current.patternFill;let u=!1;if(l){const d=o.isModifyingCurrentTransform()?a.getTransform():null;if(this.dependencyTracker?.save(t),a.save(),a.fillStyle=o.getPattern(a,this,Ii(a),Oe.FILL,t),d){const p=new Path2D;p.addPath(i,a.getTransform().invertSelf().multiplySelf(d)),i=p}u=!0}const h=this.current.getClippedPathBoundingBox();this.contentVisible&&h!==null&&(this.pendingEOFill?(a.fill(i,"evenodd"),this.pendingEOFill=!1):a.fill(i)),this.dependencyTracker?.recordDependencies(t,Ei.fill),u&&(a.restore(),this.dependencyTracker?.restore(t)),s&&this.consumePath(t,i,h)}eoFill(t,i){this.pendingEOFill=!0,this.fill(t,i)}fillStroke(t,i){this.fill(t,i,!1),this.stroke(t,i,!1),this.consumePath(t,i)}eoFillStroke(t,i){this.pendingEOFill=!0,this.fillStroke(t,i)}closeFillStroke(t,i){this.fillStroke(t,i)}closeEOFillStroke(t,i){this.pendingEOFill=!0,this.fillStroke(t,i)}endPath(t,i){this.consumePath(t,i)}rawFillPath(t,i){this.ctx.fill(i),this.dependencyTracker?.recordDependencies(t,Ei.rawFillPath).recordOperation(t)}clip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=Bv}eoClip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=Jp}beginText(t){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,this.dependencyTracker?.recordOpenMarker(t).resetIncrementalData("sameLineText").resetIncrementalData("moveText",t)}endText(t){const i=this.pendingTextPaths,s=this.ctx;if(this.dependencyTracker){const{dependencyTracker:a}=this;i!==void 0&&a.recordFutureForcedDependency("textClip",a.getOpenMarker()).recordFutureForcedDependency("textClip",t),a.recordCloseMarker(t)}if(i!==void 0){const a=new Path2D,o=s.getTransform().invertSelf();for(const{transform:l,x:u,y:h,fontSize:d,path:p}of i)p&&a.addPath(p,new DOMMatrix(l).preMultiplySelf(o).translate(u,h).scale(d,-d));s.clip(a)}delete this.pendingTextPaths}setCharSpacing(t,i){this.dependencyTracker?.recordSimpleData("charSpacing",t),this.current.charSpacing=i}setWordSpacing(t,i){this.dependencyTracker?.recordSimpleData("wordSpacing",t),this.current.wordSpacing=i}setHScale(t,i){this.dependencyTracker?.recordSimpleData("hScale",t),this.current.textHScale=i/100}setLeading(t,i){this.dependencyTracker?.recordSimpleData("leading",t),this.current.leading=-i}setFont(t,i,s){this.dependencyTracker?.recordSimpleData("font",t).recordSimpleDataFromNamed("fontObj",i,t);const a=this.commonObjs.get(i),o=this.current;if(!a)throw new Error(`Can't find font for ${i}`);if(o.fontMatrix=a.fontMatrix||qu,(o.fontMatrix[0]===0||o.fontMatrix[3]===0)&&Ct("Invalid font matrix for font "+i),s<0?(s=-s,o.fontDirection=-1):o.fontDirection=1,this.current.font=a,this.current.fontSize=s,a.isType3Font)return;const l=a.loadedName||"sans-serif",u=a.systemFontInfo?.css||`"${l}", ${a.fallbackName}`;let h="normal";a.black?h="900":a.bold&&(h="bold");const d=a.italic?"italic":"normal";let p=s;s<Yp?p=Yp:s>Xp&&(p=Xp),this.current.fontSizeScale=s/p,this.ctx.font=`${d} ${h} ${p}px ${u}`}setTextRenderingMode(t,i){this.dependencyTracker?.recordSimpleData("textRenderingMode",t),this.current.textRenderingMode=i}setTextRise(t,i){this.dependencyTracker?.recordSimpleData("textRise",t),this.current.textRise=i}moveText(t,i,s){this.dependencyTracker?.resetIncrementalData("sameLineText").recordIncrementalData("moveText",t),this.current.x=this.current.lineX+=i,this.current.y=this.current.lineY+=s}setLeadingMoveText(t,i,s){this.setLeading(t,-s),this.moveText(t,i,s)}setTextMatrix(t,i){this.dependencyTracker?.recordSimpleData("textMatrix",t);const{current:s}=this;s.textMatrix=i,s.textMatrixScale=Math.hypot(i[0],i[1]),s.x=s.lineX=0,s.y=s.lineY=0}nextLine(t){this.moveText(t,0,this.current.leading),this.dependencyTracker?.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??t)}#n(t,i,s){const a=new Path2D;return a.addPath(t,new DOMMatrix(s).invertSelf().multiplySelf(i)),a}paintChar(t,i,s,a,o,l){const u=this.ctx,h=this.current,d=h.font,p=h.textRenderingMode,b=h.fontSize/h.fontSizeScale,v=p&Re.FILL_STROKE_MASK,A=!!(p&Re.ADD_TO_PATH_FLAG),w=h.patternFill&&!d.missingFile,S=h.patternStroke&&!d.missingFile;let C;if((d.disableFontFace||A||w||S)&&!d.missingFile&&(C=d.getPathGenerator(this.commonObjs,i)),C&&(d.disableFontFace||w||S)){u.save(),u.translate(s,a),u.scale(b,-b),this.dependencyTracker?.recordCharacterBBox(t,u,d);let E;if(v===Re.FILL||v===Re.FILL_STROKE)if(o){E=u.getTransform(),u.setTransform(...o);const k=this.#n(C,E,o);u.fill(k)}else u.fill(C);if(v===Re.STROKE||v===Re.FILL_STROKE)if(l){E||=u.getTransform(),u.setTransform(...l);const{a:k,b:O,c:P,d:z}=E,L=dt.inverseTransform(l),j=dt.transform([k,O,P,z,0,0],L);dt.singularValueDecompose2dScale(j,ui),u.lineWidth*=Math.max(ui[0],ui[1])/b,u.stroke(this.#n(C,E,l))}else u.lineWidth/=b,u.stroke(C);u.restore()}else(v===Re.FILL||v===Re.FILL_STROKE)&&(u.fillText(i,s,a),this.dependencyTracker?.recordCharacterBBox(t,u,d,b,s,a,()=>u.measureText(i))),(v===Re.STROKE||v===Re.FILL_STROKE)&&(this.dependencyTracker&&this.dependencyTracker?.recordCharacterBBox(t,u,d,b,s,a,()=>u.measureText(i)).recordDependencies(t,Ei.stroke),u.strokeText(i,s,a));A&&((this.pendingTextPaths||=[]).push({transform:ae(u),x:s,y:a,fontSize:b,path:C}),this.dependencyTracker?.recordCharacterBBox(t,u,d,b,s,a))}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const i=t.getImageData(0,0,10,10).data;let s=!1;for(let a=3;a<i.length;a+=4)if(i[a]>0&&i[a]<255){s=!0;break}return Mt(this,"isFontSubpixelAAEnabled",s)}showText(t,i){this.dependencyTracker&&(this.dependencyTracker.recordDependencies(t,Ei.showText).resetBBox(t),this.current.textRenderingMode&Re.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",t).inheritPendingDependenciesAsFutureForcedDependencies());const s=this.current,a=s.font;if(a.isType3Font){this.showType3Text(t,i),this.dependencyTracker?.recordShowTextOperation(t);return}const o=s.fontSize;if(o===0){this.dependencyTracker?.recordOperation(t);return}const l=this.ctx,u=s.fontSizeScale,h=s.charSpacing,d=s.wordSpacing,p=s.fontDirection,b=s.textHScale*p,v=i.length,A=a.vertical,w=A?1:-1,S=a.defaultVMetrics,C=o*s.fontMatrix[0],E=s.textRenderingMode===Re.FILL&&!a.disableFontFace&&!s.patternFill;l.save(),s.textMatrix&&l.transform(...s.textMatrix),l.translate(s.x,s.y+s.textRise),p>0?l.scale(b,-1):l.scale(b,1);let k,O;if(s.patternFill){l.save();const D=s.fillColor.getPattern(l,this,Ii(l),Oe.FILL,t);k=ae(l),l.restore(),l.fillStyle=D}if(s.patternStroke){l.save();const D=s.strokeColor.getPattern(l,this,Ii(l),Oe.STROKE,t);O=ae(l),l.restore(),l.strokeStyle=D}let P=s.lineWidth;const z=s.textMatrixScale;if(z===0||P===0){const D=s.textRenderingMode&Re.FILL_STROKE_MASK;(D===Re.STROKE||D===Re.FILL_STROKE)&&(P=this.getSinglePixelWidth())}else P/=z;if(u!==1&&(l.scale(u,u),P/=u),l.lineWidth=P,a.isInvalidPDFjsFont){const D=[];let N=0;for(const $ of i)D.push($.unicode),N+=$.width;const U=D.join("");if(l.fillText(U,0,0),this.dependencyTracker!==null){const $=l.measureText(U);this.dependencyTracker.recordBBox(t,this.ctx,-$.actualBoundingBoxLeft,$.actualBoundingBoxRight,-$.actualBoundingBoxAscent,$.actualBoundingBoxDescent).recordShowTextOperation(t)}s.x+=N*C*b,l.restore(),this.compose();return}let L=0,j;for(j=0;j<v;++j){const D=i[j];if(typeof D=="number"){L+=w*D*o/1e3;continue}let N=!1;const U=(D.isSpace?d:0)+h,$=D.fontChar,tt=D.accent;let at,gt,bt=D.width;if(A){const et=D.vmetric||S,it=-(D.vmetric?et[1]:bt*.5)*C,ut=et[2]*C;bt=et?-et[0]:bt,at=it/u,gt=(L+ut)/u}else at=L/u,gt=0;let F;if(a.remeasure&&bt>0){F=l.measureText($);const et=F.width*1e3/o*u;if(bt<et&&this.isFontSubpixelAAEnabled){const it=bt/et;N=!0,l.save(),l.scale(it,1),at/=it}else bt!==et&&(at+=(bt-et)/2e3*o/u)}if(this.contentVisible&&(D.isInFont||a.missingFile)){if(E&&!tt)l.fillText($,at,gt),this.dependencyTracker?.recordCharacterBBox(t,l,F?{bbox:null}:a,o/u,at,gt,()=>F??l.measureText($));else if(this.paintChar(t,$,at,gt,k,O),tt){const et=at+o*tt.offset.x/u,it=gt-o*tt.offset.y/u;this.paintChar(t,tt.fontChar,et,it,k,O)}}const q=A?bt*C-U*p:bt*C+U*p;L+=q,N&&l.restore()}A?s.y-=L:s.x+=L*b,l.restore(),this.compose(),this.dependencyTracker?.recordShowTextOperation(t)}showType3Text(t,i){const s=this.ctx,a=this.current,o=a.font,l=a.fontSize,u=a.fontDirection,h=o.vertical?1:-1,d=a.charSpacing,p=a.wordSpacing,b=a.textHScale*u,v=a.fontMatrix||qu,A=i.length,w=a.textRenderingMode===Re.INVISIBLE;let S,C,E,k;if(w||l===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,s.save(),a.textMatrix&&s.transform(...a.textMatrix),s.translate(a.x,a.y+a.textRise),s.scale(b,u);const O=this.dependencyTracker;for(this.dependencyTracker=O?new rl(O,t):null,S=0;S<A;++S){if(C=i[S],typeof C=="number"){k=h*C*l/1e3,this.ctx.translate(k,0),a.x+=k*b;continue}const P=(C.isSpace?p:0)+d,z=o.charProcOperatorList[C.operatorListId];z?this.contentVisible&&(this.save(),s.scale(l,l),s.transform(...v),this.executeOperatorList(z),this.restore()):Ct(`Type3 character "${C.operatorListId}" is not available.`);const L=[C.width,0];dt.applyTransform(L,v),E=L[0]*l+P,s.translate(E,0),a.x+=E*b}s.restore(),O&&(this.dependencyTracker=O)}setCharWidth(t,i,s){}setCharWidthAndBounds(t,i,s,a,o,l,u){const h=new Path2D;h.rect(a,o,l-a,u-o),this.ctx.clip(h),this.dependencyTracker?.recordBBox(t,this.ctx,a,l,o,u).recordClipBox(t,this.ctx,a,l,o,u),this.endPath(t)}getColorN_Pattern(t,i){let s;if(i[0]==="TilingPattern"){const a=this.baseTransform||ae(this.ctx),o={createCanvasGraphics:(l,u)=>new oa(l,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new rl(this.dependencyTracker,u,!0):null)};s=new fh(i,this.ctx,o,a)}else s=this._getPattern(t,i[1],i[2]);return s}setStrokeColorN(t,...i){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.current.strokeColor=this.getColorN_Pattern(t,i),this.current.patternStroke=!0}setFillColorN(t,...i){this.dependencyTracker?.recordSimpleData("fillColor",t),this.current.fillColor=this.getColorN_Pattern(t,i),this.current.patternFill=!0}setStrokeRGBColor(t,i){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor=i,this.current.patternStroke=!1}setStrokeTransparent(t){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(t,i){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor=i,this.current.patternFill=!1}setFillTransparent(t){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,i,s=null){let a;return this.cachedPatterns.has(i)?a=this.cachedPatterns.get(i):(a=Nv(this.getObject(t,i)),this.cachedPatterns.set(i,a)),s&&(a.matrix=s),a}shadingFill(t,i){if(!this.contentVisible)return;const s=this.ctx;this.save(t);const a=this._getPattern(t,i);s.fillStyle=a.getPattern(s,this,Ii(s),Oe.SHADING,t);const o=Ii(s);if(o){const{width:l,height:u}=s.canvas,h=aa.slice();dt.axialAlignedBoundingBox([0,0,l,u],o,h);const[d,p,b,v]=h;this.ctx.fillRect(d,p,b-d,v-p)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.dependencyTracker?.resetBBox(t).recordFullPageBBox(t).recordDependencies(t,Ei.transform).recordDependencies(t,Ei.fill).recordOperation(t),this.compose(this.current.getClippedPathBoundingBox()),this.restore(t)}beginInlineImage(){Jt("Should not call beginInlineImage")}beginImageData(){Jt("Should not call beginImageData")}paintFormXObjectBegin(t,i,s){if(this.contentVisible&&(this.save(t),this.baseTransformStack.push(this.baseTransform),i&&this.transform(t,...i),this.baseTransform=ae(this.ctx),s)){dt.axialAlignedBoundingBox(s,this.baseTransform,this.current.minMax);const[a,o,l,u]=s,h=new Path2D;h.rect(a,o,l-a,u-o),this.ctx.clip(h),this.dependencyTracker?.recordClipBox(t,this.ctx,a,l,o,u),this.endPath(t)}}paintFormXObjectEnd(t){this.contentVisible&&(this.restore(t),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t,i){if(!this.contentVisible)return;this.save(t),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const s=this.ctx;i.isolated||hl("TODO: Support non-isolated groups."),i.knockout&&Ct("Knockout groups not supported.");const a=ae(s);if(i.matrix&&s.transform(...i.matrix),!i.bbox)throw new Error("Bounding box is required.");let o=aa.slice();dt.axialAlignedBoundingBox(i.bbox,ae(s),o);const l=[0,0,s.canvas.width,s.canvas.height];o=dt.intersect(o,l)||[0,0,0,0];const u=Math.floor(o[0]),h=Math.floor(o[1]),d=Math.max(Math.ceil(o[2])-u,1),p=Math.max(Math.ceil(o[3])-h,1);this.current.startNewPathAndClipBox([0,0,d,p]);let b="groupAt"+this.groupLevel;i.smask&&(b+="_smask_"+this.smaskCounter++%2);const v=this.cachedCanvases.getCanvas(b,d,p),A=v.context;A.translate(-u,-h),A.transform(...a);let w=new Path2D;const[S,C,E,k]=i.bbox;if(w.rect(S,C,E-S,k-C),i.matrix){const O=new Path2D;O.addPath(w,new DOMMatrix(i.matrix)),w=O}A.clip(w),i.smask&&this.smaskStack.push({canvas:v.canvas,context:A,offsetX:u,offsetY:h,subtype:i.smask.subtype,backdrop:i.smask.backdrop,transferMap:i.smask.transferMap||null,startTransformInverse:null}),(!i.smask||this.dependencyTracker)&&(s.setTransform(1,0,0,1,0,0),s.translate(u,h),s.save()),lr(s,A),this.ctx=A,this.dependencyTracker?.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(s),this.setGState(t,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(s),this.groupLevel++}endGroup(t,i){if(!this.contentVisible)return;this.groupLevel--;const s=this.ctx,a=this.groupStack.pop();if(this.ctx=a,this.ctx.imageSmoothingEnabled=!1,this.dependencyTracker?.popBaseTransform(),i.smask)this.tempSMask=this.smaskStack.pop(),this.restore(t),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const o=ae(this.ctx);this.restore(t),this.ctx.save(),this.ctx.setTransform(...o);const l=aa.slice();dt.axialAlignedBoundingBox([0,0,s.canvas.width,s.canvas.height],o,l),this.ctx.drawImage(s.canvas,0,0),this.ctx.restore(),this.compose(l)}}beginAnnotation(t,i,s,a,o,l){if(this.#t(),Zo(this.ctx),this.ctx.save(),this.save(t),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),s){const u=s[2]-s[0],h=s[3]-s[1];if(l&&this.annotationCanvasMap){a=a.slice(),a[4]-=s[0],a[5]-=s[1],s=s.slice(),s[0]=s[1]=0,s[2]=u,s[3]=h,dt.singularValueDecompose2dScale(ae(this.ctx),ui);const{viewportScale:d}=this,p=Math.ceil(u*this.outputScaleX*d),b=Math.ceil(h*this.outputScaleY*d);this.annotationCanvas=this.canvasFactory.create(p,b);const{canvas:v,context:A}=this.annotationCanvas;this.annotationCanvasMap.set(i,v),this.annotationCanvas.savedCtx=this.ctx,this.ctx=A,this.ctx.save(),this.ctx.setTransform(ui[0],0,0,-ui[1],0,h*ui[1]),Zo(this.ctx)}else{Zo(this.ctx),this.endPath(t);const d=new Path2D;d.rect(s[0],s[1],u,h),this.ctx.clip(d)}}this.current=new Kp(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(t,...a),this.transform(t,...o)}endAnnotation(t){this.annotationCanvas&&(this.ctx.restore(),this.#e(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t,i){if(!this.contentVisible)return;const s=i.count;i=this.getObject(t,i.data,i),i.count=s;const a=this.ctx,o=this._createMaskCanvas(t,i),l=o.canvas;a.save(),a.setTransform(1,0,0,1,0,0),a.drawImage(l,o.offsetX,o.offsetY),this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,o.offsetX,o.offsetX+l.width,o.offsetY,o.offsetY+l.height).recordOperation(t),a.restore(),this.compose()}paintImageMaskXObjectRepeat(t,i,s,a=0,o=0,l,u){if(!this.contentVisible)return;i=this.getObject(t,i.data,i);const h=this.ctx;h.save();const d=ae(h);h.transform(s,a,o,l,0,0);const p=this._createMaskCanvas(t,i);h.setTransform(1,0,0,1,p.offsetX-d[4],p.offsetY-d[5]),this.dependencyTracker?.resetBBox(t);for(let b=0,v=u.length;b<v;b+=2){const A=dt.transform(d,[s,a,o,l,u[b],u[b+1]]);h.drawImage(p.canvas,A[4],A[5]),this.dependencyTracker?.recordBBox(t,this.ctx,A[4],A[4]+p.canvas.width,A[5],A[5]+p.canvas.height)}h.restore(),this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageMaskXObjectGroup(t,i){if(!this.contentVisible)return;const s=this.ctx,a=this.current.fillColor,o=this.current.patternFill;this.dependencyTracker?.resetBBox(t).recordDependencies(t,Ei.transformAndFill);for(const l of i){const{data:u,width:h,height:d,transform:p}=l,b=this.cachedCanvases.getCanvas("maskCanvas",h,d),v=b.context;v.save();const A=this.getObject(t,u,l);Wp(v,A),v.globalCompositeOperation="source-in",v.fillStyle=o?a.getPattern(v,this,Ii(s),Oe.FILL,t):a,v.fillRect(0,0,h,d),v.restore(),s.save(),s.transform(...p),s.scale(1,-1),Wo(s,b.canvas,0,0,h,d,0,-1,1,1),this.dependencyTracker?.recordBBox(t,s,0,h,0,d),s.restore()}this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageXObject(t,i){if(!this.contentVisible)return;const s=this.getObject(t,i);if(!s){Ct("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t,s)}paintImageXObjectRepeat(t,i,s,a,o){if(!this.contentVisible)return;const l=this.getObject(t,i);if(!l){Ct("Dependent image isn't ready yet");return}const u=l.width,h=l.height,d=[];for(let p=0,b=o.length;p<b;p+=2)d.push({transform:[s,0,0,a,o[p],o[p+1]],x:0,y:0,w:u,h});this.paintInlineImageXObjectGroup(t,l,d)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:i,width:s,height:a}=t,o=this.cachedCanvases.getCanvas("inlineImage",s,a),l=o.context;return l.filter=this.current.transferMaps,l.drawImage(i,0,0),l.filter="none",o.canvas}paintInlineImageXObject(t,i){if(!this.contentVisible)return;const s=i.width,a=i.height,o=this.ctx;this.save(t);const{filter:l}=o;l!=="none"&&l!==""&&(o.filter="none"),o.scale(1/s,-1/a);let u;if(i.bitmap)u=this.applyTransferMapsToBitmap(i);else if(typeof HTMLElement=="function"&&i instanceof HTMLElement||!i.data)u=i;else{const p=this.cachedCanvases.getCanvas("inlineImage",s,a).context;Qp(p,i),u=this.applyTransferMapsToCanvas(p)}const h=this._scaleImage(u,Ii(o));o.imageSmoothingEnabled=Zp(ae(o),i.interpolate),this.dependencyTracker?.resetBBox(t).recordBBox(t,o,0,s,-a,0).recordDependencies(t,Ei.imageXObject).recordOperation(t),Wo(o,h.img,0,0,h.paintWidth,h.paintHeight,0,-a,s,a),this.compose(),this.restore(t)}paintInlineImageXObjectGroup(t,i,s){if(!this.contentVisible)return;const a=this.ctx;let o;if(i.bitmap)o=i.bitmap;else{const l=i.width,u=i.height,d=this.cachedCanvases.getCanvas("inlineImage",l,u).context;Qp(d,i),o=this.applyTransferMapsToCanvas(d)}this.dependencyTracker?.resetBBox(t);for(const l of s)a.save(),a.transform(...l.transform),a.scale(1,-1),Wo(a,o,l.x,l.y,l.w,l.h,0,-1,1,1),this.dependencyTracker?.recordBBox(t,a,0,1,-1,0),a.restore();this.dependencyTracker?.recordOperation(t),this.compose()}paintSolidColorImageMask(t){this.contentVisible&&(this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,0,1,0,1).recordDependencies(t,Ei.fill).recordOperation(t),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t,i){}markPointProps(t,i,s){}beginMarkedContent(t,i){this.dependencyTracker?.beginMarkedContent(t),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,i,s){this.dependencyTracker?.beginMarkedContent(t),i==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(s)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(t){this.dependencyTracker?.endMarkedContent(t),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(t){}endCompat(t){}consumePath(t,i,s){const a=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(s);const o=this.ctx;this.pendingClip?(a||(this.pendingClip===Jp?o.clip(i,"evenodd"):o.clip(i)),this.pendingClip=null,this.dependencyTracker?.bboxToClipBoxDropOperation(t).recordFutureForcedDependency("clipPath",t)):this.dependencyTracker?.recordOperation(t),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=ae(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const i=Math.abs(t[0]*t[3]-t[2]*t[1]),s=Math.hypot(t[0],t[2]),a=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(s,a)/i}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:i,b:s,c:a,d:o}=this.ctx.getTransform();let l,u;if(s===0&&a===0){const h=Math.abs(i),d=Math.abs(o);if(h===d)if(t===0)l=u=1/h;else{const p=h*t;l=u=p<1?1/p:1}else if(t===0)l=1/h,u=1/d;else{const p=h*t,b=d*t;l=p<1?1/p:1,u=b<1?1/b:1}}else{const h=Math.abs(i*o-s*a),d=Math.hypot(i,s),p=Math.hypot(a,o);if(t===0)l=p/h,u=d/h;else{const b=t*h;l=p>b?p/b:1,u=d>b?d/b:1}}this._cachedScaleForStroking[0]=l,this._cachedScaleForStroking[1]=u}return this._cachedScaleForStroking}rescaleAndStroke(t,i){const{ctx:s,current:{lineWidth:a}}=this,[o,l]=this.getScaleForStroking();if(o===l){s.lineWidth=(a||1)*o,s.stroke(t);return}const u=s.getLineDash();i&&s.save(),s.scale(o,l),Iu.a=1/o,Iu.d=1/l;const h=new Path2D;if(h.addPath(t,Iu),u.length>0){const d=Math.max(o,l);s.setLineDash(u.map(p=>p/d)),s.lineDashOffset/=d}s.lineWidth=a||1,s.stroke(h),i&&s.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}}for(const g in br)oa.prototype[g]!==void 0&&(oa.prototype[br[g]]=oa.prototype[g]);class la{#t;#e;#n;static strings=["fontFamily","fontWeight","italicAngle"];static write(t){const i=new TextEncoder,s={};let a=0;for(const d of la.strings){const p=i.encode(t[d]);s[d]=p,a+=4+p.length}const o=new ArrayBuffer(a),l=new Uint8Array(o),u=new DataView(o);let h=0;for(const d of la.strings){const p=s[d],b=p.length;u.setUint32(h,b),l.set(p,h+4),h+=4+b}return zt(h===o.byteLength,"CssFontInfo.write: Buffer overflow"),o}constructor(t){this.#t=t,this.#e=new DataView(this.#t),this.#n=new TextDecoder}#i(t){zt(t<la.strings.length,"Invalid string index");let i=0;for(let a=0;a<t;a++)i+=this.#e.getUint32(i)+4;const s=this.#e.getUint32(i);return this.#n.decode(new Uint8Array(this.#t,i+4,s))}get fontFamily(){return this.#i(0)}get fontWeight(){return this.#i(1)}get italicAngle(){return this.#i(2)}}class ca{#t;#e;#n;static strings=["css","loadedName","baseFontName","src"];static write(t){const i=new TextEncoder,s={};let a=0;for(const v of ca.strings){const A=i.encode(t[v]);s[v]=A,a+=4+A.length}a+=4;let o,l,u=1+a;t.style&&(o=i.encode(t.style.style),l=i.encode(t.style.weight),u+=4+o.length+4+l.length);const h=new ArrayBuffer(u),d=new Uint8Array(h),p=new DataView(h);let b=0;p.setUint8(b++,t.guessFallback?1:0),p.setUint32(b,0),b+=4,a=0;for(const v of ca.strings){const A=s[v],w=A.length;a+=4+w,p.setUint32(b,w),d.set(A,b+4),b+=4+w}return p.setUint32(b-a-4,a),t.style&&(p.setUint32(b,o.length),d.set(o,b+4),b+=4+o.length,p.setUint32(b,l.length),d.set(l,b+4),b+=4+l.length),zt(b<=h.byteLength,"SubstitionInfo.write: Buffer overflow"),h.transferToFixedLength(b)}constructor(t){this.#t=t,this.#e=new DataView(this.#t),this.#n=new TextDecoder}get guessFallback(){return this.#e.getUint8(0)!==0}#i(t){zt(t<ca.strings.length,"Invalid string index");let i=5;for(let a=0;a<t;a++)i+=this.#e.getUint32(i)+4;const s=this.#e.getUint32(i);return this.#n.decode(new Uint8Array(this.#t,i+4,s))}get css(){return this.#i(0)}get loadedName(){return this.#i(1)}get baseFontName(){return this.#i(2)}get src(){return this.#i(3)}get style(){let t=1;t+=4+this.#e.getUint32(t);const i=this.#e.getUint32(t),s=this.#n.decode(new Uint8Array(this.#t,t+4,i));t+=4+i;const a=this.#e.getUint32(t),o=this.#n.decode(new Uint8Array(this.#t,t+4,a));return{style:s,weight:o}}}class Wt{static bools=["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"];static numbers=["ascent","defaultWidth","descent"];static strings=["fallbackName","loadedName","mimetype","name"];static#t=Math.ceil(this.bools.length*2/8);static#e=this.#t+this.numbers.length*8;static#n=this.#e+1+8;static#i=this.#n+1+48;static#r=this.#i+1+6;#s;#a;#o;constructor({data:t,extra:i}){this.#s=t,this.#a=new TextDecoder,this.#o=new DataView(this.#s),i&&Object.assign(this,i)}#c(t){zt(t<Wt.bools.length,"Invalid boolean index");const i=Math.floor(t/4),s=t*2%8,a=this.#o.getUint8(i)>>s&3;return a===0?void 0:a===2}get black(){return this.#c(0)}get bold(){return this.#c(1)}get disableFontFace(){return this.#c(2)}get fontExtraProperties(){return this.#c(3)}get isInvalidPDFjsFont(){return this.#c(4)}get isType3Font(){return this.#c(5)}get italic(){return this.#c(6)}get missingFile(){return this.#c(7)}get remeasure(){return this.#c(8)}get vertical(){return this.#c(9)}#l(t){return zt(t<Wt.numbers.length,"Invalid number index"),this.#o.getFloat64(Wt.#t+t*8)}get ascent(){return this.#l(0)}get defaultWidth(){return this.#l(1)}get descent(){return this.#l(2)}get bbox(){let t=Wt.#e;if(this.#o.getUint8(t)===0)return;t+=1;const s=[];for(let a=0;a<4;a++)s.push(this.#o.getInt16(t,!0)),t+=2;return s}get fontMatrix(){let t=Wt.#n;if(this.#o.getUint8(t)===0)return;t+=1;const s=[];for(let a=0;a<6;a++)s.push(this.#o.getFloat64(t,!0)),t+=8;return s}get defaultVMetrics(){let t=Wt.#i;if(this.#o.getUint8(t)===0)return;t+=1;const s=[];for(let a=0;a<3;a++)s.push(this.#o.getInt16(t,!0)),t+=2;return s}#d(t){zt(t<Wt.strings.length,"Invalid string index");let i=Wt.#r+4;for(let o=0;o<t;o++)i+=this.#o.getUint32(i)+4;const s=this.#o.getUint32(i),a=new Uint8Array(s);return a.set(new Uint8Array(this.#s,i+4,s)),this.#a.decode(a)}get fallbackName(){return this.#d(0)}get loadedName(){return this.#d(1)}get mimetype(){return this.#d(2)}get name(){return this.#d(3)}get data(){let t=Wt.#r;const i=this.#o.getUint32(t);t+=4+i;const s=this.#o.getUint32(t);t+=4+s;const a=this.#o.getUint32(t);t+=4+a;const o=this.#o.getUint32(t);if(o!==0)return new Uint8Array(this.#s,t+4,o)}clearData(){let t=Wt.#r;const i=this.#o.getUint32(t);t+=4+i;const s=this.#o.getUint32(t);t+=4+s;const a=this.#o.getUint32(t);t+=4+a;const o=this.#o.getUint32(t);new Uint8Array(this.#s,t+4,o).fill(0),this.#o.setUint32(t,0)}get cssFontInfo(){let t=Wt.#r;const i=this.#o.getUint32(t);t+=4+i;const s=this.#o.getUint32(t);t+=4+s;const a=this.#o.getUint32(t);if(a===0)return null;const o=new Uint8Array(a);return o.set(new Uint8Array(this.#s,t+4,a)),new la(o.buffer)}get systemFontInfo(){let t=Wt.#r;const i=this.#o.getUint32(t);t+=4+i;const s=this.#o.getUint32(t);if(s===0)return null;const a=new Uint8Array(s);return a.set(new Uint8Array(this.#s,t+4,s)),new ca(a.buffer)}static write(t){const i=t.systemFontInfo?ca.write(t.systemFontInfo):null,s=t.cssFontInfo?la.write(t.cssFontInfo):null,a=new TextEncoder,o={};let l=0;for(const S of Wt.strings)o[S]=a.encode(t[S]),l+=4+o[S].length;const u=Wt.#r+4+l+4+(i?i.byteLength:0)+4+(s?s.byteLength:0)+4+(t.data?t.data.length:0),h=new ArrayBuffer(u),d=new Uint8Array(h),p=new DataView(h);let b=0;const v=Wt.bools.length;let A=0,w=0;for(let S=0;S<v;S++){const C=t[Wt.bools[S]];A|=(C===void 0?0:C?2:1)<<w,w+=2,(w===8||S===v-1)&&(p.setUint8(b++,A),A=0,w=0)}zt(b===Wt.#t,"FontInfo.write: Boolean properties offset mismatch");for(const S of Wt.numbers)p.setFloat64(b,t[S]),b+=8;if(zt(b===Wt.#e,"FontInfo.write: Number properties offset mismatch"),t.bbox){p.setUint8(b++,4);for(const S of t.bbox)p.setInt16(b,S,!0),b+=2}else p.setUint8(b++,0),b+=8;if(zt(b===Wt.#n,"FontInfo.write: BBox properties offset mismatch"),t.fontMatrix){p.setUint8(b++,6);for(const S of t.fontMatrix)p.setFloat64(b,S,!0),b+=8}else p.setUint8(b++,0),b+=48;if(zt(b===Wt.#i,"FontInfo.write: FontMatrix properties offset mismatch"),t.defaultVMetrics){p.setUint8(b++,1);for(const S of t.defaultVMetrics)p.setInt16(b,S,!0),b+=2}else p.setUint8(b++,0),b+=6;zt(b===Wt.#r,"FontInfo.write: DefaultVMetrics properties offset mismatch"),p.setUint32(Wt.#r,0),b+=4;for(const S of Wt.strings){const C=o[S],E=C.length;p.setUint32(b,E),d.set(C,b+4),b+=4+E}if(p.setUint32(Wt.#r,b-Wt.#r-4),!i)p.setUint32(b,0),b+=4;else{const S=i.byteLength;p.setUint32(b,S),zt(b+4+S<=h.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),d.set(new Uint8Array(i),b+4),b+=4+S}if(!s)p.setUint32(b,0),b+=4;else{const S=s.byteLength;p.setUint32(b,S),zt(b+4+S<=h.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),d.set(new Uint8Array(s),b+4),b+=4+S}return t.data===void 0?(p.setUint32(b,0),b+=4):(p.setUint32(b,t.data.length),d.set(t.data,b+4),b+=4+t.data.length),zt(b<=h.byteLength,"FontInfo.write: Buffer overflow"),h.transferToFixedLength(b)}}class ua{static#t=null;static#e="";static get workerPort(){return this.#t}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");this.#t=t}static get workerSrc(){return this.#e}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");this.#e=t}}class Pv{#t;#e;constructor({parsedData:t,rawData:i}){this.#t=t,this.#e=i}getRaw(){return this.#e}get(t){return this.#t.get(t)??null}[Symbol.iterator](){return this.#t.entries()}}const na=Symbol("INTERNAL");class Fv{#t=!1;#e=!1;#n=!1;#i=!0;constructor(t,{name:i,intent:s,usage:a,rbGroups:o}){this.#t=!!(t&ci.DISPLAY),this.#e=!!(t&ci.PRINT),this.name=i,this.intent=s,this.usage=a,this.rbGroups=o}get visible(){if(this.#n)return this.#i;if(!this.#i)return!1;const{print:t,view:i}=this.usage;return this.#t?i?.viewState!=="OFF":this.#e?t?.printState!=="OFF":!0}_setVisible(t,i,s=!1){t!==na&&Jt("Internal method `_setVisible` called."),this.#n=s,this.#i=i}}class zv{#t=null;#e=new Map;#n=null;#i=null;constructor(t,i=ci.DISPLAY){if(this.renderingIntent=i,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,this.#i=t.order;for(const s of t.groups)this.#e.set(s.id,new Fv(i,s));if(t.baseState==="OFF")for(const s of this.#e.values())s._setVisible(na,!1);for(const s of t.on)this.#e.get(s)._setVisible(na,!0);for(const s of t.off)this.#e.get(s)._setVisible(na,!1);this.#n=this.getHash()}}#r(t){const i=t.length;if(i<2)return!0;const s=t[0];for(let a=1;a<i;a++){const o=t[a];let l;if(Array.isArray(o))l=this.#r(o);else if(this.#e.has(o))l=this.#e.get(o).visible;else return Ct(`Optional content group not found: ${o}`),!0;switch(s){case"And":if(!l)return!1;break;case"Or":if(l)return!0;break;case"Not":return!l;default:return!0}}return s==="And"}isVisible(t){if(this.#e.size===0)return!0;if(!t)return hl("Optional content group not defined."),!0;if(t.type==="OCG")return this.#e.has(t.id)?this.#e.get(t.id).visible:(Ct(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return this.#r(t.expression);if(!t.policy||t.policy==="AnyOn"){for(const i of t.ids){if(!this.#e.has(i))return Ct(`Optional content group not found: ${i}`),!0;if(this.#e.get(i).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const i of t.ids){if(!this.#e.has(i))return Ct(`Optional content group not found: ${i}`),!0;if(!this.#e.get(i).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const i of t.ids){if(!this.#e.has(i))return Ct(`Optional content group not found: ${i}`),!0;if(!this.#e.get(i).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const i of t.ids){if(!this.#e.has(i))return Ct(`Optional content group not found: ${i}`),!0;if(this.#e.get(i).visible)return!1}return!0}return Ct(`Unknown optional content policy ${t.policy}.`),!0}return Ct(`Unknown group type ${t.type}.`),!0}setVisibility(t,i=!0,s=!0){const a=this.#e.get(t);if(!a){Ct(`Optional content group not found: ${t}`);return}if(s&&i&&a.rbGroups.length)for(const o of a.rbGroups)for(const l of o)l!==t&&this.#e.get(l)?._setVisible(na,!1,!0);a._setVisible(na,!!i,!0),this.#t=null}setOCGState({state:t,preserveRB:i}){let s;for(const a of t){switch(a){case"ON":case"OFF":case"Toggle":s=a;continue}const o=this.#e.get(a);if(o)switch(s){case"ON":this.setVisibility(a,!0,i);break;case"OFF":this.setVisibility(a,!1,i);break;case"Toggle":this.setVisibility(a,!o.visible,i);break}}this.#t=null}get hasInitialVisibility(){return this.#n===null||this.getHash()===this.#n}getOrder(){return this.#e.size?this.#i?this.#i.slice():[...this.#e.keys()]:null}getGroup(t){return this.#e.get(t)||null}getHash(){if(this.#t!==null)return this.#t;const t=new mm;for(const[i,s]of this.#e)t.update(`${i}:${s.visible}`);return this.#t=t.hexdigest()}[Symbol.iterator](){return this.#e.entries()}}class Iv{constructor(t,{disableRange:i=!1,disableStream:s=!1}){zt(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:a,initialData:o,progressiveDone:l,contentDispositionFilename:u}=t;if(this._queuedChunks=[],this._progressiveDone=l,this._contentDispositionFilename=u,o?.length>0){const h=o instanceof Uint8Array&&o.byteLength===o.buffer.byteLength?o.buffer:new Uint8Array(o).buffer;this._queuedChunks.push(h)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!s,this._isRangeSupported=!i,this._contentLength=a,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener((h,d)=>{this._onReceiveData({begin:h,chunk:d})}),t.addProgressListener((h,d)=>{this._onProgress({loaded:h,total:d})}),t.addProgressiveReadListener(h=>{this._onReceiveData({chunk:h})}),t.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),t.transportReady()}_onReceiveData({begin:t,chunk:i}){const s=i instanceof Uint8Array&&i.byteLength===i.buffer.byteLength?i.buffer:new Uint8Array(i).buffer;if(t===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(s):this._queuedChunks.push(s);else{const a=this._rangeReaders.some(function(o){return o._begin!==t?!1:(o._enqueue(s),!0)});zt(a,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(t){t.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:t.loaded}):this._fullRequestReader?.onProgress?.({loaded:t.loaded,total:t.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const i=this._rangeReaders.indexOf(t);i>=0&&this._rangeReaders.splice(i,1)}getFullReader(){zt(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new Uv(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,i){if(i<=this._progressiveDataLength)return null;const s=new Hv(this,t,i);return this._pdfDataRangeTransport.requestDataRange(t,i),this._rangeReaders.push(s),s}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const i of this._rangeReaders.slice(0))i.cancel(t);this._pdfDataRangeTransport.abort()}}class Uv{constructor(t,i,s=!1,a=null){this._stream=t,this._done=s||!1,this._filename=oh(a)?a:null,this._queuedChunks=i||[],this._loaded=0;for(const o of this._queuedChunks)this._loaded+=o.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class Hv{constructor(t,i,s){this._stream=t,this._begin=i,this._end=s,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const i=this._queuedChunk;return this._queuedChunk=null,{value:i,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function qv(g){let t=!0,i=s("filename\\*","i").exec(g);if(i){i=i[1];let p=u(i);return p=unescape(p),p=h(p),p=d(p),o(p)}if(i=l(g),i){const p=d(i);return o(p)}if(i=s("filename","i").exec(g),i){i=i[1];let p=u(i);return p=d(p),o(p)}function s(p,b){return new RegExp("(?:^|;)\\s*"+p+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',b)}function a(p,b){if(p){if(!/^[\x00-\xFF]+$/.test(b))return b;try{const v=new TextDecoder(p,{fatal:!0}),A=Ar(b);b=v.decode(A),t=!1}catch{}}return b}function o(p){return t&&/[\x80-\xff]/.test(p)&&(p=a("utf-8",p),t&&(p=a("iso-8859-1",p))),p}function l(p){const b=[];let v;const A=s("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(v=A.exec(p))!==null;){let[,S,C,E]=v;if(S=parseInt(S,10),S in b){if(S===0)break;continue}b[S]=[C,E]}const w=[];for(let S=0;S<b.length&&S in b;++S){let[C,E]=b[S];E=u(E),C&&(E=unescape(E),S===0&&(E=h(E))),w.push(E)}return w.join("")}function u(p){if(p.startsWith('"')){const b=p.slice(1).split('\\"');for(let v=0;v<b.length;++v){const A=b[v].indexOf('"');A!==-1&&(b[v]=b[v].slice(0,A),b.length=v+1),b[v]=b[v].replaceAll(/\\(.)/g,"$1")}p=b.join('"')}return p}function h(p){const b=p.indexOf("'");if(b===-1)return p;const v=p.slice(0,b),w=p.slice(b+1).replace(/^[^']*'/,"");return a(v,w)}function d(p){return!p.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(p)?p:p.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(b,v,A,w){if(A==="q"||A==="Q")return w=w.replaceAll("_"," "),w=w.replaceAll(/=([0-9a-fA-F]{2})/g,function(S,C){return String.fromCharCode(parseInt(C,16))}),a(v,w);try{w=atob(w)}catch{}return a(v,w)})}return""}function wm(g,t){const i=new Headers;if(!g||!t||typeof t!="object")return i;for(const s in t){const a=t[s];a!==void 0&&i.append(s,a)}return i}function gl(g){return URL.parse(g)?.origin??null}function _m({responseHeaders:g,isHttp:t,rangeChunkSize:i,disableRange:s}){const a={allowRangeRequests:!1,suggestedLength:void 0},o=parseInt(g.get("Content-Length"),10);return!Number.isInteger(o)||(a.suggestedLength=o,o<=2*i)||s||!t||g.get("Accept-Ranges")!=="bytes"||(g.get("Content-Encoding")||"identity")!=="identity"||(a.allowRangeRequests=!0),a}function Em(g){const t=g.get("Content-Disposition");if(t){let i=qv(t);if(i.includes("%"))try{i=decodeURIComponent(i)}catch{}if(oh(i))return i}return null}function Cr(g,t){return new al(`Unexpected server response (${g}) while retrieving PDF "${t}".`,g,g===404||g===0&&t.startsWith("file:"))}function Cm(g){return g===200||g===206}function Tm(g,t,i){return{method:"GET",headers:g,signal:i.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function Dm(g){return g instanceof Uint8Array?g.buffer:g instanceof ArrayBuffer?g:(Ct(`getArrayBuffer - unexpected data format: ${g}`),new Uint8Array(g).buffer)}class Gv{_responseOrigin=null;constructor(t){this.source=t,this.isHttp=/^https?:/i.test(t.url),this.headers=wm(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return zt(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new Vv(this),this._fullRequestReader}getRangeReader(t,i){if(i<=this._progressiveDataLength)return null;const s=new Yv(this,t,i);return this._rangeRequestReaders.push(s),s}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const i of this._rangeRequestReaders.slice(0))i.cancel(t)}}class Vv{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const i=t.source;this._withCredentials=i.withCredentials||!1,this._contentLength=i.length,this._headersCapability=Promise.withResolvers(),this._disableRange=i.disableRange||!1,this._rangeChunkSize=i.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!i.disableStream,this._isRangeSupported=!i.disableRange;const s=new Headers(t.headers),a=i.url;fetch(a,Tm(s,this._withCredentials,this._abortController)).then(o=>{if(t._responseOrigin=gl(o.url),!Cm(o.status))throw Cr(o.status,a);this._reader=o.body.getReader(),this._headersCapability.resolve();const l=o.headers,{allowRangeRequests:u,suggestedLength:h}=_m({responseHeaders:l,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=u,this._contentLength=h||this._contentLength,this._filename=Em(l),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Un("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:t,done:i}=await this._reader.read();return i?{value:t,done:i}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:Dm(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}class Yv{constructor(t,i,s){this._stream=t,this._reader=null,this._loaded=0;const a=t.source;this._withCredentials=a.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!a.disableStream,this._abortController=new AbortController;const o=new Headers(t.headers);o.append("Range",`bytes=${i}-${s-1}`);const l=a.url;fetch(l,Tm(o,this._withCredentials,this._abortController)).then(u=>{const h=gl(u.url);if(h!==t._responseOrigin)throw new Error(`Expected range response-origin "${h}" to match "${t._responseOrigin}".`);if(!Cm(u.status))throw Cr(u.status,l);this._readCapability.resolve(),this._reader=u.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:t,done:i}=await this._reader.read();return i?{value:t,done:i}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded}),{value:Dm(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}const Uu=200,Hu=206;function Xv(g){const t=g.response;return typeof t!="string"?t:Ar(t).buffer}class $v{_responseOrigin=null;constructor({url:t,httpHeaders:i,withCredentials:s}){this.url=t,this.isHttp=/^https?:/i.test(t),this.headers=wm(this.isHttp,i),this.withCredentials=s||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(t){const i=new XMLHttpRequest,s=this.currXhrId++,a=this.pendingRequests[s]={xhr:i};i.open("GET",this.url),i.withCredentials=this.withCredentials;for(const[o,l]of this.headers)i.setRequestHeader(o,l);return this.isHttp&&"begin"in t&&"end"in t?(i.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),a.expectedStatus=Hu):a.expectedStatus=Uu,i.responseType="arraybuffer",zt(t.onError,"Expected `onError` callback to be provided."),i.onerror=()=>{t.onError(i.status)},i.onreadystatechange=this.onStateChange.bind(this,s),i.onprogress=this.onProgress.bind(this,s),a.onHeadersReceived=t.onHeadersReceived,a.onDone=t.onDone,a.onError=t.onError,a.onProgress=t.onProgress,i.send(null),s}onProgress(t,i){const s=this.pendingRequests[t];s&&s.onProgress?.(i)}onStateChange(t,i){const s=this.pendingRequests[t];if(!s)return;const a=s.xhr;if(a.readyState>=2&&s.onHeadersReceived&&(s.onHeadersReceived(),delete s.onHeadersReceived),a.readyState!==4||!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],a.status===0&&this.isHttp){s.onError(a.status);return}const o=a.status||Uu;if(!(o===Uu&&s.expectedStatus===Hu)&&o!==s.expectedStatus){s.onError(a.status);return}const u=Xv(a);if(o===Hu){const h=a.getResponseHeader("Content-Range"),d=/bytes (\d+)-(\d+)\/(\d+)/.exec(h);d?s.onDone({begin:parseInt(d[1],10),chunk:u}):(Ct('Missing or invalid "Content-Range" header.'),s.onError(0))}else u?s.onDone({begin:0,chunk:u}):s.onError(a.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const i=this.pendingRequests[t].xhr;delete this.pendingRequests[t],i.abort()}}class Kv{constructor(t){this._source=t,this._manager=new $v(t),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const i=this._rangeRequestReaders.indexOf(t);i>=0&&this._rangeRequestReaders.splice(i,1)}getFullReader(){return zt(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new Qv(this._manager,this._source),this._fullRequestReader}getRangeReader(t,i){const s=new Wv(this._manager,t,i);return s.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(s),s}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const i of this._rangeRequestReaders.slice(0))i.cancel(t)}}class Qv{constructor(t,i){this._manager=t,this._url=i.url,this._fullRequestId=t.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=i.disableRange||!1,this._contentLength=i.length,this._rangeChunkSize=i.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,i=this._manager.getRequestXhr(t);this._manager._responseOrigin=gl(i.responseURL);const s=i.getAllResponseHeaders(),a=new Headers(s?s.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(u=>{const[h,...d]=u.split(": ");return[h,d.join(": ")]}):[]),{allowRangeRequests:o,suggestedLength:l}=_m({responseHeaders:a,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});o&&(this._isRangeSupported=!0),this._contentLength=l||this._contentLength,this._filename=Em(a),this._isRangeSupported&&this._manager.abortRequest(t),this._headersCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=Cr(t,this._url),this._headersCapability.reject(this._storedError);for(const i of this._requests)i.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){this.onProgress?.({loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class Wv{constructor(t,i,s){this._manager=t,this._url=t.url,this._requestId=t.request({begin:i,end:s,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){const t=gl(this._manager.getRequestXhr(this._requestId)?.responseURL);t!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${t}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){this.onClosed?.(this)}_onDone(t){const i=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:i,done:!1}):this._queuedChunk=i,this._done=!0;for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError??=Cr(t,this._url);for(const i of this._requests)i.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){this.isStreamingSupported||this.onProgress?.({loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const i=this._queuedChunk;return this._queuedChunk=null,{value:i,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const Zv=/^[a-z][a-z0-9\-+.]+:/i;function Jv(g){if(Zv.test(g))return new URL(g);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(g))}class tx{constructor(t){this.source=t,this.url=Jv(t.url),zt(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return zt(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new ex(this),this._fullRequestReader}getRangeReader(t,i){if(i<=this._progressiveDataLength)return null;const s=new ix(this,t,i);return this._rangeRequestReaders.push(s),s}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const i of this._rangeRequestReaders.slice(0))i.cancel(t)}}class ex{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const i=t.source;this._contentLength=i.length,this._loaded=0,this._filename=null,this._disableRange=i.disableRange||!1,this._rangeChunkSize=i.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!i.disableStream,this._isRangeSupported=!i.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const s=process.getBuiltinModule("fs");s.promises.lstat(this._url).then(a=>{this._contentLength=a.size,this._setReadableStream(s.createReadStream(this._url)),this._headersCapability.resolve()},a=>{a.code==="ENOENT"&&(a=Cr(0,this._url.href)),this._storedError=a,this._headersCapability.reject(a)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",i=>{this._error(i)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Un("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class ix{constructor(t,i,s){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const a=t.source;this._isStreamingSupported=!a.disableStream;const o=process.getBuiltinModule("fs");this._setReadableStream(o.createReadStream(this._url,{start:i,end:s-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",i=>{this._error(i)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const cr=Symbol("INITIAL_DATA");class Nm{#t=Object.create(null);#e(t){return this.#t[t]||={...Promise.withResolvers(),data:cr}}get(t,i=null){if(i){const a=this.#e(t);return a.promise.then(()=>i(a.data)),null}const s=this.#t[t];if(!s||s.data===cr)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return s.data}has(t){const i=this.#t[t];return!!i&&i.data!==cr}delete(t){const i=this.#t[t];return!i||i.data===cr?!1:(delete this.#t[t],!0)}resolve(t,i=null){const s=this.#e(t);s.data=i,s.resolve()}clear(){for(const t in this.#t){const{data:i}=this.#t[t];i?.bitmap?.close()}this.#t=Object.create(null)}*[Symbol.iterator](){for(const t in this.#t){const{data:i}=this.#t[t];i!==cr&&(yield[t,i])}}}const nx=1e5,tm=30;class ze{#t=Promise.withResolvers();#e=null;#n=!1;#i=!!globalThis.FontInspector?.enabled;#r=null;#s=null;#a=0;#o=0;#c=null;#l=null;#d=0;#h=0;#f=Object.create(null);#m=[];#g=null;#u=[];#p=new WeakMap;#b=null;static#v=new Map;static#y=new Map;static#E=new WeakMap;static#w=null;static#x=new Set;constructor({textContentSource:t,container:i,viewport:s}){if(t instanceof ReadableStream)this.#g=t;else if(typeof t=="object")this.#g=new ReadableStream({start(h){h.enqueue(t),h.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#e=this.#l=i,this.#h=s.scale*Gi.pixelRatio,this.#d=s.rotation,this.#s={div:null,properties:null,ctx:null};const{pageWidth:a,pageHeight:o,pageX:l,pageY:u}=s.rawDims;this.#b=[1,0,0,-1,-l,u+o],this.#o=a,this.#a=o,ze.#N(),ds(i,s),this.#t.promise.finally(()=>{ze.#x.delete(this),this.#s=null,this.#f=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:t,isFirefox:i}=Le.platform;return Mt(this,"fontFamilyMap",new Map([["sans-serif",`${t&&i?"Calibri, ":""}sans-serif`],["monospace",`${t&&i?"Lucida Console, ":""}monospace`]]))}render(){const t=()=>{this.#c.read().then(({value:i,done:s})=>{if(s){this.#t.resolve();return}this.#r??=i.lang,Object.assign(this.#f,i.styles),this.#T(i.items),t()},this.#t.reject)};return this.#c=this.#g.getReader(),ze.#x.add(this),t(),this.#t.promise}update({viewport:t,onBefore:i=null}){const s=t.scale*Gi.pixelRatio,a=t.rotation;if(a!==this.#d&&(i?.(),this.#d=a,ds(this.#l,{rotation:a})),s!==this.#h){i?.(),this.#h=s;const o={div:null,properties:null,ctx:ze.#M(this.#r)};for(const l of this.#u)o.properties=this.#p.get(l),o.div=l,this.#_(o)}}cancel(){const t=new Un("TextLayer task cancelled.");this.#c?.cancel(t).catch(()=>{}),this.#c=null,this.#t.reject(t)}get textDivs(){return this.#u}get textContentItemsStr(){return this.#m}#T(t){if(this.#n)return;this.#s.ctx??=ze.#M(this.#r);const i=this.#u,s=this.#m;for(const a of t){if(i.length>nx){Ct("Ignoring additional textDivs for performance reasons."),this.#n=!0;return}if(a.str===void 0){if(a.type==="beginMarkedContentProps"||a.type==="beginMarkedContent"){const o=this.#e;this.#e=document.createElement("span"),this.#e.classList.add("markedContent"),a.id&&this.#e.setAttribute("id",`${a.id}`),o.append(this.#e)}else a.type==="endMarkedContent"&&(this.#e=this.#e.parentNode);continue}s.push(a.str),this.#S(a)}}#S(t){const i=document.createElement("span"),s={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};this.#u.push(i);const a=dt.transform(this.#b,t.transform);let o=Math.atan2(a[1],a[0]);const l=this.#f[t.fontName];l.vertical&&(o+=Math.PI/2);let u=this.#i&&l.fontSubstitution||l.fontFamily;u=ze.fontFamilyMap.get(u)||u;const h=Math.hypot(a[2],a[3]),d=h*ze.#P(u,l,this.#r);let p,b;o===0?(p=a[4],b=a[5]-d):(p=a[4]+d*Math.sin(o),b=a[5]-d*Math.cos(o));const v="calc(var(--total-scale-factor) *",A=i.style;this.#e===this.#l?(A.left=`${(100*p/this.#o).toFixed(2)}%`,A.top=`${(100*b/this.#a).toFixed(2)}%`):(A.left=`${v}${p.toFixed(2)}px)`,A.top=`${v}${b.toFixed(2)}px)`),A.fontSize=`${v}${(ze.#w*h).toFixed(2)}px)`,A.fontFamily=u,s.fontSize=h,i.setAttribute("role","presentation"),i.textContent=t.str,i.dir=t.dir,this.#i&&(i.dataset.fontName=l.fontSubstitutionLoadedName||t.fontName),o!==0&&(s.angle=o*(180/Math.PI));let w=!1;if(t.str.length>1)w=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const S=Math.abs(t.transform[0]),C=Math.abs(t.transform[3]);S!==C&&Math.max(S,C)/Math.min(S,C)>1.5&&(w=!0)}if(w&&(s.canvasWidth=l.vertical?t.height:t.width),this.#p.set(i,s),this.#s.div=i,this.#s.properties=s,this.#_(this.#s),s.hasText&&this.#e.append(i),s.hasEOL){const S=document.createElement("br");S.setAttribute("role","presentation"),this.#e.append(S)}}#_(t){const{div:i,properties:s,ctx:a}=t,{style:o}=i;let l="";if(ze.#w>1&&(l=`scale(${1/ze.#w})`),s.canvasWidth!==0&&s.hasText){const{fontFamily:u}=o,{canvasWidth:h,fontSize:d}=s;ze.#D(a,d*this.#h,u);const{width:p}=a.measureText(i.textContent);p>0&&(l=`scaleX(${h*this.#h/p}) ${l}`)}s.angle!==0&&(l=`rotate(${s.angle}deg) ${l}`),l.length>0&&(o.transform=l)}static cleanup(){if(!(this.#x.size>0)){this.#v.clear();for(const{canvas:t}of this.#y.values())t.remove();this.#y.clear()}}static#M(t=null){let i=this.#y.get(t||="");if(!i){const s=document.createElement("canvas");s.className="hiddenCanvasElement",s.lang=t,document.body.append(s),i=s.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#y.set(t,i),this.#E.set(i,{size:0,family:""})}return i}static#D(t,i,s){const a=this.#E.get(t);i===a.size&&s===a.family||(t.font=`${i}px ${s}`,a.size=i,a.family=s)}static#N(){if(this.#w!==null)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),this.#w=t.getBoundingClientRect().height,t.remove()}static#P(t,i,s){const a=this.#v.get(t);if(a)return a;const o=this.#M(s);o.canvas.width=o.canvas.height=tm,this.#D(o,tm,t);const l=o.measureText(""),u=l.fontBoundingBoxAscent,h=Math.abs(l.fontBoundingBoxDescent);o.canvas.width=o.canvas.height=0;let d=.8;return u?d=u/(u+h):(Le.platform.isFirefox&&Ct("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),i.ascent?d=i.ascent:i.descent&&(d=1+i.descent)),this.#v.set(t,d),d}}const sx=100;function Mm(g={}){typeof g=="string"||g instanceof URL?g={url:g}:(g instanceof ArrayBuffer||ArrayBuffer.isView(g))&&(g={data:g});const t=new gh,{docId:i}=t,s=g.url?hv(g.url):null,a=g.data?dv(g.data):null,o=g.httpHeaders||null,l=g.withCredentials===!0,u=g.password??null,h=g.range instanceof Rm?g.range:null,d=Number.isInteger(g.rangeChunkSize)&&g.rangeChunkSize>0?g.rangeChunkSize:2**16;let p=g.worker instanceof vr?g.worker:null;const b=g.verbosity,v=typeof g.docBaseUrl=="string"&&!dl(g.docBaseUrl)?g.docBaseUrl:null,A=Xo(g.cMapUrl),w=g.cMapPacked!==!1,S=g.CMapReaderFactory||(Ie?xv:Ip),C=Xo(g.iccUrl),E=Xo(g.standardFontDataUrl),k=g.StandardFontDataFactory||(Ie?Av:Up),O=Xo(g.wasmUrl),P=g.WasmFactory||(Ie?Sv:Hp),z=g.stopAtErrors!==!0,L=Number.isInteger(g.maxImageSize)&&g.maxImageSize>-1?g.maxImageSize:-1,j=g.isEvalSupported!==!1,D=typeof g.isOffscreenCanvasSupported=="boolean"?g.isOffscreenCanvasSupported:!Ie,N=typeof g.isImageDecoderSupported=="boolean"?g.isImageDecoderSupported:!Ie&&(Le.platform.isFirefox||!globalThis.chrome),U=Number.isInteger(g.canvasMaxAreaInBytes)?g.canvasMaxAreaInBytes:-1,$=typeof g.disableFontFace=="boolean"?g.disableFontFace:Ie,tt=g.fontExtraProperties===!0,at=g.enableXfa===!0,gt=g.ownerDocument||globalThis.document,bt=g.disableRange===!0,F=g.disableStream===!0,q=g.disableAutoFetch===!0,et=g.pdfBug===!0,it=g.CanvasFactory||(Ie?vv:mv),ut=g.FilterFactory||(Ie?yv:bv),M=g.enableHWA===!0,H=g.useWasm!==!1,T=h?h.length:g.length??NaN,Q=typeof g.useSystemFonts=="boolean"?g.useSystemFonts:!Ie&&!$,nt=typeof g.useWorkerFetch=="boolean"?g.useWorkerFetch:!!(S===Ip&&k===Up&&P===Hp&&A&&E&&O&&dr(A,document.baseURI)&&dr(E,document.baseURI)&&dr(O,document.baseURI)),rt=null;zy(b);const ot={canvasFactory:new it({ownerDocument:gt,enableHWA:M}),filterFactory:new ut({docId:i,ownerDocument:gt}),cMapReaderFactory:nt?null:new S({baseUrl:A,isCompressed:w}),standardFontDataFactory:nt?null:new k({baseUrl:E}),wasmFactory:nt?null:new P({baseUrl:O})};p||(p=vr.create({verbosity:b,port:ua.workerPort}),t._worker=p);const ft={docId:i,apiVersion:"5.4.296",data:a,password:u,disableAutoFetch:q,rangeChunkSize:d,length:T,docBaseUrl:v,enableXfa:at,evaluatorOptions:{maxImageSize:L,disableFontFace:$,ignoreErrors:z,isEvalSupported:j,isOffscreenCanvasSupported:D,isImageDecoderSupported:N,canvasMaxAreaInBytes:U,fontExtraProperties:tt,useSystemFonts:Q,useWasm:H,useWorkerFetch:nt,cMapUrl:A,iccUrl:C,standardFontDataUrl:E,wasmUrl:O}},X={ownerDocument:gt,pdfBug:et,styleElement:rt,loadingParams:{disableAutoFetch:q,enableXfa:at}};return p.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(p.destroyed)throw new Error("Worker was destroyed");const st=p.messageHandler.sendWithPromise("GetDocRequest",ft,a?[a.buffer]:null);let lt;if(h)lt=new Iv(h,{disableRange:bt,disableStream:F});else if(!a){if(!s)throw new Error("getDocument - no `url` parameter provided.");const Rt=dr(s)?Gv:Ie?tx:Kv;lt=new Rt({url:s,length:T,httpHeaders:o,withCredentials:l,rangeChunkSize:d,disableRange:bt,disableStream:F})}return st.then(Rt=>{if(t.destroyed)throw new Error("Loading aborted");if(p.destroyed)throw new Error("Worker was destroyed");const Gt=new fr(i,Rt,p.port),St=new ox(Gt,t,lt,X,ot,M);t._transport=St,Gt.send("Ready",null)})}).catch(t._capability.reject),t}class gh{static#t=0;_capability=Promise.withResolvers();_transport=null;_worker=null;docId=`d${gh.#t++}`;destroyed=!1;onPassword=null;onProgress=null;get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(t){throw this._worker?.port&&delete this._worker._pendingDestroy,t}this._transport=null,this._worker?.destroy(),this._worker=null}async getData(){return this._transport.getData()}}class Rm{#t=Promise.withResolvers();#e=[];#n=[];#i=[];#r=[];constructor(t,i,s=!1,a=null){this.length=t,this.initialData=i,this.progressiveDone=s,this.contentDispositionFilename=a}addRangeListener(t){this.#r.push(t)}addProgressListener(t){this.#i.push(t)}addProgressiveReadListener(t){this.#n.push(t)}addProgressiveDoneListener(t){this.#e.push(t)}onDataRange(t,i){for(const s of this.#r)s(t,i)}onDataProgress(t,i){this.#t.promise.then(()=>{for(const s of this.#i)s(t,i)})}onDataProgressiveRead(t){this.#t.promise.then(()=>{for(const i of this.#n)i(t)})}onDataProgressiveDone(){this.#t.promise.then(()=>{for(const t of this.#e)t()})}transportReady(){this.#t.resolve()}requestDataRange(t,i){Jt("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class ax{constructor(t,i){this._pdfInfo=t,this._transport=i}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Mt(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(t,i){return this._transport.getAnnotationsByType(t,i)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:i}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(i)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class rx{#t=!1;constructor(t,i,s,a=!1){this._pageIndex=t,this._pageInfo=i,this._transport=s,this._stats=a?new Op:null,this._pdfBug=a,this.commonObjs=s.commonObjs,this.objs=new Nm,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:i=this.rotate,offsetX:s=0,offsetY:a=0,dontFlip:o=!1}={}){return new wr({viewBox:this.view,userUnit:this.userUnit,scale:t,rotation:i,offsetX:s,offsetY:a,dontFlip:o})}getAnnotations({intent:t="display"}={}){const{renderingIntent:i}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,i)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Mt(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:t,canvas:i=t.canvas,viewport:s,intent:a="display",annotationMode:o=zn.ENABLE,transform:l=null,background:u=null,optionalContentConfigPromise:h=null,annotationCanvasMap:d=null,pageColors:p=null,printAnnotationStorage:b=null,isEditing:v=!1,recordOperations:A=!1,operationsFilter:w=null}){this._stats?.time("Overall");const S=this._transport.getRenderingIntent(a,o,b,v),{renderingIntent:C,cacheKey:E}=S;this.#t=!1,h||=this._transport.getOptionalContentConfig(C);let k=this._intentStates.get(E);k||(k=Object.create(null),this._intentStates.set(E,k)),k.streamReaderCancelTimeout&&(clearTimeout(k.streamReaderCancelTimeout),k.streamReaderCancelTimeout=null);const O=!!(C&ci.PRINT);k.displayReadyCapability||(k.displayReadyCapability=Promise.withResolvers(),k.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(S));const P=!!(this._pdfBug&&globalThis.StepperManager?.enabled),z=!this.recordedBBoxes&&(A||P),L=N=>{if(k.renderTasks.delete(j),z){const U=j.gfx?.dependencyTracker.take();U&&(j.stepper&&j.stepper.setOperatorBBoxes(U,j.gfx.dependencyTracker.takeDebugMetadata()),A&&(this.recordedBBoxes=U))}O&&(this.#t=!0),this.#e(),N?(j.capability.reject(N),this._abortOperatorList({intentState:k,reason:N instanceof Error?N:new Error(N)})):j.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},j=new ra({callback:L,params:{canvas:i,canvasContext:t,dependencyTracker:z?new _v(i,k.operatorList.length,P):null,viewport:s,transform:l,background:u},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:d,operatorList:k.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!O,pdfBug:this._pdfBug,pageColors:p,enableHWA:this._transport.enableHWA,operationsFilter:w});(k.renderTasks||=new Set).add(j);const D=j.task;return Promise.all([k.displayReadyCapability.promise,h]).then(([N,U])=>{if(this.destroyed){L();return}if(this._stats?.time("Rendering"),!(U.renderingIntent&C))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");j.initializeGraphics({transparency:N,optionalContentConfig:U}),j.operatorListChanged()}).catch(L),D}getOperatorList({intent:t="display",annotationMode:i=zn.ENABLE,printAnnotationStorage:s=null,isEditing:a=!1}={}){function o(){u.operatorList.lastChunk&&(u.opListReadCapability.resolve(u.operatorList),u.renderTasks.delete(h))}const l=this._transport.getRenderingIntent(t,i,s,a,!0);let u=this._intentStates.get(l.cacheKey);u||(u=Object.create(null),this._intentStates.set(l.cacheKey,u));let h;return u.opListReadCapability||(h=Object.create(null),h.operatorListChanged=o,u.opListReadCapability=Promise.withResolvers(),(u.renderTasks||=new Set).add(h),u.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(l)),u.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:i=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:i===!0},{highWaterMark:100,size(a){return a.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(s=>yr.textContent(s));const i=this.streamTextContent(t);return new Promise(function(s,a){function o(){l.read().then(function({value:h,done:d}){if(d){s(u);return}u.lang??=h.lang,Object.assign(u.styles,h.styles),u.items.push(...h.items),o()},a)}const l=i.getReader(),u={items:[],styles:Object.create(null),lang:null};o()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const i of this._intentStates.values())if(this._abortOperatorList({intentState:i,reason:new Error("Page was destroyed."),force:!0}),!i.opListReadCapability)for(const s of i.renderTasks)t.push(s.completed),s.cancel();return this.objs.clear(),this.#t=!1,Promise.all(t)}cleanup(t=!1){this.#t=!0;const i=this.#e();return t&&i&&(this._stats&&=new Op),i}#e(){if(!this.#t||this.destroyed)return!1;for(const{renderTasks:t,operatorList:i}of this._intentStates.values())if(t.size>0||!i.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#t=!1,!0}_startRenderPage(t,i){const s=this._intentStates.get(i);s&&(this._stats?.timeEnd("Page Request"),s.displayReadyCapability?.resolve(t))}_renderPageChunk(t,i){for(let s=0,a=t.length;s<a;s++)i.operatorList.fnArray.push(t.fnArray[s]),i.operatorList.argsArray.push(t.argsArray[s]);i.operatorList.lastChunk=t.lastChunk,i.operatorList.separateAnnots=t.separateAnnots;for(const s of i.renderTasks)s.operatorListChanged();t.lastChunk&&this.#e()}_pumpOperatorList({renderingIntent:t,cacheKey:i,annotationStorageSerializable:s,modifiedIds:a}){const{map:o,transfer:l}=s,h=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:i,annotationStorage:o,modifiedIds:a},l).getReader(),d=this._intentStates.get(i);d.streamReader=h;const p=()=>{h.read().then(({value:b,done:v})=>{if(v){d.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(b,d),p())},b=>{if(d.streamReader=null,!this._transport.destroyed){if(d.operatorList){d.operatorList.lastChunk=!0;for(const v of d.renderTasks)v.operatorListChanged();this.#e()}if(d.displayReadyCapability)d.displayReadyCapability.reject(b);else if(d.opListReadCapability)d.opListReadCapability.reject(b);else throw b}})};p()}_abortOperatorList({intentState:t,reason:i,force:s=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!s){if(t.renderTasks.size>0)return;if(i instanceof rh){let a=sx;i.extraDelay>0&&i.extraDelay<1e3&&(a+=i.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:i,force:!0})},a);return}}if(t.streamReader.cancel(new Un(i.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[a,o]of this._intentStates)if(o===t){this._intentStates.delete(a);break}this.cleanup()}}}get stats(){return this._stats}}var In,ki,dn,cs,ll,us,hs,He,nl,km,Om,gr,ha,sl;const se=class se{constructor({name:t=null,port:i=null,verbosity:s=Iy()}={}){Fi(this,He);Fi(this,In,Promise.withResolvers());Fi(this,ki,null);Fi(this,dn,null);Fi(this,cs,null);if(this.name=t,this.destroyed=!1,this.verbosity=s,i){if(ne(se,hs).has(i))throw new Error("Cannot use more than one PDFWorker per port.");ne(se,hs).set(i,this),zi(this,He,km).call(this,i)}else zi(this,He,Om).call(this)}get promise(){return ne(this,In).promise}get port(){return ne(this,dn)}get messageHandler(){return ne(this,ki)}destroy(){this.destroyed=!0,ne(this,cs)?.terminate(),We(this,cs,null),ne(se,hs).delete(ne(this,dn)),We(this,dn,null),ne(this,ki)?.destroy(),We(this,ki,null)}static create(t){const i=ne(this,hs).get(t?.port);if(i){if(i._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return i}return new se(t)}static get workerSrc(){if(ua.workerSrc)return ua.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return Mt(this,"_setupFakeWorkerGlobal",(async()=>ne(this,ha,sl)?ne(this,ha,sl):(await import(this.workerSrc)).WorkerMessageHandler)())}};In=new WeakMap,ki=new WeakMap,dn=new WeakMap,cs=new WeakMap,ll=new WeakMap,us=new WeakMap,hs=new WeakMap,He=new WeakSet,nl=function(){ne(this,In).resolve(),ne(this,ki).send("configure",{verbosity:this.verbosity})},km=function(t){We(this,dn,t),We(this,ki,new fr("main","worker",t)),ne(this,ki).on("ready",()=>{}),zi(this,He,nl).call(this)},Om=function(){if(ne(se,us)||ne(se,ha,sl)){zi(this,He,gr).call(this);return}let{workerSrc:t}=se;try{se._isSameOrigin(window.location,t)||(t=se._createCDNWrapper(new URL(t,window.location).href));const i=new Worker(t,{type:"module"}),s=new fr("main","worker",i),a=()=>{o.abort(),s.destroy(),i.terminate(),this.destroyed?ne(this,In).reject(new Error("Worker was destroyed")):zi(this,He,gr).call(this)},o=new AbortController;i.addEventListener("error",()=>{ne(this,cs)||a()},{signal:o.signal}),s.on("test",u=>{if(o.abort(),this.destroyed||!u){a();return}We(this,ki,s),We(this,dn,i),We(this,cs,i),zi(this,He,nl).call(this)}),s.on("ready",u=>{if(o.abort(),this.destroyed){a();return}try{l()}catch{zi(this,He,gr).call(this)}});const l=()=>{const u=new Uint8Array;s.send("test",u,[u.buffer])};l();return}catch{hl("The worker has been disabled.")}zi(this,He,gr).call(this)},gr=function(){ne(se,us)||(Ct("Setting up fake worker."),We(se,us,!0)),se._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){ne(this,In).reject(new Error("Worker was destroyed"));return}const i=new pv;We(this,dn,i);const s=`fake${vp(se,ll)._++}`,a=new fr(s+"_worker",s,i);t.setup(a,i),We(this,ki,new fr(s,s+"_worker",i)),zi(this,He,nl).call(this)}).catch(t=>{ne(this,In).reject(new Error(`Setting up fake worker failed: "${t.message}".`))})},ha=new WeakSet,sl=function(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}},Fi(se,ha),Fi(se,ll,0),Fi(se,us,!1),Fi(se,hs,new WeakMap),Ie&&(We(se,us,!0),ua.workerSrc||="./pdf.worker.mjs"),se._isSameOrigin=(t,i)=>{const s=URL.parse(t);if(!s?.origin||s.origin==="null")return!1;const a=new URL(i,s);return s.origin===a.origin},se._createCDNWrapper=t=>{const i=`await import("${t}");`;return URL.createObjectURL(new Blob([i],{type:"text/javascript"}))},se.fromPort=t=>{if(Zy("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!t?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return se.create(t)};let vr=se;class ox{#t=new Map;#e=new Map;#n=new Map;#i=new Map;#r=null;constructor(t,i,s,a,o,l){this.messageHandler=t,this.loadingTask=i,this.commonObjs=new Nm,this.fontLoader=new cv({ownerDocument:a.ownerDocument,styleElement:a.styleElement}),this.loadingParams=a.loadingParams,this._params=a,this.canvasFactory=o.canvasFactory,this.filterFactory=o.filterFactory,this.cMapReaderFactory=o.cMapReaderFactory,this.standardFontDataFactory=o.standardFontDataFactory,this.wasmFactory=o.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=s,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=l,this.setupMessageHandler()}#s(t,i=null){const s=this.#t.get(t);if(s)return s;const a=this.messageHandler.sendWithPromise(t,i);return this.#t.set(t,a),a}get annotationStorage(){return Mt(this,"annotationStorage",new uh)}getRenderingIntent(t,i=zn.ENABLE,s=null,a=!1,o=!1){let l=ci.DISPLAY,u=$u;switch(t){case"any":l=ci.ANY;break;case"display":break;case"print":l=ci.PRINT;break;default:Ct(`getRenderingIntent - invalid intent: ${t}`)}const h=l&ci.PRINT&&s instanceof bm?s:this.annotationStorage;switch(i){case zn.DISABLE:l+=ci.ANNOTATIONS_DISABLE;break;case zn.ENABLE:break;case zn.ENABLE_FORMS:l+=ci.ANNOTATIONS_FORMS;break;case zn.ENABLE_STORAGE:l+=ci.ANNOTATIONS_STORAGE,u=h.serializable;break;default:Ct(`getRenderingIntent - invalid annotationMode: ${i}`)}a&&(l+=ci.IS_EDITING),o&&(l+=ci.OPLIST);const{ids:d,hash:p}=h.modifiedIds,b=[l,u.hash,p];return{renderingIntent:l,cacheKey:b.join("_"),annotationStorageSerializable:u,modifiedIds:d}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#r?.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const s of this.#e.values())t.push(s._destroy());this.#e.clear(),this.#n.clear(),this.#i.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const i=this.messageHandler.sendWithPromise("Terminate",null);return t.push(i),Promise.all(t).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(),ze.cleanup(),this._networkStream?.cancelAllRequests(new Un("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:i}=this;t.on("GetReader",(s,a)=>{zt(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=o=>{this._lastProgress={loaded:o.loaded,total:o.total}},a.onPull=()=>{this._fullReader.read().then(function({value:o,done:l}){if(l){a.close();return}zt(o instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),a.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{a.error(o)})},a.onCancel=o=>{this._fullReader.cancel(o),a.ready.catch(l=>{if(!this.destroyed)throw l})}}),t.on("ReaderHeadersReady",async s=>{await this._fullReader.headersReady;const{isStreamingSupported:a,isRangeSupported:o,contentLength:l}=this._fullReader;return(!a||!o)&&(this._lastProgress&&i.onProgress?.(this._lastProgress),this._fullReader.onProgress=u=>{i.onProgress?.({loaded:u.loaded,total:u.total})}),{isStreamingSupported:a,isRangeSupported:o,contentLength:l}}),t.on("GetRangeReader",(s,a)=>{zt(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const o=this._networkStream.getRangeReader(s.begin,s.end);if(!o){a.close();return}a.onPull=()=>{o.read().then(function({value:l,done:u}){if(u){a.close();return}zt(l instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),a.enqueue(new Uint8Array(l),1,[l])}).catch(l=>{a.error(l)})},a.onCancel=l=>{o.cancel(l),a.ready.catch(u=>{if(!this.destroyed)throw u})}}),t.on("GetDoc",({pdfInfo:s})=>{this._numPages=s.numPages,this._htmlForXfa=s.htmlForXfa,delete s.htmlForXfa,i._capability.resolve(new ax(s,this))}),t.on("DocException",s=>{i._capability.reject(Ze(s))}),t.on("PasswordRequest",s=>{this.#r=Promise.withResolvers();try{if(!i.onPassword)throw Ze(s);const a=o=>{o instanceof Error?this.#r.reject(o):this.#r.resolve({password:o})};i.onPassword(a,s.code)}catch(a){this.#r.reject(a)}return this.#r.promise}),t.on("DataLoaded",s=>{i.onProgress?.({loaded:s.length,total:s.length}),this.downloadInfoCapability.resolve(s)}),t.on("StartRenderPage",s=>{if(this.destroyed)return;this.#e.get(s.pageIndex)._startRenderPage(s.transparency,s.cacheKey)}),t.on("commonobj",([s,a,o])=>{if(this.destroyed||this.commonObjs.has(s))return null;switch(a){case"Font":if("error"in o){const p=o.error;Ct(`Error during font loading: ${p}`),this.commonObjs.resolve(s,p);break}const l=new Wt(o),u=this._params.pdfBug&&globalThis.FontInspector?.enabled?(p,b)=>globalThis.FontInspector.fontAdded(p,b):null,h=new uv(l,u,o.extra,o.charProcOperatorList);this.fontLoader.bind(h).catch(()=>t.sendWithPromise("FontFallback",{id:s})).finally(()=>{!h.fontExtraProperties&&h.data&&h.clearData(),this.commonObjs.resolve(s,h)});break;case"CopyLocalImage":const{imageRef:d}=o;zt(d,"The imageRef must be defined.");for(const p of this.#e.values())for(const[,b]of p.objs)if(b?.ref===d)return b.dataLen?(this.commonObjs.resolve(s,structuredClone(b)),b.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(s,o);break;default:throw new Error(`Got unknown common object type ${a}`)}return null}),t.on("obj",([s,a,o,l])=>{if(this.destroyed)return;const u=this.#e.get(a);if(!u.objs.has(s)){if(u._intentStates.size===0){l?.bitmap?.close();return}switch(o){case"Image":case"Pattern":u.objs.resolve(s,l);break;default:throw new Error(`Got unknown object type ${o}`)}}}),t.on("DocProgress",s=>{this.destroyed||i.onProgress?.({loaded:s.loaded,total:s.total})}),t.on("FetchBinaryData",async s=>{if(this.destroyed)throw new Error("Worker was destroyed.");const a=this[s.type];if(!a)throw new Error(`${s.type} not initialized, see the \`useWorkerFetch\` parameter.`);return a.fetch(s)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&Ct("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:i}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:this._fullReader?.filename??null},i).finally(()=>{this.annotationStorage.resetModified()})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const i=t-1,s=this.#n.get(i);if(s)return s;const a=this.messageHandler.sendWithPromise("GetPage",{pageIndex:i}).then(o=>{if(this.destroyed)throw new Error("Transport destroyed");o.refStr&&this.#i.set(o.refStr,t);const l=new rx(i,o,this,this._params.pdfBug);return this.#e.set(i,l),l});return this.#n.set(i,a),a}getPageIndex(t){return Ku(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,i){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:i})}getFieldObjects(){return this.#s("GetFieldObjects")}hasJSActions(){return this.#s("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(t,i){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:t,pageIndexesToSkip:i})}getDocJSActions(){return this.#s("GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return this.#s("GetOptionalContentConfig").then(i=>new zv(i,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",i=this.#t.get(t);if(i)return i;const s=this.messageHandler.sendWithPromise(t,null).then(a=>({info:a[0],metadata:a[1]?new Pv(a[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#t.set(t,s),s}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const i of this.#e.values())if(!i.cleanup())throw new Error(`startCleanup: Page ${i.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(!0),ze.cleanup()}}cachedPageNumber(t){if(!Ku(t))return null;const i=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`;return this.#i.get(i)??null}}class lx{#t=null;onContinue=null;onError=null;constructor(t){this.#t=t}get promise(){return this.#t.capability.promise}cancel(t=0){this.#t.cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=this.#t.operatorList;if(!t)return!1;const{annotationCanvasMap:i}=this.#t;return t.form||t.canvas&&i?.size>0}}class ra{#t=null;static#e=new WeakSet;constructor({callback:t,params:i,objs:s,commonObjs:a,annotationCanvasMap:o,operatorList:l,pageIndex:u,canvasFactory:h,filterFactory:d,useRequestAnimationFrame:p=!1,pdfBug:b=!1,pageColors:v=null,enableHWA:A=!1,operationsFilter:w=null}){this.callback=t,this.params=i,this.objs=s,this.commonObjs=a,this.annotationCanvasMap=o,this.operatorListIdx=null,this.operatorList=l,this._pageIndex=u,this.canvasFactory=h,this.filterFactory=d,this._pdfBug=b,this.pageColors=v,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=p===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new lx(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=i.canvas,this._canvasContext=i.canvas?null:i.canvasContext,this._enableHWA=A,this._dependencyTracker=i.dependencyTracker,this._operationsFilter=w}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:i}){if(this.cancelled)return;if(this._canvas){if(ra.#e.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");ra.#e.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:s,transform:a,background:o,dependencyTracker:l}=this.params,u=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new oa(u,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:i},this.annotationCanvasMap,this.pageColors,l),this.gfx.beginDrawing({transform:a,viewport:s,transparency:t,background:o}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(t=null,i=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#t&&(window.cancelAnimationFrame(this.#t),this.#t=null),ra.#e.delete(this._canvas),t||=new rh(`Rendering cancelled, page ${this._pageIndex+1}`,i),this.callback(t),this.task.onError?.(t)}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.gfx.dependencyTracker?.growOperationsCount(this.operatorList.fnArray.length),this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#t=window.requestAnimationFrame(()=>{this.#t=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),ra.#e.delete(this._canvas),this.callback())))}}const Lm="5.4.296",cx="f56dc8601";class Ci{#t=null;#e=null;#n;#i=null;#r=!1;#s=!1;#a=null;#o;#c=null;#l=null;static#d=null;static get _keyboardManager(){return Mt(this,"_keyboardManager",new Er([[["Escape","mac+Escape"],Ci.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Ci.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Ci.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Ci.prototype._moveToPrevious],[["Home","mac+Home"],Ci.prototype._moveToBeginning],[["End","mac+End"],Ci.prototype._moveToEnd]]))}constructor({editor:t=null,uiManager:i=null}){t?(this.#s=!1,this.#a=t):this.#s=!0,this.#l=t?._uiManager||i,this.#o=this.#l._eventBus,this.#n=t?.color?.toUpperCase()||this.#l?.highlightColors.values().next().value||"#FFFF98",Ci.#d||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const t=this.#t=document.createElement("button");t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.ariaHasPopup="true",this.#a&&(t.ariaControls=`${this.#a.id}_colorpicker_dropdown`);const i=this.#l._signal;t.addEventListener("click",this.#g.bind(this),{signal:i}),t.addEventListener("keydown",this.#m.bind(this),{signal:i});const s=this.#e=document.createElement("span");return s.className="swatch",s.ariaHidden="true",s.style.backgroundColor=this.#n,t.append(s),t}renderMainDropdown(){const t=this.#i=this.#h();return t.ariaOrientation="horizontal",t.ariaLabelledBy="highlightColorPickerLabel",t}#h(){const t=document.createElement("div"),i=this.#l._signal;t.addEventListener("contextmenu",Ti,{signal:i}),t.className="dropdown",t.role="listbox",t.ariaMultiSelectable="false",t.ariaOrientation="vertical",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),this.#a&&(t.id=`${this.#a.id}_colorpicker_dropdown`);for(const[s,a]of this.#l.highlightColors){const o=document.createElement("button");o.tabIndex="0",o.role="option",o.setAttribute("data-color",a),o.title=s,o.setAttribute("data-l10n-id",Ci.#d[s]);const l=document.createElement("span");o.append(l),l.className="swatch",l.style.backgroundColor=a,o.ariaSelected=a===this.#n,o.addEventListener("click",this.#f.bind(this,a),{signal:i}),t.append(o)}return t.addEventListener("keydown",this.#m.bind(this),{signal:i}),t}#f(t,i){i.stopPropagation(),this.#o.dispatch("switchannotationeditorparams",{source:this,type:Ft.HIGHLIGHT_COLOR,value:t}),this.updateColor(t)}_colorSelectFromKeyboard(t){if(t.target===this.#t){this.#g(t);return}const i=t.target.getAttribute("data-color");i&&this.#f(i,t)}_moveToNext(t){if(!this.#p){this.#g(t);return}if(t.target===this.#t){this.#i.firstChild?.focus();return}t.target.nextSibling?.focus()}_moveToPrevious(t){if(t.target===this.#i?.firstChild||t.target===this.#t){this.#p&&this._hideDropdownFromKeyboard();return}this.#p||this.#g(t),t.target.previousSibling?.focus()}_moveToBeginning(t){if(!this.#p){this.#g(t);return}this.#i.firstChild?.focus()}_moveToEnd(t){if(!this.#p){this.#g(t);return}this.#i.lastChild?.focus()}#m(t){Ci._keyboardManager.exec(this,t)}#g(t){if(this.#p){this.hideDropdown();return}if(this.#r=t.detail===0,this.#c||(this.#c=new AbortController,window.addEventListener("pointerdown",this.#u.bind(this),{signal:this.#l.combinedSignal(this.#c)})),this.#t.ariaExpanded="true",this.#i){this.#i.classList.remove("hidden");return}const i=this.#i=this.#h();this.#t.append(i)}#u(t){this.#i?.contains(t.target)||this.hideDropdown()}hideDropdown(){this.#i?.classList.add("hidden"),this.#t.ariaExpanded="false",this.#c?.abort(),this.#c=null}get#p(){return this.#i&&!this.#i.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#s){if(!this.#p){this.#a?.unselect();return}this.hideDropdown(),this.#t.focus({preventScroll:!0,focusVisible:this.#r})}}updateColor(t){if(this.#e&&(this.#e.style.backgroundColor=t),!this.#i)return;const i=this.#l.highlightColors.values();for(const s of this.#i.children)s.ariaSelected=i.next().value===t.toUpperCase()}destroy(){this.#t?.remove(),this.#t=null,this.#e=null,this.#i?.remove(),this.#i=null}}class xr{#t=null;#e=null;#n=null;static#i=null;constructor(t){this.#e=t,this.#n=t._uiManager,xr.#i||=Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"})}renderButton(){if(this.#t)return this.#t;const{editorType:t,colorType:i,colorValue:s}=this.#e,a=this.#t=document.createElement("input");return a.type="color",a.value=s||"#000000",a.className="basicColorPicker",a.tabIndex=0,a.setAttribute("data-l10n-id",xr.#i[t]),a.addEventListener("input",()=>{this.#n.updateParams(i,a.value)},{signal:this.#n._signal}),a}update(t){this.#t&&(this.#t.value=t)}destroy(){this.#t?.remove(),this.#t=null}hideDropdown(){}}function em(g){return Math.floor(Math.max(0,Math.min(1,g))*255).toString(16).padStart(2,"0")}function ur(g){return Math.max(0,Math.min(255,255*g))}class im{static CMYK_G([t,i,s,a]){return["G",1-Math.min(1,.3*t+.59*s+.11*i+a)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=ur(t),[t,t,t]}static G_HTML([t]){const i=em(t);return`#${i}${i}${i}`}static RGB_G([t,i,s]){return["G",.3*t+.59*i+.11*s]}static RGB_rgb(t){return t.map(ur)}static RGB_HTML(t){return`#${t.map(em).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,i,s,a]){return["RGB",1-Math.min(1,t+a),1-Math.min(1,s+a),1-Math.min(1,i+a)]}static CMYK_rgb([t,i,s,a]){return[ur(1-Math.min(1,t+a)),ur(1-Math.min(1,s+a)),ur(1-Math.min(1,i+a))]}static CMYK_HTML(t){const i=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(i)}static RGB_CMYK([t,i,s]){const a=1-t,o=1-i,l=1-s,u=Math.min(a,o,l);return["CMYK",a,o,l,u]}}class ux{create(t,i,s=!1){if(t<=0||i<=0)throw new Error("Invalid SVG dimensions");const a=this._createSVG("svg:svg");return a.setAttribute("version","1.1"),s||(a.setAttribute("width",`${t}px`),a.setAttribute("height",`${i}px`)),a.setAttribute("preserveAspectRatio","none"),a.setAttribute("viewBox",`0 0 ${t} ${i}`),a}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){Jt("Abstract method `_createSVG` called.")}}class ol extends ux{_createSVG(t){return document.createElementNS(un,t)}}const hx=9,fs=new WeakSet,dx=new Date().getTimezoneOffset()*60*1e3;class nm{static create(t){switch(t.data.annotationType){case xe.LINK:return new ph(t);case xe.TEXT:return new gx(t);case xe.WIDGET:switch(t.data.fieldType){case"Tx":return new px(t);case"Btn":return t.data.radioButton?new jm(t):t.data.checkBox?new bx(t):new yx(t);case"Ch":return new vx(t);case"Sig":return new mx(t)}return new ms(t);case xe.POPUP:return new Zu(t);case xe.FREETEXT:return new Bm(t);case xe.LINE:return new Ax(t);case xe.SQUARE:return new Sx(t);case xe.CIRCLE:return new wx(t);case xe.POLYLINE:return new Pm(t);case xe.CARET:return new Ex(t);case xe.INK:return new mh(t);case xe.POLYGON:return new _x(t);case xe.HIGHLIGHT:return new Fm(t);case xe.UNDERLINE:return new Cx(t);case xe.SQUIGGLY:return new Tx(t);case xe.STRIKEOUT:return new Dx(t);case xe.STAMP:return new zm(t);case xe.FILEATTACHMENT:return new Nx(t);default:return new re(t)}}}class re{#t=null;#e=!1;#n=null;constructor(t,{isRenderable:i=!1,ignoreBorder:s=!1,createQuadrilaterals:a=!1}={}){this.isRenderable=i,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableComment=t.enableComment,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,i&&(this.container=this._createContainer(s)),a&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:t,richText:i}){return!!(t?.str||i?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return re._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){const{data:t}=this,i=this.annotationStorage?.getEditor(t.id);return i?i.getData():t}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){const t=this.annotationStorage?.getEditor(this.data.id);if(t)return t.commentButtonPositionInPage;const{quadPoints:i,inkLists:s,rect:a}=this.data;let o=-1/0,l=-1/0;if(i?.length>=8){for(let u=0;u<i.length;u+=8)i[u+1]>l?(l=i[u+1],o=i[u+2]):i[u+1]===l&&(o=Math.max(o,i[u+2]));return[o,l]}if(s?.length>=1){for(const u of s)for(let h=0,d=u.length;h<d;h+=2)u[h+1]>l?(l=u[h+1],o=u[h]):u[h+1]===l&&(o=Math.max(o,u[h]));if(o!==1/0)return[o,l]}return a?[a[2],a[3]]:null}_normalizePoint(t){const{page:{view:i},viewport:{rawDims:{pageWidth:s,pageHeight:a,pageX:o,pageY:l}}}=this.parent;return t[1]=i[3]-t[1]+i[1],t[0]=100*(t[0]-o)/s,t[1]=100*(t[1]-l)/a,t}get commentText(){const{data:t}=this;return this.annotationStorage.getRawValue(`${mr}${t.id}`)?.popup?.contents||t.contentsObj?.str||""}set commentText(t){const{data:i}=this,s={deleted:!t,contents:t||""};this.annotationStorage.updateEditor(i.id,{popup:s})||this.annotationStorage.setValue(`${mr}${i.id}`,{id:i.id,annotationType:i.annotationType,pageIndex:this.parent.page._pageIndex,popup:s,popupRef:i.popupRef,modificationDate:new Date}),t||this.removePopup()}removePopup(){(this.#n?.popup||this.popup)?.remove(),this.#n=this.popup=null}updateEdited(t){if(!this.container)return;t.rect&&(this.#t||={rect:this.data.rect.slice(0)});const{rect:i,popup:s}=t;i&&this.#i(i);let a=this.#n?.popup||this.popup;!a&&s?.text&&(this._createPopup(s),a=this.#n.popup),a&&(a.updateEdited(t),s?.deleted&&(a.remove(),this.#n=null,this.popup=null))}resetEdited(){this.#t&&(this.#i(this.#t.rect),this.#n?.popup.resetEdited(),this.#t=null)}#i(t){const{container:{style:i},data:{rect:s,rotation:a},parent:{viewport:{rawDims:{pageWidth:o,pageHeight:l,pageX:u,pageY:h}}}}=this;s?.splice(0,4,...t),i.left=`${100*(t[0]-u)/o}%`,i.top=`${100*(l-t[3]+h)/l}%`,a===0?(i.width=`${100*(t[2]-t[0])/o}%`,i.height=`${100*(t[3]-t[1])/l}%`):this.setRotation(a)}_createContainer(t){const{data:i,parent:{page:s,viewport:a}}=this,o=document.createElement("section");o.setAttribute("data-annotation-id",i.id),!(this instanceof ms)&&!(this instanceof ph)&&(o.tabIndex=0);const{style:l}=o;if(l.zIndex=this.parent.zIndex,this.parent.zIndex+=2,i.alternativeText&&(o.title=i.alternativeText),i.noRotate&&o.classList.add("norotate"),!i.rect||this instanceof Zu){const{rotation:S}=i;return!i.hasOwnCanvas&&S!==0&&this.setRotation(S,o),o}const{width:u,height:h}=this;if(!t&&i.borderStyle.width>0){l.borderWidth=`${i.borderStyle.width}px`;const S=i.borderStyle.horizontalCornerRadius,C=i.borderStyle.verticalCornerRadius;if(S>0||C>0){const k=`calc(${S}px * var(--total-scale-factor)) / calc(${C}px * var(--total-scale-factor))`;l.borderRadius=k}else if(this instanceof jm){const k=`calc(${u}px * var(--total-scale-factor)) / calc(${h}px * var(--total-scale-factor))`;l.borderRadius=k}switch(i.borderStyle.style){case ia.SOLID:l.borderStyle="solid";break;case ia.DASHED:l.borderStyle="dashed";break;case ia.BEVELED:Ct("Unimplemented border style: beveled");break;case ia.INSET:Ct("Unimplemented border style: inset");break;case ia.UNDERLINE:l.borderBottomStyle="solid";break}const E=i.borderColor||null;E?(this.#e=!0,l.borderColor=dt.makeHexColor(E[0]|0,E[1]|0,E[2]|0)):l.borderWidth=0}const d=dt.normalizeRect([i.rect[0],s.view[3]-i.rect[1]+s.view[1],i.rect[2],s.view[3]-i.rect[3]+s.view[1]]),{pageWidth:p,pageHeight:b,pageX:v,pageY:A}=a.rawDims;l.left=`${100*(d[0]-v)/p}%`,l.top=`${100*(d[1]-A)/b}%`;const{rotation:w}=i;return i.hasOwnCanvas||w===0?(l.width=`${100*u/p}%`,l.height=`${100*h/b}%`):this.setRotation(w,o),o}setRotation(t,i=this.container){if(!this.data.rect)return;const{pageWidth:s,pageHeight:a}=this.parent.viewport.rawDims;let{width:o,height:l}=this;t%180!==0&&([o,l]=[l,o]),i.style.width=`${100*o/s}%`,i.style.height=`${100*l/a}%`,i.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(i,s,a)=>{const o=a.detail[i],l=o[0],u=o.slice(1);a.target.style[s]=im[`${l}_HTML`](u),this.annotationStorage.setValue(this.data.id,{[s]:im[`${l}_rgb`](u)})};return Mt(this,"_commonActions",{display:i=>{const{display:s}=i.detail,a=s%2===1;this.container.style.visibility=a?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:a,noPrint:s===1||s===2})},print:i=>{this.annotationStorage.setValue(this.data.id,{noPrint:!i.detail.print})},hidden:i=>{const{hidden:s}=i.detail;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:s,noView:s})},focus:i=>{setTimeout(()=>i.target.focus({preventScroll:!1}),0)},userName:i=>{i.target.title=i.detail.userName},readonly:i=>{i.target.disabled=i.detail.readonly},required:i=>{this._setRequired(i.target,i.detail.required)},bgColor:i=>{t("bgColor","backgroundColor",i)},fillColor:i=>{t("fillColor","backgroundColor",i)},fgColor:i=>{t("fgColor","color",i)},textColor:i=>{t("textColor","color",i)},borderColor:i=>{t("borderColor","borderColor",i)},strokeColor:i=>{t("strokeColor","borderColor",i)},rotation:i=>{const s=i.detail.rotation;this.setRotation(s),this.annotationStorage.setValue(this.data.id,{rotation:s})}})}_dispatchEventFromSandbox(t,i){const s=this._commonActions;for(const a of Object.keys(i.detail))(t[a]||s[a])?.(i)}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const i=this.annotationStorage.getRawValue(this.data.id);if(!i)return;const s=this._commonActions;for(const[a,o]of Object.entries(i)){const l=s[a];if(l){const u={detail:{[a]:o},target:t};l(u),delete i[a]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[i,s,a,o]=this.data.rect.map(S=>Math.fround(S));if(t.length===8){const[S,C,E,k]=t.subarray(2,6);if(a===S&&o===C&&i===E&&s===k)return}const{style:l}=this.container;let u;if(this.#e){const{borderColor:S,borderWidth:C}=l;l.borderWidth=0,u=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${S}" stroke-width="${C}">`],this.container.classList.add("hasBorder")}const h=a-i,d=o-s,{svgFactory:p}=this,b=p.createElement("svg");b.classList.add("quadrilateralsContainer"),b.setAttribute("width",0),b.setAttribute("height",0),b.role="none";const v=p.createElement("defs");b.append(v);const A=p.createElement("clipPath"),w=`clippath_${this.data.id}`;A.setAttribute("id",w),A.setAttribute("clipPathUnits","objectBoundingBox"),v.append(A);for(let S=2,C=t.length;S<C;S+=8){const E=t[S],k=t[S+1],O=t[S+2],P=t[S+3],z=p.createElement("rect"),L=(O-i)/h,j=(o-k)/d,D=(E-O)/h,N=(k-P)/d;z.setAttribute("x",L),z.setAttribute("y",j),z.setAttribute("width",D),z.setAttribute("height",N),A.append(z),u?.push(`<rect vector-effect="non-scaling-stroke" x="${L}" y="${j}" width="${D}" height="${N}"/>`)}this.#e&&(u.push("</g></svg>')"),l.backgroundImage=u.join("")),this.container.append(b),this.container.style.clipPath=`url(#${w})`}_createPopup(t=null){const{data:i}=this;let s,a;t?(s={str:t.text},a=t.date):(s=i.contentsObj,a=i.modificationDate);const o=this.#n=new Zu({data:{color:i.color,titleObj:i.titleObj,modificationDate:a,contentsObj:s,richText:i.richText,parentRect:i.rect,borderStyle:0,id:`popup_${i.id}`,rotation:i.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]});this.parent._commentManager||this.parent.div.append(o.render())}get hasPopupElement(){return!!(this.#n||this.popup||this.data.popupRef)}get extraPopupElement(){return this.#n}render(){Jt("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,i=null){const s=[];if(this._fieldObjects){const a=this._fieldObjects[t];if(a)for(const{page:o,id:l,exportValues:u}of a){if(o===-1||l===i)continue;const h=typeof u=="string"?u:null,d=document.querySelector(`[data-element-id="${l}"]`);if(d&&!fs.has(d)){Ct(`_getElementsByName - element not allowed: ${l}`);continue}s.push({id:l,exportValue:h,domElement:d})}return s}for(const a of document.getElementsByName(t)){const{exportValue:o}=a,l=a.getAttribute("data-element-id");l!==i&&fs.has(a)&&s.push({id:l,exportValue:o,domElement:a})}return s}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const i of t)i.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:i}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:t,editId:i,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}}class fx extends re{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.editor=t.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:t}=this;t.hasComment&&(this._createPopup(t.comment),this.extraPopupElement.popup.renderCommentButton())}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(t){this.editor.comment=t,t||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.container.remove(),this.container=null,this.removePopup()}}class ph extends re{constructor(t,i=null){super(t,{isRenderable:!0,ignoreBorder:!!i?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:i}=this,s=document.createElement("a");s.setAttribute("data-element-id",t.id);let a=!1;return t.url?(i.addLinkAttributes(s,t.url,t.newWindow),a=!0):t.action?(this._bindNamedAction(s,t.action,t.overlaidText),a=!0):t.attachment?(this.#e(s,t.attachment,t.overlaidText,t.attachmentDest),a=!0):t.setOCGState?(this.#n(s,t.setOCGState,t.overlaidText),a=!0):t.dest?(this._bindLink(s,t.dest,t.overlaidText),a=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(s,t),a=!0),t.resetForm?(this._bindResetFormAction(s,t.resetForm),a=!0):this.isTooltipOnly&&!a&&(this._bindLink(s,""),a=!0)),this.container.classList.add("linkAnnotation"),a&&this.container.append(s),this.container}#t(){this.container.setAttribute("data-internal-link","")}_bindLink(t,i,s=""){t.href=this.linkService.getDestinationHash(i),t.onclick=()=>(i&&this.linkService.goToDestination(i),!1),(i||i==="")&&this.#t(),s&&(t.title=s)}_bindNamedAction(t,i,s=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(i),!1),s&&(t.title=s),this.#t()}#e(t,i,s="",a=null){t.href=this.linkService.getAnchorUrl(""),i.description?t.title=i.description:s&&(t.title=s),t.onclick=()=>(this.downloadManager?.openOrDownloadData(i.content,i.filename,a),!1),this.#t()}#n(t,i,s=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(i),!1),s&&(t.title=s),this.#t()}_bindJSAction(t,i){t.href=this.linkService.getAnchorUrl("");const s=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const a of Object.keys(i.actions)){const o=s.get(a);o&&(t[o]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i.id,name:a}}),!1))}i.overlaidText&&(t.title=i.overlaidText),t.onclick||(t.onclick=()=>!1),this.#t()}_bindResetFormAction(t,i){const s=t.onclick;if(s||(t.href=this.linkService.getAnchorUrl("")),this.#t(),!this._fieldObjects){Ct('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),s||(t.onclick=()=>!1);return}t.onclick=()=>{s?.();const{fields:a,refs:o,include:l}=i,u=[];if(a.length!==0||o.length!==0){const p=new Set(o);for(const b of a){const v=this._fieldObjects[b]||[];for(const{id:A}of v)p.add(A)}for(const b of Object.values(this._fieldObjects))for(const v of b)p.has(v.id)===l&&u.push(v)}else for(const p of Object.values(this._fieldObjects))u.push(...p);const h=this.annotationStorage,d=[];for(const p of u){const{id:b}=p;switch(d.push(b),p.type){case"text":{const A=p.defaultValue||"";h.setValue(b,{value:A});break}case"checkbox":case"radiobutton":{const A=p.defaultValue===p.exportValues;h.setValue(b,{value:A});break}case"combobox":case"listbox":{const A=p.defaultValue||"";h.setValue(b,{value:A});break}default:continue}const v=document.querySelector(`[data-element-id="${b}"]`);if(v){if(!fs.has(v)){Ct(`_bindResetFormAction - element not allowed: ${b}`);continue}}else continue;v.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:d,name:"ResetForm"}}),!1}}}class gx extends re{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(t),this.container}}class ms extends re{render(){return this.container}showElementAndHideCanvas(t){this.data.hasOwnCanvas&&(t.previousSibling?.nodeName==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return Le.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,i,s,a,o){s.includes("mouse")?t.addEventListener(s,l=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:a,value:o(l),shift:l.shiftKey,modifier:this._getKeyModifier(l)}})}):t.addEventListener(s,l=>{if(s==="blur"){if(!i.focused||!l.relatedTarget)return;i.focused=!1}else if(s==="focus"){if(i.focused)return;i.focused=!0}o&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:a,value:o(l)}})})}_setEventListeners(t,i,s,a){for(const[o,l]of s)(l==="Action"||this.data.actions?.[l])&&((l==="Focus"||l==="Blur")&&(i||={focused:!1}),this._setEventListener(t,i,o,l,a),l==="Focus"&&!this.data.actions?.Blur?this._setEventListener(t,i,"blur","Blur",null):l==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(t,i,"focus","Focus",null))}_setBackgroundColor(t){const i=this.data.backgroundColor||null;t.style.backgroundColor=i===null?"transparent":dt.makeHexColor(i[0],i[1],i[2])}_setTextStyle(t){const i=["left","center","right"],{fontColor:s}=this.data.defaultAppearanceData,a=this.data.defaultAppearanceData.fontSize||hx,o=t.style;let l;const u=2,h=d=>Math.round(10*d)/10;if(this.data.multiLine){const d=Math.abs(this.data.rect[3]-this.data.rect[1]-u),p=Math.round(d/(ju*a))||1,b=d/p;l=Math.min(a,h(b/ju))}else{const d=Math.abs(this.data.rect[3]-this.data.rect[1]-u);l=Math.min(a,h(d/ju))}o.fontSize=`calc(${l}px * var(--total-scale-factor))`,o.color=dt.makeHexColor(s[0],s[1],s[2]),this.data.textAlignment!==null&&(o.textAlign=i[this.data.textAlignment])}_setRequired(t,i){i?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",i)}}class px extends ms{constructor(t){const i=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:i})}setPropertyOnSiblings(t,i,s,a){const o=this.annotationStorage;for(const l of this._getElementsByName(t.name,t.id))l.domElement&&(l.domElement[i]=s),o.setValue(l.id,{[a]:s})}render(){const t=this.annotationStorage,i=this.data.id;this.container.classList.add("textWidgetAnnotation");let s=null;if(this.renderForms){const a=t.getValue(i,{value:this.data.fieldValue});let o=a.value||"";const l=t.getValue(i,{charLimit:this.data.maxLen}).charLimit;l&&o.length>l&&(o=o.slice(0,l));let u=a.formattedValue||this.data.textContent?.join(`
`)||null;u&&this.data.comb&&(u=u.replaceAll(/\s+/g,""));const h={userValue:o,formattedValue:u,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(s=document.createElement("textarea"),s.textContent=u??o,this.data.doNotScroll&&(s.style.overflowY="hidden")):(s=document.createElement("input"),s.type=this.data.password?"password":"text",s.setAttribute("value",u??o),this.data.doNotScroll&&(s.style.overflowX="hidden")),this.data.hasOwnCanvas&&(s.hidden=!0),fs.add(s),s.setAttribute("data-element-id",i),s.disabled=this.data.readOnly,s.name=this.data.fieldName,s.tabIndex=0;const{datetimeFormat:d,datetimeType:p,timeStep:b}=this.data,v=!!p&&this.enableScripting;d&&(s.title=d),this._setRequired(s,this.data.required),l&&(s.maxLength=l),s.addEventListener("input",w=>{t.setValue(i,{value:w.target.value}),this.setPropertyOnSiblings(s,"value",w.target.value,"value"),h.formattedValue=null}),s.addEventListener("resetform",w=>{const S=this.data.defaultFieldValue??"";s.value=h.userValue=S,h.formattedValue=null});let A=w=>{const{formattedValue:S}=h;S!=null&&(w.target.value=S),w.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){s.addEventListener("focus",S=>{if(h.focused)return;const{target:C}=S;if(v&&(C.type=p,b&&(C.step=b)),h.userValue){const E=h.userValue;if(v)if(p==="time"){const k=new Date(E),O=[k.getHours(),k.getMinutes(),k.getSeconds()];C.value=O.map(P=>P.toString().padStart(2,"0")).join(":")}else C.value=new Date(E-dx).toISOString().split(p==="date"?"T":".",1)[0];else C.value=E}h.lastCommittedValue=C.value,h.commitKey=1,this.data.actions?.Focus||(h.focused=!0)}),s.addEventListener("updatefromsandbox",S=>{this.showElementAndHideCanvas(S.target);const C={value(E){h.userValue=E.detail.value??"",v||t.setValue(i,{value:h.userValue.toString()}),E.target.value=h.userValue},formattedValue(E){const{formattedValue:k}=E.detail;h.formattedValue=k,k!=null&&E.target!==document.activeElement&&(E.target.value=k);const O={formattedValue:k};v&&(O.value=k),t.setValue(i,O)},selRange(E){E.target.setSelectionRange(...E.detail.selRange)},charLimit:E=>{const{charLimit:k}=E.detail,{target:O}=E;if(k===0){O.removeAttribute("maxLength");return}O.setAttribute("maxLength",k);let P=h.userValue;!P||P.length<=k||(P=P.slice(0,k),O.value=h.userValue=P,t.setValue(i,{value:P}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:P,willCommit:!0,commitKey:1,selStart:O.selectionStart,selEnd:O.selectionEnd}}))}};this._dispatchEventFromSandbox(C,S)}),s.addEventListener("keydown",S=>{h.commitKey=1;let C=-1;if(S.key==="Escape"?C=0:S.key==="Enter"&&!this.data.multiLine?C=2:S.key==="Tab"&&(h.commitKey=3),C===-1)return;const{value:E}=S.target;h.lastCommittedValue!==E&&(h.lastCommittedValue=E,h.userValue=E,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:E,willCommit:!0,commitKey:C,selStart:S.target.selectionStart,selEnd:S.target.selectionEnd}}))});const w=A;A=null,s.addEventListener("blur",S=>{if(!h.focused||!S.relatedTarget)return;this.data.actions?.Blur||(h.focused=!1);const{target:C}=S;let{value:E}=C;if(v){if(E&&p==="time"){const k=E.split(":").map(O=>parseInt(O,10));E=new Date(2e3,0,1,k[0],k[1],k[2]||0).valueOf(),C.step=""}else E.includes("T")||(E=`${E}T00:00`),E=new Date(E).valueOf();C.type="text"}h.userValue=E,h.lastCommittedValue!==E&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:E,willCommit:!0,commitKey:h.commitKey,selStart:S.target.selectionStart,selEnd:S.target.selectionEnd}}),w(S)}),this.data.actions?.Keystroke&&s.addEventListener("beforeinput",S=>{h.lastCommittedValue=null;const{data:C,target:E}=S,{value:k,selectionStart:O,selectionEnd:P}=E;let z=O,L=P;switch(S.inputType){case"deleteWordBackward":{const j=k.substring(0,O).match(/\w*[^\w]*$/);j&&(z-=j[0].length);break}case"deleteWordForward":{const j=k.substring(O).match(/^[^\w]*\w*/);j&&(L+=j[0].length);break}case"deleteContentBackward":O===P&&(z-=1);break;case"deleteContentForward":O===P&&(L+=1);break}S.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:k,change:C||"",willCommit:!1,selStart:z,selEnd:L}})}),this._setEventListeners(s,h,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],S=>S.target.value)}if(A&&s.addEventListener("blur",A),this.data.comb){const S=(this.data.rect[2]-this.data.rect[0])/l;s.classList.add("comb"),s.style.letterSpacing=`calc(${S}px * var(--total-scale-factor) - 1ch)`}}else s=document.createElement("div"),s.textContent=this.data.fieldValue,s.style.verticalAlign="middle",s.style.display="table-cell",this.data.hasOwnCanvas&&(s.hidden=!0);return this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class mx extends ms{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class bx extends ms{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,i=this.data,s=i.id;let a=t.getValue(s,{value:i.exportValue===i.fieldValue}).value;typeof a=="string"&&(a=a!=="Off",t.setValue(s,{value:a})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const o=document.createElement("input");return fs.add(o),o.setAttribute("data-element-id",s),o.disabled=i.readOnly,this._setRequired(o,this.data.required),o.type="checkbox",o.name=i.fieldName,a&&o.setAttribute("checked",!0),o.setAttribute("exportValue",i.exportValue),o.tabIndex=0,o.addEventListener("change",l=>{const{name:u,checked:h}=l.target;for(const d of this._getElementsByName(u,s)){const p=h&&d.exportValue===i.exportValue;d.domElement&&(d.domElement.checked=p),t.setValue(d.id,{value:p})}t.setValue(s,{value:h})}),o.addEventListener("resetform",l=>{const u=i.defaultFieldValue||"Off";l.target.checked=u===i.exportValue}),this.enableScripting&&this.hasJSActions&&(o.addEventListener("updatefromsandbox",l=>{const u={value(h){h.target.checked=h.detail.value!=="Off",t.setValue(s,{value:h.target.checked})}};this._dispatchEventFromSandbox(u,l)}),this._setEventListeners(o,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],l=>l.target.checked)),this._setBackgroundColor(o),this._setDefaultPropertiesFromJS(o),this.container.append(o),this.container}}class jm extends ms{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,i=this.data,s=i.id;let a=t.getValue(s,{value:i.fieldValue===i.buttonValue}).value;if(typeof a=="string"&&(a=a!==i.buttonValue,t.setValue(s,{value:a})),a)for(const l of this._getElementsByName(i.fieldName,s))t.setValue(l.id,{value:!1});const o=document.createElement("input");if(fs.add(o),o.setAttribute("data-element-id",s),o.disabled=i.readOnly,this._setRequired(o,this.data.required),o.type="radio",o.name=i.fieldName,a&&o.setAttribute("checked",!0),o.tabIndex=0,o.addEventListener("change",l=>{const{name:u,checked:h}=l.target;for(const d of this._getElementsByName(u,s))t.setValue(d.id,{value:!1});t.setValue(s,{value:h})}),o.addEventListener("resetform",l=>{const u=i.defaultFieldValue;l.target.checked=u!=null&&u===i.buttonValue}),this.enableScripting&&this.hasJSActions){const l=i.buttonValue;o.addEventListener("updatefromsandbox",u=>{const h={value:d=>{const p=l===d.detail.value;for(const b of this._getElementsByName(d.target.name)){const v=p&&b.id===s;b.domElement&&(b.domElement.checked=v),t.setValue(b.id,{value:v})}}};this._dispatchEventFromSandbox(h,u)}),this._setEventListeners(o,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],u=>u.target.checked)}return this._setBackgroundColor(o),this._setDefaultPropertiesFromJS(o),this.container.append(o),this.container}}class yx extends ph{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const i=t.lastChild;return this.enableScripting&&this.hasJSActions&&i&&(this._setDefaultPropertiesFromJS(i),i.addEventListener("updatefromsandbox",s=>{this._dispatchEventFromSandbox({},s)})),t}}class vx extends ms{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,i=this.data.id,s=t.getValue(i,{value:this.data.fieldValue}),a=document.createElement("select");fs.add(a),a.setAttribute("data-element-id",i),a.disabled=this.data.readOnly,this._setRequired(a,this.data.required),a.name=this.data.fieldName,a.tabIndex=0;let o=this.data.combo&&this.data.options.length>0;this.data.combo||(a.size=this.data.options.length,this.data.multiSelect&&(a.multiple=!0)),a.addEventListener("resetform",p=>{const b=this.data.defaultFieldValue;for(const v of a.options)v.selected=v.value===b});for(const p of this.data.options){const b=document.createElement("option");b.textContent=p.displayValue,b.value=p.exportValue,s.value.includes(p.exportValue)&&(b.setAttribute("selected",!0),o=!1),a.append(b)}let l=null;if(o){const p=document.createElement("option");p.value=" ",p.setAttribute("hidden",!0),p.setAttribute("selected",!0),a.prepend(p),l=()=>{p.remove(),a.removeEventListener("input",l),l=null},a.addEventListener("input",l)}const u=p=>{const b=p?"value":"textContent",{options:v,multiple:A}=a;return A?Array.prototype.filter.call(v,w=>w.selected).map(w=>w[b]):v.selectedIndex===-1?null:v[v.selectedIndex][b]};let h=u(!1);const d=p=>{const b=p.target.options;return Array.prototype.map.call(b,v=>({displayValue:v.textContent,exportValue:v.value}))};return this.enableScripting&&this.hasJSActions?(a.addEventListener("updatefromsandbox",p=>{const b={value(v){l?.();const A=v.detail.value,w=new Set(Array.isArray(A)?A:[A]);for(const S of a.options)S.selected=w.has(S.value);t.setValue(i,{value:u(!0)}),h=u(!1)},multipleSelection(v){a.multiple=!0},remove(v){const A=a.options,w=v.detail.remove;A[w].selected=!1,a.remove(w),A.length>0&&Array.prototype.findIndex.call(A,C=>C.selected)===-1&&(A[0].selected=!0),t.setValue(i,{value:u(!0),items:d(v)}),h=u(!1)},clear(v){for(;a.length!==0;)a.remove(0);t.setValue(i,{value:null,items:[]}),h=u(!1)},insert(v){const{index:A,displayValue:w,exportValue:S}=v.detail.insert,C=a.children[A],E=document.createElement("option");E.textContent=w,E.value=S,C?C.before(E):a.append(E),t.setValue(i,{value:u(!0),items:d(v)}),h=u(!1)},items(v){const{items:A}=v.detail;for(;a.length!==0;)a.remove(0);for(const w of A){const{displayValue:S,exportValue:C}=w,E=document.createElement("option");E.textContent=S,E.value=C,a.append(E)}a.options.length>0&&(a.options[0].selected=!0),t.setValue(i,{value:u(!0),items:d(v)}),h=u(!1)},indices(v){const A=new Set(v.detail.indices);for(const w of v.target.options)w.selected=A.has(w.index);t.setValue(i,{value:u(!0)}),h=u(!1)},editable(v){v.target.disabled=!v.detail.editable}};this._dispatchEventFromSandbox(b,p)}),a.addEventListener("input",p=>{const b=u(!0),v=u(!1);t.setValue(i,{value:b}),p.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:h,change:v,changeEx:b,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(a,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],p=>p.target.value)):a.addEventListener("input",function(p){t.setValue(i,{value:u(!0)})}),this.data.combo&&this._setTextStyle(a),this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.append(a),this.container}}class Zu extends re{constructor(t){const{data:i,elements:s,parent:a}=t,o=!!a._commentManager;if(super(t,{isRenderable:!o&&re._hasPopupData(i)}),this.elements=s,o&&re._hasPopupData(i)){const l=this.popup=this.#t();for(const u of s)u.popup=l}else this.popup=null}#t(){return new xx({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})}render(){const{container:t}=this;t.classList.add("popupAnnotation"),t.role="comment";const i=this.popup=this.#t(),s=[];for(const a of this.elements)a.popup=i,a.container.ariaHasPopup="dialog",s.push(a.data.id),a.addHighlightArea();return this.container.setAttribute("aria-controls",s.map(a=>`${ah}${a}`).join(",")),this.container}}class xx{#t=null;#e=this.#G.bind(this);#n=this.#z.bind(this);#i=this.#O.bind(this);#r=this.#A.bind(this);#s=null;#a=null;#o=null;#c=null;#l=null;#d=null;#h=null;#f=!1;#m=null;#g=null;#u=null;#p=null;#b=null;#v=null;#y=null;#E=null;#w=null;#x=null;#T=!1;#S=null;#_=null;constructor({container:t,color:i,elements:s,titleObj:a,modificationDate:o,contentsObj:l,richText:u,parent:h,rect:d,parentRect:p,open:b,commentManager:v=null}){this.#a=t,this.#w=a,this.#o=l,this.#E=u,this.#d=h,this.#s=i,this.#y=d,this.#h=p,this.#l=s,this.#t=v,this.#S=s[0],this.#c=Vu.toDateObject(o),this.trigger=s.flatMap(A=>A.getElementsToTriggerPopup()),v?this.renderCommentButton():(this.#M(),this.#a.hidden=!0,b&&this.#A())}#M(){if(this.#g)return;this.#g=new AbortController;const{signal:t}=this.#g;for(const i of this.trigger)i.addEventListener("click",this.#r,{signal:t}),i.addEventListener("pointerenter",this.#i,{signal:t}),i.addEventListener("pointerleave",this.#n,{signal:t}),i.classList.add("popupTriggerArea");for(const i of this.#l)i.container?.addEventListener("keydown",this.#e,{signal:t})}#D(){const t=this.#l.find(i=>i.hasCommentButton);t&&(this.#b=t._normalizePoint(t.commentButtonPosition))}renderCommentButton(){if(this.#p||(this.#b||this.#D(),!this.#b))return;const{signal:t}=this.#g=new AbortController,i=!!this.#S.extraPopupElement,s=()=>{this.#t.toggleCommentPopup(this,!0,void 0,!i)},a=()=>{this.#t.toggleCommentPopup(this,!1,!0,!i)},o=()=>{this.#t.toggleCommentPopup(this,!1,!1)};if(i){this.#p=this.#S.container;for(const l of this.trigger)l.ariaHasPopup="dialog",l.ariaControls="commentPopup",l.addEventListener("keydown",this.#e,{signal:t}),l.addEventListener("click",s,{signal:t}),l.addEventListener("pointerenter",a,{signal:t}),l.addEventListener("pointerleave",o,{signal:t}),l.classList.add("popupTriggerArea")}else{const l=this.#p=document.createElement("button");l.className="annotationCommentButton";const u=this.#S.container;l.style.zIndex=u.style.zIndex+1,l.tabIndex=0,l.ariaHasPopup="dialog",l.ariaControls="commentPopup",l.setAttribute("data-l10n-id","pdfjs-show-comment-button"),this.#P(),this.#N(),l.addEventListener("keydown",this.#e,{signal:t}),l.addEventListener("click",s,{signal:t}),l.addEventListener("pointerenter",a,{signal:t}),l.addEventListener("pointerleave",o,{signal:t}),u.after(l)}}#N(){if(this.#S.extraPopupElement&&!this.#S.editor)return;this.renderCommentButton();const[t,i]=this.#b,{style:s}=this.#p;s.left=`calc(${t}%)`,s.top=`calc(${i}% - var(--comment-button-dim))`}#P(){this.#S.extraPopupElement||(this.renderCommentButton(),this.#p.style.backgroundColor=this.commentButtonColor||"")}get commentButtonColor(){const{color:t,opacity:i}=this.#S.commentData;return t?this.#d._commentManager.makeCommentColor(t,i):null}focusCommentButton(){setTimeout(()=>{this.#p?.focus()},0)}getData(){const{richText:t,color:i,opacity:s,creationDate:a,modificationDate:o}=this.#S.commentData;return{contentsObj:{str:this.comment},richText:t,color:i,opacity:s,creationDate:a,modificationDate:o}}get elementBeforePopup(){return this.#p}get comment(){return this.#_||=this.#S.commentText,this.#_}set comment(t){t!==this.comment&&(this.#S.commentText=this.#_=t)}get parentBoundingClientRect(){return this.#S.layer.getBoundingClientRect()}setCommentButtonStates({selected:t,hasPopup:i}){this.#p&&(this.#p.classList.toggle("selected",t),this.#p.ariaExpanded=i)}setSelectedCommentButton(t){this.#p.classList.toggle("selected",t)}get commentPopupPosition(){if(this.#v)return this.#v;const{x:t,y:i,height:s}=this.#p.getBoundingClientRect(),{x:a,y:o,width:l,height:u}=this.#S.layer.getBoundingClientRect();return[(t-a)/l,(i+s-o)/u]}set commentPopupPosition(t){this.#v=t}hasDefaultPopupPosition(){return this.#v===null}get commentButtonPosition(){return this.#b}get commentButtonWidth(){return this.#p.getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(t){const[i,s]=this.#v||this.commentButtonPosition.map(d=>d/100),a=this.parentBoundingClientRect,{x:o,y:l,width:u,height:h}=a;this.#t.showDialog(null,this,o+i*u,l+s*h,{...t,parentDimensions:a})}render(){if(this.#m)return;const t=this.#m=document.createElement("div");if(t.className="popup",this.#s){const s=t.style.outlineColor=dt.makeHexColor(...this.#s);t.style.backgroundColor=`color-mix(in srgb, ${s} 30%, white)`}const i=document.createElement("span");if(i.className="header",this.#w?.str){const s=document.createElement("span");s.className="title",i.append(s),{dir:s.dir,str:s.textContent}=this.#w}if(t.append(i),this.#c){const s=document.createElement("time");s.className="popupDate",s.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),s.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#c.valueOf()})),s.dateTime=this.#c.toISOString(),i.append(s)}gm({html:this.#k||this.#o.str,dir:this.#o?.dir,className:"popupContent"},t),this.#a.append(t)}get#k(){const t=this.#E,i=this.#o;return t?.str&&(!i?.str||i.str===t.str)&&this.#E.html||null}get#L(){return this.#k?.attributes?.style?.fontSize||0}get#F(){return this.#k?.attributes?.style?.color||null}#j(t){const i=[],s={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:i}]}},a={style:{color:this.#F,fontSize:this.#L?`calc(${this.#L}px * var(--total-scale-factor))`:""}};for(const o of t.split(`
`))i.push({name:"span",value:o,attributes:a});return s}#G(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&this.#f)&&this.#A()}updateEdited({rect:t,popup:i,deleted:s}){if(this.#t){s?(this.remove(),this.#_=null):i&&(i.deleted?this.remove():(this.#P(),this.#_=i.text)),t&&(this.#b=null,this.#D(),this.#N());return}if(s||i?.deleted){this.remove();return}this.#M(),this.#x||={contentsObj:this.#o,richText:this.#E},t&&(this.#u=null),i&&i.text&&(this.#E=this.#j(i.text),this.#c=Vu.toDateObject(i.date),this.#o=null),this.#m?.remove(),this.#m=null}resetEdited(){this.#x&&({contentsObj:this.#o,richText:this.#E}=this.#x,this.#x=null,this.#m?.remove(),this.#m=null,this.#u=null)}remove(){if(this.#g?.abort(),this.#g=null,this.#m?.remove(),this.#m=null,this.#T=!1,this.#f=!1,this.#p?.remove(),this.#p=null,this.trigger)for(const t of this.trigger)t.classList.remove("popupTriggerArea")}#C(){if(this.#u!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:i,pageHeight:s,pageX:a,pageY:o}}}=this.#d;let l=!!this.#h,u=l?this.#h:this.#y;for(const w of this.#l)if(!u||dt.intersect(w.data.rect,u)!==null){u=w.data.rect,l=!0;break}const h=dt.normalizeRect([u[0],t[3]-u[1]+t[1],u[2],t[3]-u[3]+t[1]]),p=l?u[2]-u[0]+5:0,b=h[0]+p,v=h[1];this.#u=[100*(b-a)/i,100*(v-o)/s];const{style:A}=this.#a;A.left=`${this.#u[0]}%`,A.top=`${this.#u[1]}%`}#A(){if(this.#t){this.#t.toggleCommentPopup(this,!1);return}this.#f=!this.#f,this.#f?(this.#O(),this.#a.addEventListener("click",this.#r),this.#a.addEventListener("keydown",this.#e)):(this.#z(),this.#a.removeEventListener("click",this.#r),this.#a.removeEventListener("keydown",this.#e))}#O(){this.#m||this.render(),this.isVisible?this.#f&&this.#a.classList.add("focused"):(this.#C(),this.#a.hidden=!1,this.#a.style.zIndex=parseInt(this.#a.style.zIndex)+1e3)}#z(){this.#a.classList.remove("focused"),!(this.#f||!this.isVisible)&&(this.#a.hidden=!0,this.#a.style.zIndex=parseInt(this.#a.style.zIndex)-1e3)}forceHide(){this.#T=this.isVisible,this.#T&&(this.#a.hidden=!0)}maybeShow(){this.#t||(this.#M(),this.#T&&(this.#m||this.#O(),this.#T=!1,this.#a.hidden=!1))}get isVisible(){return this.#t?!1:this.#a.hidden===!1}}class Bm extends re{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=Tt.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const i of this.textContent){const s=document.createElement("span");s.textContent=i,t.append(s)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class Ax extends re{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const{data:t,width:i,height:s}=this,a=this.svgFactory.create(i,s,!0),o=this.#t=this.svgFactory.createElement("svg:line");return o.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),o.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),o.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),o.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),o.setAttribute("stroke-width",t.borderStyle.width||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),a.append(o),this.container.append(a),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class Sx extends re{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const{data:t,width:i,height:s}=this,a=this.svgFactory.create(i,s,!0),o=t.borderStyle.width,l=this.#t=this.svgFactory.createElement("svg:rect");return l.setAttribute("x",o/2),l.setAttribute("y",o/2),l.setAttribute("width",i-o),l.setAttribute("height",s-o),l.setAttribute("stroke-width",o||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),a.append(l),this.container.append(a),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class wx extends re{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const{data:t,width:i,height:s}=this,a=this.svgFactory.create(i,s,!0),o=t.borderStyle.width,l=this.#t=this.svgFactory.createElement("svg:ellipse");return l.setAttribute("cx",i/2),l.setAttribute("cy",s/2),l.setAttribute("rx",i/2-o/2),l.setAttribute("ry",s/2-o/2),l.setAttribute("stroke-width",o||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),a.append(l),this.container.append(a),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class Pm extends re{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:i,borderStyle:s,popupRef:a},width:o,height:l}=this;if(!i)return this.container;const u=this.svgFactory.create(o,l,!0);let h=[];for(let p=0,b=i.length;p<b;p+=2){const v=i[p]-t[0],A=t[3]-i[p+1];h.push(`${v},${A}`)}h=h.join(" ");const d=this.#t=this.svgFactory.createElement(this.svgElementName);return d.setAttribute("points",h),d.setAttribute("stroke-width",s.width||1),d.setAttribute("stroke","transparent"),d.setAttribute("fill","transparent"),u.append(d),this.container.append(u),!a&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class _x extends Pm{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Ex extends re{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class mh extends re{#t=null;#e=[];constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?Tt.HIGHLIGHT:Tt.INK}#n(t,i){switch(t){case 90:return{transform:`rotate(90) translate(${-i[0]},${i[1]}) scale(1,-1)`,width:i[3]-i[1],height:i[2]-i[0]};case 180:return{transform:`rotate(180) translate(${-i[2]},${i[1]}) scale(1,-1)`,width:i[2]-i[0],height:i[3]-i[1]};case 270:return{transform:`rotate(270) translate(${-i[2]},${i[3]}) scale(1,-1)`,width:i[3]-i[1],height:i[2]-i[0]};default:return{transform:`translate(${-i[0]},${i[3]}) scale(1,-1)`,width:i[2]-i[0],height:i[3]-i[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:i,inkLists:s,borderStyle:a,popupRef:o}}=this,{transform:l,width:u,height:h}=this.#n(i,t),d=this.svgFactory.create(u,h,!0),p=this.#t=this.svgFactory.createElement("svg:g");d.append(p),p.setAttribute("stroke-width",a.width||1),p.setAttribute("stroke-linecap","round"),p.setAttribute("stroke-linejoin","round"),p.setAttribute("stroke-miterlimit",10),p.setAttribute("stroke","transparent"),p.setAttribute("fill","transparent"),p.setAttribute("transform",l);for(let b=0,v=s.length;b<v;b++){const A=this.svgFactory.createElement(this.svgElementName);this.#e.push(A),A.setAttribute("points",s[b].join(",")),p.append(A)}return!o&&this.hasPopupData&&this._createPopup(),this.container.append(d),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:i,points:s,rect:a}=t,o=this.#t;if(i>=0&&o.setAttribute("stroke-width",i||1),s)for(let l=0,u=this.#e.length;l<u;l++)this.#e[l].setAttribute("points",s[l].join(","));if(a){const{transform:l,width:u,height:h}=this.#n(this.data.rotation,a);o.parentElement.setAttribute("viewBox",`0 0 ${u} ${h}`),o.setAttribute("transform",l)}}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class Fm extends re{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=Tt.HIGHLIGHT}render(){const{data:{overlaidText:t,popupRef:i}}=this;if(!i&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),t){const s=document.createElement("mark");s.classList.add("overlaidText"),s.textContent=t,this.container.append(s)}return this.container}}class Cx extends re{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:i}}=this;if(!i&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),t){const s=document.createElement("u");s.classList.add("overlaidText"),s.textContent=t,this.container.append(s)}return this.container}}class Tx extends re{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:i}}=this;if(!i&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),t){const s=document.createElement("u");s.classList.add("overlaidText"),s.textContent=t,this.container.append(s)}return this.container}}class Dx extends re{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:i}}=this;if(!i&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),t){const s=document.createElement("s");s.classList.add("overlaidText"),s.textContent=t,this.container.append(s)}return this.container}}class zm extends re{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=Tt.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class Nx extends re{#t=null;constructor(t){super(t,{isRenderable:!0});const{file:i}=this.data;this.filename=i.filename,this.content=i.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...i})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:i}=this;let s;i.hasAppearance||i.fillAlpha===0?s=document.createElement("div"):(s=document.createElement("img"),s.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(i.name)?"paperclip":"pushpin"}.svg`,i.fillAlpha&&i.fillAlpha<1&&(s.style=`filter: opacity(${Math.round(i.fillAlpha*100)}%);`)),s.addEventListener("dblclick",this.#e.bind(this)),this.#t=s;const{isMac:a}=Le.platform;return t.addEventListener("keydown",o=>{o.key==="Enter"&&(a?o.metaKey:o.ctrlKey)&&this.#e()}),!i.popupRef&&this.hasPopupData?this._createPopup():s.classList.add("popupTriggerArea"),t.append(s),t}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}#e(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}class bh{#t=null;#e=null;#n=null;#i=new Map;#r=null;#s=null;constructor({div:t,accessibilityManager:i,annotationCanvasMap:s,annotationEditorUIManager:a,page:o,viewport:l,structTreeLayer:u,commentManager:h,linkService:d,annotationStorage:p}){this.div=t,this.#t=i,this.#e=s,this.#r=u||null,this.#s=d||null,this.#n=p||new uh,this.page=o,this.viewport=l,this.zIndex=0,this._annotationEditorUIManager=a,this._commentManager=h||null}hasEditableAnnotations(){return this.#i.size>0}async#a(t,i,s){const a=t.firstChild||t,o=a.id=`${ah}${i}`,l=await this.#r?.getAriaAttributes(o);if(l)for(const[u,h]of l)a.setAttribute(u,h);s?s.at(-1).container.after(t):(this.div.append(t),this.#t?.moveElementInDOM(this.div,t,a,!1))}async render(t){const{annotations:i}=t,s=this.div;ds(s,this.viewport);const a=new Map,o={data:null,layer:s,linkService:this.#s,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new ol,annotationStorage:this.#n,enableComment:t.enableComment===!0,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const l of i){if(l.noHTML)continue;const u=l.annotationType===xe.POPUP;if(u){const p=a.get(l.id);if(!p)continue;o.elements=p}else if(l.rect[2]===l.rect[0]||l.rect[3]===l.rect[1])continue;o.data=l;const h=nm.create(o);if(!h.isRenderable)continue;if(!u&&l.popupRef){const p=a.get(l.popupRef);p?p.push(h):a.set(l.popupRef,[h])}const d=h.render();l.hidden&&(d.style.visibility="hidden"),await this.#a(d,l.id,o.elements),h.extraPopupElement?.popup?.renderCommentButton(),h._isEditable&&(this.#i.set(h.data.id,h),this._annotationEditorUIManager?.renderAnnotationElement(h))}this.#o()}async addLinkAnnotations(t){const i={data:null,layer:this.div,linkService:this.#s,svgFactory:new ol,parent:this};for(const s of t){s.borderStyle||=bh._defaultBorderStyle,i.data=s;const a=nm.create(i);if(!a.isRenderable)continue;const o=a.render();await this.#a(o,s.id,null)}}update({viewport:t}){const i=this.div;this.viewport=t,ds(i,{rotation:t.rotation}),this.#o(),i.hidden=!1}#o(){if(!this.#e)return;const t=this.div;for(const[i,s]of this.#e){const a=t.querySelector(`[data-annotation-id="${i}"]`);if(!a)continue;s.className="annotationContent";const{firstChild:o}=a;o?o.nodeName==="CANVAS"?o.replaceWith(s):o.classList.contains("annotationContent")?o.after(s):o.before(s):a.append(s);const l=this.#i.get(i);l&&(l._hasNoCanvas?(this._annotationEditorUIManager?.setMissingCanvas(i,a.id,s),l._hasNoCanvas=!1):l.canvas=s)}this.#e.clear()}getEditableAnnotations(){return Array.from(this.#i.values())}getEditableAnnotation(t){return this.#i.get(t)}addFakeAnnotation(t){const{div:i}=this,{id:s,rotation:a}=t,o=new fx({data:{id:s,rect:t.getPDFRect(),rotation:a},editor:t,layer:i,parent:this,enableComment:!!this._commentManager,linkService:this.#s,annotationStorage:this.#n}),l=o.render();return i.append(l),this.#t?.moveElementInDOM(i,l,l,!1),o.createOrUpdatePopup(),o}static get _defaultBorderStyle(){return Mt(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:ia.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}}const Jo=/\r\n?|\n/g;class _e extends vt{#t="";#e=`${this.id}-editor`;#n=null;#i;_colorPicker=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const t=_e.prototype,i=o=>o.isEmpty(),s=Hn.TRANSLATE_SMALL,a=Hn.TRANSLATE_BIG;return Mt(this,"_keyboardManager",new Er([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-s,0],checker:i}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-a,0],checker:i}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[s,0],checker:i}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[a,0],checker:i}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-s],checker:i}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-a],checker:i}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,s],checker:i}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,a],checker:i}]]))}static _type="freetext";static _editorType=Tt.FREETEXT;constructor(t){super({...t,name:"freeTextEditor"}),this.color=t.color||_e._defaultColor||vt._defaultLineColor,this.#i=t.fontSize||_e._defaultFontSize,this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert")}static initialize(t,i){vt.initialize(t,i);const s=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(s.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,i){switch(t){case Ft.FREETEXT_SIZE:_e._defaultFontSize=i;break;case Ft.FREETEXT_COLOR:_e._defaultColor=i;break}}updateParams(t,i){switch(t){case Ft.FREETEXT_SIZE:this.#r(i);break;case Ft.FREETEXT_COLOR:this.#s(i);break}}static get defaultPropertiesToUpdate(){return[[Ft.FREETEXT_SIZE,_e._defaultFontSize],[Ft.FREETEXT_COLOR,_e._defaultColor||vt._defaultLineColor]]}get propertiesToUpdate(){return[[Ft.FREETEXT_SIZE,this.#i],[Ft.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||=new xr(this),[["colorPicker",this._colorPicker]]}get colorType(){return Ft.FREETEXT_COLOR}#r(t){const i=a=>{this.editorDiv.style.fontSize=`calc(${a}px * var(--total-scale-factor))`,this.translate(0,-(a-this.#i)*this.parentScale),this.#i=a,this.#o()},s=this.#i;this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ft.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}onUpdatedColor(){this.editorDiv.style.color=this.color,this._colorPicker?.update(this.color),super.onUpdatedColor()}#s(t){const i=a=>{this.color=a,this.onUpdatedColor()},s=this.color;this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ft.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(t,i){this._uiManager.translateSelectedEditors(t,i,!0)}getInitialTranslation(){const t=this.parentScale;return[-_e._internalPadding*t,-(_e._internalPadding+this.#i)*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#n=new AbortController;const t=this._uiManager.combinedSignal(this.#n);return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#e),this._isDraggable=!0,this.#n?.abort(),this.#n=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#a(){const t=[];this.editorDiv.normalize();let i=null;for(const s of this.editorDiv.childNodes)i?.nodeType===Node.TEXT_NODE&&s.nodeName==="BR"||(t.push(_e.#c(s)),i=s);return t.join(`
`)}#o(){const[t,i]=this.parentDimensions;let s;if(this.isAttachedToDOM)s=this.div.getBoundingClientRect();else{const{currentLayer:a,div:o}=this,l=o.style.display,u=o.classList.contains("hidden");o.classList.remove("hidden"),o.style.display="hidden",a.div.append(this.div),s=o.getBoundingClientRect(),o.remove(),o.style.display=l,o.classList.toggle("hidden",u)}this.rotation%180===this.parentRotation%180?(this.width=s.width/t,this.height=s.height/i):(this.width=s.height/t,this.height=s.width/i),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=this.#t,i=this.#t=this.#a().trimEnd();if(t===i)return;const s=a=>{if(this.#t=a,!a){this.remove();return}this.#l(),this._uiManager.rebuild(this),this.#o()};this.addCommands({cmd:()=>{s(i)},undo:()=>{s(t)},mustExec:!1}),this.#o()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){_e._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,i;(this._isCopy||this.annotationElementId)&&(t=this.x,i=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#e),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:s}=this.editorDiv;if(s.fontSize=`calc(${this.#i}px * var(--total-scale-factor))`,s.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[a,o]=this.parentDimensions;if(this.annotationElementId){const{position:l}=this._initialData;let[u,h]=this.getInitialTranslation();[u,h]=this.pageTranslationToScreen(u,h);const[d,p]=this.pageDimensions,[b,v]=this.pageTranslation;let A,w;switch(this.rotation){case 0:A=t+(l[0]-b)/d,w=i+this.height-(l[1]-v)/p;break;case 90:A=t+(l[0]-b)/d,w=i-(l[1]-v)/p,[u,h]=[h,-u];break;case 180:A=t-this.width+(l[0]-b)/d,w=i-(l[1]-v)/p,[u,h]=[-u,-h];break;case 270:A=t+(l[0]-b-this.height*p)/d,w=i+(l[1]-v-this.width*d)/p,[u,h]=[-h,u];break}this.setAt(A*a,w*o,u,h)}else this._moveAfterPaste(t,i);this.#l(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#c(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(Jo,"")}editorDivPaste(t){const i=t.clipboardData||window.clipboardData,{types:s}=i;if(s.length===1&&s[0]==="text/plain")return;t.preventDefault();const a=_e.#h(i.getData("text")||"").replaceAll(Jo,`
`);if(!a)return;const o=window.getSelection();if(!o.rangeCount)return;this.editorDiv.normalize(),o.deleteFromDocument();const l=o.getRangeAt(0);if(!a.includes(`
`)){l.insertNode(document.createTextNode(a)),this.editorDiv.normalize(),o.collapseToStart();return}const{startContainer:u,startOffset:h}=l,d=[],p=[];if(u.nodeType===Node.TEXT_NODE){const A=u.parentElement;if(p.push(u.nodeValue.slice(h).replaceAll(Jo,"")),A!==this.editorDiv){let w=d;for(const S of this.editorDiv.childNodes){if(S===A){w=p;continue}w.push(_e.#c(S))}}d.push(u.nodeValue.slice(0,h).replaceAll(Jo,""))}else if(u===this.editorDiv){let A=d,w=0;for(const S of this.editorDiv.childNodes)w++===h&&(A=p),A.push(_e.#c(S))}this.#t=`${d.join(`
`)}${a}${p.join(`
`)}`,this.#l();const b=new Range;let v=Math.sumPrecise(d.map(A=>A.length));for(const{firstChild:A}of this.editorDiv.childNodes)if(A.nodeType===Node.TEXT_NODE){const w=A.nodeValue.length;if(v<=w){b.setStart(A,v),b.setEnd(A,v);break}v-=w}o.removeAllRanges(),o.addRange(b)}#l(){if(this.editorDiv.replaceChildren(),!!this.#t)for(const t of this.#t.split(`
`)){const i=document.createElement("div");i.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(i)}}#d(){return this.#t.replaceAll(""," ")}static#h(t){return t.replaceAll(" ","")}get contentDiv(){return this.editorDiv}getPDFRect(){const t=_e._internalPadding*this.parentScale;return this.getRect(t,t)}static async deserialize(t,i,s){let a=null;if(t instanceof Bm){const{data:{defaultAppearanceData:{fontSize:l,fontColor:u},rect:h,rotation:d,id:p,popupRef:b,richText:v,contentsObj:A,creationDate:w,modificationDate:S},textContent:C,textPosition:E,parent:{page:{pageNumber:k}}}=t;if(!C||C.length===0)return null;a=t={annotationType:Tt.FREETEXT,color:Array.from(u),fontSize:l,value:C.join(`
`),position:E,pageIndex:k-1,rect:h.slice(0),rotation:d,annotationElementId:p,id:p,deleted:!1,popupRef:b,comment:A?.str||null,richText:v,creationDate:w,modificationDate:S}}const o=await super.deserialize(t,i,s);return o.#i=t.fontSize,o.color=dt.makeHexColor(...t.color),o.#t=_e.#h(t.value),o._initialData=a,t.comment&&o.setCommentData(t),o}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i=vt._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),s=Object.assign(super.serialize(t),{color:i,fontSize:this.#i,value:this.#d()});return this.addComment(s),t?(s.isCopy=!0,s):this.annotationElementId&&!this.#f(s)?null:(s.id=this.annotationElementId,s)}#f(t){const{value:i,fontSize:s,color:a,pageIndex:o}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||t.value!==i||t.fontSize!==s||t.color.some((l,u)=>l!==a[u])||t.pageIndex!==o}renderAnnotationElement(t){const i=super.renderAnnotationElement(t);if(!i)return null;const{style:s}=i;s.fontSize=`calc(${this.#i}px * var(--total-scale-factor))`,s.color=this.color,i.replaceChildren();for(const a of this.#t.split(`
`)){const o=document.createElement("div");o.append(a?document.createTextNode(a):document.createElement("br")),i.append(o)}return t.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:this.#t}}),i}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}}class ct{static PRECISION=1e-4;toSVGPath(){Jt("Abstract method `toSVGPath` must be implemented.")}get box(){Jt("Abstract getter `box` must be implemented.")}serialize(t,i){Jt("Abstract method `serialize` must be implemented.")}static _rescale(t,i,s,a,o,l){l||=new Float32Array(t.length);for(let u=0,h=t.length;u<h;u+=2)l[u]=i+t[u]*a,l[u+1]=s+t[u+1]*o;return l}static _rescaleAndSwap(t,i,s,a,o,l){l||=new Float32Array(t.length);for(let u=0,h=t.length;u<h;u+=2)l[u]=i+t[u+1]*a,l[u+1]=s+t[u]*o;return l}static _translate(t,i,s,a){a||=new Float32Array(t.length);for(let o=0,l=t.length;o<l;o+=2)a[o]=i+t[o],a[o+1]=s+t[o+1];return a}static svgRound(t){return Math.round(t*1e4)}static _normalizePoint(t,i,s,a,o){switch(o){case 90:return[1-i/s,t/a];case 180:return[1-t/s,1-i/a];case 270:return[i/s,1-t/a];default:return[t/s,i/a]}}static _normalizePagePoint(t,i,s){switch(s){case 90:return[1-i,t];case 180:return[1-t,1-i];case 270:return[i,1-t];default:return[t,i]}}static createBezierPoints(t,i,s,a,o,l){return[(t+5*s)/6,(i+5*a)/6,(5*s+o)/6,(5*a+l)/6,(s+o)/2,(a+l)/2]}}class ls{#t;#e=[];#n;#i;#r=[];#s=new Float32Array(18);#a;#o;#c;#l;#d;#h;#f=[];static#m=8;static#g=2;static#u=ls.#m+ls.#g;constructor({x:t,y:i},s,a,o,l,u=0){this.#t=s,this.#h=o*a,this.#i=l,this.#s.set([NaN,NaN,NaN,NaN,t,i],6),this.#n=u,this.#l=ls.#m*a,this.#c=ls.#u*a,this.#d=a,this.#f.push(t,i)}isEmpty(){return isNaN(this.#s[8])}#p(){const t=this.#s.subarray(4,6),i=this.#s.subarray(16,18),[s,a,o,l]=this.#t;return[(this.#a+(t[0]-i[0])/2-s)/o,(this.#o+(t[1]-i[1])/2-a)/l,(this.#a+(i[0]-t[0])/2-s)/o,(this.#o+(i[1]-t[1])/2-a)/l]}add({x:t,y:i}){this.#a=t,this.#o=i;const[s,a,o,l]=this.#t;let[u,h,d,p]=this.#s.subarray(8,12);const b=t-d,v=i-p,A=Math.hypot(b,v);if(A<this.#c)return!1;const w=A-this.#l,S=w/A,C=S*b,E=S*v;let k=u,O=h;u=d,h=p,d+=C,p+=E,this.#f?.push(t,i);const P=-E/w,z=C/w,L=P*this.#h,j=z*this.#h;return this.#s.set(this.#s.subarray(2,8),0),this.#s.set([d+L,p+j],4),this.#s.set(this.#s.subarray(14,18),12),this.#s.set([d-L,p-j],16),isNaN(this.#s[6])?(this.#r.length===0&&(this.#s.set([u+L,h+j],2),this.#r.push(NaN,NaN,NaN,NaN,(u+L-s)/o,(h+j-a)/l),this.#s.set([u-L,h-j],14),this.#e.push(NaN,NaN,NaN,NaN,(u-L-s)/o,(h-j-a)/l)),this.#s.set([k,O,u,h,d,p],6),!this.isEmpty()):(this.#s.set([k,O,u,h,d,p],6),Math.abs(Math.atan2(O-h,k-u)-Math.atan2(E,C))<Math.PI/2?([u,h,d,p]=this.#s.subarray(2,6),this.#r.push(NaN,NaN,NaN,NaN,((u+d)/2-s)/o,((h+p)/2-a)/l),[u,h,k,O]=this.#s.subarray(14,18),this.#e.push(NaN,NaN,NaN,NaN,((k+u)/2-s)/o,((O+h)/2-a)/l),!0):([k,O,u,h,d,p]=this.#s.subarray(0,6),this.#r.push(((k+5*u)/6-s)/o,((O+5*h)/6-a)/l,((5*u+d)/6-s)/o,((5*h+p)/6-a)/l,((u+d)/2-s)/o,((h+p)/2-a)/l),[d,p,u,h,k,O]=this.#s.subarray(12,18),this.#e.push(((k+5*u)/6-s)/o,((O+5*h)/6-a)/l,((5*u+d)/6-s)/o,((5*h+p)/6-a)/l,((u+d)/2-s)/o,((h+p)/2-a)/l),!0))}toSVGPath(){if(this.isEmpty())return"";const t=this.#r,i=this.#e;if(isNaN(this.#s[6])&&!this.isEmpty())return this.#b();const s=[];s.push(`M${t[4]} ${t[5]}`);for(let a=6;a<t.length;a+=6)isNaN(t[a])?s.push(`L${t[a+4]} ${t[a+5]}`):s.push(`C${t[a]} ${t[a+1]} ${t[a+2]} ${t[a+3]} ${t[a+4]} ${t[a+5]}`);this.#y(s);for(let a=i.length-6;a>=6;a-=6)isNaN(i[a])?s.push(`L${i[a+4]} ${i[a+5]}`):s.push(`C${i[a]} ${i[a+1]} ${i[a+2]} ${i[a+3]} ${i[a+4]} ${i[a+5]}`);return this.#v(s),s.join(" ")}#b(){const[t,i,s,a]=this.#t,[o,l,u,h]=this.#p();return`M${(this.#s[2]-t)/s} ${(this.#s[3]-i)/a} L${(this.#s[4]-t)/s} ${(this.#s[5]-i)/a} L${o} ${l} L${u} ${h} L${(this.#s[16]-t)/s} ${(this.#s[17]-i)/a} L${(this.#s[14]-t)/s} ${(this.#s[15]-i)/a} Z`}#v(t){const i=this.#e;t.push(`L${i[4]} ${i[5]} Z`)}#y(t){const[i,s,a,o]=this.#t,l=this.#s.subarray(4,6),u=this.#s.subarray(16,18),[h,d,p,b]=this.#p();t.push(`L${(l[0]-i)/a} ${(l[1]-s)/o} L${h} ${d} L${p} ${b} L${(u[0]-i)/a} ${(u[1]-s)/o}`)}newFreeDrawOutline(t,i,s,a,o,l){return new Im(t,i,s,a,o,l)}getOutlines(){const t=this.#r,i=this.#e,s=this.#s,[a,o,l,u]=this.#t,h=new Float32Array((this.#f?.length??0)+2);for(let b=0,v=h.length-2;b<v;b+=2)h[b]=(this.#f[b]-a)/l,h[b+1]=(this.#f[b+1]-o)/u;if(h[h.length-2]=(this.#a-a)/l,h[h.length-1]=(this.#o-o)/u,isNaN(s[6])&&!this.isEmpty())return this.#E(h);const d=new Float32Array(this.#r.length+24+this.#e.length);let p=t.length;for(let b=0;b<p;b+=2){if(isNaN(t[b])){d[b]=d[b+1]=NaN;continue}d[b]=t[b],d[b+1]=t[b+1]}p=this.#x(d,p);for(let b=i.length-6;b>=6;b-=6)for(let v=0;v<6;v+=2){if(isNaN(i[b+v])){d[p]=d[p+1]=NaN,p+=2;continue}d[p]=i[b+v],d[p+1]=i[b+v+1],p+=2}return this.#w(d,p),this.newFreeDrawOutline(d,h,this.#t,this.#d,this.#n,this.#i)}#E(t){const i=this.#s,[s,a,o,l]=this.#t,[u,h,d,p]=this.#p(),b=new Float32Array(36);return b.set([NaN,NaN,NaN,NaN,(i[2]-s)/o,(i[3]-a)/l,NaN,NaN,NaN,NaN,(i[4]-s)/o,(i[5]-a)/l,NaN,NaN,NaN,NaN,u,h,NaN,NaN,NaN,NaN,d,p,NaN,NaN,NaN,NaN,(i[16]-s)/o,(i[17]-a)/l,NaN,NaN,NaN,NaN,(i[14]-s)/o,(i[15]-a)/l],0),this.newFreeDrawOutline(b,t,this.#t,this.#d,this.#n,this.#i)}#w(t,i){const s=this.#e;return t.set([NaN,NaN,NaN,NaN,s[4],s[5]],i),i+=6}#x(t,i){const s=this.#s.subarray(4,6),a=this.#s.subarray(16,18),[o,l,u,h]=this.#t,[d,p,b,v]=this.#p();return t.set([NaN,NaN,NaN,NaN,(s[0]-o)/u,(s[1]-l)/h,NaN,NaN,NaN,NaN,d,p,NaN,NaN,NaN,NaN,b,v,NaN,NaN,NaN,NaN,(a[0]-o)/u,(a[1]-l)/h],i),i+=24}}class Im extends ct{#t;#e=new Float32Array(4);#n;#i;#r;#s;#a;constructor(t,i,s,a,o,l){super(),this.#a=t,this.#r=i,this.#t=s,this.#s=a,this.#n=o,this.#i=l,this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],this.#o(l);const[u,h,d,p]=this.#e;for(let b=0,v=t.length;b<v;b+=2)t[b]=(t[b]-u)/d,t[b+1]=(t[b+1]-h)/p;for(let b=0,v=i.length;b<v;b+=2)i[b]=(i[b]-u)/d,i[b+1]=(i[b+1]-h)/p}toSVGPath(){const t=[`M${this.#a[4]} ${this.#a[5]}`];for(let i=6,s=this.#a.length;i<s;i+=6){if(isNaN(this.#a[i])){t.push(`L${this.#a[i+4]} ${this.#a[i+5]}`);continue}t.push(`C${this.#a[i]} ${this.#a[i+1]} ${this.#a[i+2]} ${this.#a[i+3]} ${this.#a[i+4]} ${this.#a[i+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,i,s,a],o){const l=s-t,u=a-i;let h,d;switch(o){case 0:h=ct._rescale(this.#a,t,a,l,-u),d=ct._rescale(this.#r,t,a,l,-u);break;case 90:h=ct._rescaleAndSwap(this.#a,t,i,l,u),d=ct._rescaleAndSwap(this.#r,t,i,l,u);break;case 180:h=ct._rescale(this.#a,s,i,-l,u),d=ct._rescale(this.#r,s,i,-l,u);break;case 270:h=ct._rescaleAndSwap(this.#a,s,a,-l,-u),d=ct._rescaleAndSwap(this.#r,s,a,-l,-u);break}return{outline:Array.from(h),points:[Array.from(d)]}}#o(t){const i=this.#a;let s=i[4],a=i[5];const o=[s,a,s,a];let l=s,u=a,h=s,d=a;const p=t?Math.max:Math.min,b=new Float32Array(4);for(let A=6,w=i.length;A<w;A+=6){const S=i[A+4],C=i[A+5];isNaN(i[A])?(dt.pointBoundingBox(S,C,o),u>C?(l=S,u=C):u===C&&(l=p(l,S)),d<C?(h=S,d=C):d===C&&(h=p(h,S))):(b[0]=b[1]=1/0,b[2]=b[3]=-1/0,dt.bezierBoundingBox(s,a,...i.slice(A,A+6),b),dt.rectBoundingBox(b[0],b[1],b[2],b[3],o),u>b[1]?(l=b[0],u=b[1]):u===b[1]&&(l=p(l,b[0])),d<b[3]?(h=b[2],d=b[3]):d===b[3]&&(h=p(h,b[2]))),s=S,a=C}const v=this.#e;v[0]=o[0]-this.#n,v[1]=o[1]-this.#n,v[2]=o[2]-o[0]+2*this.#n,v[3]=o[3]-o[1]+2*this.#n,this.firstPoint=[l,u],this.lastPoint=[h,d]}get box(){return this.#e}newOutliner(t,i,s,a,o,l=0){return new ls(t,i,s,a,o,l)}getNewOutline(t,i){const[s,a,o,l]=this.#e,[u,h,d,p]=this.#t,b=o*d,v=l*p,A=s*d+u,w=a*p+h,S=this.newOutliner({x:this.#r[0]*b+A,y:this.#r[1]*v+w},this.#t,this.#s,t,this.#i,i??this.#n);for(let C=2;C<this.#r.length;C+=2)S.add({x:this.#r[C]*b+A,y:this.#r[C+1]*v+w});return S.getOutlines()}}class Ju{#t;#e;#n;#i=[];#r=[];constructor(t,i=0,s=0,a=!0){const o=[1/0,1/0,-1/0,-1/0],l=10**-4;for(const{x:S,y:C,width:E,height:k}of t){const O=Math.floor((S-i)/l)*l,P=Math.ceil((S+E+i)/l)*l,z=Math.floor((C-i)/l)*l,L=Math.ceil((C+k+i)/l)*l,j=[O,z,L,!0],D=[P,z,L,!1];this.#i.push(j,D),dt.rectBoundingBox(O,z,P,L,o)}const u=o[2]-o[0]+2*s,h=o[3]-o[1]+2*s,d=o[0]-s,p=o[1]-s;let b=a?-1/0:1/0,v=1/0;const A=this.#i.at(a?-1:-2),w=[A[0],A[2]];for(const S of this.#i){const[C,E,k,O]=S;!O&&a?E<v?(v=E,b=C):E===v&&(b=Math.max(b,C)):O&&!a&&(E<v?(v=E,b=C):E===v&&(b=Math.min(b,C))),S[0]=(C-d)/u,S[1]=(E-p)/h,S[2]=(k-p)/h}this.#t=new Float32Array([d,p,u,h]),this.#e=[b,v],this.#n=w}getOutlines(){this.#i.sort((i,s)=>i[0]-s[0]||i[1]-s[1]||i[2]-s[2]);const t=[];for(const i of this.#i)i[3]?(t.push(...this.#l(i)),this.#o(i)):(this.#c(i),t.push(...this.#l(i)));return this.#s(t)}#s(t){const i=[],s=new Set;for(const l of t){const[u,h,d]=l;i.push([u,h,l],[u,d,l])}i.sort((l,u)=>l[1]-u[1]||l[0]-u[0]);for(let l=0,u=i.length;l<u;l+=2){const h=i[l][2],d=i[l+1][2];h.push(d),d.push(h),s.add(h),s.add(d)}const a=[];let o;for(;s.size>0;){const l=s.values().next().value;let[u,h,d,p,b]=l;s.delete(l);let v=u,A=h;for(o=[u,d],a.push(o);;){let w;if(s.has(p))w=p;else if(s.has(b))w=b;else break;s.delete(w),[u,h,d,p,b]=w,v!==u&&(o.push(v,A,u,A===h?h:d),v=u),A=A===h?d:h}o.push(v,A)}return new Mx(a,this.#t,this.#e,this.#n)}#a(t){const i=this.#r;let s=0,a=i.length-1;for(;s<=a;){const o=s+a>>1,l=i[o][0];if(l===t)return o;l<t?s=o+1:a=o-1}return a+1}#o([,t,i]){const s=this.#a(t);this.#r.splice(s,0,[t,i])}#c([,t,i]){const s=this.#a(t);for(let a=s;a<this.#r.length;a++){const[o,l]=this.#r[a];if(o!==t)break;if(o===t&&l===i){this.#r.splice(a,1);return}}for(let a=s-1;a>=0;a--){const[o,l]=this.#r[a];if(o!==t)break;if(o===t&&l===i){this.#r.splice(a,1);return}}}#l(t){const[i,s,a]=t,o=[[i,s,a]],l=this.#a(a);for(let u=0;u<l;u++){const[h,d]=this.#r[u];for(let p=0,b=o.length;p<b;p++){const[,v,A]=o[p];if(!(d<=v||A<=h)){if(v>=h){if(A>d)o[p][1]=d;else{if(b===1)return[];o.splice(p,1),p--,b--}continue}o[p][2]=h,A>d&&o.push([i,d,A])}}}return o}}class Mx extends ct{#t;#e;constructor(t,i,s,a){super(),this.#e=t,this.#t=i,this.firstPoint=s,this.lastPoint=a}toSVGPath(){const t=[];for(const i of this.#e){let[s,a]=i;t.push(`M${s} ${a}`);for(let o=2;o<i.length;o+=2){const l=i[o],u=i[o+1];l===s?(t.push(`V${u}`),a=u):u===a&&(t.push(`H${l}`),s=l)}t.push("Z")}return t.join(" ")}serialize([t,i,s,a],o){const l=[],u=s-t,h=a-i;for(const d of this.#e){const p=new Array(d.length);for(let b=0;b<d.length;b+=2)p[b]=t+d[b]*u,p[b+1]=a-d[b+1]*h;l.push(p)}return l}get box(){return this.#t}get classNamesForOutlining(){return["highlightOutline"]}}class th extends ls{newFreeDrawOutline(t,i,s,a,o,l){return new Rx(t,i,s,a,o,l)}}class Rx extends Im{newOutliner(t,i,s,a,o,l=0){return new th(t,i,s,a,o,l)}}class ge extends vt{#t=null;#e=0;#n;#i=null;#r=null;#s=null;#a=null;#o=0;#c=null;#l=null;#d=null;#h=!1;#f=null;#m=null;#g=null;#u="";#p;#b="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=Tt.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const t=ge.prototype;return Mt(this,"_keyboardManager",new Er([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}constructor(t){super({...t,name:"highlightEditor"}),this.color=t.color||ge._defaultColor,this.#p=t.thickness||ge._defaultThickness,this.opacity=t.opacity||ge._defaultOpacity,this.#n=t.boxes||null,this.#b=t.methodOfCreation||"",this.#u=t.text||"",this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(this.#h=!0,this.#y(t),this.#S()):this.#n&&(this.#t=t.anchorNode,this.#e=t.anchorOffset,this.#a=t.focusNode,this.#o=t.focusOffset,this.#v(),this.#S(),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}get telemetryInitialData(){return{action:"added",type:this.#h?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:this.#p,methodOfCreation:this.#b}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}#v(){const t=new Ju(this.#n,.001);this.#l=t.getOutlines(),[this.x,this.y,this.width,this.height]=this.#l.box;const i=new Ju(this.#n,.0025,.001,this._uiManager.direction==="ltr");this.#s=i.getOutlines();const{firstPoint:s}=this.#l;this.#f=[(s[0]-this.x)/this.width,(s[1]-this.y)/this.height];const{lastPoint:a}=this.#s;this.#m=[(a[0]-this.x)/this.width,(a[1]-this.y)/this.height]}#y({highlightOutlines:t,highlightId:i,clipPathId:s}){this.#l=t;const a=1.5;if(this.#s=t.getNewOutline(this.#p/2+a,.0025),i>=0)this.#d=i,this.#i=s,this.parent.drawLayer.finalizeDraw(i,{bbox:t.box,path:{d:t.toSVGPath()}}),this.#g=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#s.box,path:{d:this.#s.toSVGPath()}},!0);else if(this.parent){const b=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#d,{bbox:ge.#_(this.#l.box,(b-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#g,{bbox:ge.#_(this.#s.box,b),path:{d:this.#s.toSVGPath()}})}const[o,l,u,h]=t.box;switch(this.rotation){case 0:this.x=o,this.y=l,this.width=u,this.height=h;break;case 90:{const[b,v]=this.parentDimensions;this.x=l,this.y=1-o,this.width=u*v/b,this.height=h*b/v;break}case 180:this.x=1-o,this.y=1-l,this.width=u,this.height=h;break;case 270:{const[b,v]=this.parentDimensions;this.x=1-l,this.y=o,this.width=u*v/b,this.height=h*b/v;break}}const{firstPoint:d}=t;this.#f=[(d[0]-o)/u,(d[1]-l)/h];const{lastPoint:p}=this.#s;this.#m=[(p[0]-o)/u,(p[1]-l)/h]}static initialize(t,i){vt.initialize(t,i),ge._defaultColor||=i.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(t,i){switch(t){case Ft.HIGHLIGHT_COLOR:ge._defaultColor=i;break;case Ft.HIGHLIGHT_THICKNESS:ge._defaultThickness=i;break}}translateInPage(t,i){}get toolbarPosition(){return this.#m}get commentButtonPosition(){return this.#f}updateParams(t,i){switch(t){case Ft.HIGHLIGHT_COLOR:this.#E(i);break;case Ft.HIGHLIGHT_THICKNESS:this.#w(i);break}}static get defaultPropertiesToUpdate(){return[[Ft.HIGHLIGHT_COLOR,ge._defaultColor],[Ft.HIGHLIGHT_THICKNESS,ge._defaultThickness]]}get propertiesToUpdate(){return[[Ft.HIGHLIGHT_COLOR,this.color||ge._defaultColor],[Ft.HIGHLIGHT_THICKNESS,this.#p||ge._defaultThickness],[Ft.HIGHLIGHT_FREE,this.#h]]}onUpdatedColor(){this.parent?.drawLayer.updateProperties(this.#d,{root:{fill:this.color,"fill-opacity":this.opacity}}),this.#r?.updateColor(this.color),super.onUpdatedColor()}#E(t){const i=(o,l)=>{this.color=o,this.opacity=l,this.onUpdatedColor()},s=this.color,a=this.opacity;this.addCommands({cmd:i.bind(this,t,ge._defaultOpacity),undo:i.bind(this,s,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ft.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(t)},!0)}#w(t){const i=this.#p,s=a=>{this.#p=a,this.#x(a)};this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ft.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",this.#r=new Ci({editor:this})]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#N())}getBaseTranslation(){return[0,0]}getRect(t,i){return super.getRect(t,i,this.#N())}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){this.#T(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#S(),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let i=!1;this.parent&&!t?this.#T():t&&(this.#S(t),i=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),this.show(this._isVisible),i&&this.select()}#x(t){this.#h&&(this.#y({highlightOutlines:this.#l.getNewOutline(t/2)}),this.fixAndSetPosition(),this.setDims(this.width,this.height))}#T(){this.#d===null||!this.parent||(this.parent.drawLayer.remove(this.#d),this.#d=null,this.parent.drawLayer.remove(this.#g),this.#g=null)}#S(t=this.parent){this.#d===null&&({id:this.#d,clipPathId:this.#i}=t.drawLayer.draw({bbox:this.#l.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:this.#h},path:{d:this.#l.toSVGPath()}},!1,!0),this.#g=t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#h},bbox:this.#s.box,path:{d:this.#s.toSVGPath()}},this.#h),this.#c&&(this.#c.style.clipPath=this.#i))}static#_([t,i,s,a],o){switch(o){case 90:return[1-i-a,t,a,s];case 180:return[1-t-s,1-i-a,s,a];case 270:return[i,1-t-s,a,s]}return[t,i,s,a]}rotate(t){const{drawLayer:i}=this.parent;let s;this.#h?(t=(t-this.rotation+360)%360,s=ge.#_(this.#l.box,t)):s=ge.#_([this.x,this.y,this.width,this.height],t),i.updateProperties(this.#d,{bbox:s,root:{"data-main-rotation":t}}),i.updateProperties(this.#g,{bbox:ge.#_(this.#s.box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();this.#u&&(t.setAttribute("aria-label",this.#u),t.setAttribute("role","mark")),this.#h?t.classList.add("free"):this.div.addEventListener("keydown",this.#M.bind(this),{signal:this._uiManager._signal});const i=this.#c=document.createElement("div");return t.append(i),i.setAttribute("aria-hidden","true"),i.className="internal",i.style.clipPath=this.#i,this.setDims(this.width,this.height),pm(this,this.#c,["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{hovered:!1}})}#M(t){ge._keyboardManager.exec(this,t)}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:this.#D(!0);break;case 1:case 3:this.#D(!1);break}}#D(t){if(!this.#t)return;const i=window.getSelection();t?i.setPosition(this.#t,this.#e):i.setPosition(this.#a,this.#o)}select(){super.select(),this.#g&&this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#g&&(this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{selected:!1}}),this.#h||this.#D(!1))}get _mustFixPosition(){return!this.#h}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(this.#d,{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(this.#g,{rootClass:{hidden:!t}}))}#N(){return this.#h?this.rotation:0}#P(){if(this.#h)return null;const[t,i]=this.pageDimensions,[s,a]=this.pageTranslation,o=this.#n,l=new Float32Array(o.length*8);let u=0;for(const{x:h,y:d,width:p,height:b}of o){const v=h*t+s,A=(1-d)*i+a;l[u]=l[u+4]=v,l[u+1]=l[u+3]=A,l[u+2]=l[u+6]=v+p*t,l[u+5]=l[u+7]=A-b*i,u+=8}return l}#k(t){return this.#l.serialize(t,this.#N())}static startHighlighting(t,i,{target:s,x:a,y:o}){const{x:l,y:u,width:h,height:d}=s.getBoundingClientRect(),p=new AbortController,b=t.combinedSignal(p),v=A=>{p.abort(),this.#F(t,A)};window.addEventListener("blur",v,{signal:b}),window.addEventListener("pointerup",v,{signal:b}),window.addEventListener("pointerdown",ue,{capture:!0,passive:!1,signal:b}),window.addEventListener("contextmenu",Ti,{signal:b}),s.addEventListener("pointermove",this.#L.bind(this,t),{signal:b}),this._freeHighlight=new th({x:a,y:o},[l,u,h,d],t.scale,this._defaultThickness/2,i,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#L(t,i){this._freeHighlight.add(i)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#F(t,i){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(i,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(t,i,s){let a=null;if(t instanceof Fm){const{data:{quadPoints:w,rect:S,rotation:C,id:E,color:k,opacity:O,popupRef:P,richText:z,contentsObj:L,creationDate:j,modificationDate:D},parent:{page:{pageNumber:N}}}=t;a=t={annotationType:Tt.HIGHLIGHT,color:Array.from(k),opacity:O,quadPoints:w,boxes:null,pageIndex:N-1,rect:S.slice(0),rotation:C,annotationElementId:E,id:E,deleted:!1,popupRef:P,richText:z,comment:L?.str||null,creationDate:j,modificationDate:D}}else if(t instanceof mh){const{data:{inkLists:w,rect:S,rotation:C,id:E,color:k,borderStyle:{rawWidth:O},popupRef:P,richText:z,contentsObj:L,creationDate:j,modificationDate:D},parent:{page:{pageNumber:N}}}=t;a=t={annotationType:Tt.HIGHLIGHT,color:Array.from(k),thickness:O,inkLists:w,boxes:null,pageIndex:N-1,rect:S.slice(0),rotation:C,annotationElementId:E,id:E,deleted:!1,popupRef:P,richText:z,comment:L?.str||null,creationDate:j,modificationDate:D}}const{color:o,quadPoints:l,inkLists:u,opacity:h}=t,d=await super.deserialize(t,i,s);d.color=dt.makeHexColor(...o),d.opacity=h||1,u&&(d.#p=t.thickness),d._initialData=a,t.comment&&d.setCommentData(t);const[p,b]=d.pageDimensions,[v,A]=d.pageTranslation;if(l){const w=d.#n=[];for(let S=0;S<l.length;S+=8)w.push({x:(l[S]-v)/p,y:1-(l[S+1]-A)/b,width:(l[S+2]-l[S])/p,height:(l[S+1]-l[S+5])/b});d.#v(),d.#S(),d.rotate(d.rotation)}else if(u){d.#h=!0;const w=u[0],S={x:w[0]-v,y:b-(w[1]-A)},C=new th(S,[0,0,p,b],1,d.#p/2,!0,.001);for(let O=0,P=w.length;O<P;O+=2)S.x=w[O]-v,S.y=b-(w[O+1]-A),C.add(S);const{id:E,clipPathId:k}=i.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:d.color,"fill-opacity":d._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:C.toSVGPath()}},!0,!0);d.#y({highlightOutlines:C.getOutlines(),highlightId:E,clipPathId:k}),d.#S(),d.rotate(d.parentRotation)}return d}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const i=vt._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),s=super.serialize(t);return Object.assign(s,{color:i,opacity:this.opacity,thickness:this.#p,quadPoints:this.#P(),outlines:this.#k(s.rect)}),this.addComment(s),this.annotationElementId&&!this.#j(s)?null:(s.id=this.annotationElementId,s)}#j(t){const{color:i}=this._initialData;return this.hasEditedComment||t.color.some((s,a)=>s!==i[a])}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}}class Um{#t=Object.create(null);updateProperty(t,i){this[t]=i,this.updateSVGProperty(t,i)}updateProperties(t){if(t)for(const[i,s]of Object.entries(t))i.startsWith("_")||this.updateProperty(i,s)}updateSVGProperty(t,i){this.#t[t]=i}toSVGProperties(){const t=this.#t;return this.#t=Object.create(null),{root:t}}reset(){this.#t=Object.create(null)}updateAll(t=this){this.updateProperties(t)}clone(){Jt("Not implemented")}}class At extends vt{#t=null;#e;_colorPicker=null;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#n=null;static#i=null;static#r=null;static#s=NaN;static#a=null;static#o=null;static#c=NaN;static _INNER_MARGIN=3;constructor(t){super(t),this.#e=t.mustBeCommitted||!1,this._addOutlines(t)}onUpdatedColor(){this._colorPicker?.update(this.color),super.onUpdatedColor()}_addOutlines(t){t.drawOutlines&&(this.#l(t),this.#f())}#l({drawOutlines:t,drawId:i,drawingOptions:s}){this.#t=t,this._drawingOptions||=s,this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),i>=0?(this._drawId=i,this.parent.drawLayer.finalizeDraw(i,t.defaultProperties)):this._drawId=this.#d(t,this.parent),this.#u(t.box)}#d(t,i){const{id:s}=i.drawLayer.draw(At._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return s}static _mergeSVGProperties(t,i){const s=new Set(Object.keys(t));for(const[a,o]of Object.entries(i))s.has(a)?Object.assign(t[a],o):t[a]=o;return t}static getDefaultDrawingOptions(t){Jt("Not implemented")}static get typesMap(){Jt("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,i){const s=this.typesMap.get(t);s&&this._defaultDrawingOptions.updateProperty(s,i),this._currentParent&&(At.#n.updateProperty(s,i),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,i){const s=this.constructor.typesMap.get(t);s&&this._updateProperty(t,s,i)}static get defaultPropertiesToUpdate(){const t=[],i=this._defaultDrawingOptions;for(const[s,a]of this.typesMap)t.push([s,i[a]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:i}=this;for(const[s,a]of this.constructor.typesMap)t.push([s,i[a]]);return t}_updateProperty(t,i,s){const a=this._drawingOptions,o=a[i],l=u=>{a.updateProperty(i,u);const h=this.#t.updateProperty(i,u);h&&this.#u(h),this.parent?.drawLayer.updateProperties(this._drawId,a.toSVGProperties()),t===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:l.bind(this,s),undo:l.bind(this,o),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,At._mergeSVGProperties(this.#t.getPathResizingSVGProperties(this.#g()),{bbox:this.#p()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,At._mergeSVGProperties(this.#t.getPathResizedSVGProperties(this.#g()),{bbox:this.#p()}))}_onTranslating(t,i){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#p()})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,At._mergeSVGProperties(this.#t.getPathTranslatedSVGProperties(this.#g(),this.parentDimensions),{bbox:this.#p()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#e&&(this.#e=!1,this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){this.#h(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#f(),this.#u(this.#t.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let i=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),this.#h()):t&&(this._uiManager.addShouldRescale(this),this.#f(t),i=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),i&&this.select()}#h(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#f(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#d(this.#t,t)}}#m([t,i,s,a]){const{parentDimensions:[o,l],rotation:u}=this;switch(u){case 90:return[i,1-t,s*(l/o),a*(o/l)];case 180:return[1-t,1-i,s,a];case 270:return[1-i,t,s*(l/o),a*(o/l)];default:return[t,i,s,a]}}#g(){const{x:t,y:i,width:s,height:a,parentDimensions:[o,l],rotation:u}=this;switch(u){case 90:return[1-i,t,s*(o/l),a*(l/o)];case 180:return[1-t,1-i,s,a];case 270:return[i,1-t,s*(o/l),a*(l/o)];default:return[t,i,s,a]}}#u(t){[this.x,this.y,this.width,this.height]=this.#m(t),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()}#p(){const{x:t,y:i,width:s,height:a,rotation:o,parentRotation:l,parentDimensions:[u,h]}=this;switch((o*4+l)/90){case 1:return[1-i-a,t,a,s];case 2:return[1-t-s,1-i-a,s,a];case 3:return[i,1-t-s,a,s];case 4:return[t,i-s*(u/h),a*(h/u),s*(u/h)];case 5:return[1-i,t,s*(u/h),a*(h/u)];case 6:return[1-t-a*(h/u),1-i,a*(h/u),s*(u/h)];case 7:return[i-s*(u/h),1-t-a*(h/u),s*(u/h),a*(h/u)];case 8:return[t-s,i-a,s,a];case 9:return[1-i,t-s,a,s];case 10:return[1-t,1-i,s,a];case 11:return[i-a,1-t,a,s];case 12:return[t-a*(h/u),i,a*(h/u),s*(u/h)];case 13:return[1-i-s*(u/h),t-a*(h/u),s*(u/h),a*(h/u)];case 14:return[1-t,1-i-s*(u/h),a*(h/u),s*(u/h)];case 15:return[i,1-t,s*(u/h),a*(h/u)];default:return[t,i,s,a]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,At._mergeSVGProperties({bbox:this.#p()},this.#t.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#u(this.#t.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,i;this._isCopy&&(t=this.x,i=this.y);const s=super.render();s.classList.add("draw");const a=document.createElement("div");return s.append(a),a.setAttribute("aria-hidden","true"),a.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,i),s}static createDrawerInstance(t,i,s,a,o){Jt("Not implemented")}static startDrawing(t,i,s,a){const{target:o,offsetX:l,offsetY:u,pointerId:h,pointerType:d}=a;if(At.#a&&At.#a!==d)return;const{viewport:{rotation:p}}=t,{width:b,height:v}=o.getBoundingClientRect(),A=At.#i=new AbortController,w=t.combinedSignal(A);if(At.#s||=h,At.#a??=d,window.addEventListener("pointerup",S=>{At.#s===S.pointerId?this._endDraw(S):At.#o?.delete(S.pointerId)},{signal:w}),window.addEventListener("pointercancel",S=>{At.#s===S.pointerId?this._currentParent.endDrawingSession():At.#o?.delete(S.pointerId)},{signal:w}),window.addEventListener("pointerdown",S=>{At.#a===S.pointerType&&((At.#o||=new Set).add(S.pointerId),At.#n.isCancellable()&&(At.#n.removeLastElement(),At.#n.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:w}),window.addEventListener("contextmenu",Ti,{signal:w}),o.addEventListener("pointermove",this._drawMove.bind(this),{signal:w}),o.addEventListener("touchmove",S=>{S.timeStamp===At.#c&&ue(S)},{signal:w}),t.toggleDrawing(),i._editorUndoBar?.hide(),At.#n){t.drawLayer.updateProperties(this._currentDrawId,At.#n.startNew(l,u,b,v,p));return}i.updateUIForDefaultProperties(this),At.#n=this.createDrawerInstance(l,u,b,v,p),At.#r=this.getDefaultDrawingOptions(),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(At.#r.toSVGProperties(),At.#n.defaultSVGProperties),!0,!1)}static _drawMove(t){if(At.#c=-1,!At.#n)return;const{offsetX:i,offsetY:s,pointerId:a}=t;if(At.#s===a){if(At.#o?.size>=1){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,At.#n.add(i,s)),At.#c=t.timeStamp,ue(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,At.#n=null,At.#r=null,At.#a=null,At.#c=NaN),At.#i&&(At.#i.abort(),At.#i=null,At.#s=NaN,At.#o=null)}static _endDraw(t){const i=this._currentParent;if(i){if(i.toggleDrawing(!0),this._cleanup(!1),t?.target===i.div&&i.drawLayer.updateProperties(this._currentDrawId,At.#n.end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const s=At.#n,a=this._currentDrawId,o=s.getLastElement();i.addCommands({cmd:()=>{i.drawLayer.updateProperties(a,s.setLastElement(o))},undo:()=>{i.drawLayer.updateProperties(a,s.removeLastElement())},mustExec:!1,type:Ft.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const i=this._currentParent;if(!i)return null;if(i.toggleDrawing(!0),i.cleanUndoStack(Ft.DRAW_STEP),!At.#n.isEmpty()){const{pageDimensions:[s,a],scale:o}=i,l=i.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:At.#n.getOutlines(s*o,a*o,o,this._INNER_MARGIN),drawingOptions:At.#r,mustBeCommitted:!t});return this._cleanup(!0),l}return i.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,i,s,a,o,l){Jt("Not implemented")}static async deserialize(t,i,s){const{rawDims:{pageWidth:a,pageHeight:o,pageX:l,pageY:u}}=i.viewport,h=this.deserializeDraw(l,u,a,o,this._INNER_MARGIN,t),d=await super.deserialize(t,i,s);return d.createDrawingOptions(t),d.#l({drawOutlines:h}),d.#f(),d.onScaleChanging(),d.rotate(),d}serializeDraw(t){const[i,s]=this.pageTranslation,[a,o]=this.pageDimensions;return this.#t.serialize([i,s,a,o],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}}class kx{#t=new Float64Array(6);#e;#n;#i;#r;#s;#a="";#o=0;#c=new Tr;#l;#d;constructor(t,i,s,a,o,l){this.#l=s,this.#d=a,this.#i=o,this.#r=l,[t,i]=this.#h(t,i);const u=this.#e=[NaN,NaN,NaN,NaN,t,i];this.#s=[t,i],this.#n=[{line:u,points:this.#s}],this.#t.set(u,0)}updateProperty(t,i){t==="stroke-width"&&(this.#r=i)}#h(t,i){return ct._normalizePoint(t,i,this.#l,this.#d,this.#i)}isEmpty(){return!this.#n||this.#n.length===0}isCancellable(){return this.#s.length<=10}add(t,i){[t,i]=this.#h(t,i);const[s,a,o,l]=this.#t.subarray(2,6),u=t-o,h=i-l;return Math.hypot(this.#l*u,this.#d*h)<=2?null:(this.#s.push(t,i),isNaN(s)?(this.#t.set([o,l,t,i],2),this.#e.push(NaN,NaN,NaN,NaN,t,i),{path:{d:this.toSVGPath()}}):(isNaN(this.#t[0])&&this.#e.splice(6,6),this.#t.set([s,a,o,l,t,i],0),this.#e.push(...ct.createBezierPoints(s,a,o,l,t,i)),{path:{d:this.toSVGPath()}}))}end(t,i){const s=this.add(t,i);return s||(this.#s.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(t,i,s,a,o){this.#l=s,this.#d=a,this.#i=o,[t,i]=this.#h(t,i);const l=this.#e=[NaN,NaN,NaN,NaN,t,i];this.#s=[t,i];const u=this.#n.at(-1);return u&&(u.line=new Float32Array(u.line),u.points=new Float32Array(u.points)),this.#n.push({line:l,points:this.#s}),this.#t.set(l,0),this.#o=0,this.toSVGPath(),null}getLastElement(){return this.#n.at(-1)}setLastElement(t){return this.#n?(this.#n.push(t),this.#e=t.line,this.#s=t.points,this.#o=0,{path:{d:this.toSVGPath()}}):this.#c.setLastElement(t)}removeLastElement(){if(!this.#n)return this.#c.removeLastElement();this.#n.pop(),this.#a="";for(let t=0,i=this.#n.length;t<i;t++){const{line:s,points:a}=this.#n[t];this.#e=s,this.#s=a,this.#o=0,this.toSVGPath()}return{path:{d:this.#a}}}toSVGPath(){const t=ct.svgRound(this.#e[4]),i=ct.svgRound(this.#e[5]);if(this.#s.length===2)return this.#a=`${this.#a} M ${t} ${i} Z`,this.#a;if(this.#s.length<=6){const a=this.#a.lastIndexOf("M");this.#a=`${this.#a.slice(0,a)} M ${t} ${i}`,this.#o=6}if(this.#s.length===4){const a=ct.svgRound(this.#e[10]),o=ct.svgRound(this.#e[11]);return this.#a=`${this.#a} L ${a} ${o}`,this.#o=12,this.#a}const s=[];this.#o===0&&(s.push(`M ${t} ${i}`),this.#o=6);for(let a=this.#o,o=this.#e.length;a<o;a+=6){const[l,u,h,d,p,b]=this.#e.slice(a,a+6).map(ct.svgRound);s.push(`C${l} ${u} ${h} ${d} ${p} ${b}`)}return this.#a+=s.join(" "),this.#o=this.#e.length,this.#a}getOutlines(t,i,s,a){const o=this.#n.at(-1);return o.line=new Float32Array(o.line),o.points=new Float32Array(o.points),this.#c.build(this.#n,t,i,s,this.#i,this.#r,a),this.#t=null,this.#e=null,this.#n=null,this.#a=null,this.#c}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class Tr extends ct{#t;#e=0;#n;#i;#r;#s;#a;#o;#c;build(t,i,s,a,o,l,u){this.#r=i,this.#s=s,this.#a=a,this.#o=o,this.#c=l,this.#n=u??0,this.#i=t,this.#h()}get thickness(){return this.#c}setLastElement(t){return this.#i.push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#i.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:i}of this.#i){if(t.push(`M${ct.svgRound(i[4])} ${ct.svgRound(i[5])}`),i.length===6){t.push("Z");continue}if(i.length===12&&isNaN(i[6])){t.push(`L${ct.svgRound(i[10])} ${ct.svgRound(i[11])}`);continue}for(let s=6,a=i.length;s<a;s+=6){const[o,l,u,h,d,p]=i.subarray(s,s+6).map(ct.svgRound);t.push(`C${o} ${l} ${u} ${h} ${d} ${p}`)}}return t.join("")}serialize([t,i,s,a],o){const l=[],u=[],[h,d,p,b]=this.#d();let v,A,w,S,C,E,k,O,P;switch(this.#o){case 0:P=ct._rescale,v=t,A=i+a,w=s,S=-a,C=t+h*s,E=i+(1-d-b)*a,k=t+(h+p)*s,O=i+(1-d)*a;break;case 90:P=ct._rescaleAndSwap,v=t,A=i,w=s,S=a,C=t+d*s,E=i+h*a,k=t+(d+b)*s,O=i+(h+p)*a;break;case 180:P=ct._rescale,v=t+s,A=i,w=-s,S=a,C=t+(1-h-p)*s,E=i+d*a,k=t+(1-h)*s,O=i+(d+b)*a;break;case 270:P=ct._rescaleAndSwap,v=t+s,A=i+a,w=-s,S=-a,C=t+(1-d-b)*s,E=i+(1-h-p)*a,k=t+(1-d)*s,O=i+(1-h)*a;break}for(const{line:z,points:L}of this.#i)l.push(P(z,v,A,w,S,o?new Array(z.length):null)),u.push(P(L,v,A,w,S,o?new Array(L.length):null));return{lines:l,points:u,rect:[C,E,k,O]}}static deserialize(t,i,s,a,o,{paths:{lines:l,points:u},rotation:h,thickness:d}){const p=[];let b,v,A,w,S;switch(h){case 0:S=ct._rescale,b=-t/s,v=i/a+1,A=1/s,w=-1/a;break;case 90:S=ct._rescaleAndSwap,b=-i/a,v=-t/s,A=1/a,w=1/s;break;case 180:S=ct._rescale,b=t/s+1,v=-i/a,A=-1/s,w=1/a;break;case 270:S=ct._rescaleAndSwap,b=i/a+1,v=t/s+1,A=-1/a,w=-1/s;break}if(!l){l=[];for(const E of u){const k=E.length;if(k===2){l.push(new Float32Array([NaN,NaN,NaN,NaN,E[0],E[1]]));continue}if(k===4){l.push(new Float32Array([NaN,NaN,NaN,NaN,E[0],E[1],NaN,NaN,NaN,NaN,E[2],E[3]]));continue}const O=new Float32Array(3*(k-2));l.push(O);let[P,z,L,j]=E.subarray(0,4);O.set([NaN,NaN,NaN,NaN,P,z],0);for(let D=4;D<k;D+=2){const N=E[D],U=E[D+1];O.set(ct.createBezierPoints(P,z,L,j,N,U),(D-2)*3),[P,z,L,j]=[L,j,N,U]}}}for(let E=0,k=l.length;E<k;E++)p.push({line:S(l[E].map(O=>O??NaN),b,v,A,w),points:S(u[E].map(O=>O??NaN),b,v,A,w)});const C=new this.prototype.constructor;return C.build(p,s,a,1,h,d,o),C}#l(t=this.#c){const i=this.#n+t/2*this.#a;return this.#o%180===0?[i/this.#r,i/this.#s]:[i/this.#s,i/this.#r]}#d(){const[t,i,s,a]=this.#t,[o,l]=this.#l(0);return[t+o,i+l,s-2*o,a-2*l]}#h(){const t=this.#t=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:a}of this.#i){if(a.length<=12){for(let u=4,h=a.length;u<h;u+=6)dt.pointBoundingBox(a[u],a[u+1],t);continue}let o=a[4],l=a[5];for(let u=6,h=a.length;u<h;u+=6){const[d,p,b,v,A,w]=a.subarray(u,u+6);dt.bezierBoundingBox(o,l,d,p,b,v,A,w,t),o=A,l=w}}const[i,s]=this.#l();t[0]=Ue(t[0]-i,0,1),t[1]=Ue(t[1]-s,0,1),t[2]=Ue(t[2]+i,0,1),t[3]=Ue(t[3]+s,0,1),t[2]-=t[0],t[3]-=t[1]}get box(){return this.#t}updateProperty(t,i){return t==="stroke-width"?this.#f(i):null}#f(t){const[i,s]=this.#l();this.#c=t;const[a,o]=this.#l(),[l,u]=[a-i,o-s],h=this.#t;return h[0]-=l,h[1]-=u,h[2]+=2*l,h[3]+=2*u,h}updateParentDimensions([t,i],s){const[a,o]=this.#l();this.#r=t,this.#s=i,this.#a=s;const[l,u]=this.#l(),h=l-a,d=u-o,p=this.#t;return p[0]-=h,p[1]-=d,p[2]+=2*h,p[3]+=2*d,p}updateRotation(t){return this.#e=t,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#t.map(ct.svgRound).join(" ")}get defaultProperties(){const[t,i]=this.#t;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ct.svgRound(t)} ${ct.svgRound(i)}`}}}get rotationTransform(){const[,,t,i]=this.#t;let s=0,a=0,o=0,l=0,u=0,h=0;switch(this.#e){case 90:a=i/t,o=-t/i,u=t;break;case 180:s=-1,l=-1,u=t,h=i;break;case 270:a=-i/t,o=t/i,h=i;break;default:return""}return`matrix(${s} ${a} ${o} ${l} ${ct.svgRound(u)} ${ct.svgRound(h)})`}getPathResizingSVGProperties([t,i,s,a]){const[o,l]=this.#l(),[u,h,d,p]=this.#t;if(Math.abs(d-o)<=ct.PRECISION||Math.abs(p-l)<=ct.PRECISION){const S=t+s/2-(u+d/2),C=i+a/2-(h+p/2);return{path:{"transform-origin":`${ct.svgRound(t)} ${ct.svgRound(i)}`,transform:`${this.rotationTransform} translate(${S} ${C})`}}}const b=(s-2*o)/(d-2*o),v=(a-2*l)/(p-2*l),A=d/s,w=p/a;return{path:{"transform-origin":`${ct.svgRound(u)} ${ct.svgRound(h)}`,transform:`${this.rotationTransform} scale(${A} ${w}) translate(${ct.svgRound(o)} ${ct.svgRound(l)}) scale(${b} ${v}) translate(${ct.svgRound(-o)} ${ct.svgRound(-l)})`}}}getPathResizedSVGProperties([t,i,s,a]){const[o,l]=this.#l(),u=this.#t,[h,d,p,b]=u;if(u[0]=t,u[1]=i,u[2]=s,u[3]=a,Math.abs(p-o)<=ct.PRECISION||Math.abs(b-l)<=ct.PRECISION){const C=t+s/2-(h+p/2),E=i+a/2-(d+b/2);for(const{line:k,points:O}of this.#i)ct._translate(k,C,E,k),ct._translate(O,C,E,O);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ct.svgRound(t)} ${ct.svgRound(i)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const v=(s-2*o)/(p-2*o),A=(a-2*l)/(b-2*l),w=-v*(h+o)+t+o,S=-A*(d+l)+i+l;if(v!==1||A!==1||w!==0||S!==0)for(const{line:C,points:E}of this.#i)ct._rescale(C,w,S,v,A,C),ct._rescale(E,w,S,v,A,E);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ct.svgRound(t)} ${ct.svgRound(i)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,i],s){const[a,o]=s,l=this.#t,u=t-l[0],h=i-l[1];if(this.#r===a&&this.#s===o)for(const{line:d,points:p}of this.#i)ct._translate(d,u,h,d),ct._translate(p,u,h,p);else{const d=this.#r/a,p=this.#s/o;this.#r=a,this.#s=o;for(const{line:b,points:v}of this.#i)ct._rescale(b,u,h,d,p,b),ct._rescale(v,u,h,d,p,v);l[2]*=d,l[3]*=p}return l[0]=t,l[1]=i,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${ct.svgRound(t)} ${ct.svgRound(i)}`}}}get defaultSVGProperties(){const t=this.#t;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${ct.svgRound(t[0])} ${ct.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}class pl extends Um{constructor(t){super(),this._viewParameters=t,super.updateProperties({fill:"none",stroke:vt._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,i){t==="stroke-width"&&(i??=this["stroke-width"],i*=this._viewParameters.realScale),super.updateSVGProperty(t,i)}clone(){const t=new pl(this._viewParameters);return t.updateAll(this),t}}class yh extends At{static _type="ink";static _editorType=Tt.INK;static _defaultDrawingOptions=null;constructor(t){super({...t,name:"inkEditor"}),this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,i){vt.initialize(t,i),this._defaultDrawingOptions=new pl(i.viewParameters)}static getDefaultDrawingOptions(t){const i=this._defaultDrawingOptions.clone();return i.updateProperties(t),i}static get supportMultipleDrawings(){return!0}static get typesMap(){return Mt(this,"typesMap",new Map([[Ft.INK_THICKNESS,"stroke-width"],[Ft.INK_COLOR,"stroke"],[Ft.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,i,s,a,o){return new kx(t,i,s,a,o,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,i,s,a,o,l){return Tr.deserialize(t,i,s,a,o,l)}static async deserialize(t,i,s){let a=null;if(t instanceof mh){const{data:{inkLists:l,rect:u,rotation:h,id:d,color:p,opacity:b,borderStyle:{rawWidth:v},popupRef:A,richText:w,contentsObj:S,creationDate:C,modificationDate:E},parent:{page:{pageNumber:k}}}=t;a=t={annotationType:Tt.INK,color:Array.from(p),thickness:v,opacity:b,paths:{points:l},boxes:null,pageIndex:k-1,rect:u.slice(0),rotation:h,annotationElementId:d,id:d,deleted:!1,popupRef:A,richText:w,comment:S?.str||null,creationDate:C,modificationDate:E}}const o=await super.deserialize(t,i,s);return o._initialData=a,t.comment&&o.setCommentData(t),o}get toolbarButtons(){return this._colorPicker||=new xr(this),[["colorPicker",this._colorPicker]]}get colorType(){return Ft.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:i,parent:s}=this;i.updateSVGProperty("stroke-width"),s.drawLayer.updateProperties(t,i.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:i,opacity:s}){this._drawingOptions=yh.getDefaultDrawingOptions({stroke:dt.makeHexColor(...t),"stroke-width":i,"stroke-opacity":s})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:i,points:s}=this.serializeDraw(t),{_drawingOptions:{stroke:a,"stroke-opacity":o,"stroke-width":l}}=this,u=Object.assign(super.serialize(t),{color:vt._colorManager.convert(a),opacity:o,thickness:l,paths:{lines:i,points:s}});return this.addComment(u),t?(u.isCopy=!0,u):this.annotationElementId&&!this.#t(u)?null:(u.id=this.annotationElementId,u)}#t(t){const{color:i,thickness:s,opacity:a,pageIndex:o}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||t.color.some((l,u)=>l!==i[u])||t.thickness!==s||t.opacity!==a||t.pageIndex!==o}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const{points:i,rect:s}=this.serializeDraw(!1);return t.updateEdited({rect:s,thickness:this._drawingOptions["stroke-width"],points:i,popup:this.comment}),null}}class eh extends Tr{toSVGPath(){let t=super.toSVGPath();return t.endsWith("Z")||(t+="Z"),t}}const tl=8,hr=3;class sa{static#t={maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16};static#e(t,i,s,a){return s-=t,a-=i,s===0?a>0?0:4:s===1?a+6:2-a}static#n=new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]);static#i(t,i,s,a,o,l,u){const h=this.#e(s,a,o,l);for(let d=0;d<8;d++){const p=(-d+h-u+16)%8,b=this.#n[2*p],v=this.#n[2*p+1];if(t[(s+b)*i+(a+v)]!==0)return p}return-1}static#r(t,i,s,a,o,l,u){const h=this.#e(s,a,o,l);for(let d=0;d<8;d++){const p=(d+h+u+16)%8,b=this.#n[2*p],v=this.#n[2*p+1];if(t[(s+b)*i+(a+v)]!==0)return p}return-1}static#s(t,i,s,a){const o=t.length,l=new Int32Array(o);for(let p=0;p<o;p++)l[p]=t[p]<=a?1:0;for(let p=1;p<s-1;p++)l[p*i]=l[p*i+i-1]=0;for(let p=0;p<i;p++)l[p]=l[i*s-1-p]=0;let u=1,h;const d=[];for(let p=1;p<s-1;p++){h=1;for(let b=1;b<i-1;b++){const v=p*i+b,A=l[v];if(A===0)continue;let w=p,S=b;if(A===1&&l[v-1]===0)u+=1,S-=1;else if(A>=1&&l[v+1]===0)u+=1,S+=1,A>1&&(h=A);else{A!==1&&(h=Math.abs(A));continue}const C=[b,p],E=S===b+1,k={isHole:E,points:C,id:u,parent:0};d.push(k);let O;for(const $ of d)if($.id===h){O=$;break}O?O.isHole?k.parent=E?O.parent:h:k.parent=E?h:O.parent:k.parent=E?h:0;const P=this.#i(l,i,p,b,w,S,0);if(P===-1){l[v]=-u,l[v]!==1&&(h=Math.abs(l[v]));continue}let z=this.#n[2*P],L=this.#n[2*P+1];const j=p+z,D=b+L;w=j,S=D;let N=p,U=b;for(;;){const $=this.#r(l,i,N,U,w,S,1);z=this.#n[2*$],L=this.#n[2*$+1];const tt=N+z,at=U+L;C.push(at,tt);const gt=N*i+U;if(l[gt+1]===0?l[gt]=-u:l[gt]===1&&(l[gt]=u),tt===p&&at===b&&N===j&&U===D){l[v]!==1&&(h=Math.abs(l[v]));break}else w=N,S=U,N=tt,U=at}}}return d}static#a(t,i,s,a){if(s-i<=4){for(let j=i;j<s-2;j+=2)a.push(t[j],t[j+1]);return}const o=t[i],l=t[i+1],u=t[s-4]-o,h=t[s-3]-l,d=Math.hypot(u,h),p=u/d,b=h/d,v=p*l-b*o,A=h/u,w=1/d,S=Math.atan(A),C=Math.cos(S),E=Math.sin(S),k=w*(Math.abs(C)+Math.abs(E)),O=w*(1-k+k**2),P=Math.max(Math.atan(Math.abs(E+C)*O),Math.atan(Math.abs(E-C)*O));let z=0,L=i;for(let j=i+2;j<s-2;j+=2){const D=Math.abs(v-p*t[j+1]+b*t[j]);D>z&&(L=j,z=D)}z>(d*P)**2?(this.#a(t,i,L+2,a),this.#a(t,L,s,a)):a.push(o,l)}static#o(t){const i=[],s=t.length;return this.#a(t,0,s,i),i.push(t[s-2],t[s-1]),i.length<=4?null:i}static#c(t,i,s,a,o,l){const u=new Float32Array(l**2),h=-2*a**2,d=l>>1;for(let S=0;S<l;S++){const C=(S-d)**2;for(let E=0;E<l;E++)u[S*l+E]=Math.exp((C+(E-d)**2)/h)}const p=new Float32Array(256),b=-2*o**2;for(let S=0;S<256;S++)p[S]=Math.exp(S**2/b);const v=t.length,A=new Uint8Array(v),w=new Uint32Array(256);for(let S=0;S<s;S++)for(let C=0;C<i;C++){const E=S*i+C,k=t[E];let O=0,P=0;for(let L=0;L<l;L++){const j=S+L-d;if(!(j<0||j>=s))for(let D=0;D<l;D++){const N=C+D-d;if(N<0||N>=i)continue;const U=t[j*i+N],$=u[L*l+D]*p[Math.abs(U-k)];O+=U*$,P+=$}}const z=A[E]=Math.round(O/P);w[z]++}return[A,w]}static#l(t){const i=new Uint32Array(256);for(const s of t)i[s]++;return i}static#d(t){const i=t.length,s=new Uint8ClampedArray(i>>2);let a=-1/0,o=1/0;for(let u=0,h=s.length;u<h;u++){const d=s[u]=t[u<<2];a=Math.max(a,d),o=Math.min(o,d)}const l=255/(a-o);for(let u=0,h=s.length;u<h;u++)s[u]=(s[u]-o)*l;return s}static#h(t){let i,s=-1/0,a=-1/0;const o=t.findIndex(h=>h!==0);let l=o,u=o;for(i=o;i<256;i++){const h=t[i];h>s&&(i-l>a&&(a=i-l,u=i-1),s=h,l=i)}for(i=u-1;i>=0&&!(t[i]>t[i+1]);i--);return i}static#f(t){const i=t,{width:s,height:a}=t,{maxDim:o}=this.#t;let l=s,u=a;if(s>o||a>o){let v=s,A=a,w=Math.log2(Math.max(s,a)/o);const S=Math.floor(w);w=w===S?S-1:S;for(let E=0;E<w;E++){l=Math.ceil(v/2),u=Math.ceil(A/2);const k=new OffscreenCanvas(l,u);k.getContext("2d").drawImage(t,0,0,v,A,0,0,l,u),v=l,A=u,t!==i&&t.close(),t=k.transferToImageBitmap()}const C=Math.min(o/l,o/u);l=Math.round(l*C),u=Math.round(u*C)}const d=new OffscreenCanvas(l,u).getContext("2d",{willReadFrequently:!0});d.fillStyle="white",d.fillRect(0,0,l,u),d.filter="grayscale(1)",d.drawImage(t,0,0,t.width,t.height,0,0,l,u);const p=d.getImageData(0,0,l,u).data;return[this.#d(p),l,u]}static extractContoursFromText(t,{fontFamily:i,fontStyle:s,fontWeight:a},o,l,u,h){let d=new OffscreenCanvas(1,1),p=d.getContext("2d",{alpha:!1});const b=200,v=p.font=`${s} ${a} ${b}px ${i}`,{actualBoundingBoxLeft:A,actualBoundingBoxRight:w,actualBoundingBoxAscent:S,actualBoundingBoxDescent:C,fontBoundingBoxAscent:E,fontBoundingBoxDescent:k,width:O}=p.measureText(t),P=1.5,z=Math.ceil(Math.max(Math.abs(A)+Math.abs(w)||0,O)*P),L=Math.ceil(Math.max(Math.abs(S)+Math.abs(C)||b,Math.abs(E)+Math.abs(k)||b)*P);d=new OffscreenCanvas(z,L),p=d.getContext("2d",{alpha:!0,willReadFrequently:!0}),p.font=v,p.filter="grayscale(1)",p.fillStyle="white",p.fillRect(0,0,z,L),p.fillStyle="black",p.fillText(t,z*(P-1)/2,L*(3-P)/2);const j=this.#d(p.getImageData(0,0,z,L).data),D=this.#l(j),N=this.#h(D),U=this.#s(j,z,L,N);return this.processDrawnLines({lines:{curves:U,width:z,height:L},pageWidth:o,pageHeight:l,rotation:u,innerMargin:h,mustSmooth:!0,areContours:!0})}static process(t,i,s,a,o){const[l,u,h]=this.#f(t),[d,p]=this.#c(l,u,h,Math.hypot(u,h)*this.#t.sigmaSFactor,this.#t.sigmaR,this.#t.kernelSize),b=this.#h(p),v=this.#s(d,u,h,b);return this.processDrawnLines({lines:{curves:v,width:u,height:h},pageWidth:i,pageHeight:s,rotation:a,innerMargin:o,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:t,pageWidth:i,pageHeight:s,rotation:a,innerMargin:o,mustSmooth:l,areContours:u}){a%180!==0&&([i,s]=[s,i]);const{curves:h,width:d,height:p}=t,b=t.thickness??0,v=[],A=Math.min(i/d,s/p),w=A/i,S=A/s,C=[];for(const{points:k}of h){const O=l?this.#o(k):k;if(!O)continue;C.push(O);const P=O.length,z=new Float32Array(P),L=new Float32Array(3*(P===2?2:P-2));if(v.push({line:L,points:z}),P===2){z[0]=O[0]*w,z[1]=O[1]*S,L.set([NaN,NaN,NaN,NaN,z[0],z[1]],0);continue}let[j,D,N,U]=O;j*=w,D*=S,N*=w,U*=S,z.set([j,D,N,U],0),L.set([NaN,NaN,NaN,NaN,j,D],0);for(let $=4;$<P;$+=2){const tt=z[$]=O[$]*w,at=z[$+1]=O[$+1]*S;L.set(ct.createBezierPoints(j,D,N,U,tt,at),($-2)*3),[j,D,N,U]=[N,U,tt,at]}}if(v.length===0)return null;const E=u?new eh:new Tr;return E.build(v,i,s,1,a,u?0:b,o),{outline:E,newCurves:C,areContours:u,thickness:b,width:d,height:p}}static async compressSignature({outlines:t,areContours:i,thickness:s,width:a,height:o}){let l=1/0,u=-1/0,h=0;for(const O of t){h+=O.length;for(let P=2,z=O.length;P<z;P++){const L=O[P]-O[P-2];l=Math.min(l,L),u=Math.max(u,L)}}let d;l>=-128&&u<=127?d=Int8Array:l>=-32768&&u<=32767?d=Int16Array:d=Int32Array;const p=t.length,b=tl+hr*p,v=new Uint32Array(b);let A=0;v[A++]=b*Uint32Array.BYTES_PER_ELEMENT+(h-2*p)*d.BYTES_PER_ELEMENT,v[A++]=0,v[A++]=a,v[A++]=o,v[A++]=i?0:1,v[A++]=Math.max(0,Math.floor(s??0)),v[A++]=p,v[A++]=d.BYTES_PER_ELEMENT;for(const O of t)v[A++]=O.length-2,v[A++]=O[0],v[A++]=O[1];const w=new CompressionStream("deflate-raw"),S=w.writable.getWriter();await S.ready,S.write(v);const C=d.prototype.constructor;for(const O of t){const P=new C(O.length-2);for(let z=2,L=O.length;z<L;z++)P[z-2]=O[z]-O[z-2];S.write(P)}S.close();const E=await new Response(w.readable).arrayBuffer(),k=new Uint8Array(E);return dm(k)}static async decompressSignature(t){try{const i=Ky(t),{readable:s,writable:a}=new DecompressionStream("deflate-raw"),o=a.getWriter();await o.ready,o.write(i).then(async()=>{await o.ready,await o.close()}).catch(()=>{});let l=null,u=0;for await(const O of s)l||=new Uint8Array(new Uint32Array(O.buffer,0,4)[0]),l.set(O,u),u+=O.length;const h=new Uint32Array(l.buffer,0,l.length>>2),d=h[1];if(d!==0)throw new Error(`Invalid version: ${d}`);const p=h[2],b=h[3],v=h[4]===0,A=h[5],w=h[6],S=h[7],C=[],E=(tl+hr*w)*Uint32Array.BYTES_PER_ELEMENT;let k;switch(S){case Int8Array.BYTES_PER_ELEMENT:k=new Int8Array(l.buffer,E);break;case Int16Array.BYTES_PER_ELEMENT:k=new Int16Array(l.buffer,E);break;case Int32Array.BYTES_PER_ELEMENT:k=new Int32Array(l.buffer,E);break}u=0;for(let O=0;O<w;O++){const P=h[hr*O+tl],z=new Float32Array(P+2);C.push(z);for(let L=0;L<hr-1;L++)z[L]=h[hr*O+tl+L+1];for(let L=0;L<P;L++)z[L+2]=z[L]+k[u++]}return{areContours:v,thickness:A,outlines:C,width:p,height:b}}catch(i){return Ct(`decompressSignature: ${i}`),null}}}class vh extends Um{constructor(){super(),super.updateProperties({fill:vt._defaultLineColor,"stroke-width":0})}clone(){const t=new vh;return t.updateAll(this),t}}class xh extends pl{constructor(t){super(t),super.updateProperties({stroke:vt._defaultLineColor,"stroke-width":1})}clone(){const t=new xh(this._viewParameters);return t.updateAll(this),t}}class Hi extends At{#t=!1;#e=null;#n=null;#i=null;static _type="signature";static _editorType=Tt.SIGNATURE;static _defaultDrawingOptions=null;constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"}),this._willKeepAspectRatio=!0,this.#n=t.signatureData||null,this.#e=null,this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,i){vt.initialize(t,i),this._defaultDrawingOptions=new vh,this._defaultDrawnSignatureOptions=new xh(i.viewParameters)}static getDefaultDrawingOptions(t){const i=this._defaultDrawingOptions.clone();return i.updateProperties(t),i}static get supportMultipleDrawings(){return!1}static get typesMap(){return Mt(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!this.#e}}static computeTelemetryFinalData(t){const i=t.get("hasDescription");return{hasAltText:i.get(!0)??0,hasNoAltText:i.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,i;const{_isCopy:s}=this;if(s&&(this._isCopy=!1,t=this.x,i=this.y),super.render(),this._drawId===null)if(this.#n){const{lines:a,mustSmooth:o,areContours:l,description:u,uuid:h,heightInPage:d}=this.#n,{rawDims:{pageWidth:p,pageHeight:b},rotation:v}=this.parent.viewport,A=sa.processDrawnLines({lines:a,pageWidth:p,pageHeight:b,rotation:v,innerMargin:Hi._INNER_MARGIN,mustSmooth:o,areContours:l});this.addSignature(A,d,u,h)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:this.#e||""}));return s&&(this._isCopy=!0,this._moveAfterPaste(t,i)),this.div}setUuid(t){this.#i=t,this.addEditToolbar()}getUuid(){return this.#i}get description(){return this.#e}set description(t){this.#e=t,this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:t})),super.addEditToolbar().then(i=>{i?.updateEditSignatureButton(t)}))}getSignaturePreview(){const{newCurves:t,areContours:i,thickness:s,width:a,height:o}=this.#n,l=Math.max(a,o),u=sa.processDrawnLines({lines:{curves:t.map(h=>({points:h})),thickness:s,width:a,height:o},pageWidth:l,pageHeight:l,rotation:0,innerMargin:0,mustSmooth:!1,areContours:i});return{areContours:i,outline:u.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(t,i,s,a){const{x:o,y:l}=this,{outline:u}=this.#n=t;this.#t=u instanceof eh,this.description=s;let h;this.#t?h=Hi.getDefaultDrawingOptions():(h=Hi._defaultDrawnSignatureOptions.clone(),h.updateProperties({"stroke-width":u.thickness})),this._addOutlines({drawOutlines:u,drawingOptions:h});const[,d]=this.pageDimensions;let p=i/d;p=p>=1?.5:p,this.width*=p/this.height,this.width>=1&&(p*=.9/this.width,this.width=.9),this.height=p,this.setDims(),this.x=o,this.y=l,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(a),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!a,hasDescription:!!s}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:i,pageHeight:s},rotation:a}=this.parent.viewport;return sa.process(t,i,s,a,Hi._INNER_MARGIN)}getFromText(t,i){const{rawDims:{pageWidth:s,pageHeight:a},rotation:o}=this.parent.viewport;return sa.extractContoursFromText(t,i,s,a,o,Hi._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:i,pageHeight:s},rotation:a}=this.parent.viewport;return sa.processDrawnLines({lines:t,pageWidth:i,pageHeight:s,rotation:a,innerMargin:Hi._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:i}){t?this._drawingOptions=Hi.getDefaultDrawingOptions():(this._drawingOptions=Hi._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":i}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:i,points:s}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":a}}=this,o=Object.assign(super.serialize(t),{isSignature:!0,areContours:this.#t,color:[0,0,0],thickness:this.#t?0:a});return this.addComment(o),t?(o.paths={lines:i,points:s},o.uuid=this.#i,o.isCopy=!0):o.lines=i,this.#e&&(o.accessibilityData={type:"Figure",alt:this.#e}),o}static deserializeDraw(t,i,s,a,o,l){return l.areContours?eh.deserialize(t,i,s,a,o,l):Tr.deserialize(t,i,s,a,o,l)}static async deserialize(t,i,s){const a=await super.deserialize(t,i,s);return a.#t=t.areContours,a.description=t.accessibilityData?.alt||"",a.#i=t.uuid,a}}class Ox extends vt{#t=null;#e=null;#n=null;#i=null;#r=null;#s="";#a=null;#o=!1;#c=null;#l=!1;#d=!1;static _type="stamp";static _editorType=Tt.STAMP;constructor(t){super({...t,name:"stampEditor"}),this.#i=t.bitmapUrl,this.#r=t.bitmapFile,this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,i){vt.initialize(t,i)}static isHandlingMimeForPasting(t){return Yu.includes(t)}static paste(t,i){i.pasteEditor({mode:Tt.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(t){const i=t.get("hasAltText");return{hasAltText:i.get(!0)??0,hasNoAltText:i.get(!1)??0}}#h(t,i=!1){if(!t){this.remove();return}this.#t=t.bitmap,i||(this.#e=t.id,this.#l=t.isSvg),t.file&&(this.#s=t.file.name),this.#g()}#f(){if(this.#n=null,this._uiManager.enableWaiting(!1),!!this.#a){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(t=null,i=!0){if(this.hasAltTextData())return null;const{mlManager:s}=this._uiManager;if(!s)throw new Error("No ML.");if(!await s.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:a,width:o,height:l}=t||this.copyCanvas(null,null,!0).imageData,u=await s.guess({name:"altText",request:{data:a,width:o,height:l,channels:a.length/(o*l)}});if(!u)throw new Error("No response from the AI service.");if(u.error)throw new Error("Error from the AI service.");if(u.cancel)return null;if(!u.output)throw new Error("No valid response from the AI service.");const h=u.output;return await this.setGuessedAltText(h),i&&!this.hasAltTextData()&&(this.altTextData={alt:h,decorative:!1}),h}#m(){if(this.#e){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#e).then(s=>this.#h(s,!0)).finally(()=>this.#f());return}if(this.#i){const s=this.#i;this.#i=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromUrl(s).then(a=>this.#h(a)).finally(()=>this.#f());return}if(this.#r){const s=this.#r;this.#r=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromFile(s).then(a=>this.#h(a)).finally(()=>this.#f());return}const t=document.createElement("input");t.type="file",t.accept=Yu.join(",");const i=this._uiManager._signal;this.#n=new Promise(s=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const a=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#h(a)}s()},{signal:i}),t.addEventListener("cancel",()=>{this.remove(),s()},{signal:i})}).finally(()=>this.#f()),t.click()}remove(){this.#e&&(this.#t=null,this._uiManager.imageManager.deleteId(this.#e),this.#a?.remove(),this.#a=null,this.#c&&(clearTimeout(this.#c),this.#c=null)),super.remove()}rebuild(){if(!this.parent){this.#e&&this.#m();return}super.rebuild(),this.div!==null&&(this.#e&&this.#a===null&&this.#m(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(this.#n||this.#t||this.#i||this.#r||this.#e||this.#o)}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let t,i;return this._isCopy&&(t=this.x,i=this.y),super.render(),this.div.hidden=!0,this.createAltText(),this.#o||(this.#t?this.#g():this.#m()),this._isCopy&&this._moveAfterPaste(t,i),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,i){const{id:s,bitmap:a}=this._uiManager.imageManager.getFromCanvas(t,i);i.remove(),s&&this._uiManager.imageManager.isValidId(s)&&(this.#e=s,a&&(this.#t=a),this.#o=!1,this.#g())}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;this.#c!==null&&clearTimeout(this.#c);const t=200;this.#c=setTimeout(()=>{this.#c=null,this.#p()},t)}#g(){const{div:t}=this;let{width:i,height:s}=this.#t;const[a,o]=this.pageDimensions,l=.75;if(this.width)i=this.width*a,s=this.height*o;else if(i>l*a||s>l*o){const h=Math.min(l*a/i,l*o/s);i*=h,s*=h}this._uiManager.enableWaiting(!1);const u=this.#a=document.createElement("canvas");u.setAttribute("role","img"),this.addContainer(u),this.width=i/a,this.height=s/o,this.setDims(),this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),this.#p(),this.#d||(this.parent.addUndoableEditor(this),this.#d=!0),this._reportTelemetry({action:"inserted_image"}),this.#s&&this.div.setAttribute("aria-description",this.#s),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")}copyCanvas(t,i,s=!1){t||(t=224);const{width:a,height:o}=this.#t,l=new Gi;let u=this.#t,h=a,d=o,p=null;if(i){if(a>i||o>i){const L=Math.min(i/a,i/o);h=Math.floor(a*L),d=Math.floor(o*L)}p=document.createElement("canvas");const v=p.width=Math.ceil(h*l.sx),A=p.height=Math.ceil(d*l.sy);this.#l||(u=this.#u(v,A));const w=p.getContext("2d");w.filter=this._uiManager.hcmFilter;let S="white",C="#cfcfd8";this._uiManager.hcmFilter!=="none"?C="black":ev.isDarkMode&&(S="#8f8f9d",C="#42414d");const E=15,k=E*l.sx,O=E*l.sy,P=new OffscreenCanvas(k*2,O*2),z=P.getContext("2d");z.fillStyle=S,z.fillRect(0,0,k*2,O*2),z.fillStyle=C,z.fillRect(0,0,k,O),z.fillRect(k,O,k,O),w.fillStyle=w.createPattern(P,"repeat"),w.fillRect(0,0,v,A),w.drawImage(u,0,0,u.width,u.height,0,0,v,A)}let b=null;if(s){let v,A;if(l.symmetric&&u.width<t&&u.height<t)v=u.width,A=u.height;else if(u=this.#t,a>t||o>t){const C=Math.min(t/a,t/o);v=Math.floor(a*C),A=Math.floor(o*C),this.#l||(u=this.#u(v,A))}const S=new OffscreenCanvas(v,A).getContext("2d",{willReadFrequently:!0});S.drawImage(u,0,0,u.width,u.height,0,0,v,A),b={width:v,height:A,data:S.getImageData(0,0,v,A).data}}return{canvas:p,width:h,height:d,imageData:b}}#u(t,i){const{width:s,height:a}=this.#t;let o=s,l=a,u=this.#t;for(;o>2*t||l>2*i;){const h=o,d=l;o>2*t&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2)),l>2*i&&(l=l>=16384?Math.floor(l/2)-1:Math.ceil(l/2));const p=new OffscreenCanvas(o,l);p.getContext("2d").drawImage(u,0,0,h,d,0,0,o,l),u=p.transferToImageBitmap()}return u}#p(){const[t,i]=this.parentDimensions,{width:s,height:a}=this,o=new Gi,l=Math.ceil(s*t*o.sx),u=Math.ceil(a*i*o.sy),h=this.#a;if(!h||h.width===l&&h.height===u)return;h.width=l,h.height=u;const d=this.#l?this.#t:this.#u(l,u),p=h.getContext("2d");p.filter=this._uiManager.hcmFilter,p.drawImage(d,0,0,d.width,d.height,0,0,l,u)}#b(t){if(t){if(this.#l){const a=this._uiManager.imageManager.getSvgUrl(this.#e);if(a)return a}const i=document.createElement("canvas");return{width:i.width,height:i.height}=this.#t,i.getContext("2d").drawImage(this.#t,0,0),i.toDataURL()}if(this.#l){const[i,s]=this.pageDimensions,a=Math.round(this.width*i*da.PDF_TO_CSS_UNITS),o=Math.round(this.height*s*da.PDF_TO_CSS_UNITS),l=new OffscreenCanvas(a,o);return l.getContext("2d").drawImage(this.#t,0,0,this.#t.width,this.#t.height,0,0,a,o),l.transferToImageBitmap()}return structuredClone(this.#t)}static async deserialize(t,i,s){let a=null,o=!1;if(t instanceof zm){const{data:{rect:S,rotation:C,id:E,structParent:k,popupRef:O,richText:P,contentsObj:z,creationDate:L,modificationDate:j},container:D,parent:{page:{pageNumber:N}},canvas:U}=t;let $,tt;U?(delete t.canvas,{id:$,bitmap:tt}=s.imageManager.getFromCanvas(D.id,U),U.remove()):(o=!0,t._hasNoCanvas=!0);const at=(await i._structTree.getAriaAttributes(`${ah}${E}`))?.get("aria-label")||"";a=t={annotationType:Tt.STAMP,bitmapId:$,bitmap:tt,pageIndex:N-1,rect:S.slice(0),rotation:C,annotationElementId:E,id:E,deleted:!1,accessibilityData:{decorative:!1,altText:at},isSvg:!1,structParent:k,popupRef:O,richText:P,comment:z?.str||null,creationDate:L,modificationDate:j}}const l=await super.deserialize(t,i,s),{rect:u,bitmap:h,bitmapUrl:d,bitmapId:p,isSvg:b,accessibilityData:v}=t;o?(s.addMissingCanvas(t.id,l),l.#o=!0):p&&s.imageManager.isValidId(p)?(l.#e=p,h&&(l.#t=h)):l.#i=d,l.#l=b;const[A,w]=l.pageDimensions;return l.width=(u[2]-u[0])/A,l.height=(u[3]-u[1])/w,v&&(l.altTextData=v),l._initialData=a,t.comment&&l.setCommentData(t),l.#d=!!a,l}serialize(t=!1,i=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s=Object.assign(super.serialize(t),{bitmapId:this.#e,isSvg:this.#l});if(this.addComment(s),t)return s.bitmapUrl=this.#b(!0),s.accessibilityData=this.serializeAltText(!0),s.isCopy=!0,s;const{decorative:a,altText:o}=this.serializeAltText(!1);if(!a&&o&&(s.accessibilityData={type:"Figure",alt:o}),this.annotationElementId){const u=this.#v(s);return u.isSame?null:(u.isSameAltText?delete s.accessibilityData:s.accessibilityData.structParent=this._initialData.structParent??-1,s.id=this.annotationElementId,delete s.bitmapId,s)}if(i===null)return s;i.stamps||=new Map;const l=this.#l?(s.rect[2]-s.rect[0])*(s.rect[3]-s.rect[1]):null;if(!i.stamps.has(this.#e))i.stamps.set(this.#e,{area:l,serialized:s}),s.bitmap=this.#b(!1);else if(this.#l){const u=i.stamps.get(this.#e);l>u.area&&(u.area=l,u.serialized.bitmap.close(),u.serialized.bitmap=this.#b(!1))}return s}#v(t){const{pageIndex:i,accessibilityData:{altText:s}}=this._initialData,a=t.pageIndex===i,o=(t.accessibilityData?.alt||"")===s;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&a&&o,isSameAltText:o}}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}class hn{#t;#e=!1;#n=null;#i=null;#r=null;#s=new Map;#a=!1;#o=!1;#c=!1;#l=null;#d=null;#h=null;#f=null;#m=null;#g=-1;#u;static _initialized=!1;static#p=new Map([_e,yh,Ox,ge,Hi].map(t=>[t._editorType,t]));constructor({uiManager:t,pageIndex:i,div:s,structTreeLayer:a,accessibilityManager:o,annotationLayer:l,drawLayer:u,textLayer:h,viewport:d,l10n:p}){const b=[...hn.#p.values()];if(!hn._initialized){hn._initialized=!0;for(const v of b)v.initialize(p,t)}t.registerEditorTypes(b),this.#u=t,this.pageIndex=i,this.div=s,this.#t=o,this.#n=l,this.viewport=d,this.#h=h,this.drawLayer=u,this._structTree=a,this.#u.addLayer(this)}get isEmpty(){return this.#s.size===0}get isInvisible(){return this.isEmpty&&this.#u.getMode()===Tt.NONE}updateToolbar(t){this.#u.updateToolbar(t)}updateMode(t=this.#u.getMode()){switch(this.#x(),t){case Tt.NONE:this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case Tt.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case Tt.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:i}=this.div;if(i.toggle("nonEditing",!1),t===Tt.POPUP)i.toggle("commentEditing",!0);else{i.toggle("commentEditing",!1);for(const s of hn.#p.values())i.toggle(`${s._type}Editing`,t===s._editorType)}this.div.hidden=!1}hasTextLayer(t){return t===this.#h?.div}setEditingState(t){this.#u.setEditingState(t)}addCommands(t){this.#u.addCommands(t)}cleanUndoStack(t){this.#u.cleanUndoStack(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){this.#n?.div.classList.toggle("disabled",!t)}get#b(){return this.#s.size!==0?this.#s.values():this.#u.getEditors(this.pageIndex)}async enable(){this.#c=!0,this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),this.#m?.abort(),this.#m=null;const t=new Set;for(const s of this.#b)s.enableEditing(),s.show(!0),s.annotationElementId&&(this.#u.removeChangedExistingAnnotation(s),t.add(s.annotationElementId));const i=this.#n;if(i)for(const s of i.getEditableAnnotations()){if(s.hide(),this.#u.isDeletedAnnotationElement(s.data.id)||t.has(s.data.id))continue;const a=await this.deserialize(s);a&&(this.addOrRebuild(a),a.enableEditing())}this.#c=!1,this.#u._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){if(this.#o=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),this.#h&&!this.#m){this.#m=new AbortController;const s=this.#u.combinedSignal(this.#m);this.#h.div.addEventListener("pointerdown",a=>{const{clientX:l,clientY:u,timeStamp:h}=a,d=this.#g;if(h-d>500){this.#g=h;return}this.#g=-1;const{classList:p}=this.div;p.toggle("getElements",!0);const b=document.elementsFromPoint(l,u);if(p.toggle("getElements",!1),!this.div.contains(b[0]))return;let v;const A=new RegExp(`^${mr}[0-9]+$`);for(const S of b)if(A.test(S.id)){v=S.id;break}if(!v)return;const w=this.#s.get(v);w?.annotationElementId===null&&(a.stopPropagation(),a.preventDefault(),w.dblclick(a))},{signal:s,capture:!0})}const t=this.#n;if(t){const s=new Map,a=new Map;for(const l of this.#b){if(l.disableEditing(),!l.annotationElementId){l.updateFakeAnnotationElement(t);continue}if(l.serialize()!==null){s.set(l.annotationElementId,l);continue}else a.set(l.annotationElementId,l);this.getEditableAnnotation(l.annotationElementId)?.show(),l.remove()}const o=t.getEditableAnnotations();for(const l of o){const{id:u}=l.data;if(this.#u.isDeletedAnnotationElement(u)){l.updateEdited({deleted:!0});continue}let h=a.get(u);if(h){h.resetAnnotationElement(l),h.show(!1),l.show();continue}h=s.get(u),h&&(this.#u.addChangedExistingAnnotation(h),h.renderAnnotationElement(l)&&h.show(!1)),l.show()}}this.#x(),this.isEmpty&&(this.div.hidden=!0);const{classList:i}=this.div;for(const s of hn.#p.values())i.remove(`${s._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),this.#o=!1}getEditableAnnotation(t){return this.#n?.getEditableAnnotation(t)||null}setActiveEditor(t){this.#u.getActive()!==t&&this.#u.setActiveEditor(t)}enableTextSelection(){if(this.div.tabIndex=-1,this.#h?.div&&!this.#f){this.#f=new AbortController;const t=this.#u.combinedSignal(this.#f);this.#h.div.addEventListener("pointerdown",this.#v.bind(this),{signal:t}),this.#h.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#h?.div&&this.#f&&(this.#f.abort(),this.#f=null,this.#h.div.classList.remove("highlighting"))}#v(t){this.#u.unselectAll();const{target:i}=t;if(i===this.#h.div||(i.getAttribute("role")==="img"||i.classList.contains("endOfContent"))&&this.#h.div.contains(i)){const{isMac:s}=Le.platform;if(t.button!==0||t.ctrlKey&&s)return;this.#u.showAllEditors("highlight",!0,!0),this.#h.div.classList.add("free"),this.toggleDrawing(),ge.startHighlighting(this,this.#u.direction==="ltr",{target:this.#h.div,x:t.x,y:t.y}),this.#h.div.addEventListener("pointerup",()=>{this.#h.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#u._signal}),t.preventDefault()}}enableClick(){if(this.#i)return;this.#i=new AbortController;const t=this.#u.combinedSignal(this.#i);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t});const i=this.pointerup.bind(this);this.div.addEventListener("pointerup",i,{signal:t}),this.div.addEventListener("pointercancel",i,{signal:t})}disableClick(){this.#i?.abort(),this.#i=null}attach(t){this.#s.set(t.id,t);const{annotationElementId:i}=t;i&&this.#u.isDeletedAnnotationElement(i)&&this.#u.removeDeletedAnnotationElement(t)}detach(t){this.#s.delete(t.id),this.#t?.removePointerInTextLayer(t.contentDiv),!this.#o&&t.annotationElementId&&this.#u.addDeletedAnnotationElement(t)}remove(t){this.detach(t),this.#u.removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1}changeParent(t){t.parent!==this&&(t.parent&&t.annotationElementId&&(this.#u.addDeletedAnnotationElement(t.annotationElementId),vt.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),t.parent?.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),this.#u.addEditor(t),this.attach(t),!t.isAttachedToDOM){const i=t.render();this.div.append(i),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(!this.#c),this.#u.addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){if(!t.isAttachedToDOM)return;const{activeElement:i}=document;t.div.contains(i)&&!this.#r&&(t._focusEventsAllowed=!1,this.#r=setTimeout(()=>{this.#r=null,t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this.#u._signal}),i.focus())},0)),t._structTreeParentId=this.#t?.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||=this,t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const i=()=>t._uiManager.rebuild(t),s=()=>{t.remove()};this.addCommands({cmd:i,undo:s,mustExec:!1})}getEditorByUID(t){for(const i of this.#s.values())if(i.uid===t)return i;return null}getNextId(){return this.#u.getId()}get#y(){return hn.#p.get(this.#u.getMode())}combinedSignal(t){return this.#u.combinedSignal(t)}#E(t){const i=this.#y;return i?new i.prototype.constructor(t):null}canCreateNewEmptyEditor(){return this.#y?.canCreateNewEmptyEditor()}async pasteEditor(t,i){this.updateToolbar(t),await this.#u.updateMode(t.mode);const{offsetX:s,offsetY:a}=this.#w(),o=this.getNextId(),l=this.#E({parent:this,id:o,x:s,y:a,uiManager:this.#u,isCentered:!0,...i});l&&this.add(l)}async deserialize(t){return await hn.#p.get(t.annotationType??t.annotationEditorType)?.deserialize(t,this,this.#u)||null}createAndAddNewEditor(t,i,s={}){const a=this.getNextId(),o=this.#E({parent:this,id:a,x:t.offsetX,y:t.offsetY,uiManager:this.#u,isCentered:i,...s});return o&&this.add(o),o}get boundingClientRect(){return this.div.getBoundingClientRect()}#w(){const{x:t,y:i,width:s,height:a}=this.boundingClientRect,o=Math.max(0,t),l=Math.max(0,i),u=Math.min(window.innerWidth,t+s),h=Math.min(window.innerHeight,i+a),d=(o+u)/2-t,p=(l+h)/2-i,[b,v]=this.viewport.rotation%180===0?[d,p]:[p,d];return{offsetX:b,offsetY:v}}addNewEditor(t={}){this.createAndAddNewEditor(this.#w(),!0,t)}setSelected(t){this.#u.setSelected(t)}toggleSelected(t){this.#u.toggleSelected(t)}unselect(t){this.#u.unselect(t)}pointerup(t){const{isMac:i}=Le.platform;if(t.button!==0||t.ctrlKey&&i||t.target!==this.div||!this.#a||(this.#a=!1,this.#y?.isDrawer&&this.#y.supportMultipleDrawings))return;if(!this.#e){this.#e=!0;return}const s=this.#u.getMode();if(s===Tt.STAMP||s===Tt.SIGNATURE){this.#u.unselectAll();return}this.createAndAddNewEditor(t,!1)}pointerdown(t){if(this.#u.getMode()===Tt.HIGHLIGHT&&this.enableTextSelection(),this.#a){this.#a=!1;return}const{isMac:i}=Le.platform;if(t.button!==0||t.ctrlKey&&i||t.target!==this.div)return;if(this.#a=!0,this.#y?.isDrawer){this.startDrawingSession(t);return}const s=this.#u.getActive();this.#e=!s||s.isEmpty()}startDrawingSession(t){if(this.div.focus({preventScroll:!0}),this.#l){this.#y.startDrawing(this,this.#u,!1,t);return}this.#u.setCurrentDrawingSession(this),this.#l=new AbortController;const i=this.#u.combinedSignal(this.#l);this.div.addEventListener("blur",({relatedTarget:s})=>{s&&!this.div.contains(s)&&(this.#d=null,this.commitOrRemove())},{signal:i}),this.#y.startDrawing(this,this.#u,!1,t)}pause(t){if(t){const{activeElement:i}=document;this.div.contains(i)&&(this.#d=i);return}this.#d&&setTimeout(()=>{this.#d?.focus(),this.#d=null},0)}endDrawingSession(t=!1){return this.#l?(this.#u.setCurrentDrawingSession(null),this.#l.abort(),this.#l=null,this.#d=null,this.#y.endDrawing(t)):null}findNewParent(t,i,s){const a=this.#u.findParent(i,s);return a===null||a===this?!1:(a.changeParent(t),!0)}commitOrRemove(){return this.#l?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#l&&this.#y.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#u.getActive()?.parent===this&&(this.#u.commitOrRemove(),this.#u.setActiveEditor(null)),this.#r&&(clearTimeout(this.#r),this.#r=null);for(const t of this.#s.values())this.#t?.removePointerInTextLayer(t.contentDiv),t.setParent(null),t.isAttachedToDOM=!1,t.div.remove();this.div=null,this.#s.clear(),this.#u.removeLayer(this)}#x(){for(const t of this.#s.values())t.isEmpty()&&t.remove()}render({viewport:t}){this.viewport=t,ds(this.div,t);for(const i of this.#u.getEditors(this.pageIndex))this.add(i),i.rebuild();this.updateMode()}update({viewport:t}){this.#u.commitOrRemove(),this.#x();const i=this.viewport.rotation,s=t.rotation;if(this.viewport=t,ds(this.div,{rotation:s}),i!==s)for(const a of this.#s.values())a.rotate(s)}get pageDimensions(){const{pageWidth:t,pageHeight:i}=this.viewport.rawDims;return[t,i]}get scale(){return this.#u.viewParameters.realScale}}class ke{#t=null;#e=new Map;#n=new Map;static#i=0;constructor({pageIndex:t}){this.pageIndex=t}setParent(t){if(!this.#t){this.#t=t;return}if(this.#t!==t){if(this.#e.size>0)for(const i of this.#e.values())i.remove(),t.append(i);this.#t=t}}static get _svgFactory(){return Mt(this,"_svgFactory",new ol)}static#r(t,[i,s,a,o]){const{style:l}=t;l.top=`${100*s}%`,l.left=`${100*i}%`,l.width=`${100*a}%`,l.height=`${100*o}%`}#s(){const t=ke._svgFactory.create(1,1,!0);return this.#t.append(t),t.setAttribute("aria-hidden",!0),t}#a(t,i){const s=ke._svgFactory.createElement("clipPath");t.append(s);const a=`clip_${i}`;s.setAttribute("id",a),s.setAttribute("clipPathUnits","objectBoundingBox");const o=ke._svgFactory.createElement("use");return s.append(o),o.setAttribute("href",`#${i}`),o.classList.add("clip"),a}#o(t,i){for(const[s,a]of Object.entries(i))a===null?t.removeAttribute(s):t.setAttribute(s,a)}draw(t,i=!1,s=!1){const a=ke.#i++,o=this.#s(),l=ke._svgFactory.createElement("defs");o.append(l);const u=ke._svgFactory.createElement("path");l.append(u);const h=`path_p${this.pageIndex}_${a}`;u.setAttribute("id",h),u.setAttribute("vector-effect","non-scaling-stroke"),i&&this.#n.set(a,u);const d=s?this.#a(l,h):null,p=ke._svgFactory.createElement("use");return o.append(p),p.setAttribute("href",`#${h}`),this.updateProperties(o,t),this.#e.set(a,o),{id:a,clipPathId:`url(#${d})`}}drawOutline(t,i){const s=ke.#i++,a=this.#s(),o=ke._svgFactory.createElement("defs");a.append(o);const l=ke._svgFactory.createElement("path");o.append(l);const u=`path_p${this.pageIndex}_${s}`;l.setAttribute("id",u),l.setAttribute("vector-effect","non-scaling-stroke");let h;if(i){const b=ke._svgFactory.createElement("mask");o.append(b),h=`mask_p${this.pageIndex}_${s}`,b.setAttribute("id",h),b.setAttribute("maskUnits","objectBoundingBox");const v=ke._svgFactory.createElement("rect");b.append(v),v.setAttribute("width","1"),v.setAttribute("height","1"),v.setAttribute("fill","white");const A=ke._svgFactory.createElement("use");b.append(A),A.setAttribute("href",`#${u}`),A.setAttribute("stroke","none"),A.setAttribute("fill","black"),A.setAttribute("fill-rule","nonzero"),A.classList.add("mask")}const d=ke._svgFactory.createElement("use");a.append(d),d.setAttribute("href",`#${u}`),h&&d.setAttribute("mask",`url(#${h})`);const p=d.cloneNode();return a.append(p),d.classList.add("mainOutline"),p.classList.add("secondaryOutline"),this.updateProperties(a,t),this.#e.set(s,a),s}finalizeDraw(t,i){this.#n.delete(t),this.updateProperties(t,i)}updateProperties(t,i){if(!i)return;const{root:s,bbox:a,rootClass:o,path:l}=i,u=typeof t=="number"?this.#e.get(t):t;if(u){if(s&&this.#o(u,s),a&&ke.#r(u,a),o){const{classList:h}=u;for(const[d,p]of Object.entries(o))h.toggle(d,p)}if(l){const d=u.firstChild.firstChild;this.#o(d,l)}}}updateParent(t,i){if(i===this)return;const s=this.#e.get(t);s&&(i.#t.append(s),this.#e.delete(t),i.#e.set(t,s))}remove(t){this.#n.delete(t),this.#t!==null&&(this.#e.get(t).remove(),this.#e.delete(t))}destroy(){this.#t=null;for(const t of this.#e.values())t.remove();this.#e.clear(),this.#n.clear()}}globalThis._pdfjsTestingUtils={HighlightOutliner:Ju};globalThis.pdfjsLib={AbortException:Un,AnnotationEditorLayer:hn,AnnotationEditorParamsType:Ft,AnnotationEditorType:Tt,AnnotationEditorUIManager:Hn,AnnotationLayer:bh,AnnotationMode:zn,AnnotationType:xe,applyOpacity:nv,build:cx,ColorPicker:Ci,createValidAbsoluteUrl:lm,CSSConstants:iv,DOMSVGFactory:ol,DrawLayer:ke,FeatureTest:Le,fetchData:Sr,findContrastColor:sv,getDocument:Mm,getFilenameFromUrl:Qy,getPdfFilenameFromUrl:Wy,getRGB:_r,getUuid:hm,getXfaPageViewport:Jy,GlobalWorkerOptions:ua,ImageKind:il,InvalidPDFException:Gu,isDataScheme:dl,isPdfFile:oh,isValidExplicitDest:gv,MathClamp:Ue,noContextMenu:Ti,normalizeUnicode:Xy,OPS:br,OutputScale:Gi,PasswordResponses:Fy,PDFDataRangeTransport:Rm,PDFDateString:Vu,PDFWorker:vr,PermissionFlag:Py,PixelsPerInch:da,RenderingCancelledException:rh,renderRichText:gm,ResponseException:al,setLayerDimensions:ds,shadow:Mt,SignatureExtractor:sa,stopEvent:ue,SupportedImageMimeTypes:Yu,TextLayer:ze,TouchManager:fl,updateUrlHash:cm,Util:dt,VerbosityLevel:cl,version:Lm,XfaLayer:fm};ua.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${Lm}/pdf.worker.min.js`;const Lx=async g=>{const t=await g.arrayBuffer(),i=await Mm({data:t}).promise;let s="";for(let a=1;a<=i.numPages;a++){const u=(await(await i.getPage(a)).getTextContent()).items.map(h=>h.str).join(" ");s+=u+`
`}return s},jx=g=>{const t=[],i=g.split(`
`),s=/(\d{1,2}\/\d{1,2}\/\d{4})\s+(.+?)\s+([-+]?\$?[\d,]+\.?\d{0,2})/g;let a=0;for(const o of i){const l=[...o.matchAll(s)];for(const u of l)try{const h=u[1],d=u[2].trim(),p=u[3].replace(/[$,]/g,""),b=new Date(h);if(isNaN(b.getTime()))continue;const v=parseFloat(p);if(isNaN(v))continue;t.push({id:`pdf-${b.getTime()}-${a}`,date:b,description:d,category:"Uncategorized",amount:v,balance:0,isPending:!1,isManual:!1,sortOrder:a}),a++}catch(h){console.warn("Failed to parse line:",o,h)}}return t},Bx=g=>{const t=[],i=g.split(`
`),s=/(\d{2}\/\d{2})\s+(.+?)\s+([-+]?\$?[\d,]+\.\d{2})/g;let a=0;const o=new Date().getFullYear();for(const l of i){const u=[...l.matchAll(s)];for(const h of u)try{const d=`${h[1]}/${o}`,p=h[2].trim(),b=h[3].replace(/[$,]/g,""),v=new Date(d);if(isNaN(v.getTime()))continue;const A=parseFloat(b);if(isNaN(A))continue;t.push({id:`pdf-${v.getTime()}-${a}`,date:v,description:p,category:"Uncategorized",amount:A,balance:0,isPending:!1,isManual:!1,sortOrder:a}),a++}catch(d){console.warn("Failed to parse line:",l,d)}}return t},Px=g=>{const t=[],i=g.split(`
`),s=/(\d{1,2}\/\d{1,2}\/\d{4})\s+(.+?)\s+(?:([\d,]+\.\d{2})\s+)?([-]?[\d,]+\.\d{2})?/g;let a=0;for(const o of i){const l=[...o.matchAll(s)];for(const u of l)try{const h=u[1],d=u[2].trim(),p=u[3]?parseFloat(u[3].replace(/,/g,"")):0,b=u[4]?parseFloat(u[4].replace(/[-,]/g,"")):0,v=new Date(h);if(isNaN(v.getTime()))continue;const A=p>0?p:-b;if(A===0)continue;t.push({id:`pdf-${v.getTime()}-${a}`,date:v,description:d,category:"Uncategorized",amount:A,balance:0,isPending:!1,isManual:!1,sortOrder:a}),a++}catch(h){console.warn("Failed to parse line:",o,h)}}return t},Fx=g=>{const t=[],i=g.split(`
`),s=[/(\d{1,2}\/\d{1,2}\/\d{4})\s+(.+?)\s+([-+]?\$?[\d,]+\.\d{2})/g,/(\d{4}-\d{2}-\d{2})\s+(.+?)\s+([-+]?\$?[\d,]+\.\d{2})/g,/(\d{2}\/\d{2}\/\d{4})\s+(.+?)\s+([-+]?\$?[\d,]+\.\d{2})/g];let a=0;for(const o of i)for(const l of s){const u=[...o.matchAll(l)];for(const h of u)try{const d=h[1],p=h[2].trim(),b=h[3].replace(/[$,]/g,""),v=new Date(d);if(isNaN(v.getTime()))continue;const A=parseFloat(b);if(isNaN(A))continue;t.some(S=>S.date.getTime()===v.getTime()&&S.description===p&&S.amount===A)||(t.push({id:`pdf-${v.getTime()}-${a}`,date:v,description:p,category:"Uncategorized",amount:A,balance:0,isPending:!1,isManual:!1,sortOrder:a}),a++)}catch(d){console.warn("Failed to parse line:",o,d)}}return t},zx=[{name:"USAA",detect:g=>g.toLowerCase().includes("usaa"),parse:jx},{name:"Chase",detect:g=>g.toLowerCase().includes("chase"),parse:Bx},{name:"Bank of America",detect:g=>g.toLowerCase().includes("bank of america")||g.toLowerCase().includes("bankofamerica"),parse:Px}],Ix=async g=>{const t=[];try{const i=await Lx(g);if(!i.trim())return{transactions:[],errors:["Could not extract text from PDF. The file may be scanned or encrypted."]};const s=zx.find(o=>o.detect(i));let a;return s?(console.log(`Detected bank format: ${s.name}`),a=s.parse(i)):(console.log("Using generic parser"),a=Fx(i)),a.length===0&&t.push("No transactions found in PDF. The format may not be supported."),{transactions:a,errors:t}}catch(i){return{transactions:[],errors:[`Failed to parse PDF: ${i instanceof Error?i.message:"Unknown error"}`]}}},Ux=({onImportComplete:g})=>{const[t,i]=mt.useState(!1),[s,a]=mt.useState(!1),[o,l]=mt.useState("Processing file..."),[u,h]=mt.useState(!1),[d,p]=mt.useState(null),[b,v]=mt.useState(""),A=mt.useRef(null),w=async P=>{const z=P.name.toLowerCase().endsWith(".csv"),L=P.name.toLowerCase().endsWith(".pdf");if(!z&&!L){alert("Please select a CSV or PDF file");return}i(!0),l(L?"Extracting data from PDF...":"Processing CSV file...");try{let j;L?j=await Ix(P):j=await Dy(P),p(j),i(!1),h(!0)}catch(j){console.error("Error parsing file:",j),alert(`Failed to parse ${L?"PDF":"CSV"} file. Please check the format.`),i(!1)}},S=()=>{if(!d)return;const P=b?parseFloat(b.replace(/[$,]/g,"")):void 0;if(b&&(isNaN(P)||P<0)){alert("Please enter a valid balance amount");return}g(d,P),h(!1),p(null),v("")},C=()=>{d&&(g(d),h(!1),p(null),v(""))},E=P=>{const z=P.target.files?.[0];z&&w(z)},k=P=>{P.preventDefault(),P.stopPropagation(),P.type==="dragenter"||P.type==="dragover"?a(!0):P.type==="dragleave"&&a(!1)},O=P=>{P.preventDefault(),P.stopPropagation(),a(!1);const z=P.dataTransfer.files?.[0];z&&w(z)};return y.jsxs(y.Fragment,{children:[y.jsxs("div",{className:`
          border-2 border-dashed rounded-2xl p-12 text-center cursor-pointer
          transition-all duration-200 backdrop-blur-sm
          ${s?"border-blue-500 bg-blue-500/20":"border-gray-600 hover:border-gray-500 bg-gray-800/50"}
          ${t?"opacity-50 pointer-events-none":""}
        `,onDragEnter:k,onDragLeave:k,onDragOver:k,onDrop:O,onClick:()=>A.current?.click(),children:[y.jsx("input",{ref:A,type:"file",accept:".csv,.pdf",onChange:E,className:"hidden"}),t?y.jsxs("div",{className:"space-y-4",children:[y.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto"}),y.jsx("p",{className:"text-gray-400",children:o})]}):y.jsxs("div",{className:"space-y-4",children:[y.jsx("div",{className:"text-6xl",children:""}),y.jsxs("div",{className:"text-gray-300",children:[y.jsx("p",{className:"text-lg font-semibold text-white",children:"Import Bank Transactions"}),y.jsx("p",{className:"text-sm mt-2 text-gray-400",children:"Drag and drop your CSV or PDF statement here, or click to browse"}),y.jsxs("div",{className:"flex items-center justify-center gap-4 mt-4 text-xs text-gray-500",children:[y.jsx("span",{className:"px-3 py-1 bg-gray-700 rounded-lg",children:"CSV"}),y.jsx("span",{className:"px-3 py-1 bg-gray-700 rounded-lg",children:"PDF"})]}),y.jsx("p",{className:"text-xs mt-3 text-gray-500",children:"Supports USAA, Chase, Bank of America, Wells Fargo, Capital One, and more"})]})]})]}),u&&y.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:y.jsxs("div",{className:"bg-gray-800 rounded-2xl p-6 max-w-md w-full border border-gray-700 shadow-xl",children:[y.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:"Update Current Balance"}),y.jsx("p",{className:"text-gray-400 text-sm mb-6",children:"Enter your current account balance from your bank's app to keep your balances accurate. This is optional - you can skip if you prefer to use the balance from the imported file."}),y.jsxs("div",{className:"mb-6",children:[y.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Current Balance (optional)"}),y.jsx("input",{type:"text",value:b,onChange:P=>v(P.target.value),onKeyDown:P=>{P.key==="Enter"&&S(),P.key==="Escape"&&C()},placeholder:"$0.00",className:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500",autoFocus:!0})]}),y.jsxs("div",{className:"flex gap-3",children:[y.jsx("button",{onClick:C,className:"flex-1 px-4 py-3 bg-gray-700 text-white rounded-lg hover:bg-gray-600 transition-colors font-medium",children:"Skip"}),y.jsx("button",{onClick:S,className:"flex-1 px-4 py-3 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors font-medium",children:"Update Balance"})]})]})})]})},Hx=({onImportComplete:g})=>{const[t,i]=mt.useState(""),[s,a]=mt.useState(null),[o,l]=mt.useState(!1),u=()=>{a(null);try{const d=JSON.parse(t),p=Array.isArray(d)?d:d.transactions||[];if(p.length===0){a("No transactions found in JSON. Expected an array of transactions.");return}const b=p.map((v,A)=>{if(!v.date)throw new Error(`Transaction ${A+1}: Missing required field 'date'`);if(!v.description&&!v.desc&&!v.merchant)throw new Error(`Transaction ${A+1}: Missing required field 'description'`);if(v.amount===void 0&&v.amt===void 0)throw new Error(`Transaction ${A+1}: Missing required field 'amount'`);let w;if(typeof v.date=="string"){if(w=new Date(v.date),isNaN(w.getTime()))throw new Error(`Transaction ${A+1}: Invalid date format '${v.date}'`)}else w=new Date(v.date);let S;const C=v.amount??v.amt;if(typeof C=="string"){const E=C.replace(/[$,]/g,"");if(S=parseFloat(E),isNaN(S))throw new Error(`Transaction ${A+1}: Invalid amount '${C}'`)}else S=parseFloat(C);return v.type==="debit"||v.transaction_type==="debit"||S>0?S=-Math.abs(S):(v.type==="credit"||v.transaction_type==="credit")&&(S=Math.abs(S)),{id:`json-import-${Date.now()}-${A}`,date:w,description:v.description||v.desc||v.merchant||"Unknown",category:v.category||v.cat||"Uncategorized",amount:S,balance:0,isPending:v.pending||v.isPending||!1,isManual:!0,sortOrder:A}});g({transactions:b,errors:[]}),i(""),l(!1)}catch(d){d instanceof Error?a(d.message):a("Failed to parse JSON. Please check the format.")}},h=`[
  {
    "date": "2024-01-15",
    "description": "Amazon Purchase",
    "category": "Shopping",
    "amount": -125.50
  },
  {
    "date": "2024-01-14",
    "description": "Salary Deposit",
    "category": "Income",
    "amount": 3000.00
  }
]`;return y.jsxs(y.Fragment,{children:[y.jsx("button",{onClick:()=>l(!0),className:"px-6 py-3 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-2xl font-semibold hover:from-purple-600 hover:to-pink-600 transition-all shadow-lg",children:"Import from JSON"}),o&&y.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:y.jsxs("div",{className:"bg-gray-800 rounded-3xl p-8 max-w-4xl w-full max-h-[90vh] overflow-y-auto border border-gray-700",children:[y.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"Import Transactions from JSON"}),y.jsxs("div",{className:"mb-6",children:[y.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Instructions"}),y.jsxs("ol",{className:"list-decimal list-inside text-gray-300 space-y-2 text-sm",children:[y.jsx("li",{children:"Upload your credit card statement PDF to claude.ai"}),y.jsx("li",{children:'Ask Claude: "Extract all transactions from this statement as JSON with fields: date, description, category, amount"'}),y.jsx("li",{children:"Copy the JSON response from Claude"}),y.jsx("li",{children:"Paste it in the box below and click Import"})]})]}),y.jsxs("div",{className:"mb-4",children:[y.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Paste JSON Here"}),y.jsx("textarea",{value:t,onChange:d=>i(d.target.value),placeholder:h,className:"w-full h-64 px-4 py-3 bg-gray-700 border border-gray-600 rounded-xl text-white font-mono text-sm resize-y"})]}),s&&y.jsxs("div",{className:"mb-4 p-4 bg-red-500/20 border border-red-500/50 rounded-xl text-red-300 text-sm",children:[y.jsx("strong",{children:"Error:"})," ",s]}),y.jsxs("div",{className:"mb-6 p-4 bg-gray-700/50 rounded-xl",children:[y.jsx("h4",{className:"text-sm font-semibold text-white mb-2",children:"Expected JSON Format"}),y.jsx("pre",{className:"text-xs text-gray-300 overflow-x-auto",children:h}),y.jsxs("p",{className:"text-xs text-gray-400 mt-2",children:[y.jsx("strong",{children:"Note:"})," Negative amounts = debits (expenses), Positive amounts = credits (income/refunds)"]})]}),y.jsxs("div",{className:"flex gap-4",children:[y.jsx("button",{onClick:u,disabled:!t.trim(),className:"px-6 py-3 bg-gradient-to-r from-green-500 to-emerald-500 text-white rounded-2xl font-semibold hover:from-green-600 hover:to-emerald-600 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:"Import Transactions"}),y.jsx("button",{onClick:()=>{l(!1),i(""),a(null)},className:"px-6 py-3 bg-gray-700 text-white rounded-2xl font-semibold hover:bg-gray-600 transition-all",children:"Cancel"})]})]})})]})},qx=({transactions:g,onAddTransaction:t,onDeleteTransaction:i,onCreateRecurringBill:s,onUpdateTransaction:a,onDismissProjection:o,recurringBills:l})=>{const[u,h]=mt.useState(!1),[d,p]=mt.useState(""),[b,v]=mt.useState(null),[A,w]=mt.useState(!0),[S,C]=mt.useState(null),[E,k]=mt.useState(""),[O,P]=mt.useState("date"),[z,L]=mt.useState("desc"),[j,D]=mt.useState(""),[N,U]=mt.useState(""),[$,tt]=mt.useState(""),at=T=>{O===T?L(z==="asc"?"desc":"asc"):(P(T),L(T==="date"||T==="amount"?"desc":"asc"))},bt=[...g].sort((T,Q)=>{let nt=0;switch(O){case"date":nt=T.date.getTime()-Q.date.getTime(),nt===0&&T.sortOrder!==void 0&&Q.sortOrder!==void 0&&(nt=T.sortOrder-Q.sortOrder);break;case"description":nt=T.description.localeCompare(Q.description);break;case"category":nt=T.category.localeCompare(Q.category);break;case"amount":nt=T.amount-Q.amount;break}return z==="asc"?nt:-nt}).filter(T=>{const Q=T.description.toLowerCase().includes(d.toLowerCase())||T.category.toLowerCase().includes(d.toLowerCase()),nt=T.description.includes("(Projected)"),rt=A||!nt;let ot=!0;const ft=new Date(T.date);if(ft.setHours(0,0,0,0),j){const X=new Date(j);X.setHours(0,0,0,0),ot=ot&&ft>=X}if(N){const X=new Date(N);X.setHours(23,59,59,999),ot=ot&&ft<=X}if(T.description.includes("(Projected)")&&$){const X=new Date($);X.setHours(23,59,59,999),ot=ot&&ft<=X}return Q&&rt&&ot}),F=T=>{a({...T,isReconciled:!T.isReconciled,isPending:T.isReconciled?T.isPending:!1})},q=T=>{const Q=T.description.replace(" (Projected)","");return l.some(nt=>nt.description.toLowerCase()===Q.toLowerCase()||nt.description.toLowerCase().includes(Q.toLowerCase())||Q.toLowerCase().includes(nt.description.toLowerCase()))},et=T=>{a({...T,isProjectedVisible:T.isProjectedVisible===!1})},it=(T,Q)=>{if(!T.isReconciled)switch(C({id:T.id,field:Q}),Q){case"date":k(Ty(T.date));break;case"description":k(T.description);break;case"category":k(T.category);break;case"amount":k(Math.abs(T.amount).toString());break}},ut=T=>{if(!S)return;let Q={};switch(S.field){case"date":const nt=gs(E);isNaN(nt.getTime())||(Q.date=nt);break;case"description":E.trim()&&(Q.description=E.trim());break;case"category":E.trim()&&(Q.category=E.trim());break;case"amount":const rt=parseFloat(E);isNaN(rt)||(Q.amount=T.amount<0?-Math.abs(rt):Math.abs(rt));break}Object.keys(Q).length>0&&a({...T,...Q}),C(null),k("")},M=()=>{C(null),k("")},H=T=>{const Q=T.description.replace(" (Projected)","");T.id.startsWith("proj-")?(t({date:T.date,description:Q,category:T.category,amount:T.amount,balance:T.balance,isPending:!0,isManual:!0}),o(T.id)):a({...T,description:Q,isPending:!0})};return y.jsxs("div",{className:"space-y-3",children:[y.jsxs("div",{className:"flex justify-between items-center",children:[y.jsx("h2",{className:"text-xl font-bold text-white",children:"Transaction History"}),y.jsx("button",{onClick:()=>h(!0),className:"px-3 py-1.5 text-sm bg-gradient-to-r from-blue-500 to-purple-500 text-white rounded-lg hover:from-blue-600 hover:to-purple-600 transition-all shadow-lg font-medium",children:"+ Add Transaction"})]}),y.jsxs("div",{className:"space-y-2",children:[y.jsxs("div",{className:"flex gap-2",children:[y.jsx("div",{className:"relative flex-1",children:y.jsx("input",{type:"text",placeholder:"Search by Description or Category...",value:d,onChange:T=>p(T.target.value),className:"w-full px-3 py-2 text-sm bg-gray-800 border border-gray-700 rounded-lg text-white placeholder-gray-500 focus:ring-2 focus:ring-blue-500 focus:border-transparent"})}),y.jsxs("div",{className:"flex items-center gap-2 bg-gray-800 rounded-lg px-3 py-2 border border-gray-700",children:[y.jsx("span",{className:"text-xs text-gray-300 whitespace-nowrap",children:"Show Projected"}),y.jsx("button",{onClick:()=>w(!A),className:`relative inline-flex h-5 w-9 items-center rounded-full transition-colors ${A?"bg-blue-500":"bg-gray-600"}`,children:y.jsx("span",{className:`inline-block h-3.5 w-3.5 transform rounded-full bg-white transition-transform ${A?"translate-x-5":"translate-x-1"}`})})]})]}),y.jsxs("div",{className:"flex gap-2 items-center bg-gray-800/50 rounded-lg px-3 py-2 border border-gray-700",children:[y.jsx("span",{className:"text-xs text-gray-400 whitespace-nowrap",children:"From:"}),y.jsx("input",{type:"date",value:j,onChange:T=>D(T.target.value),className:"px-2 py-1 text-xs bg-gray-700 border border-gray-600 rounded text-white"}),y.jsx("span",{className:"text-xs text-gray-400 whitespace-nowrap",children:"To:"}),y.jsx("input",{type:"date",value:N,onChange:T=>U(T.target.value),className:"px-2 py-1 text-xs bg-gray-700 border border-gray-600 rounded text-white"}),y.jsx("span",{className:"text-xs text-gray-400 whitespace-nowrap ml-4",children:"Show Projections Thru:"}),y.jsx("input",{type:"date",value:$,onChange:T=>tt(T.target.value),className:"px-2 py-1 text-xs bg-gray-700 border border-gray-600 rounded text-white"}),(j||N||$)&&y.jsx("button",{onClick:()=>{D(""),U(""),tt("")},className:"px-2 py-1 text-xs bg-red-500 text-white rounded hover:bg-red-600",title:"Clear date filters",children:"Clear"})]})]}),y.jsx("div",{className:"overflow-x-auto bg-gray-800 rounded-xl shadow-xl border border-gray-700",children:y.jsxs("table",{className:"w-full",children:[y.jsx("thead",{className:"bg-gray-900/50 border-b border-gray-700",children:y.jsxs("tr",{children:[y.jsx("th",{className:"px-3 py-2 text-center text-[10px] font-medium text-gray-300 uppercase tracking-wider",children:y.jsx("span",{title:"Reconciled",children:""})}),y.jsx("th",{className:"px-3 py-2 text-left text-[10px] font-medium text-gray-300 uppercase tracking-wider",children:"ID"}),y.jsx("th",{className:"px-3 py-2 text-left text-[10px] font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-700/30 select-none",onClick:()=>at("date"),children:y.jsxs("div",{className:"flex items-center gap-1",children:["Date",O==="date"&&y.jsx("span",{className:"text-blue-400",children:z==="asc"?"":""})]})}),y.jsx("th",{className:"px-3 py-2 text-left text-[10px] font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-700/30 select-none",onClick:()=>at("description"),children:y.jsxs("div",{className:"flex items-center gap-1",children:["Description",O==="description"&&y.jsx("span",{className:"text-blue-400",children:z==="asc"?"":""})]})}),y.jsx("th",{className:"px-3 py-2 text-left text-[10px] font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-700/30 select-none",onClick:()=>at("category"),children:y.jsxs("div",{className:"flex items-center gap-1",children:["Category",O==="category"&&y.jsx("span",{className:"text-blue-400",children:z==="asc"?"":""})]})}),y.jsx("th",{className:"px-3 py-2 text-right text-[10px] font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-700/30 select-none",onClick:()=>at("amount"),children:y.jsxs("div",{className:"flex items-center gap-1 justify-end",children:["Amount",O==="amount"&&y.jsx("span",{className:"text-blue-400",children:z==="asc"?"":""})]})}),y.jsx("th",{className:"px-3 py-2 text-right text-[10px] font-medium text-gray-300 uppercase tracking-wider",children:"Balance"}),y.jsx("th",{className:"px-3 py-2 text-center text-[10px] font-medium text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),y.jsx("tbody",{className:"divide-y divide-gray-700",children:bt.length===0?y.jsx("tr",{children:y.jsx("td",{colSpan:8,className:"px-4 py-8 text-center text-gray-400",children:"No transactions found. Import a CSV or add a manual transaction."})}):bt.map(T=>y.jsxs("tr",{className:"hover:bg-gray-700/30 transition-colors",children:[y.jsx("td",{className:"px-3 py-2 text-center",children:y.jsx("button",{onClick:()=>F(T),disabled:T.description.includes("(Projected)"),className:`w-6 h-6 rounded flex items-center justify-center transition-colors ${T.description.includes("(Projected)")?"bg-gray-800 text-gray-600 cursor-not-allowed":T.isReconciled?"bg-green-500 text-white":"bg-gray-700 text-gray-400 hover:bg-gray-600"}`,title:T.description.includes("(Projected)")?"Mark as processed first":T.isReconciled?"Reconciled":"Not reconciled",children:T.description.includes("(Projected)")?"":T.isReconciled&&""})}),y.jsx("td",{className:"px-3 py-2 text-[10px] text-gray-500 font-mono truncate max-w-[120px]",title:T.id,children:T.id}),y.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-white",children:S?.id===T.id&&S.field==="date"&&!T.isReconciled?y.jsxs("div",{className:"flex items-center gap-1",children:[y.jsx("input",{type:"date",value:E,onChange:Q=>k(Q.target.value),onKeyDown:Q=>{Q.key==="Enter"&&ut(T),Q.key==="Escape"&&M()},className:"px-2 py-1 bg-gray-700 border border-gray-600 rounded text-white",autoFocus:!0}),y.jsx("button",{onClick:()=>ut(T),className:"px-2 py-1 bg-green-500 text-white rounded text-xs hover:bg-green-600",children:""}),y.jsx("button",{onClick:M,className:"px-2 py-1 bg-red-500 text-white rounded text-xs hover:bg-red-600",children:""})]}):y.jsx("button",{onClick:()=>!T.isReconciled&&it(T,"date"),className:`text-left w-full ${T.isReconciled?"cursor-default px-2 py-1":"hover:bg-gray-700/50 rounded px-2 py-1 cursor-pointer"}`,disabled:T.isReconciled,title:T.isReconciled?"Cannot edit reconciled transaction":"Click to edit date",children:T.date.toLocaleDateString()})}),y.jsx("td",{className:"px-3 py-2 text-xs text-white",children:y.jsxs("div",{className:"flex items-center gap-2",children:[S?.id===T.id&&S.field==="description"&&!T.isReconciled?y.jsxs("div",{className:"flex items-center gap-1 flex-1",children:[y.jsx("input",{type:"text",value:E,onChange:Q=>k(Q.target.value),onKeyDown:Q=>{Q.key==="Enter"&&ut(T),Q.key==="Escape"&&M()},className:"flex-1 px-2 py-1 bg-gray-700 border border-gray-600 rounded text-white",autoFocus:!0}),y.jsx("button",{onClick:()=>ut(T),className:"px-2 py-1 bg-green-500 text-white rounded text-xs hover:bg-green-600",children:""}),y.jsx("button",{onClick:M,className:"px-2 py-1 bg-red-500 text-white rounded text-xs hover:bg-red-600",children:""})]}):y.jsx("button",{onClick:()=>!T.isReconciled&&it(T,"description"),className:`text-left flex-1 ${T.isReconciled?"cursor-default px-2 py-1":"hover:bg-gray-700/50 rounded px-2 py-1 cursor-pointer"}`,disabled:T.isReconciled,title:T.isReconciled?"Cannot edit reconciled transaction":"Click to edit description",children:T.description}),T.isReconciled&&y.jsx("span",{className:"px-2 py-0.5 text-xs bg-green-500/20 text-green-300 rounded-lg border border-green-500/30",children:"Cleared"}),T.description.includes("(Projected)")?y.jsx("span",{className:"px-2 py-0.5 text-xs bg-purple-500/20 text-purple-300 rounded-lg border border-purple-500/30",children:"Projected"}):T.isPending&&!T.isReconciled&&y.jsx("span",{className:"px-2 py-0.5 text-xs bg-yellow-500/20 text-yellow-300 rounded-lg border border-yellow-500/30",children:"Pending"}),T.isManual&&!T.description.includes("(Projected)")&&y.jsx("span",{className:"px-2 py-0.5 text-xs bg-blue-500/20 text-blue-300 rounded-lg border border-blue-500/30",children:"Manual"})]})}),y.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-300",children:S?.id===T.id&&S.field==="category"&&!T.isReconciled?y.jsxs("div",{className:"flex items-center gap-1",children:[y.jsx("input",{type:"text",value:E,onChange:Q=>k(Q.target.value),onKeyDown:Q=>{Q.key==="Enter"&&ut(T),Q.key==="Escape"&&M()},className:"px-2 py-1 bg-gray-700 border border-gray-600 rounded text-white",autoFocus:!0}),y.jsx("button",{onClick:()=>ut(T),className:"px-2 py-1 bg-green-500 text-white rounded text-xs hover:bg-green-600",children:""}),y.jsx("button",{onClick:M,className:"px-2 py-1 bg-red-500 text-white rounded text-xs hover:bg-red-600",children:""})]}):y.jsx("button",{onClick:()=>!T.isReconciled&&it(T,"category"),className:`text-left w-full ${T.isReconciled?"cursor-default px-2 py-1":"hover:bg-gray-700/50 rounded px-2 py-1 cursor-pointer"}`,disabled:T.isReconciled,title:T.isReconciled?"Cannot edit reconciled transaction":"Click to edit category",children:T.category})}),y.jsx("td",{className:`px-3 py-2 whitespace-nowrap text-xs text-right font-semibold ${T.amount<0?"text-red-400":"text-green-400"}`,children:S?.id===T.id&&S.field==="amount"&&!T.isReconciled?y.jsxs("div",{className:"flex items-center gap-1 justify-end",children:[y.jsxs("span",{className:"text-gray-300",children:[T.amount<0?"-":"","$"]}),y.jsx("input",{type:"number",step:"0.01",value:E,onChange:Q=>k(Q.target.value),onKeyDown:Q=>{Q.key==="Enter"&&ut(T),Q.key==="Escape"&&M()},className:"w-24 px-2 py-1 bg-gray-700 border border-gray-600 rounded text-white text-right",autoFocus:!0}),y.jsx("button",{onClick:()=>ut(T),className:"px-2 py-1 bg-green-500 text-white rounded text-xs hover:bg-green-600",children:""}),y.jsx("button",{onClick:M,className:"px-2 py-1 bg-red-500 text-white rounded text-xs hover:bg-red-600",children:""})]}):y.jsxs("button",{onClick:()=>!T.isReconciled&&it(T,"amount"),className:`text-right w-full ${T.isReconciled?"cursor-default":"hover:bg-gray-700/50 rounded px-2 py-1 cursor-pointer"}`,disabled:T.isReconciled,title:T.isReconciled?"Cannot edit reconciled transaction":"Click to edit amount",children:[T.amount<0?"-":"","$",Math.abs(T.amount).toFixed(2)]})}),y.jsxs("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-right font-semibold text-white",children:["$",T.balance.toFixed(2)]}),y.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm",children:y.jsx("div",{className:"flex gap-2 justify-center items-center",children:T.description.includes("(Projected)")?y.jsxs(y.Fragment,{children:[y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("span",{className:"text-xs text-gray-400",children:"Include:"}),y.jsx("button",{onClick:()=>et(T),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${T.isProjectedVisible!==!1?"bg-blue-500":"bg-gray-600"}`,title:T.isProjectedVisible!==!1?"Included in balance":"Excluded from balance",children:y.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${T.isProjectedVisible!==!1?"translate-x-6":"translate-x-1"}`})})]}),y.jsx("button",{onClick:()=>H(T),className:"px-3 py-1 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors font-medium text-xs",children:"Mark as Processed"}),y.jsx("button",{onClick:()=>{confirm(`Dismiss this projected transaction?

${T.description}
${T.amount<0?"-":""}$${Math.abs(T.amount).toFixed(2)}

It will not appear again.`)&&o(T.id)},className:"px-3 py-1 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors font-medium text-xs",title:"Dismiss this projection",children:"Dismiss"})]}):y.jsxs(y.Fragment,{children:[!q(T)&&y.jsx("button",{onClick:()=>v(T),className:"px-3 py-1 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors font-medium text-xs",children:"Make Recurring"}),y.jsx("button",{onClick:()=>{confirm(`Are you sure you want to permanently remove this transaction?

${T.description}
${T.amount<0?"-":""}$${Math.abs(T.amount).toFixed(2)}

This action cannot be undone.`)&&i(T.id)},className:"px-3 py-1 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors font-medium text-xs",title:"Permanently remove this transaction",children:"Remove"})]})})})]},T.id))})]})}),u&&y.jsx(Gx,{onAdd:T=>{t(T),h(!1)},onCancel:()=>h(!1)}),b&&y.jsx(Vx,{transaction:b,onSave:T=>{s(T),v(null)},onCancel:()=>v(null)})]})},Gx=({onAdd:g,onCancel:t})=>{const[i,s]=mt.useState({date:new Date().toISOString().split("T")[0],description:"",category:"",amount:"",isPending:!1}),a=o=>{o.preventDefault(),g({date:new Date(i.date),description:i.description,category:i.category,amount:parseFloat(i.amount),balance:0,isPending:i.isPending,isManual:!0})};return y.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50",children:y.jsxs("div",{className:"bg-gray-800 rounded-3xl p-6 w-full max-w-md border border-gray-700 shadow-2xl",children:[y.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:"Add Manual Transaction"}),y.jsxs("form",{onSubmit:a,className:"space-y-4",children:[y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Date"}),y.jsx("input",{type:"date",value:i.date,onChange:o=>s({...i,date:o.target.value}),className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-xl text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Description"}),y.jsx("input",{type:"text",value:i.description,onChange:o=>s({...i,description:o.target.value}),className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-xl text-white placeholder-gray-500 focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Grocery Store",required:!0})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Category"}),y.jsx("input",{type:"text",value:i.category,onChange:o=>s({...i,category:o.target.value}),className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-xl text-white placeholder-gray-500 focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Groceries",required:!0})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Amount (negative for expenses, positive for income)"}),y.jsx("input",{type:"number",step:"0.01",value:i.amount,onChange:o=>s({...i,amount:o.target.value}),className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-xl text-white placeholder-gray-500 focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"-25.50",required:!0})]}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("input",{type:"checkbox",id:"isPending",checked:i.isPending,onChange:o=>s({...i,isPending:o.target.checked}),className:"h-4 w-4 text-blue-500 rounded bg-gray-700 border-gray-600"}),y.jsx("label",{htmlFor:"isPending",className:"text-sm text-gray-300",children:"Mark as Pending"})]}),y.jsxs("div",{className:"flex gap-3 pt-4",children:[y.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-gradient-to-r from-blue-500 to-purple-500 text-white rounded-xl hover:from-blue-600 hover:to-purple-600 transition-all font-medium",children:"Add Transaction"}),y.jsx("button",{type:"button",onClick:t,className:"flex-1 px-4 py-2 bg-gray-700 text-gray-300 rounded-xl hover:bg-gray-600 transition-all",children:"Cancel"})]})]})]})})},Vx=({transaction:g,onSave:t,onCancel:i})=>{const s=g.amount>0,a=new Date(g.date);a.setDate(a.getDate()+30);const[o,l]=mt.useState({description:g.description,category:g.category,amount:Math.abs(g.amount).toString(),frequency:"monthly",nextDueDate:a.toISOString().split("T")[0],dayOfMonth:g.date.getDate().toString()}),u=h=>{h.preventDefault();const d=parseFloat(o.amount),p=s?Math.abs(d):-Math.abs(d);t({description:o.description,category:o.category,amount:p,frequency:o.frequency,dayOfMonth:o.frequency==="monthly"?parseInt(o.dayOfMonth):void 0,nextDueDate:new Date(o.nextDueDate),isActive:!0})};return y.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50",children:y.jsxs("div",{className:"bg-gray-800 rounded-3xl p-6 w-full max-w-md border border-gray-700 shadow-2xl",children:[y.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:"Create Recurring Bill"}),y.jsxs("form",{onSubmit:u,className:"space-y-4",children:[y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Description"}),y.jsx("input",{type:"text",value:o.description,onChange:h=>l({...o,description:h.target.value}),className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-xl text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Category"}),y.jsx("input",{type:"text",value:o.category,onChange:h=>l({...o,category:h.target.value}),className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-xl text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Amount"}),y.jsx("input",{type:"number",step:"0.01",value:o.amount,onChange:h=>l({...o,amount:h.target.value}),className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-xl text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0}),y.jsx("p",{className:"text-xs text-gray-500 mt-1",children:s?"Income (positive amount)":"Expense (negative amount)"})]}),y.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Frequency"}),y.jsxs("select",{value:o.frequency,onChange:h=>l({...o,frequency:h.target.value}),className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-xl text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[y.jsx("option",{value:"weekly",children:"Weekly"}),y.jsx("option",{value:"biweekly",children:"Bi-weekly"}),y.jsx("option",{value:"monthly",children:"Monthly"}),y.jsx("option",{value:"yearly",children:"Yearly"})]})]}),o.frequency==="monthly"&&y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Day of Month"}),y.jsx("input",{type:"number",min:"1",max:"31",value:o.dayOfMonth,onChange:h=>l({...o,dayOfMonth:h.target.value}),className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-xl text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Next Due Date"}),y.jsx("input",{type:"date",value:o.nextDueDate,onChange:h=>l({...o,nextDueDate:h.target.value}),className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-xl text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),y.jsxs("div",{className:"flex gap-3 pt-4",children:[y.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-gradient-to-r from-blue-500 to-purple-500 text-white rounded-xl hover:from-blue-600 hover:to-purple-600 transition-all font-medium",children:"Create Recurring Bill"}),y.jsx("button",{type:"button",onClick:i,className:"flex-1 px-4 py-2 bg-gray-700 text-gray-300 rounded-xl hover:bg-gray-600 transition-all",children:"Cancel"})]})]})]})})},Yx=({bills:g,onAddBill:t,onUpdateBill:i,onDeleteBill:s})=>{const[a,o]=mt.useState(!1),[l,u]=mt.useState(null),h=g.filter(p=>p.isActive),d=g.filter(p=>!p.isActive);return y.jsxs("div",{className:"space-y-6",children:[y.jsxs("div",{className:"flex justify-between items-center",children:[y.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Recurring Bills"}),y.jsx("button",{onClick:()=>o(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"+ Add Recurring Bill"})]}),y.jsxs("div",{children:[y.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Active Bills"}),h.length===0?y.jsx("p",{className:"text-gray-500",children:"No active recurring bills. Add one to see projections."}):y.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:h.map(p=>y.jsx(sm,{bill:p,onEdit:()=>u(p),onToggleActive:()=>i({...p,isActive:!1}),onDelete:()=>s(p.id)},p.id))})]}),d.length>0&&y.jsxs("div",{children:[y.jsx("h3",{className:"text-lg font-semibold text-gray-500 mb-3",children:"Inactive Bills"}),y.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:d.map(p=>y.jsx(sm,{bill:p,onEdit:()=>u(p),onToggleActive:()=>i({...p,isActive:!0}),onDelete:()=>s(p.id)},p.id))})]}),(a||l)&&y.jsx(Xx,{bill:l,onSave:p=>{l?(i({...p,id:l.id}),u(null)):(t(p),o(!1))},onCancel:()=>{o(!1),u(null)}})]})},sm=({bill:g,onEdit:t,onToggleActive:i,onDelete:s})=>{const a=o=>o.charAt(0).toUpperCase()+o.slice(1);return y.jsxs("div",{className:`bg-white rounded-lg shadow p-4 border-l-4 ${g.isActive?"border-blue-500":"border-gray-300"}`,children:[y.jsxs("div",{className:"flex justify-between items-start mb-2",children:[y.jsx("h4",{className:"font-semibold text-gray-900",children:g.description}),y.jsxs("span",{className:`text-2xl font-bold ${g.amount<0?"text-red-600":"text-green-600"}`,children:["$",Math.abs(g.amount).toFixed(2)]})]}),y.jsxs("div",{className:"space-y-1 text-sm text-gray-600 mb-3",children:[y.jsxs("p",{children:["Category: ",g.category]}),y.jsxs("p",{children:["Frequency: ",a(g.frequency)]}),y.jsxs("p",{children:["Next Due: ",g.nextDueDate.toLocaleDateString()]}),g.dayOfMonth&&y.jsxs("p",{children:["Day of Month: ",g.dayOfMonth]})]}),y.jsxs("div",{className:"flex gap-2",children:[y.jsx("button",{onClick:t,className:"flex-1 px-3 py-1 text-sm bg-blue-100 text-blue-700 rounded hover:bg-blue-200 transition-colors",children:"Edit"}),y.jsx("button",{onClick:i,className:`flex-1 px-3 py-1 text-sm rounded transition-colors ${g.isActive?"bg-yellow-100 text-yellow-700 hover:bg-yellow-200":"bg-green-100 text-green-700 hover:bg-green-200"}`,children:g.isActive?"Pause":"Activate"}),y.jsx("button",{onClick:()=>{confirm("Are you sure you want to delete this recurring bill?")&&s()},className:"px-3 py-1 text-sm bg-red-100 text-red-700 rounded hover:bg-red-200 transition-colors",children:"Delete"})]})]})},Xx=({bill:g,onSave:t,onCancel:i})=>{const[s,a]=mt.useState({description:g?.description||"",category:g?.category||"",amount:g?Math.abs(g.amount).toString():"",isExpense:g?g.amount<0:!0,frequency:g?.frequency||"monthly",dayOfMonth:g?.dayOfMonth?.toString()||"",dayOfWeek:g?.dayOfWeek?.toString()||"",nextDueDate:g?.nextDueDate?g.nextDueDate.toISOString().split("T")[0]:new Date().toISOString().split("T")[0]}),o=l=>{l.preventDefault();const u=parseFloat(s.amount)*(s.isExpense?-1:1);t({description:s.description,category:s.category,amount:u,frequency:s.frequency,dayOfMonth:s.dayOfMonth?parseInt(s.dayOfMonth):void 0,dayOfWeek:s.dayOfWeek?parseInt(s.dayOfWeek):void 0,nextDueDate:new Date(s.nextDueDate),isActive:!0})};return y.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:y.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md max-h-[90vh] overflow-y-auto",children:[y.jsxs("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:[g?"Edit":"Add"," Recurring Bill"]}),y.jsxs("form",{onSubmit:o,className:"space-y-4",children:[y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),y.jsx("input",{type:"text",value:s.description,onChange:l=>a({...s,description:l.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Electric Bill",required:!0})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),y.jsx("input",{type:"text",value:s.category,onChange:l=>a({...s,category:l.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Utilities",required:!0})]}),y.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount"}),y.jsx("input",{type:"number",step:"0.01",value:s.amount,onChange:l=>a({...s,amount:l.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"100.00",required:!0})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Type"}),y.jsxs("select",{value:s.isExpense?"expense":"income",onChange:l=>a({...s,isExpense:l.target.value==="expense"}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[y.jsx("option",{value:"expense",children:"Expense"}),y.jsx("option",{value:"income",children:"Income"})]})]})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Frequency"}),y.jsxs("select",{value:s.frequency,onChange:l=>a({...s,frequency:l.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[y.jsx("option",{value:"weekly",children:"Weekly"}),y.jsx("option",{value:"biweekly",children:"Bi-weekly"}),y.jsx("option",{value:"monthly",children:"Monthly"}),y.jsx("option",{value:"yearly",children:"Yearly"})]})]}),s.frequency==="monthly"&&y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Day of Month (1-31)"}),y.jsx("input",{type:"number",min:"1",max:"31",value:s.dayOfMonth,onChange:l=>a({...s,dayOfMonth:l.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"15"})]}),s.frequency==="weekly"&&y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Day of Week"}),y.jsxs("select",{value:s.dayOfWeek,onChange:l=>a({...s,dayOfWeek:l.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[y.jsx("option",{value:"",children:"Select a day"}),y.jsx("option",{value:"0",children:"Sunday"}),y.jsx("option",{value:"1",children:"Monday"}),y.jsx("option",{value:"2",children:"Tuesday"}),y.jsx("option",{value:"3",children:"Wednesday"}),y.jsx("option",{value:"4",children:"Thursday"}),y.jsx("option",{value:"5",children:"Friday"}),y.jsx("option",{value:"6",children:"Saturday"})]})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Next Due Date"}),y.jsx("input",{type:"date",value:s.nextDueDate,onChange:l=>a({...s,nextDueDate:l.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),y.jsxs("div",{className:"flex gap-3 pt-4",children:[y.jsxs("button",{type:"submit",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[g?"Update":"Add"," Bill"]}),y.jsx("button",{type:"button",onClick:i,className:"flex-1 px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition-colors",children:"Cancel"})]})]})]})})},$x=g=>{const t=Kx(g),i=[];return t.forEach(s=>{if(s.length<2)return;const a=Wx(s);if(!a)return;const o=Math.round(s.reduce((d,p)=>d+p.amount,0)/s.length*100)/100,l=Zx(s,a,o),h=o>0?35:50;l>=h&&i.push({description:s[0].description,category:s[0].category,averageAmount:o,frequency:a,occurrences:s,confidence:l,suggestedNextDate:Jx(s,a)})}),i.sort((s,a)=>a.confidence-s.confidence)},Kx=g=>{const t=new Map;return g.forEach(i=>{if(i.isManual||i.isPending)return;const s=Qx(i.description),a=i.amount>=0?`INCOME:${s}`:`EXPENSE:${s}`;t.has(a)||t.set(a,[]),t.get(a).push(i)}),Array.from(t.values())},Qx=g=>g.toLowerCase().replace(/\d+/g,"").replace(/[^\w\s]/g,"").trim(),Wx=g=>{if(g.length<2)return null;const t=[...g].sort((a,o)=>a.date.getTime()-o.date.getTime()),i=[];for(let a=1;a<t.length;a++){const o=Math.round((t[a].date.getTime()-t[a-1].date.getTime())/864e5);i.push(o)}const s=i.reduce((a,o)=>a+o,0)/i.length;return s>=5&&s<=9?"weekly":s>=12&&s<=16?"biweekly":s>=27&&s<=33?"monthly":s>=355&&s<=375?"yearly":null},Zx=(g,t,i)=>{let s=0;s+=Math.min(g.length*10,40);const a=g.map(h=>Math.abs(h.amount)),o=Math.max(...a),l=Math.min(...a),u=(o-l)/Math.abs(i);if(u<.1?s+=30:u<.2?s+=20:u<.3&&(s+=10),g.length>=2){const h=[...g].sort((v,A)=>v.date.getTime()-A.date.getTime()),d=[];for(let v=1;v<h.length;v++){const A=Math.round((h[v].date.getTime()-h[v-1].date.getTime())/864e5);d.push(A)}const p=d.reduce((v,A)=>v+A,0)/d.length,b=Math.max(...d.map(v=>Math.abs(v-p)));b<3?s+=30:b<7&&(s+=15)}return Math.min(s,100)},Jx=(g,t)=>{const s=[...g].sort((o,l)=>l.date.getTime()-o.date.getTime())[0].date,a=new Date(s);switch(t){case"weekly":a.setDate(a.getDate()+7);break;case"biweekly":a.setDate(a.getDate()+14);break;case"monthly":a.setMonth(a.getMonth()+1);break;case"yearly":a.setFullYear(a.getFullYear()+1);break}return a},tA=({transactions:g,existingBills:t,onAddBill:i})=>{const[s,a]=mt.useState([]),[o,l]=mt.useState(null),[u,h]=mt.useState(new Set);mt.useEffect(()=>{const b=$x(g).filter(v=>{const A=u.has(v.description),w=t.some(S=>S.description.toLowerCase().includes(v.description.toLowerCase())||v.description.toLowerCase().includes(S.description.toLowerCase()));return!A&&!w});a(b)},[g,t,u]);const d=p=>{h(new Set([...u,p]))};return s.length===0?y.jsx("div",{className:"bg-gray-800/50 rounded-2xl p-6 border border-gray-700",children:y.jsx("p",{className:"text-gray-400 text-center",children:"No recurring bill suggestions found. Import more transactions to detect patterns."})}):y.jsxs("div",{className:"space-y-4",children:[y.jsxs("div",{className:"flex justify-between items-center",children:[y.jsx("h3",{className:"text-lg font-semibold text-white",children:"Suggested Recurring Bills"}),y.jsxs("span",{className:"text-sm text-gray-400",children:[s.length," suggestions"]})]}),y.jsx("div",{className:"grid gap-4",children:s.map((p,b)=>y.jsx(eA,{suggestion:p,onAdd:()=>l(p),onDismiss:()=>d(p.description)},b))}),o&&y.jsx(iA,{suggestion:o,onSave:p=>{i(p),l(null),d(o.description)},onCancel:()=>l(null)})]})},eA=({suggestion:g,onAdd:t,onDismiss:i})=>{const s=o=>o>=80?"text-green-400":o>=60?"text-yellow-400":"text-orange-400",a=g.averageAmount>0;return y.jsxs("div",{className:`bg-gray-800/80 rounded-2xl p-5 border transition-all ${a?"border-green-500/30 hover:border-green-500/50":"border-red-500/30 hover:border-red-500/50"}`,children:[y.jsxs("div",{className:"flex justify-between items-start mb-3",children:[y.jsxs("div",{className:"flex-1",children:[y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("h4",{className:"font-semibold text-white text-lg",children:g.description}),y.jsx("span",{className:`px-2 py-0.5 text-xs rounded-lg font-medium ${a?"bg-green-500/20 text-green-300 border border-green-500/30":"bg-red-500/20 text-red-300 border border-red-500/30"}`,children:a?"Income":"Expense"})]}),y.jsx("p",{className:"text-sm text-gray-400 mt-1",children:g.category})]}),y.jsxs("div",{className:"text-right",children:[y.jsxs("p",{className:`text-2xl font-bold ${a?"text-green-400":"text-red-400"}`,children:[a?"+":"","$",Math.abs(g.averageAmount).toFixed(2)]}),y.jsxs("p",{className:`text-xs font-medium mt-1 ${s(g.confidence)}`,children:[g.confidence,"% confidence"]})]})]}),y.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-400 mb-4",children:[y.jsx("span",{className:"capitalize",children:g.frequency}),y.jsx("span",{children:""}),y.jsxs("span",{children:[g.occurrences.length," occurrences"]}),y.jsx("span",{children:""}),y.jsxs("span",{children:["Next: ",g.suggestedNextDate.toLocaleDateString()]})]}),y.jsxs("div",{className:"flex gap-2",children:[y.jsx("button",{onClick:t,className:"flex-1 px-4 py-2 bg-gradient-to-r from-blue-500 to-purple-500 text-white rounded-xl hover:from-blue-600 hover:to-purple-600 transition-all font-medium",children:"Add to Recurring Bills"}),y.jsx("button",{onClick:i,className:"px-4 py-2 bg-gray-700 text-gray-300 rounded-xl hover:bg-gray-600 transition-all",children:"Dismiss"})]})]})},iA=({suggestion:g,onSave:t,onCancel:i})=>{const s=g.averageAmount>0,[a,o]=mt.useState({description:g.description,category:g.category,amount:Math.abs(g.averageAmount).toString(),isIncome:s,frequency:g.frequency,nextDueDate:g.suggestedNextDate.toISOString().split("T")[0],dayOfMonth:g.frequency==="monthly"?g.suggestedNextDate.getDate().toString():""}),l=u=>{u.preventDefault();const h=parseFloat(a.amount),d=a.isIncome?Math.abs(h):-Math.abs(h);t({description:a.description,category:a.category,amount:d,frequency:a.frequency,dayOfMonth:a.dayOfMonth?parseInt(a.dayOfMonth):void 0,nextDueDate:new Date(a.nextDueDate),isActive:!0})};return y.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50",children:y.jsxs("div",{className:"bg-gray-800 rounded-3xl p-6 w-full max-w-md border border-gray-700 shadow-2xl",children:[y.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:"Review Recurring Bill"}),y.jsxs("form",{onSubmit:l,className:"space-y-4",children:[y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Description"}),y.jsx("input",{type:"text",value:a.description,onChange:u=>o({...a,description:u.target.value}),className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-xl text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Category"}),y.jsx("input",{type:"text",value:a.category,onChange:u=>o({...a,category:u.target.value}),className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-xl text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Amount"}),y.jsx("input",{type:"number",step:"0.01",value:a.amount,onChange:u=>o({...a,amount:u.target.value}),className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-xl text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),y.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Type"}),y.jsxs("select",{value:a.isIncome?"income":"expense",onChange:u=>o({...a,isIncome:u.target.value==="income"}),className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-xl text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[y.jsx("option",{value:"expense",children:"Expense"}),y.jsx("option",{value:"income",children:"Income"})]})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Frequency"}),y.jsxs("select",{value:a.frequency,onChange:u=>o({...a,frequency:u.target.value}),className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-xl text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[y.jsx("option",{value:"weekly",children:"Weekly"}),y.jsx("option",{value:"biweekly",children:"Bi-weekly"}),y.jsx("option",{value:"monthly",children:"Monthly"}),y.jsx("option",{value:"yearly",children:"Yearly"})]})]})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Next Due Date"}),y.jsx("input",{type:"date",value:a.nextDueDate,onChange:u=>o({...a,nextDueDate:u.target.value}),className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-xl text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),a.frequency==="monthly"&&y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Day of Month (1-31)"}),y.jsx("input",{type:"number",min:"1",max:"31",value:a.dayOfMonth,onChange:u=>o({...a,dayOfMonth:u.target.value}),className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-xl text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),y.jsxs("div",{className:"flex gap-3 pt-4",children:[y.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-gradient-to-r from-blue-500 to-purple-500 text-white rounded-xl hover:from-blue-600 hover:to-purple-600 transition-all font-medium",children:"Add Bill"}),y.jsx("button",{type:"button",onClick:i,className:"flex-1 px-4 py-2 bg-gray-700 text-gray-300 rounded-xl hover:bg-gray-600 transition-all",children:"Cancel"})]})]})]})})},nA=({transactions:g,currentBalance:t})=>{const[i,s]=mt.useState(!0),a=new Date;a.setHours(0,0,0,0);const o=g.filter(A=>{const w=new Date(A.date);return w.setHours(0,0,0,0),w>a}).sort((A,w)=>A.date.getTime()-w.date.getTime()),l=i?o:o.filter(A=>!A.description.includes("(Projected)")),u=l.reduce((A,w)=>{const S=`${w.date.getFullYear()}-${String(w.date.getMonth()+1).padStart(2,"0")}`;return A[S]||(A[S]=[]),A[S].push(w),A},{}),h=Object.keys(u).sort(),d=l.filter(A=>A.amount>0).reduce((A,w)=>A+w.amount,0),p=l.filter(A=>A.amount<0).reduce((A,w)=>A+Math.abs(w.amount),0),b=l.length>0?l[l.length-1].balance:t,v=b-t;return y.jsxs("div",{className:"space-y-6",children:[y.jsxs("div",{className:"flex justify-between items-start",children:[y.jsxs("div",{children:[y.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Balance Projections"}),y.jsx("p",{className:"text-gray-400",children:"Future balance projections based on recurring bills and scheduled transactions"})]}),y.jsxs("div",{className:"flex items-center gap-3 bg-gray-800 rounded-xl px-4 py-3 border border-gray-700",children:[y.jsx("span",{className:"text-sm text-gray-300",children:"Include Recurring Bills"}),y.jsx("button",{onClick:()=>s(!i),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${i?"bg-blue-500":"bg-gray-600"}`,children:y.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${i?"translate-x-6":"translate-x-1"}`})})]})]}),y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[y.jsxs("div",{className:"bg-gradient-to-br from-blue-500/20 to-blue-600/20 rounded-2xl p-6 border border-blue-500/30",children:[y.jsx("h3",{className:"text-sm font-medium text-blue-300 mb-2",children:"Current Balance"}),y.jsxs("p",{className:"text-3xl font-bold text-white",children:["$",t.toFixed(2)]})]}),y.jsxs("div",{className:"bg-gradient-to-br from-green-500/20 to-green-600/20 rounded-2xl p-6 border border-green-500/30",children:[y.jsx("h3",{className:"text-sm font-medium text-green-300 mb-2",children:"Expected Income"}),y.jsxs("p",{className:"text-3xl font-bold text-white",children:["+$",d.toFixed(2)]})]}),y.jsxs("div",{className:"bg-gradient-to-br from-red-500/20 to-red-600/20 rounded-2xl p-6 border border-red-500/30",children:[y.jsx("h3",{className:"text-sm font-medium text-red-300 mb-2",children:"Expected Expenses"}),y.jsxs("p",{className:"text-3xl font-bold text-white",children:["-$",p.toFixed(2)]})]}),y.jsxs("div",{className:`bg-gradient-to-br rounded-2xl p-6 border ${v>=0?"from-purple-500/20 to-purple-600/20 border-purple-500/30":"from-orange-500/20 to-orange-600/20 border-orange-500/30"}`,children:[y.jsx("h3",{className:`text-sm font-medium mb-2 ${v>=0?"text-purple-300":"text-orange-300"}`,children:"Projected End Balance"}),y.jsxs("p",{className:"text-3xl font-bold text-white",children:["$",b.toFixed(2)]}),y.jsxs("p",{className:`text-sm mt-1 ${v>=0?"text-green-400":"text-red-400"}`,children:[v>=0?"+":"",v.toFixed(2)," net change"]})]})]}),l.length===0?y.jsx("div",{className:"bg-gray-800/50 rounded-2xl p-12 border border-gray-700 text-center",children:y.jsx("p",{className:"text-gray-400",children:"No future transactions projected. Add recurring bills to see balance projections."})}):y.jsxs("div",{className:"space-y-4",children:[y.jsx("h3",{className:"text-xl font-semibold text-white",children:"Monthly Breakdown"}),h.map(A=>{const w=u[A],[S,C]=A.split("-"),E=new Date(parseInt(S),parseInt(C)-1).toLocaleDateString("en-US",{month:"long",year:"numeric"}),k=w.filter(L=>L.amount>0).reduce((L,j)=>L+j.amount,0),O=w.filter(L=>L.amount<0).reduce((L,j)=>L+Math.abs(j.amount),0),P=w[0].balance-w[0].amount,z=w[w.length-1].balance;return y.jsxs("div",{className:"bg-gray-800 rounded-2xl p-6 border border-gray-700",children:[y.jsxs("div",{className:"flex justify-between items-center mb-4",children:[y.jsx("h4",{className:"text-lg font-semibold text-white",children:E}),y.jsxs("div",{className:"text-right",children:[y.jsx("p",{className:"text-sm text-gray-400",children:"End Balance"}),y.jsxs("p",{className:"text-2xl font-bold text-white",children:["$",z.toFixed(2)]})]})]}),y.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[y.jsxs("div",{className:"bg-gray-700/50 rounded-xl p-3",children:[y.jsx("p",{className:"text-xs text-gray-400",children:"Start"}),y.jsxs("p",{className:"text-lg font-semibold text-white",children:["$",P.toFixed(2)]})]}),y.jsxs("div",{className:"bg-green-500/20 rounded-xl p-3",children:[y.jsx("p",{className:"text-xs text-green-300",children:"Income"}),y.jsxs("p",{className:"text-lg font-semibold text-white",children:["+$",k.toFixed(2)]})]}),y.jsxs("div",{className:"bg-red-500/20 rounded-xl p-3",children:[y.jsx("p",{className:"text-xs text-red-300",children:"Expenses"}),y.jsxs("p",{className:"text-lg font-semibold text-white",children:["-$",O.toFixed(2)]})]})]}),y.jsx("div",{className:"space-y-2",children:w.map((L,j)=>y.jsxs("div",{className:"flex justify-between items-center bg-gray-700/30 rounded-xl p-3",children:[y.jsxs("div",{className:"flex-1",children:[y.jsx("p",{className:"text-white font-medium",children:L.description}),y.jsxs("p",{className:"text-sm text-gray-400",children:[L.date.toLocaleDateString(),"  ",L.category]})]}),y.jsxs("div",{className:"text-right",children:[y.jsxs("p",{className:`font-semibold ${L.amount<0?"text-red-400":"text-green-400"}`,children:[L.amount<0?"-":"+","$",Math.abs(L.amount).toFixed(2)]}),y.jsxs("p",{className:"text-sm text-gray-400",children:["$",L.balance.toFixed(2)]})]})]},j))})]},A)})]})]})},sA=({debts:g,onAddDebt:t,onUpdateDebt:i,onDeleteDebt:s})=>{const[a,o]=mt.useState(!1),[l,u]=mt.useState(null),h=g.reduce((b,v)=>b+v.currentBalance,0),d=g.reduce((b,v)=>b+v.minimumPayment,0),p=g.length>0?g.reduce((b,v)=>b+v.interestRate*v.currentBalance,0)/h:0;return y.jsxs("div",{className:"space-y-6",children:[y.jsxs("div",{className:"flex justify-between items-center",children:[y.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Debts & Credit Cards"}),y.jsx("button",{onClick:()=>o(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"+ Add Debt"})]}),y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[y.jsxs("div",{className:"bg-red-50 rounded-lg p-6 border border-red-200",children:[y.jsx("h3",{className:"text-sm font-medium text-red-900 mb-2",children:"Total Debt"}),y.jsxs("p",{className:"text-3xl font-bold text-red-600",children:["$",h.toFixed(2)]})]}),y.jsxs("div",{className:"bg-orange-50 rounded-lg p-6 border border-orange-200",children:[y.jsx("h3",{className:"text-sm font-medium text-orange-900 mb-2",children:"Total Min. Payment"}),y.jsxs("p",{className:"text-3xl font-bold text-orange-600",children:["$",d.toFixed(2)]})]}),y.jsxs("div",{className:"bg-purple-50 rounded-lg p-6 border border-purple-200",children:[y.jsx("h3",{className:"text-sm font-medium text-purple-900 mb-2",children:"Avg. Interest Rate"}),y.jsxs("p",{className:"text-3xl font-bold text-purple-600",children:[isNaN(p)?"0.00":p.toFixed(2),"%"]})]})]}),g.length===0?y.jsx("div",{className:"bg-white rounded-lg shadow p-8 text-center",children:y.jsx("p",{className:"text-gray-500",children:"No debts tracked. Add one to start managing your debt."})}):y.jsx("div",{className:"space-y-4",children:g.map(b=>y.jsx(aA,{debt:b,onEdit:()=>u(b),onDelete:()=>s(b.id)},b.id))}),(a||l)&&y.jsx(rA,{debt:l,onSave:b=>{l?(i({...b,id:l.id}),u(null)):(t(b),o(!1))},onCancel:()=>{o(!1),u(null)}})]})},aA=({debt:g,onEdit:t,onDelete:i})=>{const s=o=>({credit_card:"Credit Card",loan:"Loan",mortgage:"Mortgage",student_loan:"Student Loan",other:"Other"})[o],a=o=>({credit_card:"bg-red-100 text-red-800",loan:"bg-orange-100 text-orange-800",mortgage:"bg-blue-100 text-blue-800",student_loan:"bg-purple-100 text-purple-800",other:"bg-gray-100 text-gray-800"})[o];return y.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[y.jsxs("div",{className:"flex justify-between items-start mb-4",children:[y.jsxs("div",{children:[y.jsx("h3",{className:"text-xl font-bold text-gray-900",children:g.name}),y.jsx("span",{className:`inline-block px-2 py-1 text-xs rounded mt-2 ${a(g.type)}`,children:s(g.type)})]}),y.jsxs("div",{className:"text-right",children:[y.jsx("p",{className:"text-sm text-gray-600",children:"Current Balance"}),y.jsxs("p",{className:"text-3xl font-bold text-red-600",children:["$",g.currentBalance.toFixed(2)]})]})]}),y.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[y.jsxs("div",{children:[y.jsx("p",{className:"text-sm text-gray-600",children:"Interest Rate"}),y.jsxs("p",{className:"text-lg font-semibold text-gray-900",children:[g.interestRate.toFixed(2),"%"]})]}),y.jsxs("div",{children:[y.jsx("p",{className:"text-sm text-gray-600",children:"Min. Payment"}),y.jsxs("p",{className:"text-lg font-semibold text-gray-900",children:["$",g.minimumPayment.toFixed(2)]})]}),g.dueDate&&y.jsxs("div",{children:[y.jsx("p",{className:"text-sm text-gray-600",children:"Due Day"}),y.jsx("p",{className:"text-lg font-semibold text-gray-900",children:g.dueDate})]}),g.institution&&y.jsxs("div",{children:[y.jsx("p",{className:"text-sm text-gray-600",children:"Institution"}),y.jsx("p",{className:"text-lg font-semibold text-gray-900",children:g.institution})]})]}),y.jsxs("div",{className:"flex gap-2",children:[y.jsx("button",{onClick:t,className:"flex-1 px-4 py-2 bg-blue-100 text-blue-700 rounded hover:bg-blue-200 transition-colors",children:"Edit"}),y.jsx("button",{onClick:()=>{confirm(`Are you sure you want to delete ${g.name}?`)&&i()},className:"px-4 py-2 bg-red-100 text-red-700 rounded hover:bg-red-200 transition-colors",children:"Delete"})]})]})},rA=({debt:g,onSave:t,onCancel:i})=>{const[s,a]=mt.useState({name:g?.name||"",type:g?.type||"credit_card",currentBalance:g?.currentBalance.toString()||"",interestRate:g?.interestRate.toString()||"",minimumPayment:g?.minimumPayment.toString()||"",dueDate:g?.dueDate?.toString()||"",institution:g?.institution||""}),o=l=>{l.preventDefault(),t({name:s.name,type:s.type,currentBalance:parseFloat(s.currentBalance),interestRate:parseFloat(s.interestRate),minimumPayment:parseFloat(s.minimumPayment),dueDate:s.dueDate?parseInt(s.dueDate):void 0,institution:s.institution||void 0})};return y.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:y.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md max-h-[90vh] overflow-y-auto",children:[y.jsxs("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:[g?"Edit":"Add"," Debt"]}),y.jsxs("form",{onSubmit:o,className:"space-y-4",children:[y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),y.jsx("input",{type:"text",value:s.name,onChange:l=>a({...s,name:l.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Chase Freedom",required:!0})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Type"}),y.jsxs("select",{value:s.type,onChange:l=>a({...s,type:l.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[y.jsx("option",{value:"credit_card",children:"Credit Card"}),y.jsx("option",{value:"loan",children:"Loan"}),y.jsx("option",{value:"mortgage",children:"Mortgage"}),y.jsx("option",{value:"student_loan",children:"Student Loan"}),y.jsx("option",{value:"other",children:"Other"})]})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Balance"}),y.jsx("input",{type:"number",step:"0.01",value:s.currentBalance,onChange:l=>a({...s,currentBalance:l.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"5000.00",required:!0})]}),y.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Interest Rate (%)"}),y.jsx("input",{type:"number",step:"0.01",value:s.interestRate,onChange:l=>a({...s,interestRate:l.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"18.99",required:!0})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Min. Payment"}),y.jsx("input",{type:"number",step:"0.01",value:s.minimumPayment,onChange:l=>a({...s,minimumPayment:l.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"100.00",required:!0})]})]}),y.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Due Day (1-31)"}),y.jsx("input",{type:"number",min:"1",max:"31",value:s.dueDate,onChange:l=>a({...s,dueDate:l.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"15"})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Institution"}),y.jsx("input",{type:"text",value:s.institution,onChange:l=>a({...s,institution:l.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Chase"})]})]}),y.jsxs("div",{className:"flex gap-3 pt-4",children:[y.jsxs("button",{type:"submit",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[g?"Update":"Add"," Debt"]}),y.jsx("button",{type:"button",onClick:i,className:"flex-1 px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition-colors",children:"Cancel"})]})]})]})})},Hm="finance-data.json",qm=g=>({...g,transactions:g.transactions.map(t=>({...t,date:new Date(t.date)})),recurringBills:g.recurringBills.map(t=>({...t,nextDueDate:new Date(t.nextDueDate)}))}),Gm=()=>"showDirectoryPicker"in window,oA=async()=>{if(!Gm())return alert("File System Access API is not supported in this browser. Please use Safari, Chrome, or Edge."),null;try{return await window.showDirectoryPicker()}catch(g){return g.name!=="AbortError"&&(console.error("Error selecting folder:",g),alert("Failed to select folder. Please try again.")),null}},lA=async(g,t)=>{try{if(await g.queryPermission({mode:"readwrite"})!=="granted"&&await g.requestPermission({mode:"readwrite"})!=="granted")return alert("Permission denied. Please grant access to save data."),!1;const a=await(await g.getFileHandle(Hm,{create:!0})).createWritable(),o={...t,lastModified:new Date().toISOString()};return await a.write(JSON.stringify(o,null,2)),await a.close(),console.log("Data saved to iCloud Drive"),!0}catch(i){return console.error("Error saving to iCloud:",i),alert("Failed to save data to iCloud Drive. Please try again."),!1}},am=async g=>{try{if(await g.queryPermission({mode:"read"})!=="granted"&&await g.requestPermission({mode:"read"})!=="granted")return alert("Permission denied. Please grant access to load data."),null;const a=await(await(await g.getFileHandle(Hm)).getFile()).text(),o=JSON.parse(a);return qm(o)}catch(t){return t.name==="NotFoundError"?(console.log("No existing data file found, will create on first save"),null):(console.error("Error loading from iCloud:",t),alert("Failed to load data from iCloud Drive."),null)}},cA=g=>{const t={...g,lastModified:new Date().toISOString()},i=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),s=URL.createObjectURL(i),a=document.createElement("a");a.href=s,a.download=`finance-data-${new Date().toISOString().split("T")[0]}.json`,a.click(),URL.revokeObjectURL(s)},uA=()=>new Promise(g=>{const t=document.createElement("input");t.type="file",t.accept="application/json",t.onchange=async i=>{const s=i.target.files?.[0];if(!s){g(null);return}try{const a=await s.text(),o=JSON.parse(a);g(qm(o))}catch(a){console.error("Error importing data:",a),alert("Failed to import data. Please check the file format."),g(null)}},t.click()}),hA=({transactions:g,accounts:t,activeAccountId:i,recurringBills:s,debts:a,onDataLoaded:o})=>{const[l,u]=mt.useState(null),[h,d]=mt.useState(!1),p=Gm(),b=async()=>{const C=await oA();if(C){u(C);const E=await am(C);E&&confirm("Found existing data in this folder. Load it? This will replace your current data.")&&o({transactions:E.transactions,accounts:E.accounts||(E.account?[E.account]:[]),activeAccountId:E.activeAccountId||E.account?.id||"",recurringBills:E.recurringBills,debts:E.debts})}},v=async()=>{if(!l){alert("Please select an iCloud Drive folder first.");return}d(!0);const C=await lA(l,{transactions:g,accounts:t,activeAccountId:i,recurringBills:s,debts:a,lastModified:new Date().toISOString()});d(!1),C&&alert("Data synced to iCloud Drive successfully!")},A=async()=>{if(!l){alert("Please select an iCloud Drive folder first.");return}d(!0);const C=await am(l);d(!1),C&&confirm("This will replace your current data with data from iCloud. Continue?")&&(o({transactions:C.transactions,accounts:C.accounts||(C.account?[C.account]:[]),activeAccountId:C.activeAccountId||C.account?.id||"",recurringBills:C.recurringBills,debts:C.debts}),alert("Data loaded from iCloud Drive successfully!"))},w=()=>{cA({transactions:g,accounts:t,activeAccountId:i,recurringBills:s,debts:a,lastModified:new Date().toISOString()})},S=async()=>{const C=await uA();C&&confirm("This will replace your current data with data from the file. Continue?")&&(o({transactions:C.transactions,accounts:C.accounts||(C.account?[C.account]:[]),activeAccountId:C.activeAccountId||C.account?.id||"",recurringBills:C.recurringBills,debts:C.debts}),alert("Data imported successfully!"))};return y.jsxs("div",{className:"space-y-6",children:[y.jsxs("div",{children:[y.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"iCloud Drive Sync"}),y.jsx("p",{className:"text-gray-400",children:"Sync your financial data to a shared iCloud Drive folder accessible by your Apple Family"})]}),p?y.jsxs("div",{className:"bg-gradient-to-br from-blue-500/20 to-blue-600/20 rounded-2xl p-6 border border-blue-500/30",children:[y.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[y.jsx("svg",{className:"w-8 h-8 text-blue-400",fill:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{d:"M19.35 10.04A7.49 7.49 0 0 0 12 4C9.11 4 6.6 5.64 5.35 8.04A5.994 5.994 0 0 0 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96z"})}),y.jsxs("div",{children:[y.jsx("h3",{className:"text-lg font-semibold text-white",children:"iCloud Drive Integration"}),y.jsx("p",{className:"text-sm text-gray-400",children:l?`Connected to: ${l.name}`:"Not connected"})]})]}),y.jsx("div",{className:"space-y-3",children:l?y.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[y.jsx("button",{onClick:v,disabled:h,className:"px-4 py-3 bg-green-500 text-white rounded-xl hover:bg-green-600 transition-all font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:h?"Syncing...":"Save to iCloud"}),y.jsx("button",{onClick:A,disabled:h,className:"px-4 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-all font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:h?"Loading...":"Load from iCloud"}),y.jsx("button",{onClick:b,className:"col-span-2 px-4 py-2 bg-gray-700 text-gray-300 rounded-xl hover:bg-gray-600 transition-all",children:"Change Folder"})]}):y.jsx("button",{onClick:b,className:"w-full px-4 py-3 bg-gradient-to-r from-blue-500 to-purple-500 text-white rounded-xl hover:from-blue-600 hover:to-purple-600 transition-all font-medium",children:"Select iCloud Drive Folder"})}),y.jsx("div",{className:"mt-4 p-4 bg-blue-500/10 rounded-xl border border-blue-500/20",children:y.jsxs("p",{className:"text-xs text-blue-300",children:[y.jsx("strong",{children:"Tip:"})," Create a shared folder in iCloud Drive, share it with your family member, and both select the same folder. Changes will sync automatically via iCloud."]})})]}):y.jsxs("div",{className:"bg-yellow-500/20 rounded-2xl p-6 border border-yellow-500/30",children:[y.jsx("h3",{className:"text-lg font-semibold text-yellow-300 mb-2",children:"Browser Not Supported"}),y.jsx("p",{className:"text-sm text-yellow-200",children:"Your browser doesn't support File System Access API. Please use Safari, Chrome, or Edge for iCloud Drive integration, or use the manual export/import below."})]}),y.jsxs("div",{className:"bg-gray-800 rounded-2xl p-6 border border-gray-700",children:[y.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Manual Backup"}),y.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"Export your data to a file and save it to iCloud Drive manually, or import from a file."}),y.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[y.jsx("button",{onClick:w,className:"px-4 py-3 bg-gradient-to-r from-green-500 to-emerald-500 text-white rounded-xl hover:from-green-600 hover:to-emerald-600 transition-all font-medium",children:"Export Data"}),y.jsx("button",{onClick:S,className:"px-4 py-3 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-xl hover:from-purple-600 hover:to-pink-600 transition-all font-medium",children:"Import Data"})]})]}),y.jsxs("div",{className:"bg-gray-800/50 rounded-2xl p-6 border border-gray-700",children:[y.jsx("h3",{className:"text-lg font-semibold text-white mb-3",children:"Setup Instructions"}),y.jsxs("ol",{className:"text-sm text-gray-300 space-y-2 list-decimal list-inside",children:[y.jsx("li",{children:'Create a new folder in your iCloud Drive (e.g., "Family Finances")'}),y.jsx("li",{children:'Right-click the folder and select "Share"  Add your family member'}),y.jsx("li",{children:'Both of you click "Select iCloud Drive Folder" and choose the same folder'}),y.jsx("li",{children:"The first person saves data to iCloud"}),y.jsx("li",{children:"The second person loads the data from iCloud"}),y.jsx("li",{children:'From then on, click "Save to iCloud" after making changes'}),y.jsx("li",{children:'Click "Load from iCloud" to get the latest data'})]})]})]})},dA=({accounts:g,activeAccountId:t,onSelectAccount:i,onManageAccounts:s})=>{const a=g.find(u=>u.id===t),o=u=>{switch(u){case"checking":return"";case"savings":return"";case"credit_card":return"";default:return""}},l=u=>{switch(u){case"checking":return"Checking";case"savings":return"Savings";case"credit_card":return"Credit Card";default:return"Account"}};return y.jsxs("div",{className:"flex items-center gap-4",children:[y.jsxs("div",{className:"relative",children:[y.jsx("select",{value:t,onChange:u=>i(u.target.value),className:"appearance-none bg-gray-800 text-white border border-gray-700 rounded-2xl px-6 py-3 pr-12 font-medium hover:bg-gray-700 transition-colors cursor-pointer focus:outline-none focus:ring-2 focus:ring-blue-500",children:g.map(u=>y.jsxs("option",{value:u.id,children:[o(u.accountType)," ",u.name," ( ",u.accountNumber.slice(-4),")"]},u.id))}),y.jsx("div",{className:"absolute right-4 top-1/2 -translate-y-1/2 pointer-events-none text-gray-400",children:""})]}),a&&y.jsx("div",{className:"flex items-center gap-6",children:y.jsxs("div",{className:"text-sm",children:[y.jsx("span",{className:"text-gray-400",children:l(a.accountType)}),a.accountType==="credit_card"&&a.creditLimit&&y.jsxs("span",{className:"text-gray-500 ml-2",children:["Limit: $",a.creditLimit.toLocaleString()]})]})}),y.jsx("button",{onClick:s,className:"px-4 py-2 bg-gray-700 text-white rounded-xl hover:bg-gray-600 transition-colors text-sm font-medium",title:"Manage accounts",children:"Manage Accounts"})]})},ti={TRANSACTIONS:"usaa_bills_transactions",ACCOUNT:"usaa_bills_account",ACCOUNTS:"usaa_bills_accounts",RECURRING_BILLS:"usaa_bills_recurring",DEBTS:"usaa_bills_debts",ACTIVE_ACCOUNT_ID:"usaa_bills_active_account",DISMISSED_PROJECTIONS:"usaa_bills_dismissed_projections"},Vm=g=>{localStorage.setItem(ti.TRANSACTIONS,JSON.stringify(g))},Ym=()=>{const g=localStorage.getItem(ti.TRANSACTIONS);return g?JSON.parse(g).map(i=>({...i,date:new Date(i.date)})):[]},ih=g=>{localStorage.setItem(ti.ACCOUNTS,JSON.stringify(g))},fA=()=>{const g=localStorage.getItem(ti.ACCOUNTS);return g?JSON.parse(g):[]},nh=g=>{localStorage.setItem(ti.ACTIVE_ACCOUNT_ID,g)},gA=()=>localStorage.getItem(ti.ACTIVE_ACCOUNT_ID),pA=()=>{const g=localStorage.getItem(ti.ACCOUNT);return g?JSON.parse(g):null},Xm=g=>{localStorage.setItem(ti.RECURRING_BILLS,JSON.stringify(g))},$m=()=>{const g=localStorage.getItem(ti.RECURRING_BILLS);return g?JSON.parse(g).map(i=>({...i,nextDueDate:new Date(i.nextDueDate)})):[]},mA=g=>{localStorage.setItem(ti.DEBTS,JSON.stringify(g))},bA=()=>{const g=localStorage.getItem(ti.DEBTS);return g?JSON.parse(g):[]},yA=()=>({id:"bills-account",name:"USAA Bills",accountType:"checking",accountNumber:"0165700823",routingNumber:"314074269",availableBalance:2969.86,institution:"USAA",isDefault:!0}),vA=()=>{const g=pA(),t=fA();if(t.length>0)return t;if(g){const a={...g,accountType:g.accountType||"checking",isDefault:!0},o=[a];return ih(o),nh(a.id),xA(a.id),AA(a.id),o}const i=yA(),s=[i];return ih(s),nh(i.id),s},xA=g=>{const i=Ym().map(s=>({...s,accountId:s.accountId||g}));Vm(i)},AA=g=>{const i=$m().map(s=>({...s,accountId:s.accountId||g}));Xm(i)},SA=g=>{localStorage.setItem(ti.DISMISSED_PROJECTIONS,JSON.stringify(Array.from(g)))},wA=()=>{const g=localStorage.getItem(ti.DISMISSED_PROJECTIONS);if(!g)return new Set;try{return new Set(JSON.parse(g))}catch{return new Set}},_A=()=>{Object.values(ti).forEach(g=>localStorage.removeItem(g))},EA=({accounts:g,onAddAccount:t,onUpdateAccount:i,onDeleteAccount:s,onClose:a})=>{const[o,l]=mt.useState(!1),[u,h]=mt.useState(null),[d,p]=mt.useState({name:"",accountType:"checking",accountNumber:"",routingNumber:"",institution:"",availableBalance:0,creditLimit:void 0}),b=()=>{p({name:"",accountType:"checking",accountNumber:"",routingNumber:"",institution:"",availableBalance:0,creditLimit:void 0}),h(null),l(!1)},v=S=>{h(S),p({name:S.name,accountType:S.accountType,accountNumber:S.accountNumber,routingNumber:S.routingNumber||"",institution:S.institution,availableBalance:S.availableBalance,creditLimit:S.creditLimit}),l(!0)},A=S=>{S.preventDefault(),u?i({...u,...d,routingNumber:d.accountType==="credit_card"?void 0:d.routingNumber,creditLimit:d.accountType==="credit_card"?d.creditLimit:void 0}):t({...d,routingNumber:d.accountType==="credit_card"?void 0:d.routingNumber,creditLimit:d.accountType==="credit_card"?d.creditLimit:void 0}),b()},w=S=>{switch(S){case"checking":return"Checking";case"savings":return"Savings";case"credit_card":return"Credit Card";default:return S}};return y.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:y.jsxs("div",{className:"bg-gray-800 rounded-3xl p-8 max-w-5xl w-full max-h-[90vh] overflow-y-auto border border-gray-700",children:[y.jsxs("div",{className:"flex justify-between items-center mb-6",children:[y.jsx("h2",{className:"text-2xl font-bold text-white",children:"Manage Accounts"}),y.jsx("button",{onClick:a,className:"text-gray-400 hover:text-white text-2xl",children:""})]}),y.jsxs("div",{className:"mb-8",children:[y.jsxs("div",{className:"flex justify-between items-center mb-4",children:[y.jsx("h3",{className:"text-lg font-semibold text-white",children:"Your Accounts"}),y.jsx("button",{onClick:()=>{confirm(` WARNING: This will delete ALL data including accounts, transactions, recurring bills, and debts. This cannot be undone!

Are you absolutely sure?`)&&confirm("This is your final warning. Click OK to permanently delete everything.")&&(_A(),window.location.reload())},className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors text-sm font-medium",title:"Delete all data and start fresh",children:" Clear All Data"})]}),y.jsx("div",{className:"space-y-3",children:g.map(S=>y.jsxs("div",{className:"bg-gray-700/50 rounded-2xl p-4 flex justify-between items-center",children:[y.jsxs("div",{children:[y.jsxs("div",{className:"flex items-center gap-3",children:[y.jsx("h4",{className:"text-white font-semibold",children:S.name}),y.jsx("span",{className:"px-2 py-1 bg-blue-500/20 text-blue-300 rounded-lg text-xs",children:w(S.accountType)}),S.isDefault&&y.jsx("span",{className:"px-2 py-1 bg-green-500/20 text-green-300 rounded-lg text-xs",children:"Default"})]}),y.jsxs("div",{className:"text-sm text-gray-400 mt-1",children:[S.institution,"  ",S.accountNumber.slice(-4)]}),y.jsxs("div",{className:"text-lg font-semibold text-white mt-2",children:["$",S.availableBalance.toLocaleString("en-US",{minimumFractionDigits:2}),S.accountType==="credit_card"&&S.creditLimit&&y.jsxs("span",{className:"text-sm text-gray-400 ml-2",children:["/ $",S.creditLimit.toLocaleString()]})]})]}),y.jsxs("div",{className:"flex gap-2",children:[y.jsx("button",{onClick:()=>v(S),className:"px-4 py-2 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors text-sm",children:"Edit"}),g.length>1&&y.jsx("button",{onClick:()=>{confirm(`Delete ${S.name}? This will remove all transactions for this account.`)&&s(S.id)},className:"px-4 py-2 bg-red-500 text-white rounded-xl hover:bg-red-600 transition-colors text-sm",children:"Delete"})]})]},S.id))})]}),o?y.jsxs("form",{onSubmit:A,className:"bg-gray-700/30 rounded-2xl p-6 space-y-4",children:[y.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:u?"Edit Account":"Add New Account"}),y.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Account Name"}),y.jsx("input",{type:"text",value:d.name,onChange:S=>p({...d,name:S.target.value}),required:!0,className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-xl text-white",placeholder:"My Checking"})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Account Type"}),y.jsxs("select",{value:d.accountType,onChange:S=>p({...d,accountType:S.target.value}),className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-xl text-white",children:[y.jsx("option",{value:"checking",children:"Checking"}),y.jsx("option",{value:"savings",children:"Savings"}),y.jsx("option",{value:"credit_card",children:"Credit Card"})]})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Institution"}),y.jsx("input",{type:"text",value:d.institution,onChange:S=>p({...d,institution:S.target.value}),required:!0,className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-xl text-white",placeholder:"USAA"})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Account Number"}),y.jsx("input",{type:"text",value:d.accountNumber,onChange:S=>p({...d,accountNumber:S.target.value}),required:!0,className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-xl text-white",placeholder:"0165700823"})]}),d.accountType!=="credit_card"&&y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Routing Number"}),y.jsx("input",{type:"text",value:d.routingNumber,onChange:S=>p({...d,routingNumber:S.target.value}),className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-xl text-white",placeholder:"314074269"})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:d.accountType==="credit_card"?"Current Balance":"Available Balance"}),y.jsx("input",{type:"number",step:"0.01",value:d.availableBalance,onChange:S=>p({...d,availableBalance:parseFloat(S.target.value)}),required:!0,className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-xl text-white",placeholder:"0.00"})]}),d.accountType==="credit_card"&&y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Credit Limit"}),y.jsx("input",{type:"number",step:"0.01",value:d.creditLimit||"",onChange:S=>p({...d,creditLimit:S.target.value?parseFloat(S.target.value):void 0}),className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-xl text-white",placeholder:"5000.00"})]})]}),y.jsxs("div",{className:"flex gap-4 mt-6",children:[y.jsx("button",{type:"submit",className:"px-6 py-3 bg-green-500 text-white rounded-xl hover:bg-green-600 transition-colors font-semibold",children:u?"Save Changes":"Add Account"}),y.jsx("button",{type:"button",onClick:b,className:"px-6 py-3 bg-gray-600 text-white rounded-xl hover:bg-gray-500 transition-colors font-semibold",children:"Cancel"})]})]}):y.jsx("button",{onClick:()=>l(!0),className:"w-full px-6 py-3 bg-gradient-to-r from-blue-500 to-purple-500 text-white rounded-2xl font-semibold hover:from-blue-600 hover:to-purple-600 transition-all",children:"+ Add New Account"})]})})},CA=(g,t=60)=>{const i=[],s=Cy();return s.setDate(s.getDate()+t),g.filter(a=>a.isActive).forEach(a=>{let o=new Date(a.nextDueDate);for(;o<=s;)i.push({id:`proj-${a.id}-${o.getTime()}`,date:new Date(o),description:`${a.description} (Projected)`,category:a.category,amount:a.amount,balance:0,isPending:!0,isManual:!1}),o=TA(o,a.frequency,a.dayOfMonth,a.dayOfWeek)}),i.sort((a,o)=>a.date.getTime()-o.date.getTime())},TA=(g,t,i,s)=>{const a=new Date(g);switch(t){case"weekly":a.setDate(a.getDate()+7);break;case"biweekly":a.setDate(a.getDate()+14);break;case"monthly":a.setMonth(a.getMonth()+1),i&&a.setDate(i);break;case"yearly":a.setFullYear(a.getFullYear()+1);break}return a},rm=(g,t=0)=>{if(g.length===0)return[];const i=[...g].sort((u,h)=>u.date.getTime()-h.date.getTime());let s=-1;for(let u=i.length-1;u>=0;u--)if(!i[u].description.includes("(Projected)")&&i[u].isReconciled){s=u;break}let a=s;if(a===-1){for(let u=i.length-1;u>=0;u--)if(!i[u].description.includes("(Projected)")){a=u;break}}if(a===-1){const u=[];let h=t;for(let d=0;d<i.length;d++)i[d].isProjectedVisible!==!1&&(h+=i[d].amount,h=Math.round(h*100)/100),u.push({...i[d],balance:h});return u}const o=new Array(i.length);let l=t;o[a]={...i[a],balance:l};for(let u=a-1;u>=0;u--)i[u].isProjectedVisible!==!1&&(l-=i[u].amount,l=Math.round(l*100)/100),o[u]={...i[u],balance:l};l=t;for(let u=a+1;u<i.length;u++)i[u].isProjectedVisible!==!1&&(l+=i[u].amount,l=Math.round(l*100)/100),o[u]={...i[u],balance:l};return o};function DA(){const[g,t]=mt.useState("account"),[i,s]=mt.useState([]),[a,o]=mt.useState([]),[l,u]=mt.useState(""),[h,d]=mt.useState([]),[p,b]=mt.useState([]),[v,A]=mt.useState(!0),[w,S]=mt.useState(new Set),[C,E]=mt.useState(new Map),[k,O]=mt.useState(new Map),[P,z]=mt.useState(!1);mt.useEffect(()=>{const X=Ym(),st=vA(),lt=gA(),Rt=$m(),Gt=bA(),St=wA();s(X),o(st),u(lt||st[0]?.id||""),d(Rt),b(Gt),S(St)},[]),mt.useEffect(()=>{i.length>0&&Vm(i)},[i]),mt.useEffect(()=>{a.length>0&&ih(a)},[a]),mt.useEffect(()=>{l&&nh(l)},[l]),mt.useEffect(()=>{h.length>0&&Xm(h)},[h]),mt.useEffect(()=>{p.length>0&&mA(p)},[p]),mt.useEffect(()=>{SA(w)},[w]);const L=a.find(X=>X.id===l)||null,j=i.filter(X=>X.accountId===l),D=h.filter(X=>X.accountId===l),N=X=>{u(X)},U=X=>{const st={...X,id:`account-${Date.now()}`};o([...a,st])},$=X=>{o(a.map(st=>st.id===X.id?X:st))},tt=X=>{s(i.filter(lt=>lt.accountId!==X)),d(h.filter(lt=>lt.accountId!==X));const st=a.filter(lt=>lt.id!==X);o(st),l===X&&st.length>0&&u(st[0].id)},at=(X,st)=>{if(!l)return;let lt=0,Rt=0,Gt=0;const St=[...i];if(X.transactions.forEach(Lt=>{const wt={...Lt,accountId:l},je=St.findIndex(oe=>oe.id===wt.id),_t=St.findIndex(oe=>oe.accountId===l&&oe.date.toDateString()===wt.date.toDateString()&&oe.description===wt.description&&Math.abs(oe.amount-wt.amount)<.01),Ht=je!==-1?je:_t;if(Ht!==-1){const oe=St[Ht];oe.isManual?(St[Ht]={...wt,isReconciled:oe.isReconciled},Rt++):Gt++}else St.push(wt),lt++}),s(St),st!==void 0&&L){const Lt={...L,availableBalance:st};$(Lt)}if(X.errors.length>0)alert(`Import completed with ${X.errors.length} errors. Check console for details.`),console.error("Import errors:",X.errors);else{const Lt=st!==void 0?`
Balance updated to: $${st.toFixed(2)}`:"";alert(`Import complete!
New: ${lt}
Updated: ${Rt}
Skipped: ${Gt}${Lt}`)}},gt=X=>{if(!l)return;const st={...X,id:`manual-${Date.now()}`,accountId:l};s([...i,st])},bt=X=>{s(i.filter(st=>st.id!==X))},F=X=>{if(X.id.startsWith("proj-")){const st=new Map(C);st.set(X.id,X.isProjectedVisible!==!1),E(st);const lt=new Map(k);lt.set(X.id,{isReconciled:X.isReconciled,isPending:X.isPending,isProjectedVisible:X.isProjectedVisible}),O(lt)}else s(i.map(st=>st.id===X.id?X:st))},q=X=>{S(new Set([...w,X]))},et=X=>{if(!l)return;const st={...X,id:`bill-${Date.now()}`,accountId:l};d([...h,st])},it=X=>{d(h.map(st=>st.id===X.id?X:st))},ut=X=>{d(h.filter(st=>st.id!==X))},M=X=>{const st={...X,id:`debt-${Date.now()}`};b([...p,st])},H=X=>{b(p.map(st=>st.id===X.id?X:st))},T=X=>{b(p.filter(st=>st.id!==X))},Q=X=>{s(X.transactions),o(X.accounts),u(X.activeAccountId),d(X.recurringBills),b(X.debts)},nt=()=>{if(!L)return;const X=prompt(`Enter the current balance shown in your bank's app:

Current calculated balance: $${ot.toFixed(2)}

This will update the account balance and recalculate all transaction balances.`);if(X===null)return;const st=parseFloat(X.replace(/[$,]/g,""));if(isNaN(st)){alert("Please enter a valid balance amount");return}const lt={...L,availableBalance:st};$(lt),alert(`Balance updated to $${st.toFixed(2)}
All transaction balances have been recalculated.`)},rt=v&&L?rm([...j,...CA(D,60).filter(X=>{if(w.has(X.id))return!1;const st=X.date.toDateString(),lt=X.description.replace(" (Projected)","");return!j.some(Rt=>Rt.date.toDateString()===st&&Rt.description.toLowerCase()===lt.toLowerCase())}).map(X=>{const st=k.get(X.id);return{...X,isProjectedVisible:st?.isProjectedVisible!==void 0?st.isProjectedVisible:C.has(X.id)?C.get(X.id):!0,isReconciled:st?.isReconciled||!1,isPending:st?.isPending!==void 0?st.isPending:!0}})],L.availableBalance):rm(j,L?.availableBalance||0),ot=(()=>{const X=rt.filter(st=>!st.description.includes("(Projected)"));return X.length===0?L?.availableBalance||0:X[X.length-1].balance})(),ft=rt.length>0?rt[rt.length-1].balance:L?.availableBalance||0;return y.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900",children:[y.jsx("div",{className:"sticky top-0 z-50 bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 pt-3 pb-2",children:y.jsx("div",{className:"max-w-7xl mx-auto px-3",children:y.jsxs("div",{className:"bg-gradient-to-br from-gray-800 to-gray-900 rounded-2xl shadow-xl p-4 border border-gray-700",children:[y.jsx("div",{className:"mb-3",children:y.jsx(dA,{accounts:a,activeAccountId:l,onSelectAccount:N,onManageAccounts:()=>z(!0)})}),y.jsxs("div",{className:"flex justify-between items-start",children:[y.jsxs("div",{children:[y.jsx("h1",{className:"text-xl font-bold text-white",children:L?.name||"No Account"}),y.jsxs("p",{className:"text-gray-400 text-xs mt-1 flex items-center gap-1",children:[y.jsx("span",{className:"inline-block w-1.5 h-1.5 rounded-full bg-green-400"}),L?.institution,"  ",L?.accountNumber.slice(-4)]})]}),y.jsxs("div",{className:"flex items-center gap-3",children:[y.jsx("button",{onClick:nt,className:"px-3 py-1.5 bg-gradient-to-r from-blue-500 to-purple-500 text-white rounded-lg hover:from-blue-600 hover:to-purple-600 transition-all font-medium text-sm",title:"Adjust balance to match your bank",children:"Adjust Balance"}),y.jsxs("div",{className:"text-right bg-gradient-to-br from-blue-500/20 to-purple-500/20 px-4 py-2 rounded-xl border border-blue-500/30",children:[y.jsx("p",{className:"text-xs text-gray-400 mb-0.5",children:L?.accountType==="credit_card"?"Balance":"Current Balance"}),y.jsxs("p",{className:"text-2xl font-bold text-white",children:["$",ot.toFixed(2)]}),L?.accountType==="credit_card"&&L?.creditLimit&&y.jsxs("p",{className:"text-[10px] text-gray-400 mt-0.5",children:["Limit: $",L.creditLimit.toLocaleString()]})]})]})]})]})})}),y.jsxs("div",{className:"max-w-7xl mx-auto px-3 pb-5",children:[y.jsxs("div",{className:"bg-gray-800 rounded-2xl shadow-xl mb-4 border border-gray-700",children:[y.jsxs("nav",{className:"flex gap-1.5 p-2",children:[y.jsx("button",{onClick:()=>t("account"),className:`px-4 py-2 text-sm font-medium rounded-xl transition-all ${g==="account"?"bg-gradient-to-r from-blue-500 to-purple-500 text-white shadow-lg":"text-gray-400 hover:text-white hover:bg-gray-700"}`,children:"Account Info"}),y.jsx("button",{onClick:()=>t("register"),className:`px-4 py-2 text-sm font-medium rounded-xl transition-all ${g==="register"?"bg-gradient-to-r from-blue-500 to-purple-500 text-white shadow-lg":"text-gray-400 hover:text-white hover:bg-gray-700"}`,children:"Transactions"}),y.jsx("button",{onClick:()=>t("recurring"),className:`px-4 py-2 text-sm font-medium rounded-xl transition-all ${g==="recurring"?"bg-gradient-to-r from-blue-500 to-purple-500 text-white shadow-lg":"text-gray-400 hover:text-white hover:bg-gray-700"}`,children:"Recurring Bills"}),y.jsx("button",{onClick:()=>t("projections"),className:`px-4 py-2 text-sm font-medium rounded-xl transition-all ${g==="projections"?"bg-gradient-to-r from-blue-500 to-purple-500 text-white shadow-lg":"text-gray-400 hover:text-white hover:bg-gray-700"}`,children:"Projections"}),y.jsx("button",{onClick:()=>t("debts"),className:`px-4 py-2 text-sm font-medium rounded-xl transition-all ${g==="debts"?"bg-gradient-to-r from-blue-500 to-purple-500 text-white shadow-lg":"text-gray-400 hover:text-white hover:bg-gray-700"}`,children:"Debts"}),y.jsx("button",{onClick:()=>t("sync"),className:`px-4 py-2 text-sm font-medium rounded-xl transition-all ${g==="sync"?"bg-gradient-to-r from-blue-500 to-purple-500 text-white shadow-lg":"text-gray-400 hover:text-white hover:bg-gray-700"}`,children:"iCloud Sync"})]}),y.jsxs("div",{className:"p-4",children:[g==="account"&&y.jsxs("div",{className:"space-y-6",children:[y.jsx("h2",{className:"text-2xl font-bold text-white",children:"Account Information"}),y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[y.jsxs("div",{className:"bg-gradient-to-br from-blue-500/20 to-blue-600/20 rounded-2xl p-6 border border-blue-500/30 backdrop-blur-sm",children:[y.jsx("h3",{className:"text-sm font-medium text-blue-300 mb-2",children:"Current Balance"}),y.jsxs("p",{className:"text-3xl font-bold text-white",children:["$",ot.toFixed(2)]})]}),y.jsxs("div",{className:"bg-gradient-to-br from-green-500/20 to-green-600/20 rounded-2xl p-6 border border-green-500/30 backdrop-blur-sm",children:[y.jsx("h3",{className:"text-sm font-medium text-green-300 mb-2",children:"Projected Balance (60 days)"}),y.jsxs("p",{className:"text-3xl font-bold text-white",children:["$",ft.toFixed(2)]})]}),y.jsxs("div",{className:"bg-gradient-to-br from-purple-500/20 to-purple-600/20 rounded-2xl p-6 border border-purple-500/30 backdrop-blur-sm",children:[y.jsx("h3",{className:"text-sm font-medium text-purple-300 mb-2",children:"Transactions"}),y.jsx("p",{className:"text-3xl font-bold text-white",children:i.length})]})]}),y.jsxs("div",{className:"bg-gray-800/50 rounded-2xl p-6 border border-gray-700",children:[y.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Account Details"}),y.jsxs("dl",{className:"grid grid-cols-2 gap-4",children:[y.jsxs("div",{children:[y.jsx("dt",{className:"text-sm text-gray-400",children:"Account Number"}),y.jsxs("dd",{className:"text-lg font-medium text-white",children:[" ",L?.accountNumber.slice(-4)]})]}),y.jsxs("div",{children:[y.jsx("dt",{className:"text-sm text-gray-400",children:"Routing Number"}),y.jsx("dd",{className:"text-lg font-medium text-white",children:L?.routingNumber})]}),y.jsxs("div",{children:[y.jsx("dt",{className:"text-sm text-gray-400",children:"Institution"}),y.jsx("dd",{className:"text-lg font-medium text-white",children:L?.institution})]}),y.jsxs("div",{children:[y.jsx("dt",{className:"text-sm text-gray-400",children:"Account Type"}),y.jsx("dd",{className:"text-lg font-medium text-white",children:"Bills"})]})]})]}),y.jsxs("div",{children:[y.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:"Import Transactions"}),y.jsxs("div",{className:"flex gap-4",children:[y.jsx(Ux,{onImportComplete:at}),y.jsx(Hx,{onImportComplete:at})]})]}),y.jsxs("div",{className:"flex items-center gap-3 bg-gray-800/50 rounded-2xl p-4 border border-gray-700",children:[y.jsx("input",{type:"checkbox",id:"showProjections",checked:v,onChange:X=>A(X.target.checked),className:"h-5 w-5 text-blue-500 rounded bg-gray-700 border-gray-600"}),y.jsx("label",{htmlFor:"showProjections",className:"text-gray-300 font-medium",children:"Show projected transactions from recurring bills"})]})]}),g==="register"&&y.jsx(qx,{transactions:rt,onAddTransaction:gt,onDeleteTransaction:bt,onCreateRecurringBill:et,onUpdateTransaction:F,onDismissProjection:q,recurringBills:D}),g==="recurring"&&y.jsxs("div",{className:"space-y-6",children:[y.jsx(tA,{transactions:j,existingBills:D,onAddBill:et}),y.jsx(Yx,{bills:D,onAddBill:et,onUpdateBill:it,onDeleteBill:ut})]}),g==="projections"&&y.jsx(nA,{transactions:rt,currentBalance:L?.availableBalance||0}),g==="debts"&&y.jsx(sA,{debts:p,onAddDebt:M,onUpdateDebt:H,onDeleteDebt:T}),g==="sync"&&y.jsx(hA,{transactions:i,accounts:a,activeAccountId:l,recurringBills:h,debts:p,onDataLoaded:Q})]})]}),P&&y.jsx(EA,{accounts:a,onAddAccount:U,onUpdateAccount:$,onDeleteAccount:tt,onClose:()=>z(!1)})]})]})}Ay.createRoot(document.getElementById("root")).render(y.jsx(mt.StrictMode,{children:y.jsx(DA,{})}));
